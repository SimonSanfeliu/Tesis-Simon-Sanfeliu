exp,request,model,format,rag,genQuery,goldQuery,results,resultsCols,resultsRows,error,usage,resultGold,resultGoldCols,resultGoldRows
42,"Get all the objects classified as AGN with a probability larger than 0.6, with light curves covering at least one year that have at least 20 detections at least in one band, and select those that show variations larger than 1 magnitude in the g band and larger than 0.5 in the r band. The magnitudes need to be the corrected ones. Return their oid, the value, name, version and filter id from the features, mean coordinates, number of detections, maximum and minimum magnitudes, the variations in bands as the difference between the maximum and minimum magnitudes aliasing the column as 'delta_mag'. For the filter id columns, use the alias '[table_name]_fid' using the table name as the alias.",gpt-4o,sql,True,"-- Final Query: Retrieve the required data for objects meeting all conditions

SELECT obj.oid,
       feat.value,
       feat.name,
       feat.version,
       feat.fid AS feature_fid,
       obj.meanra,
       obj.meandec,
       obj.ndet,
       magstat.max_mag,
       magstat.min_mag,
       (magstat.max_mag - magstat.min_mag) AS delta_mag
FROM
  (-- Intersected oids from all conditions
 SELECT oid
   FROM
     (SELECT oid
      FROM
        (-- Sub-query for AGN classification
 SELECT DISTINCT oid
         FROM probability
         WHERE classifier_name = 'lc_classifier'
           AND class_name = 'AGN'
           AND probability > 0.6
           AND ranking = 1) AS agn_oids INTERSECT SELECT oid
      FROM
        (-- Sub-query for light curve duration
 SELECT oid
         FROM OBJECT
         WHERE (lastmjd - firstmjd) >= 365) AS duration_oids INTERSECT SELECT oid
      FROM
        (-- Sub-query for detection count
 SELECT oid
         FROM OBJECT
         WHERE ndet >= 20) AS detection_oids INTERSECT SELECT oid
      FROM
        (-- Sub-query for magnitude variation in g band
 SELECT oid
         FROM feature
         WHERE name = 'delta_mag_fid'
           AND fid = 1
           AND value > 1) AS g_variation_oids INTERSECT SELECT oid
      FROM
        (-- Sub-query for magnitude variation in r band
 SELECT oid
         FROM feature
         WHERE name = 'delta_mag_fid'
           AND fid = 2
           AND value > 0.5) AS r_variation_oids) AS final_oids) AS filtered_oids
INNER JOIN OBJECT obj ON filtered_oids.oid = obj.oid
INNER JOIN magstat ON obj.oid = magstat.oid
INNER JOIN feature feat ON obj.oid = feat.oid
WHERE feat.name IN ('delta_mag_fid')
ORDER BY obj.oid","
SELECT
  sq.oid, sq.value, sq.name, sq.fid as feature_fid, sq.version, sq.ndet, sq.meanra, sq.meandec,
  magstat.magmax, magstat.magmin,  magstat.magmax-magstat.magmin as delta_mag, magstat.fid as magstat_fid
FROM
  (
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 1
  AND feature.fid = 1
) as sq1
UNION
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 0.5
  AND feature.fid = 2
) as sq2
ORDER BY oid
) AS sq
  INNER JOIN magstat
  ON sq.oid = magstat.oid
WHERE
  sq.oid in (
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 1
  AND feature.fid = 1
) as sq1
INTERSECT
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 0.5
  AND feature.fid = 2
) as sq2
ORDER BY oid
)
  AND magstat.ndet > 20
  AND magstat.corrected = TRUE
ORDER BY oid
",,,,"(psycopg2.errors.UndefinedColumn) column magstat.max_mag does not exist
LINE 11:        magstat.max_mag,
                ^
HINT:  Perhaps you meant to reference the column ""magstat.magmax"".

[SQL: -- Final Query: Retrieve the required data for objects meeting all conditions

SELECT obj.oid,
       feat.value,
       feat.name,
       feat.version,
       feat.fid AS feature_fid,
       obj.meanra,
       obj.meandec,
       obj.ndet,
       magstat.max_mag,
       magstat.min_mag,
       (magstat.max_mag - magstat.min_mag) AS delta_mag
FROM
  (-- Intersected oids from all conditions
 SELECT oid
   FROM
     (SELECT oid
      FROM
        (-- Sub-query for AGN classification
 SELECT DISTINCT oid
         FROM probability
         WHERE classifier_name = 'lc_classifier'
           AND class_name = 'AGN'
           AND probability > 0.6
           AND ranking = 1) AS agn_oids INTERSECT SELECT oid
      FROM
        (-- Sub-query for light curve duration
 SELECT oid
         FROM OBJECT
         WHERE (lastmjd - firstmjd) >= 365) AS duration_oids INTERSECT SELECT oid
      FROM
        (-- Sub-query for detection count
 SELECT oid
         FROM OBJECT
         WHERE ndet >= 20) AS detection_oids INTERSECT SELECT oid
      FROM
        (-- Sub-query for magnitude variation in g band
 SELECT oid
         FROM feature
         WHERE name = 'delta_mag_fid'
           AND fid = 1
           AND value > 1) AS g_variation_oids INTERSECT SELECT oid
      FROM
        (-- Sub-query for magnitude variation in r band
 SELECT oid
         FROM feature
         WHERE name = 'delta_mag_fid'
           AND fid = 2
           AND value > 0.5) AS r_variation_oids) AS final_oids) AS filtered_oids
INNER JOIN OBJECT obj ON filtered_oids.oid = obj.oid
INNER JOIN magstat ON obj.oid = magstat.oid
INNER JOIN feature feat ON obj.oid = feat.oid
WHERE feat.name IN ('delta_mag_fid')
ORDER BY obj.oid]
(Background on this error at: https://sqlalche.me/e/20/f405)","{'Schema Linking': {'input_tokens': 4021, 'output_tokens': 10, 'total_tokens': 4031, 'total_cost': 0.0, 'input_cost': 0.0100525, 'output_cost': 0.0001, 'new_total_cost': 0.0101525}, 'Classification': {'input_tokens': 541, 'output_tokens': 3, 'total_tokens': 544, 'input_cost': 0.0013525, 'output_cost': 3e-05, 'total_cost': 0.0013825, 'new_total_cost': 0.0013825}, 'Decompostion': {'input_tokens': 4263, 'output_tokens': 896, 'total_tokens': 5159, 'input_cost': 0.0106575, 'output_cost': 0.00896, 'total_cost': 0.0196175, 'new_total_cost': 0.0196175}, 'Query generation': {'input_tokens': 2274, 'output_tokens': 1034, 'total_tokens': 3308, 'input_cost': 0.005685, 'output_cost': 0.01034, 'total_cost': 0.016025, 'new_total_cost': 0.016025}, 'Self-correction': {'input_tokens': 4448, 'output_tokens': 652, 'total_tokens': 5100, 'input_cost': 0.01112, 'output_cost': 0.00652, 'total_cost': 0.01764}}","              oid        value       name  feature_fid version  ndet  \
0    ZTF18aajadqs    23.218352  Amplitude            1  24.5.1  1094   
1    ZTF18aajadqs    23.218352  Amplitude            1  24.5.1  1094   
2    ZTF18aajadqs    32.419900  Amplitude            2  24.5.1  1094   
3    ZTF18aajadqs    32.419900  Amplitude            2  24.5.1  1094   
4    ZTF18aajspec  1081.856191  Amplitude            1  24.5.1   410   
..            ...          ...        ...          ...     ...   ...   
307  ZTF22aaihxyw    31.858641  Amplitude            1  24.5.1    92   
308  ZTF23aagpjmh     9.379387  Amplitude            1  24.5.1    93   
309  ZTF23aagpjmh     9.379387  Amplitude            1  24.5.1    93   
310  ZTF23aagpjmh     6.896555  Amplitude            2  24.5.1    93   
311  ZTF23aagpjmh     6.896555  Amplitude            2  24.5.1    93   

         meanra    meandec     magmax     magmin  delta_mag  magstat_fid  
0    262.778601  30.297384  20.614600  18.841400   1.773199            1  
1    262.778601  30.297384  20.236600  18.619764   1.616837            2  
2    262.778601  30.297384  20.614600  18.841400   1.773199            1  
3    262.778601  30.297384  20.236600  18.619764   1.616837            2  
4    233.968281  57.902714  18.376663  15.342505   3.034159            1  
..          ...        ...        ...        ...        ...          ...  
307  258.003548   9.019252  20.240100  19.632126   0.607975            2  
308  270.287182  13.851849  20.859700  19.852900   1.006800            1  
309  270.287182  13.851849  20.569700  19.989302   0.580399            2  
310  270.287182  13.851849  20.859700  19.852900   1.006800            1  
311  270.287182  13.851849  20.569700  19.989302   0.580399            2  

[312 rows x 12 columns]","['oid' 'value' 'name' 'feature_fid' 'version' 'ndet' 'meanra' 'meandec'
 'magmax' 'magmin' 'delta_mag' 'magstat_fid']","['ZTF18aajadqs' 'ZTF18aajadqs' 'ZTF18aajadqs' 'ZTF18aajadqs'
 'ZTF18aajspec' 'ZTF18aajspec' 'ZTF18aajspec' 'ZTF18aajspec'
 'ZTF18aakixcl' 'ZTF18aakixcl' 'ZTF18aakixcl' 'ZTF18aakixcl'
 'ZTF18aakjijh' 'ZTF18aakjijh' 'ZTF18aakjijh' 'ZTF18aakjijh'
 'ZTF18aakxwff' 'ZTF18aakxwff' 'ZTF18aakxwff' 'ZTF18aakxwff'
 'ZTF18aakxwiz' 'ZTF18aakxwiz' 'ZTF18aakxwiz' 'ZTF18aakxwiz'
 'ZTF18aalrock' 'ZTF18aalrock' 'ZTF18aalrock' 'ZTF18aalrock'
 'ZTF18aamdjwg' 'ZTF18aamdjwg' 'ZTF18aamdjwg' 'ZTF18aamdjwg'
 'ZTF18aamofne' 'ZTF18aamofne' 'ZTF18aamofne' 'ZTF18aamofne'
 'ZTF18aamofne' 'ZTF18aamofne' 'ZTF18aanfpul' 'ZTF18aanfpul'
 'ZTF18aanfpul' 'ZTF18aanfpul' 'ZTF18aaspnuh' 'ZTF18aaspnuh'
 'ZTF18aaspnuh' 'ZTF18aaspnuh' 'ZTF18aatxtgo' 'ZTF18aatxtgo'
 'ZTF18aatxtgo' 'ZTF18aatxtgo' 'ZTF18aatxtgo' 'ZTF18aatxtgo'
 'ZTF18aaucvzg' 'ZTF18aaucvzg' 'ZTF18aaucvzg' 'ZTF18aaucvzg'
 'ZTF18aaudipu' 'ZTF18aaudipu' 'ZTF18aaudipu' 'ZTF18aaudipu'
 'ZTF18aavbtmi' 'ZTF18aavbtmi' 'ZTF18aavbtmi' 'ZTF18aavbtmi'
 'ZTF18aavpbfs' 'ZTF18aavpbfs' 'ZTF18aavpbfs' 'ZTF18aavpbfs'
 'ZTF18aaxsizg' 'ZTF18aaxsizg' 'ZTF18aaxsizg' 'ZTF18aaxsizg'
 'ZTF18aaxwjxd' 'ZTF18aaxwjxd' 'ZTF18aaxwjxd' 'ZTF18aaxwjxd'
 'ZTF18aaziklu' 'ZTF18aaziklu' 'ZTF18aaziklu' 'ZTF18aaziklu'
 'ZTF18abaocda' 'ZTF18abaocda' 'ZTF18abaocda' 'ZTF18abaocda'
 'ZTF18abceijy' 'ZTF18abceijy' 'ZTF18abceijy' 'ZTF18abceijy'
 'ZTF18abdgdgx' 'ZTF18abdgdgx' 'ZTF18abdgdgx' 'ZTF18abdgdgx'
 'ZTF18abfzylf' 'ZTF18abfzylf' 'ZTF18abfzylf' 'ZTF18abfzylf'
 'ZTF18abgrqii' 'ZTF18abgrqii' 'ZTF18abgrqii' 'ZTF18abgrqii'
 'ZTF18abitzos' 'ZTF18abitzos' 'ZTF18abitzos' 'ZTF18abitzos'
 'ZTF18abjsyoz' 'ZTF18abjsyoz' 'ZTF18abjsyoz' 'ZTF18abjsyoz'
 'ZTF18abjyinu' 'ZTF18abjyinu' 'ZTF18abjyinu' 'ZTF18abjyinu'
 'ZTF18abjzard' 'ZTF18abjzard' 'ZTF18abjzard' 'ZTF18abjzard'
 'ZTF18abkuccd' 'ZTF18abkuccd' 'ZTF18abkuccd' 'ZTF18abkuccd'
 'ZTF18ablqhms' 'ZTF18ablqhms' 'ZTF18ablqhms' 'ZTF18ablqhms'
 'ZTF18abmbbiu' 'ZTF18abmbbiu' 'ZTF18abmbbiu' 'ZTF18abmbbiu'
 'ZTF18abmkaja' 'ZTF18abmkaja' 'ZTF18abmkaja' 'ZTF18abmkaja'
 'ZTF18abnrdci' 'ZTF18abnrdci' 'ZTF18abnrdci' 'ZTF18abnrdci'
 'ZTF18abqkzlv' 'ZTF18abqkzlv' 'ZTF18abqkzlv' 'ZTF18abqkzlv'
 'ZTF18abrzevn' 'ZTF18abrzevn' 'ZTF18abrzevn' 'ZTF18abrzevn'
 'ZTF18absduqy' 'ZTF18absduqy' 'ZTF18absduqy' 'ZTF18absduqy'
 'ZTF18abslvkt' 'ZTF18abslvkt' 'ZTF18abslvkt' 'ZTF18abslvkt'
 'ZTF18absnhwp' 'ZTF18absnhwp' 'ZTF18absnhwp' 'ZTF18absnhwp'
 'ZTF18abtuobh' 'ZTF18abtuobh' 'ZTF18abtuobh' 'ZTF18abtuobh'
 'ZTF18abvhpiv' 'ZTF18abvhpiv' 'ZTF18abvhpiv' 'ZTF18abvhpiv'
 'ZTF18acaozxv' 'ZTF18acaozxv' 'ZTF18acaozxv' 'ZTF18acaozxv'
 'ZTF18aceefae' 'ZTF18aceefae' 'ZTF18aceefae' 'ZTF18aceefae'
 'ZTF18acvmijm' 'ZTF18acvmijm' 'ZTF18acvmijm' 'ZTF18acvmijm'
 'ZTF18aczeraz' 'ZTF18aczeraz' 'ZTF18aczeraz' 'ZTF18aczeraz'
 'ZTF18adizfbz' 'ZTF18adizfbz' 'ZTF18adizfbz' 'ZTF18adizfbz'
 'ZTF18adjpdzn' 'ZTF18adjpdzn' 'ZTF18adjpdzn' 'ZTF18adjpdzn'
 'ZTF18adjqudh' 'ZTF18adjqudh' 'ZTF18adjqudh' 'ZTF18adjqudh'
 'ZTF18adqwjfw' 'ZTF18adqwjfw' 'ZTF18adqwjfw' 'ZTF18adqwjfw'
 'ZTF19aaafpqs' 'ZTF19aaafpqs' 'ZTF19aaafpqs' 'ZTF19aaafpqs'
 'ZTF19aaafqfi' 'ZTF19aaafqfi' 'ZTF19aaafqfi' 'ZTF19aaafqfi'
 'ZTF19aamrilw' 'ZTF19aamrilw' 'ZTF19aamrilw' 'ZTF19aamrilw'
 'ZTF19aanyknm' 'ZTF19aanyknm' 'ZTF19aanyknm' 'ZTF19aanyknm'
 'ZTF19aaobvxr' 'ZTF19aaobvxr' 'ZTF19aaobvxr' 'ZTF19aaobvxr'
 'ZTF19aaptbsf' 'ZTF19aaptbsf' 'ZTF19aaptbsf' 'ZTF19aaptbsf'
 'ZTF19aaryfsm' 'ZTF19aaryfsm' 'ZTF19aaryfsm' 'ZTF19aaryfsm'
 'ZTF19aasbwqv' 'ZTF19aasbwqv' 'ZTF19aasbwqv' 'ZTF19aasbwqv'
 'ZTF19aascdla' 'ZTF19aascdla' 'ZTF19aascdla' 'ZTF19aascdla'
 'ZTF19aasevaf' 'ZTF19aasevaf' 'ZTF19aasevaf' 'ZTF19aasevaf'
 'ZTF19aasiukp' 'ZTF19aasiukp' 'ZTF19aasiukp' 'ZTF19aasiukp'
 'ZTF19aasjadu' 'ZTF19aasjadu' 'ZTF19aasjadu' 'ZTF19aasjadu'
 'ZTF19aayjofc' 'ZTF19aayjofc' 'ZTF19aayjofc' 'ZTF19aayjofc'
 'ZTF19abauzsd' 'ZTF19abauzsd' 'ZTF19abauzsd' 'ZTF19abauzsd'
 'ZTF19abhcfnm' 'ZTF19abhcfnm' 'ZTF19abhcfnm' 'ZTF19abhcfnm'
 'ZTF19abulmuc' 'ZTF19abulmuc' 'ZTF19abulmuc' 'ZTF19abulmuc'
 'ZTF19abyfdgi' 'ZTF19abyfdgi' 'ZTF19abyfdgi' 'ZTF19abyfdgi'
 'ZTF20aahdafc' 'ZTF20aahdafc' 'ZTF20aahdafc' 'ZTF20aahdafc'
 'ZTF20aakodkt' 'ZTF20aakodkt' 'ZTF20aakodkt' 'ZTF20aakodkt'
 'ZTF20aamttqy' 'ZTF20aamttqy' 'ZTF20aamttqy' 'ZTF20aamttqy'
 'ZTF20aaodmdi' 'ZTF20aaodmdi' 'ZTF20aaodmdi' 'ZTF20aaodmdi'
 'ZTF20aavijyr' 'ZTF20aavijyr' 'ZTF20aavijyr' 'ZTF20aavijyr'
 'ZTF20aaxdogb' 'ZTF20aaxdogb' 'ZTF20aaxdogb' 'ZTF20aaxdogb'
 'ZTF20abfrvoj' 'ZTF20abfrvoj' 'ZTF20abfrvoj' 'ZTF20abfrvoj'
 'ZTF20abfuuhk' 'ZTF20abfuuhk' 'ZTF20abfuuhk' 'ZTF20abfuuhk'
 'ZTF20abgsnck' 'ZTF20abgsnck' 'ZTF20abgsnck' 'ZTF20abgsnck'
 'ZTF21aaihchs' 'ZTF21aaihchs' 'ZTF21aaihchs' 'ZTF21aaihchs'
 'ZTF22aaihxyw' 'ZTF22aaihxyw' 'ZTF22aaihxyw' 'ZTF22aaihxyw'
 'ZTF23aagpjmh' 'ZTF23aagpjmh' 'ZTF23aagpjmh' 'ZTF23aagpjmh']"
43," Get the object identifiers, probabilities in the stamp classifier and light curves (including only non-detections) for objects whose highest probability in the stamp classifier is obtained for class SN, had their first detection in the first 2 days of september, and qualify as fast risers. Also, return the oid, probability, filter ID and the image difference, and filter ID of magstat as 'magstat_fid', with the initial rise estimate. Order the results by the oid and limit the results to 100 rows due to time constraints.",gpt-4o,sql,True,"-- Final Query: Retrieve object identifiers, probabilities, and light curves including non-detections

SELECT sq.oid,
       sq.probability,
       sq.fid,
       sq.image_difference,
       magstat.fid AS magstat_fid,
       magstat.dmdt_first
FROM
  (SELECT detection.oid,
          detection.probability,
          detection.fid,
          detection.image_difference
   FROM detection
   WHERE detection.oid IN
       (SELECT oid
        FROM
          (SELECT oid
           FROM
             (SELECT object.oid
              FROM OBJECT
              INNER JOIN probability ON object.oid = probability.oid
              WHERE probability.classifier_name = 'stamp_classifier'
                AND probability.class_name = 'SN'
                AND probability.ranking = 1) AS sn_oids INTERSECT SELECT oid
           FROM
             (SELECT oid
              FROM OBJECT
              WHERE firstmjd > 60188.0
                AND firstmjd < 60189.0) AS september_oids INTERSECT SELECT oid
           FROM
             (SELECT oid
              FROM magstat
              WHERE dmdt_first < -0.25) AS fast_risers_oids) AS combined_oids)
   UNION SELECT non_detection.oid,
                NULL AS probability,
                non_detection.fid,
                NULL AS image_difference
   FROM non_detection
   WHERE non_detection.oid IN
       (SELECT oid
        FROM
          (SELECT oid
           FROM
             (SELECT object.oid
              FROM OBJECT
              INNER JOIN probability ON object.oid = probability.oid
              WHERE probability.classifier_name = 'stamp_classifier'
                AND probability.class_name = 'SN'
                AND probability.ranking = 1) AS sn_oids INTERSECT SELECT oid
           FROM
             (SELECT oid
              FROM OBJECT
              WHERE firstmjd > 60188.0
                AND firstmjd < 60189.0) AS september_oids INTERSECT SELECT oid
           FROM
             (SELECT oid
              FROM magstat
              WHERE dmdt_first < -0.25) AS fast_risers_oids) AS combined_oids)) AS sq
INNER JOIN magstat ON sq.oid = magstat.oid
ORDER BY sq.oid
LIMIT 100","SELECT
    sq.oid, sq.probability, sq.diffmaglim, sq.fid, sq.mjd,
    magstat.fid as magstat_fid, magstat.dmdt_first
FROM
  (
SELECT
   non_detection.fid, non_detection.diffmaglim, non_detection.mjd, obj_oids.oid, obj_oids.probability
FROM
  (
SELECT
    object.oid, probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='stamp_classifier'
    AND probability.class_name='SN'
    AND probability.ranking=1
    AND object.firstmjd > 60188.0
    AND object.firstmjd < 60189.0
) as obj_oids
    INNER JOIN
    non_detection ON non_detection.oid = obj_oids.oid
) AS sq
  INNER JOIN magstat
  ON sq.oid = magstat.oid
WHERE
  magstat.dmdt_first < -0.25
ORDER BY oid
LIMIT 100",,,,"(psycopg2.errors.UndefinedColumn) column detection.probability does not exist
LINE 11:           detection.probability,
                   ^

[SQL: -- Final Query: Retrieve object identifiers, probabilities, and light curves including non-detections

SELECT sq.oid,
       sq.probability,
       sq.fid,
       sq.image_difference,
       magstat.fid AS magstat_fid,
       magstat.dmdt_first
FROM
  (SELECT detection.oid,
          detection.probability,
          detection.fid,
          detection.image_difference
   FROM detection
   WHERE detection.oid IN
       (SELECT oid
        FROM
          (SELECT oid
           FROM
             (SELECT object.oid
              FROM OBJECT
              INNER JOIN probability ON object.oid = probability.oid
              WHERE probability.classifier_name = 'stamp_classifier'
                AND probability.class_name = 'SN'
                AND probability.ranking = 1) AS sn_oids INTERSECT SELECT oid
           FROM
             (SELECT oid
              FROM OBJECT
              WHERE firstmjd > 60188.0
                AND firstmjd < 60189.0) AS september_oids INTERSECT SELECT oid
           FROM
             (SELECT oid
              FROM magstat
              WHERE dmdt_first < -0.25) AS fast_risers_oids) AS combined_oids)
   UNION SELECT non_detection.oid,
                NULL AS probability,
                non_detection.fid,
                NULL AS image_difference
   FROM non_detection
   WHERE non_detection.oid IN
       (SELECT oid
        FROM
          (SELECT oid
           FROM
             (SELECT object.oid
              FROM OBJECT
              INNER JOIN probability ON object.oid = probability.oid
              WHERE probability.classifier_name = 'stamp_classifier'
                AND probability.class_name = 'SN'
                AND probability.ranking = 1) AS sn_oids INTERSECT SELECT oid
           FROM
             (SELECT oid
              FROM OBJECT
              WHERE firstmjd > 60188.0
                AND firstmjd < 60189.0) AS september_oids INTERSECT SELECT oid
           FROM
             (SELECT oid
              FROM magstat
              WHERE dmdt_first < -0.25) AS fast_risers_oids) AS combined_oids)) AS sq
INNER JOIN magstat ON sq.oid = magstat.oid
ORDER BY sq.oid
LIMIT 100]
(Background on this error at: https://sqlalche.me/e/20/f405)","{'Schema Linking': {'input_tokens': 3916, 'output_tokens': 13, 'total_tokens': 3929, 'total_cost': 0.0, 'input_cost': 0.00979, 'output_cost': 0.00013, 'new_total_cost': 0.00992}, 'Classification': {'input_tokens': 500, 'output_tokens': 3, 'total_tokens': 503, 'input_cost': 0.00125, 'output_cost': 3e-05, 'total_cost': 0.00128, 'new_total_cost': 0.00128}, 'Decompostion': {'input_tokens': 4222, 'output_tokens': 760, 'total_tokens': 4982, 'input_cost': 0.010555, 'output_cost': 0.0076, 'total_cost': 0.018155, 'new_total_cost': 0.018155}, 'Query generation': {'input_tokens': 2097, 'output_tokens': 1575, 'total_tokens': 3672, 'input_cost': 0.0052425, 'output_cost': 0.01575, 'total_cost': 0.0209925, 'new_total_cost': 0.0209925}, 'Self-correction': {'input_tokens': 4442, 'output_tokens': 410, 'total_tokens': 4852, 'input_cost': 0.011105, 'output_cost': 0.0041, 'total_cost': 0.015205}}","             oid  probability  diffmaglim  fid           mjd  magstat_fid  \
0   ZTF18aaiaclp     0.520409     20.4159    1  60161.201343            2   
1   ZTF18aaiaclp     0.520409     20.5201    1  60161.206146            2   
2   ZTF18aaiaclp     0.520409     19.7568    1  60161.283750            2   
3   ZTF18aaiaclp     0.520409     19.5815    1  60163.299884            2   
4   ZTF18aaiaclp     0.520409     19.7775    1  60163.300359            2   
..           ...          ...         ...  ...           ...          ...   
95  ZTF18aaleydm     0.613368     16.7941    2  60158.233981            2   
96  ZTF18aaleydm     0.613368     19.9087    2  60161.343796            2   
97  ZTF18aaleydm     0.613368     20.2772    2  60163.288322            2   
98  ZTF18aaleydm     0.613368     20.6824    2  60165.215347            2   
99  ZTF18aaleydm     0.613368     20.2314    2  60169.290069            2   

    dmdt_first  
0    -0.445361  
1    -0.445361  
2    -0.445361  
3    -0.445361  
4    -0.445361  
..         ...  
95   -0.830610  
96   -0.830610  
97   -0.830610  
98   -0.830610  
99   -0.830610  

[100 rows x 7 columns]",['oid' 'probability' 'diffmaglim' 'fid' 'mjd' 'magstat_fid' 'dmdt_first'],"['ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aaiaclp'
 'ZTF18aaiaclp' 'ZTF18aaiaclp' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj' 'ZTF18aakjgzj'
 'ZTF18aakjgzj' 'ZTF18aaleydm' 'ZTF18aaleydm' 'ZTF18aaleydm'
 'ZTF18aaleydm' 'ZTF18aaleydm' 'ZTF18aaleydm' 'ZTF18aaleydm'
 'ZTF18aaleydm' 'ZTF18aaleydm' 'ZTF18aaleydm' 'ZTF18aaleydm'
 'ZTF18aaleydm' 'ZTF18aaleydm' 'ZTF18aaleydm' 'ZTF18aaleydm']"
45,"Find at most 10 ZTF objects that have a first detection date later than mjd=60310 days, as well as a probability of 1 of being an asteroid in the stamp classifier, ordered by the first detection date. Return all columns from the 'forced_photometry' table for such objects",gpt-4o,sql,True,"-- Final query combining all steps

SELECT *
FROM forced_photometry
WHERE oid IN
    (SELECT oid
     FROM
       (SELECT oid
        FROM OBJECT
        WHERE firstmjd > 60310) AS first_detection_oids INTERSECT SELECT oid
     FROM
       (SELECT oid
        FROM probability
        WHERE classifier_name = 'stamp_classifier'
          AND class_name = 'asteroid'
          AND probability = 1
          AND ranking = 1) AS asteroid_probability_oids)
ORDER BY firstmjd
LIMIT 10","SELECT
    *
FROM
    forced_photometry
WHERE
    oid in
(
SELECT
    object.oid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    firstmjd > 60310
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability = 1
ORDER BY firstmjd
LIMIT 10
)
",,,,"(psycopg2.errors.UndefinedColumn) column ""firstmjd"" does not exist
LINE 18: ORDER BY firstmjd
                  ^

[SQL: -- Final query combining all steps

SELECT *
FROM forced_photometry
WHERE oid IN
    (SELECT oid
     FROM
       (SELECT oid
        FROM OBJECT
        WHERE firstmjd > 60310) AS first_detection_oids INTERSECT SELECT oid
     FROM
       (SELECT oid
        FROM probability
        WHERE classifier_name = 'stamp_classifier'
          AND class_name = 'asteroid'
          AND probability = 1
          AND ranking = 1) AS asteroid_probability_oids)
ORDER BY firstmjd
LIMIT 10]
(Background on this error at: https://sqlalche.me/e/20/f405)","{'Schema Linking': {'input_tokens': 3893, 'output_tokens': 10, 'total_tokens': 3903, 'total_cost': 0.0, 'input_cost': 0.0097325, 'output_cost': 0.0001, 'new_total_cost': 0.0098325}, 'Classification': {'input_tokens': 449, 'output_tokens': 3, 'total_tokens': 452, 'input_cost': 0.0011225, 'output_cost': 3e-05, 'total_cost': 0.0011525, 'new_total_cost': 0.0011525}, 'Decompostion': {'input_tokens': 4172, 'output_tokens': 525, 'total_tokens': 4697, 'input_cost': 0.01043, 'output_cost': 0.00525, 'total_cost': 0.01568, 'new_total_cost': 0.01568}, 'Query generation': {'input_tokens': 1812, 'output_tokens': 485, 'total_tokens': 2297, 'input_cost': 0.00453, 'output_cost': 0.00485, 'total_cost': 0.00938, 'new_total_cost': 0.00938}, 'Self-correction': {'input_tokens': 4027, 'output_tokens': 204, 'total_tokens': 4231, 'input_cost': 0.0100675, 'output_cost': 0.00204, 'total_cost': 0.0121075}}","              pid           oid           mjd  fid          ra        dec  \
0   2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
1   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
2   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
3   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
4   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
65  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
66  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
67  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
68  2530118462415  ZTF24aaaajsp  60284.118461    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None  100.000000  100.000000  ...   20.395599          1   
1   None  None  100.000000  100.000000  ...   20.335699          1   
2   None  None   24.218550    5.723178  ...   20.183001          1   
3   None  None   21.659468    0.900523  ...   19.729099          1   
4   None  None  100.000000  100.000000  ...   20.528500          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   22.721621    1.108646  ...   20.472601          1   
65  None  None   23.318583    5.318606  ...   19.507900          1   
66  None  None   24.333900    6.619290  ...   20.122700          1   
67  None  None   23.181665    1.554161  ...   20.576700          1   
68  None  None   23.188475    1.678015  ...   20.609200          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.621940    340.821625     46.927788     17.041   
66           0      4.609645    340.821625     46.927795     17.605   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.017      0.740     -0.052  
66      0.021      0.903     -0.069  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]","['pid' 'oid' 'mjd' 'fid' 'ra' 'dec' 'e_ra' 'e_dec' 'mag' 'e_mag'
 'mag_corr' 'e_mag_corr' 'e_mag_corr_ext' 'isdiffpos' 'corrected'
 'dubious' 'parent_candid' 'has_stamp' 'field' 'rcid' 'rfid'
 'sciinpseeing' 'scibckgnd' 'scisigpix' 'magzpsci' 'magzpsciunc'
 'magzpscirms' 'clrcoeff' 'clrcounc' 'exptime' 'adpctdif1' 'adpctdif2'
 'diffmaglim' 'programid' 'procstatus' 'distnr' 'ranr' 'decnr' 'magnr'
 'sigmagnr' 'chinr' 'sharpnr']","['ZTF24aaaajnz' 'ZTF24aaaajnz' 'ZTF24aaaajnz' 'ZTF24aaaajnz'
 'ZTF24aaaajnz' 'ZTF24aaaajnz' 'ZTF24aaaajws' 'ZTF24aaaajws'
 'ZTF24aaaajws' 'ZTF24aaaajws' 'ZTF24aaaajws' 'ZTF24aaaajws'
 'ZTF24aaaajor' 'ZTF24aaaajor' 'ZTF24aaaajor' 'ZTF24aaaajor'
 'ZTF24aaaajor' 'ZTF24aaaajor' 'ZTF24aaaajcx' 'ZTF24aaaajcx'
 'ZTF24aaaajcx' 'ZTF24aaaajcx' 'ZTF24aaaajcx' 'ZTF24aaaajqo'
 'ZTF24aaaajqo' 'ZTF24aaaajqo' 'ZTF24aaaajqo' 'ZTF24aaaajqo'
 'ZTF24aaaajqo' 'ZTF24aaaakhc' 'ZTF24aaaakhc' 'ZTF24aaaakhc'
 'ZTF24aaaakhc' 'ZTF24aaaakhc' 'ZTF24aaaakhc' 'ZTF24aaaakhc'
 'ZTF24aaaakhc' 'ZTF24aaaajzf' 'ZTF24aaaajzf' 'ZTF24aaaajzf'
 'ZTF24aaaajzf' 'ZTF24aaaajzf' 'ZTF24aaaajzf' 'ZTF24aaaajjf'
 'ZTF24aaaajjf' 'ZTF24aaaajjf' 'ZTF24aaaajjf' 'ZTF24aaaajjf'
 'ZTF24aaaajjf' 'ZTF24aaaajjf' 'ZTF24aaaajjf' 'ZTF24aaaajjf'
 'ZTF24aaaajjf' 'ZTF24aaaajjf' 'ZTF24aaaajjf' 'ZTF24aaaajjf'
 'ZTF24aaaajuw' 'ZTF24aaaajuw' 'ZTF24aaaajuw' 'ZTF24aaaajuw'
 'ZTF24aaaajuw' 'ZTF24aaaajuw' 'ZTF24aaaajuw' 'ZTF24aaaajsp'
 'ZTF24aaaajsp' 'ZTF24aaaajsp' 'ZTF24aaaajsp' 'ZTF24aaaajsp'
 'ZTF24aaaajsp']"
46,"Find at most 50 ZTF objects that satisfy the following conditions: have a probability larger than 0.6 of being an AGN in the light curve classifier, and a WISE W1 magnitude between 12 and 13. Return all columns from the 'magstat' table for such objects",gpt-4o,sql,True,"-- Final query to retrieve up to 50 ZTF objects that satisfy the specified conditions

SELECT magstat.*
FROM magstat
WHERE magstat.oid IN
    (SELECT p.oid
     FROM
       (SELECT oid
        FROM probability
        WHERE classifier_name = 'lc_classifier'
          AND class_name = 'AGN'
          AND ranking = 1
          AND probability > 0.6) AS p
     INNER JOIN
       (SELECT oid
        FROM allwise
        WHERE w1mpro BETWEEN 12 AND 13) AS a ON p.oid = a.oid)
LIMIT 50","SELECT
    *
FROM
    magstat
WHERE
    oid IN
(
SELECT
    probability.oid
FROM
    probability INNER JOIN
    xmatch
    ON probability.oid = xmatch.oid
    INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    w1mpro > 12
    AND w1mpro < 13
    AND classifier_name = 'lc_classifier'
    AND class_name = 'AGN'
    AND probability > 0.6
LIMIT 50
)","             oid  fid  stellar  corrected  ndet  ndubious dmdt_first dm_first  \
0   ZTF20ablvwmh    1    False       True    33         0       None     None   
1   ZTF20ablvwmh    2    False       True    38         0       None     None   
2   ZTF20abthgga    1    False       True    38         0       None     None   
3   ZTF20abocrnq    2    False       True    10         0       None     None   
4   ZTF18abwwuzz    2    False       True    14         0       None     None   
5   ZTF24aaykfsk    1    False       True    38         0       None     None   
6   ZTF19abziswg    2    False       True    98         0       None     None   
7   ZTF24aaxnntz    1    False       True    46         0       None     None   
8   ZTF23abqbwes    2    False       True     5         0       None     None   
9   ZTF23aagewbg    1    False       True    43         0       None     None   
10  ZTF24aamqlzs    2    False       True     5         0       None     None   
11  ZTF19abycyzq    2    False       True     8         0       None     None   
12  ZTF20acjmyis    2    False       True    13         0       None     None   
13  ZTF19acymlwl    2    False       True     3         0       None     None   
14  ZTF19acbwoxy    2    False       True    15         0       None     None   
15  ZTF19abfvhur    2    False       True     8         0       None     None   
16  ZTF23abqxker    1    False       True     9         0       None     None   
17  ZTF23abejwlj    2    False       True     4         0       None     None   
18  ZTF24aayyuyx    2    False       True    16         0       None     None   
19  ZTF20acjahtm    1    False       True    52         0       None     None   
20  ZTF24aayfkif    1    False       True    27         0       None     None   
21  ZTF23aajdhoq    1    False       True     8         0       None     None   
22  ZTF23aajdhoq    2    False       True     1         0       None     None   
23  ZTF20abzgirf    1    False       True    18         0       None     None   
24  ZTF24aaymhil    1    False       True    21         0       None     None   
25  ZTF21aaiwigz    2    False       True    25         0       None     None   
26  ZTF18acbzqcr    1    False       True    79         0       None     None   
27  ZTF20aaipauc    2    False       True    21         0       None     None   
28  ZTF18acnbgnc    3    False       True     1         0       None     None   
29  ZTF20aansddn    1    False       True    40         0       None     None   
30  ZTF20aansddn    2    False       True    10         0       None     None   
31  ZTF24aagwytr    2    False       True     9         0       None     None   
32  ZTF19acccznf    2    False       True   149         0       None     None   
33  ZTF18abwtmla    1    False       True   229         0       None     None   
34  ZTF23aascnus    2    False       True    35         0       None     None   
35  ZTF23absdlhy    1    False       True    24         0       None     None   
36  ZTF18adlqzid    1    False       True    13         0       None     None   
37  ZTF18adlqzid    2    False       True     1         0       None     None   
38  ZTF20aascymj    1    False       True    54         0       None     None   
39  ZTF22aaixvin    2    False       True    20         0       None     None   
40  ZTF24aazyfyy    1    False       True    25         0       None     None   
41  ZTF18abhxotz    2    False       True    78         0       None     None   
42  ZTF20abgdiax    1    False       True    17         0       None     None   
43  ZTF19abualdu    2    False       True     3         0       None     None   
44  ZTF18acurjjx    1    False       True    74         0       None     None   
45  ZTF20abanneu    1    False       True     3         0       None     None   
46  ZTF20abanneu    2    False       True    12         0       None     None   
47  ZTF20aascymj    2    False       True    27         0       None     None   
48  ZTF24abagvem    1    False       True    10         0       None     None   
49  ZTF20abeohyf    1    False       True     7         0       None     None   

   sigmadm_first dt_first  ...  magmedian_corr  magmax_corr  magmin_corr  \
0           None     None  ...             NaN          NaN          NaN   
1           None     None  ...       19.819477    19.819477    19.819477   
2           None     None  ...       19.337528    19.345667    19.329388   
3           None     None  ...       19.457071    19.497710    19.419983   
4           None     None  ...       18.424168    18.424168    18.424168   
5           None     None  ...       18.656641    18.708208    18.618885   
6           None     None  ...       18.500824    18.681847    18.401377   
7           None     None  ...       19.229080    19.395044    18.957907   
8           None     None  ...       18.862757    18.862757    18.862757   
9           None     None  ...       20.080544    20.118319    20.045538   
10          None     None  ...       18.723408    18.751348    18.695467   
11          None     None  ...       19.547860    19.547860    19.547860   
12          None     None  ...             NaN          NaN          NaN   
13          None     None  ...             NaN          NaN          NaN   
14          None     None  ...       18.746320    18.795076    18.716625   
15          None     None  ...             NaN          NaN          NaN   
16          None     None  ...       19.832142    19.911161    19.735031   
17          None     None  ...       19.342850    19.354637    19.262611   
18          None     None  ...       19.104542    19.157700    18.973026   
19          None     None  ...       19.275946    19.324411    19.249823   
20          None     None  ...       19.588144    19.753895    19.241402   
21          None     None  ...       18.314947    18.337050    18.244932   
22          None     None  ...       17.752785    17.752785    17.752785   
23          None     None  ...       18.815905    18.815905    18.815905   
24          None     None  ...       19.977833    20.113134    19.870264   
25          None     None  ...       19.049305    19.200659    19.013496   
26          None     None  ...       18.833860    18.873947    18.726810   
27          None     None  ...             NaN          NaN          NaN   
28          None     None  ...             NaN          NaN          NaN   
29          None     None  ...       19.961943    20.192549    19.875132   
30          None     None  ...             NaN          NaN          NaN   
31          None     None  ...       18.273176    18.358496    18.253240   
32          None     None  ...       19.428532    19.993923    18.885424   
33          None     None  ...       17.431490    17.801197    16.952633   
34          None     None  ...       18.827646    18.855627    18.781513   
35          None     None  ...       19.768314    20.138363    19.560333   
36          None     None  ...       19.763140    19.858440    19.658790   
37          None     None  ...             NaN          NaN          NaN   
38          None     None  ...       18.699076    18.705557    18.688301   
39          None     None  ...       20.004080    20.103245    19.904917   
40          None     None  ...       19.069440    19.140905    18.956514   
41          None     None  ...       19.465017    19.491830    19.439530   
42          None     None  ...       19.713260    19.812096    19.620970   
43          None     None  ...       19.683400    19.683400    19.683400   
44          None     None  ...       18.350250    18.654222    17.845154   
45          None     None  ...             NaN          NaN          NaN   
46          None     None  ...       18.972340    18.978880    18.965797   
47          None     None  ...       18.468525    18.473875    18.448477   
48          None     None  ...       20.972620    21.382965    20.816614   
49          None     None  ...       20.241629    20.521738    20.060534   

    magsigma_corr  maglast_corr  magfirst_corr   firstmjd    lastmjd  \
0             NaN           NaN            NaN  59042.360  59522.234   
1        0.000000     19.819477            NaN  59042.460  60525.312   
2        0.008140     19.345667            NaN  59075.360  60607.246   
3        0.031743     19.497710            NaN  59031.438  60609.164   
4        0.000000     18.424168            NaN  60501.375  60594.223   
5        0.030040     18.618885            NaN  60521.418  60614.234   
6        0.064667     18.606432      18.428804  58744.170  60649.234   
7        0.107021     19.170938      19.301268  60502.453  60652.086   
8        0.000000     18.862757            NaN  60252.280  60533.363   
9        0.024380     20.090836            NaN  60081.440  60576.130   
10       0.027941     18.751348            NaN  60526.280  60552.240   
11       0.000000     19.547860            NaN  60513.470  60607.200   
12            NaN           NaN            NaN  59134.320  59913.234   
13            NaN           NaN            NaN  58864.210  58892.145   
14       0.027699     18.795076            NaN  60503.400  60536.370   
15            NaN           NaN            NaN  58757.297  60558.430   
16       0.057762     19.735031            NaN  60499.420  60533.310   
17       0.040887     19.262611      19.354637  60507.395  60533.344   
18       0.053888     19.051424      19.107258  60518.473  60651.184   
19       0.029760     19.324411            NaN  59134.266  60554.477   
20       0.093895     19.753895      19.610820  60527.496  60653.170   
21       0.027476     18.321949      18.316034  60498.215  60528.190   
22       0.000000     17.752785      17.752785  60501.266  60501.266   
23       0.000000     18.815905            NaN  59723.387  60528.223   
24       0.067366     19.953371            NaN  60507.453  60582.406   
25       0.037510     19.033398      19.023027  59671.348  60651.473   
26       0.062107     18.833860            NaN  58428.530  60640.387   
27            NaN           NaN            NaN  59141.516  59319.200   
28            NaN           NaN            NaN  60438.180  60438.180   
29       0.112717     20.192549            NaN  58871.430  60640.390   
30            NaN           NaN            NaN  58894.260  59144.535   
31       0.040420     18.345247      18.358496  60404.152  60650.460   
32       0.219793     19.392788      19.033579  58787.527  60652.460   
33       0.214669     17.401314      17.009703  58377.523  60653.320   
34       0.024767     18.784796            NaN  60436.465  60529.280   
35       0.143311     20.015684      19.587214  60311.450  60653.330   
36       0.072586     19.858440            NaN  60433.375  60530.200   
37            NaN           NaN            NaN  60436.445  60436.445   
38       0.007117     18.699076            NaN  58894.560  60576.130   
39       0.099164     19.904917            NaN  59671.324  60640.420   
40       0.066934     18.956514            NaN  60501.240  60623.100   
41       0.016260     19.491830            NaN  58320.348  60561.203   
42       0.062474     19.713260            NaN  59014.387  60557.285   
43       0.000000     19.683400            NaN  60204.380  60566.360   
44       0.228588     17.902830      17.996529  58461.480  60652.496   
45            NaN           NaN            NaN  58987.246  59012.293   
46       0.006541     18.978880            NaN  58967.360  60532.168   
47       0.010932     18.473875            NaN  58894.543  60554.195   
48       0.158122     21.034369      20.816614  60518.234  60533.242   
49       0.143888     20.241549            NaN  59012.195  60532.215   

    step_id_corr  saturation_rate  
0         24.5.1              0.0  
1         24.5.1              0.0  
2         24.5.1              0.0  
3         24.5.1              0.0  
4         24.5.1              0.0  
5         24.5.1              0.0  
6         26.0.0              0.0  
7         26.0.0              0.0  
8         24.5.1              0.0  
9         24.5.1              0.0  
10        24.5.1              0.0  
11        24.5.1              0.0  
12        24.5.1              0.0  
13        24.5.1              0.0  
14        24.5.1              0.0  
15        24.5.1              0.0  
16        24.5.1              0.0  
17        24.5.1              0.0  
18        26.0.0              0.0  
19        24.5.1              0.0  
20        26.0.0              0.0  
21        24.5.1              0.0  
22        24.5.1              0.0  
23        24.5.1              0.0  
24        24.5.1              0.0  
25        26.0.0              0.0  
26        24.5.1              0.0  
27        24.5.1              0.0  
28        24.5.1              0.0  
29        24.5.1              0.0  
30        24.5.1              0.0  
31        26.0.0              0.0  
32        26.0.0              0.0  
33        26.0.0              0.0  
34        24.5.1              0.0  
35        26.0.0              0.0  
36        24.5.1              0.0  
37        24.5.1              0.0  
38        24.5.1              0.0  
39        24.5.1              0.0  
40        24.5.1              0.0  
41        24.5.1              0.0  
42        24.5.1              0.0  
43        24.5.1              0.0  
44        26.0.0              0.0  
45        24.5.1              0.0  
46        24.5.1              0.0  
47        24.5.1              0.0  
48        24.5.1              0.0  
49        24.5.1              0.0  

[50 rows x 28 columns]","['oid' 'fid' 'stellar' 'corrected' 'ndet' 'ndubious' 'dmdt_first'
 'dm_first' 'sigmadm_first' 'dt_first' 'magmean' 'magmedian' 'magmax'
 'magmin' 'magsigma' 'maglast' 'magfirst' 'magmean_corr' 'magmedian_corr'
 'magmax_corr' 'magmin_corr' 'magsigma_corr' 'maglast_corr'
 'magfirst_corr' 'firstmjd' 'lastmjd' 'step_id_corr' 'saturation_rate']","['ZTF20ablvwmh' 'ZTF20ablvwmh' 'ZTF20abthgga' 'ZTF20abocrnq'
 'ZTF18abwwuzz' 'ZTF24aaykfsk' 'ZTF19abziswg' 'ZTF24aaxnntz'
 'ZTF23abqbwes' 'ZTF23aagewbg' 'ZTF24aamqlzs' 'ZTF19abycyzq'
 'ZTF20acjmyis' 'ZTF19acymlwl' 'ZTF19acbwoxy' 'ZTF19abfvhur'
 'ZTF23abqxker' 'ZTF23abejwlj' 'ZTF24aayyuyx' 'ZTF20acjahtm'
 'ZTF24aayfkif' 'ZTF23aajdhoq' 'ZTF23aajdhoq' 'ZTF20abzgirf'
 'ZTF24aaymhil' 'ZTF21aaiwigz' 'ZTF18acbzqcr' 'ZTF20aaipauc'
 'ZTF18acnbgnc' 'ZTF20aansddn' 'ZTF20aansddn' 'ZTF24aagwytr'
 'ZTF19acccznf' 'ZTF18abwtmla' 'ZTF23aascnus' 'ZTF23absdlhy'
 'ZTF18adlqzid' 'ZTF18adlqzid' 'ZTF20aascymj' 'ZTF22aaixvin'
 'ZTF24aazyfyy' 'ZTF18abhxotz' 'ZTF20abgdiax' 'ZTF19abualdu'
 'ZTF18acurjjx' 'ZTF20abanneu' 'ZTF20abanneu' 'ZTF20aascymj'
 'ZTF24abagvem' 'ZTF20abeohyf']",,"{'Schema Linking': {'input_tokens': 3919, 'output_tokens': 10, 'total_tokens': 3929, 'total_cost': 0.0, 'input_cost': 0.0097975, 'output_cost': 0.0001, 'new_total_cost': 0.0098975}, 'Classification': {'input_tokens': 448, 'output_tokens': 3, 'total_tokens': 451, 'input_cost': 0.00112, 'output_cost': 3e-05, 'total_cost': 0.00115, 'new_total_cost': 0.00115}, 'Decompostion': {'input_tokens': 3928, 'output_tokens': 423, 'total_tokens': 4351, 'input_cost': 0.00982, 'output_cost': 0.00423, 'total_cost': 0.01405, 'new_total_cost': 0.01405}, 'Query generation': {'input_tokens': 1419, 'output_tokens': 471, 'total_tokens': 1890, 'input_cost': 0.0035475, 'output_cost': 0.00471, 'total_cost': 0.0082575, 'new_total_cost': 0.0082575}, 'Self-correction': {'input_tokens': 3857, 'output_tokens': 390, 'total_tokens': 4247, 'input_cost': 0.0096425, 'output_cost': 0.0039, 'total_cost': 0.013542499999999999}}","              oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0    ZTF20aaxxtoh    1    False       True   213         0         NaN   
1    ZTF20aaxxtoh    2    False       True    73         0         NaN   
2    ZTF19abjgeko    1    False       True   225         0         NaN   
3    ZTF19abjgeko    2    False       True   215         0         NaN   
4    ZTF18aasrwgz    1    False       True   318         5         NaN   
..            ...  ...      ...        ...   ...       ...         ...   
105  ZTF18aajmsxl    2    False       True   300         0         NaN   
106  ZTF22aadhosm    1    False       True   129         0         NaN   
107  ZTF22aadhosm    2    False       True   183         0         NaN   
108  ZTF20abgbwbb    1    False       True   119         0         NaN   
109  ZTF20abgbwbb    2    False       True    81         0         NaN   

     dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0         NaN            NaN       NaN  ...       17.274387    17.316502   
1         NaN            NaN       NaN  ...             NaN          NaN   
2         NaN            NaN       NaN  ...       18.952019    19.050432   
3         NaN            NaN       NaN  ...       18.187994    18.187994   
4         NaN            NaN       NaN  ...       17.047077    17.511827   
..        ...            ...       ...  ...             ...          ...   
105       NaN            NaN       NaN  ...       17.885422    17.920080   
106       NaN            NaN       NaN  ...       17.930609    18.200792   
107       NaN            NaN       NaN  ...       17.093279    17.295225   
108       NaN            NaN       NaN  ...       17.126451    17.126451   
109       NaN            NaN       NaN  ...             NaN          NaN   

     magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0      17.252230       0.023305     17.316502            NaN  58970.440   
1            NaN            NaN           NaN            NaN  59020.277   
2      18.896858       0.056189     19.050432            NaN  58695.457   
3      18.187994       0.000000     18.187994            NaN  58692.492   
4      16.622496       0.216438     17.106848      16.768148  58480.480   
..           ...            ...           ...            ...        ...   
105    17.850763       0.034658     17.850763            NaN  58432.508   
106    17.742647       0.088738     17.871157      18.200792  59764.434   
107    16.963130       0.081110     17.097357      17.260368  59670.504   
108    17.126451       0.000000     17.126451            NaN  59018.387   
109          NaN            NaN           NaN            NaN  59051.355   

       lastmjd  step_id_corr  saturation_rate  
0    60619.113        24.5.1              0.0  
1    60602.100        24.5.1              0.0  
2    60648.200        24.5.1              0.0  
3    60640.260        24.5.1              0.0  
4    60652.508        26.0.0              0.0  
..         ...           ...              ...  
105  60648.460        24.5.1              0.0  
106  60653.156        26.0.0              0.0  
107  60653.120        26.0.0              0.0  
108  60619.110        24.5.1              0.0  
109  60609.125        24.5.1              0.0  

[110 rows x 28 columns]","['oid' 'fid' 'stellar' 'corrected' 'ndet' 'ndubious' 'dmdt_first'
 'dm_first' 'sigmadm_first' 'dt_first' 'magmean' 'magmedian' 'magmax'
 'magmin' 'magsigma' 'maglast' 'magfirst' 'magmean_corr' 'magmedian_corr'
 'magmax_corr' 'magmin_corr' 'magsigma_corr' 'maglast_corr'
 'magfirst_corr' 'firstmjd' 'lastmjd' 'step_id_corr' 'saturation_rate']","['ZTF20aaxxtoh' 'ZTF20aaxxtoh' 'ZTF19abjgeko' 'ZTF19abjgeko'
 'ZTF18aasrwgz' 'ZTF18aasrwgz' 'ZTF18aasrwgz' 'ZTF18aaxmawb'
 'ZTF18aaxmawb' 'ZTF19aaweqnm' 'ZTF19aaweqnm' 'ZTF19aaweqnm'
 'ZTF18acaozyy' 'ZTF18acaozyy' 'ZTF18acaozyy' 'ZTF21ababatx'
 'ZTF21ababatx' 'ZTF19abhjvps' 'ZTF19abhjvps' 'ZTF18aaqqcaj'
 'ZTF18aaqqcaj' 'ZTF18acauwik' 'ZTF18acauwik' 'ZTF18acauwik'
 'ZTF18aalowgr' 'ZTF18aalowgr' 'ZTF21aaabsml' 'ZTF21aaabsml'
 'ZTF18aamfxav' 'ZTF18aamfxav' 'ZTF19adajtxe' 'ZTF19adajtxe'
 'ZTF20achqjwc' 'ZTF20achqjwc' 'ZTF20achqjwc' 'ZTF18adaivps'
 'ZTF18adaivps' 'ZTF18aclmnmg' 'ZTF18aclmnmg' 'ZTF18acooovz'
 'ZTF18acooovz' 'ZTF19aaptufk' 'ZTF23abpqica' 'ZTF23abpqica'
 'ZTF19aaxkfwn' 'ZTF19aaxkfwn' 'ZTF20abcabkt' 'ZTF20abcabkt'
 'ZTF20abefbzi' 'ZTF20abefbzi' 'ZTF20abrehdb' 'ZTF20abrehdb'
 'ZTF18aalsbug' 'ZTF18aalsbug' 'ZTF19aaprejp' 'ZTF19aaprejp'
 'ZTF19aaprejp' 'ZTF19abbxrlb' 'ZTF19abbxrlb' 'ZTF18aamukfx'
 'ZTF18aamukfx' 'ZTF19abiwpdm' 'ZTF19abiwpdm' 'ZTF18aaiearm'
 'ZTF18aaiearm' 'ZTF19acbvsgl' 'ZTF19acbvsgl' 'ZTF20aakdzwh'
 'ZTF20aakdzwh' 'ZTF19aaapmca' 'ZTF19aaapmca' 'ZTF19aaapmca'
 'ZTF19aayocpp' 'ZTF19aayocpp' 'ZTF18abshgbq' 'ZTF18abshgbq'
 'ZTF18aczbwrf' 'ZTF18aczbwrf' 'ZTF19aayijro' 'ZTF19aayijro'
 'ZTF19aayijro' 'ZTF23aaahvfg' 'ZTF23aaahvfg' 'ZTF18abtsddf'
 'ZTF18abtsddf' 'ZTF19aaapjjd' 'ZTF19aaapjjd' 'ZTF19aaapjjd'
 'ZTF19aalzdfg' 'ZTF19aalzdfg' 'ZTF19aalzdfg' 'ZTF17aaaxudr'
 'ZTF17aaaxudr' 'ZTF18aamdqhv' 'ZTF18aamdqhv' 'ZTF18abtmeds'
 'ZTF18abtmeds' 'ZTF18acbycof' 'ZTF18acbycof' 'ZTF18abjwcao'
 'ZTF18abjwcao' 'ZTF22abxzvrs' 'ZTF22abxzvrs' 'ZTF22abxzvrs'
 'ZTF18aajmsxl' 'ZTF18aajmsxl' 'ZTF22aadhosm' 'ZTF22aadhosm'
 'ZTF20abgbwbb' 'ZTF20abgbwbb']"
47,"Find at most 30 ZTF objects that have a probability larger than 0.9 of being an asteroid in the stamp classifier version 'stamp_classifier_1.0.4'. Return the following columns: identifier of the ZTF and candidate, distance from the nearest Solar System object, MPC archive magnitude and name. Include also the following columns related to each candidate in the output table: filter identifier, FWHM from SExtractor, number of PS1 calibrators used, and exposure time",gpt-4o,sql,True,"-- Final Query: Combine results from ss_ztf and dataquality sub-queries

SELECT sq.oid,
       sq.candid,
       sq.ssdistnr,
       sq.ssmagnr,
       sq.ssnamenr,
       dq.fid,
       dq.fwhm,
       dq.ncalib,
       dq.exptime
FROM
  (SELECT ss_ztf.oid,
          ss_ztf.candid,
          ss_ztf.ssdistnr,
          ss_ztf.ssmagnr,
          ss_ztf.ssnamenr
   FROM ss_ztf
   INNER JOIN
     (SELECT oid
      FROM probability
      WHERE classifier_name = 'stamp_classifier'
        AND classifier_version = 'stamp_classifier_1.0.4'
        AND class_name = 'asteroid'
        AND probability > 0.9
        AND ranking = 1
      LIMIT 30) AS high_prob_oids ON ss_ztf.oid = high_prob_oids.oid) AS sq
INNER JOIN
  (SELECT dataquality.oid,
          dataquality.candid,
          dataquality.fid,
          dataquality.fwhm,
          dataquality.ncalib,
          dataquality.exptime
   FROM dataquality
   INNER JOIN
     (SELECT oid
      FROM probability
      WHERE classifier_name = 'stamp_classifier'
        AND classifier_version = 'stamp_classifier_1.0.4'
        AND class_name = 'asteroid'
        AND probability > 0.9
        AND ranking = 1
      LIMIT 30) AS high_prob_oids ON dataquality.oid = high_prob_oids.oid) AS dq ON sq.oid = dq.oid
AND sq.candid = dq.candid","SELECT
    sq1.oid,
    ss_ztf.candid, ss_ztf.ssdistnr, ss_ztf.ssmagnr,
    ss_ztf.ssnamenr, dataquality.fid,
    dataquality.fwhm, dataquality.nmatches,
    dataquality.exptime
FROM
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.9
    AND classifier_version = 'stamp_classifier_1.0.4'
LIMIT 30
) as sq1
INNER JOIN
ss_ztf
ON sq1.oid = ss_ztf.oid
INNER JOIN
dataquality
ON ss_ztf.oid = dataquality.oid
AND ss_ztf.candid = dataquality.candid",,,,"(psycopg2.errors.UndefinedColumn) column dataquality.ncalib does not exist
LINE 33:           dataquality.ncalib,
                   ^

[SQL: -- Final Query: Combine results from ss_ztf and dataquality sub-queries

SELECT sq.oid,
       sq.candid,
       sq.ssdistnr,
       sq.ssmagnr,
       sq.ssnamenr,
       dq.fid,
       dq.fwhm,
       dq.ncalib,
       dq.exptime
FROM
  (SELECT ss_ztf.oid,
          ss_ztf.candid,
          ss_ztf.ssdistnr,
          ss_ztf.ssmagnr,
          ss_ztf.ssnamenr
   FROM ss_ztf
   INNER JOIN
     (SELECT oid
      FROM probability
      WHERE classifier_name = 'stamp_classifier'
        AND classifier_version = 'stamp_classifier_1.0.4'
        AND class_name = 'asteroid'
        AND probability > 0.9
        AND ranking = 1
      LIMIT 30) AS high_prob_oids ON ss_ztf.oid = high_prob_oids.oid) AS sq
INNER JOIN
  (SELECT dataquality.oid,
          dataquality.candid,
          dataquality.fid,
          dataquality.fwhm,
          dataquality.ncalib,
          dataquality.exptime
   FROM dataquality
   INNER JOIN
     (SELECT oid
      FROM probability
      WHERE classifier_name = 'stamp_classifier'
        AND classifier_version = 'stamp_classifier_1.0.4'
        AND class_name = 'asteroid'
        AND probability > 0.9
        AND ranking = 1
      LIMIT 30) AS high_prob_oids ON dataquality.oid = high_prob_oids.oid) AS dq ON sq.oid = dq.oid
AND sq.candid = dq.candid]
(Background on this error at: https://sqlalche.me/e/20/f405)","{'Schema Linking': {'input_tokens': 3956, 'output_tokens': 12, 'total_tokens': 3968, 'total_cost': 0.0, 'input_cost': 0.00989, 'output_cost': 0.00012, 'new_total_cost': 0.01001}, 'Classification': {'input_tokens': 488, 'output_tokens': 3, 'total_tokens': 491, 'input_cost': 0.00122, 'output_cost': 3e-05, 'total_cost': 0.00125, 'new_total_cost': 0.00125}, 'Decompostion': {'input_tokens': 4211, 'output_tokens': 675, 'total_tokens': 4886, 'input_cost': 0.0105275, 'output_cost': 0.00675, 'total_cost': 0.0172775, 'new_total_cost': 0.0172775}, 'Query generation': {'input_tokens': 2001, 'output_tokens': 767, 'total_tokens': 2768, 'input_cost': 0.0050025, 'output_cost': 0.00767, 'total_cost': 0.0126725, 'new_total_cost': 0.0126725}, 'Self-correction': {'input_tokens': 4321, 'output_tokens': 598, 'total_tokens': 4919, 'input_cost': 0.0108025, 'output_cost': 0.00598, 'total_cost': 0.0167825}}","             oid               candid  ssdistnr  ssmagnr  ssnamenr  fid  fwhm  \
0   ZTF23aagjkwt  2299187661815015001       2.0     19.0     34211    1  3.92   
1   ZTF23aagjkxb  2299187665915015017       2.0     18.7     14496    1  5.67   
2   ZTF23aagjkwx  2299187662115015006       2.0     18.4     11781    1  2.80   
3   ZTF23aagjkyo  2299187661615015016       3.0     18.4     39603    1  3.09   
4   ZTF23aagjkyp  2299187661615015017       1.0     19.4     32158    1  3.18   
5   ZTF23aagjkyv  2299187660815015018       2.0     19.3     23676    1  3.52   
6   ZTF23aagjkyc  2299187153415015001       2.0     15.7      3816    1  3.02   
7   ZTF23aagjkzn  2299187664315015007       2.0     19.2     93638    1  3.63   
8   ZTF23aagjkzr  2299187154315015000       1.0     18.7     13815    1  3.08   
9   ZTF23aagjkzw  2299187661515015010       3.0     19.0     22240    1  3.11   
10  ZTF23aagjkzx  2299187661515015004       2.0     19.3     31628    1  3.02   
11  ZTF23aagjlaa  2299185742515015004      11.0     18.2  2017ES02    1  4.66   
12  ZTF23aagjkrb  2299186673515015000       2.0     19.1    219508    1  5.49   
13  ZTF23aagjkri  2299187662415015000       2.0     19.1     96977    1  3.50   
14  ZTF23aagjkxa  2299187665915015024       2.0     18.7     26445    1  3.61   
15  ZTF23aagjkxd  2299187661115015002       2.0     18.0      8185    1  3.23   
16  ZTF23aagjkxi  2299187661115015014       2.0     19.0     19355    1  4.44   
17  ZTF23aagjkxl  2299187661115015008       2.0     19.9     73903    1  5.29   
18  ZTF23aagjkxm  2299187661115015015       2.0     19.3     53399    1  3.60   
19  ZTF23aagjkqv  2299187155315015001       2.0     17.9     59633    1  2.89   
20  ZTF23aagjkrh  2299187662415015004       3.0     18.0      6204    1  2.78   
21  ZTF23aagjkyh  2299187660315015016       3.0     19.4     74059    1  4.18   
22  ZTF23aagjkqy  2299187154215015014       2.0     19.4    131060    1  3.52   
23  ZTF23aagjkrk  2299187662415015008       2.0     19.5     20382    1  2.94   
24  ZTF23aagjkro  2299187153515015001       2.0     18.9     29477    1  3.77   
25  ZTF23aagjkrt  2299187150815015013       2.0     19.4     61074    1  4.20   
26  ZTF23aagjkxt  2299187153315015006       2.0     17.8      5227    1  3.24   
27  ZTF23aagjktl  2299187660515015008       3.0     19.5    131756    1  3.29   
28  ZTF23aagjktz  2299187661415015019       2.0     18.7     14728    1  4.16   
29  ZTF23aagjkyg  2299187660315015001       2.0     18.9     10323    1  2.95   

    nmatches  exptime  
0        372     30.0  
1        352     30.0  
2        337     30.0  
3        325     30.0  
4        325     30.0  
5        380     30.0  
6        468     30.0  
7        421     30.0  
8        397     30.0  
9        321     30.0  
10       321     30.0  
11      1246     30.0  
12       607     30.0  
13       369     30.0  
14       352     30.0  
15       361     30.0  
16       361     30.0  
17       361     30.0  
18       361     30.0  
19       488     30.0  
20       369     30.0  
21       342     30.0  
22       428     30.0  
23       369     30.0  
24       437     30.0  
25       448     30.0  
26       448     30.0  
27       408     30.0  
28       349     30.0  
29       342     30.0  ","['oid' 'candid' 'ssdistnr' 'ssmagnr' 'ssnamenr' 'fid' 'fwhm' 'nmatches'
 'exptime']","['ZTF23aagjkwt' 'ZTF23aagjkxb' 'ZTF23aagjkwx' 'ZTF23aagjkyo'
 'ZTF23aagjkyp' 'ZTF23aagjkyv' 'ZTF23aagjkyc' 'ZTF23aagjkzn'
 'ZTF23aagjkzr' 'ZTF23aagjkzw' 'ZTF23aagjkzx' 'ZTF23aagjlaa'
 'ZTF23aagjkrb' 'ZTF23aagjkri' 'ZTF23aagjkxa' 'ZTF23aagjkxd'
 'ZTF23aagjkxi' 'ZTF23aagjkxl' 'ZTF23aagjkxm' 'ZTF23aagjkqv'
 'ZTF23aagjkrh' 'ZTF23aagjkyh' 'ZTF23aagjkqy' 'ZTF23aagjkrk'
 'ZTF23aagjkro' 'ZTF23aagjkrt' 'ZTF23aagjkxt' 'ZTF23aagjktl'
 'ZTF23aagjktz' 'ZTF23aagjkyg']"
48,"Find at most 10 ZTF objects that satisfy the following conditions: have more than 500 detections, a probability larger than 0.5 of being an asteroid in the stamp classifier version 'stamp_classifier_1.0.4', and a distance from the nearest Solar System object below 2 arcsec. Return the following columns: ZTF identifier, number of detections, first and last detection date, probability, candidate identifier, distance between ZTF object and MPC object, MPC name, detection date and filter identifier. Order the results by the first detection date.",gpt-4o,sql,True,"-- Final query to retrieve ZTF objects based on specified conditions

SELECT obj.oid AS ztf_identifier,
       obj.ndet AS number_of_detections,
       obj.firstmjd AS first_detection_date,
       obj.lastmjd AS last_detection_date,
       prob.probability,
       det.candid AS candidate_identifier,
       ss.ssdistnr AS distance_to_mpc_object,
       ss.ssnamenr AS mpc_name,
       det.mjd AS detection_date,
       det.fid AS filter_identifier
FROM OBJECT obj
INNER JOIN
  (SELECT oid
   FROM
     (SELECT oid
      FROM
        (SELECT DISTINCT oid
         FROM probability
         WHERE classifier_name = 'stamp_classifier'
           AND classifier_version = 'stamp_classifier_1.0.4'
           AND class_name = 'asteroid'
           AND ranking = 1
           AND probability > 0.5) AS prob_oids INTERSECT SELECT oid
      FROM
        (SELECT oid
         FROM OBJECT
         WHERE ndet > 500) AS det_oids INTERSECT SELECT oid
      FROM
        (SELECT oid
         FROM ss_ztf
         WHERE ssdistnr < 2) AS ss_oids) AS final_oids) AS filtered_oids ON obj.oid = filtered_oids.oid
INNER JOIN probability prob ON obj.oid = prob.oid
INNER JOIN ss_ztf ss ON obj.oid = ss.oid
INNER JOIN detection det ON obj.oid = det.oid
WHERE prob.classifier_name = 'stamp_classifier'
  AND prob.classifier_version = 'stamp_classifier_1.0.4'
  AND prob.class_name = 'asteroid'
  AND prob.ranking = 1
ORDER BY obj.firstmjd
LIMIT 10","SELECT
    object.oid, ndet, firstmjd, lastmjd,
    probability, ss_ztf.candid, ssdistnr,
    ssnamenr, mjd, fid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ss_ztf
    ON object.oid = ss_ztf.oid
    INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ndet > 500
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.5
    AND classifier_version = 'stamp_classifier_1.0.4'
    AND ssdistnr < 2
ORDER BY firstmjd
LIMIT 10
",,,,"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: -- Final query to retrieve ZTF objects based on specified conditions

SELECT obj.oid AS ztf_identifier,
       obj.ndet AS number_of_detections,
       obj.firstmjd AS first_detection_date,
       obj.lastmjd AS last_detection_date,
       prob.probability,
       det.candid AS candidate_identifier,
       ss.ssdistnr AS distance_to_mpc_object,
       ss.ssnamenr AS mpc_name,
       det.mjd AS detection_date,
       det.fid AS filter_identifier
FROM OBJECT obj
INNER JOIN
  (SELECT oid
   FROM
     (SELECT oid
      FROM
        (SELECT DISTINCT oid
         FROM probability
         WHERE classifier_name = 'stamp_classifier'
           AND classifier_version = 'stamp_classifier_1.0.4'
           AND class_name = 'asteroid'
           AND ranking = 1
           AND probability > 0.5) AS prob_oids INTERSECT SELECT oid
      FROM
        (SELECT oid
         FROM OBJECT
         WHERE ndet > 500) AS det_oids INTERSECT SELECT oid
      FROM
        (SELECT oid
         FROM ss_ztf
         WHERE ssdistnr < 2) AS ss_oids) AS final_oids) AS filtered_oids ON obj.oid = filtered_oids.oid
INNER JOIN probability prob ON obj.oid = prob.oid
INNER JOIN ss_ztf ss ON obj.oid = ss.oid
INNER JOIN detection det ON obj.oid = det.oid
WHERE prob.classifier_name = 'stamp_classifier'
  AND prob.classifier_version = 'stamp_classifier_1.0.4'
  AND prob.class_name = 'asteroid'
  AND prob.ranking = 1
ORDER BY obj.firstmjd
LIMIT 10]
(Background on this error at: https://sqlalche.me/e/20/e3q8)","{'Schema Linking': {'input_tokens': 3914, 'output_tokens': 12, 'total_tokens': 3926, 'total_cost': 0.0, 'input_cost': 0.009785, 'output_cost': 0.00012, 'new_total_cost': 0.009905}, 'Classification': {'input_tokens': 505, 'output_tokens': 3, 'total_tokens': 508, 'input_cost': 0.0012625, 'output_cost': 3e-05, 'total_cost': 0.0012925, 'new_total_cost': 0.0012925}, 'Decompostion': {'input_tokens': 4227, 'output_tokens': 710, 'total_tokens': 4937, 'input_cost': 0.0105675, 'output_cost': 0.0071, 'total_cost': 0.017667500000000003, 'new_total_cost': 0.017667500000000003}, 'Query generation': {'input_tokens': 2052, 'output_tokens': 1195, 'total_tokens': 3247, 'input_cost': 0.00513, 'output_cost': 0.01195, 'total_cost': 0.01708, 'new_total_cost': 0.01708}, 'Self-correction': {'input_tokens': 4241, 'output_tokens': 453, 'total_tokens': 4694, 'input_cost': 0.0106025, 'output_cost': 0.00453, 'total_cost': 0.0151325}}","            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   728  58279.169583  60649.539618          1.0   
1  ZTF18abbxrwg   948  58287.335428  60603.131134          1.0   
2  ZTF18abctcjx   941  58301.355914  60622.127350          1.0   
3  ZTF18abegdjb   707  58304.357766  60609.124907          1.0   
4  ZTF18abjxzue   649  58332.271759  60545.188206          1.0   
5  ZTF18abnowwc   581  58348.212234  60627.129236          1.0   
6  ZTF18abnugpf   525  58348.353021  60623.092292          1.0   
7  ZTF17aacmuxo   560  58356.512998  60650.356435          1.0   
8  ZTF17aaapcln  1214  58357.495787  60650.423808          1.0   
9  ZTF18abrbhzl   776  58358.463819  60650.423808          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  1497422265615015015    -999.0     null  59251.422269    1  
1  1499564341415015015    -999.0     null  59253.564340    2  
2  1508557300615015050    -999.0     null  59262.557303    2  
3  1508557301515015029    -999.0     null  59262.557303    2  
4  1494508860715015005    -999.0     null  59248.508866    1  
5  1508557771615015008    -999.0     null  59262.557778    2  
6  1515558154415015007    -999.0     null  59269.558160    2  
7  1521247305515015000    -999.0     null  59275.247303    2  
8  1494169106015015027    -999.0     null  59248.169109    2  
9  1521247305415015012    -999.0     null  59275.247303    2  ","['oid' 'ndet' 'firstmjd' 'lastmjd' 'probability' 'candid' 'ssdistnr'
 'ssnamenr' 'mjd' 'fid']","['ZTF18aakqcul' 'ZTF18abbxrwg' 'ZTF18abctcjx' 'ZTF18abegdjb'
 'ZTF18abjxzue' 'ZTF18abnowwc' 'ZTF18abnugpf' 'ZTF17aacmuxo'
 'ZTF17aaapcln' 'ZTF18abrbhzl']"
49,"Find all detections, non-detections and forced photometry points for the ZTF object 'ZTF24aamtvxb'. Return all epochs in the same output table, including the following columns: ZTF identifier, epoch date, filter identifier, isdiffpos flag, detection difference magnitude and its uncertainty, 5-sigma magnitude limit, forced difference magnitude and its uncertainty, and a column named 'table' (that contains the name of the table of origin for each epoch)",gpt-4o,sql,True,"-- Step 1: Sub-query to get the oid for the object 'ZTF24aamtvxb'
WITH object_oid AS
  (SELECT oid
   FROM OBJECT
   WHERE object_id = 'ZTF24aamtvxb'), -- Step 2: Sub-query for detections
detections AS
  (SELECT d.oid,
          d.mjd AS epoch_date,
          d.fid AS filter_identifier,
          d.isdiffpos,
          d.magpsf AS detection_diff_mag,
          d.sigmapsf AS detection_diff_mag_uncertainty,
          NULL AS diffmaglim,
          NULL AS forcediffimflux,
          NULL AS forcediffimfluxunc,
          'detection' AS TABLE
   FROM detection d
   INNER JOIN object_oid o ON d.oid = o.oid), -- Step 3: Sub-query for non-detections
non_detections AS
  (SELECT nd.oid,
          nd.mjd AS epoch_date,
          nd.fid AS filter_identifier,
          NULL AS isdiffpos,
          NULL AS detection_diff_mag,
          NULL AS detection_diff_mag_uncertainty,
          nd.diffmaglim,
          NULL AS forcediffimflux,
          NULL AS forcediffimfluxunc,
          'non_detection' AS TABLE
   FROM non_detection nd
   INNER JOIN object_oid o ON nd.oid = o.oid), -- Step 4: Sub-query for forced photometry
forced_photometry AS
  (SELECT fp.oid,
          fp.mjd AS epoch_date,
          fp.fid AS filter_identifier,
          NULL AS isdiffpos,
          NULL AS detection_diff_mag,
          NULL AS detection_diff_mag_uncertainty,
          NULL AS diffmaglim,
          fp.forcediffimflux,
          fp.forcediffimfluxunc,
          'forced_photometry' AS TABLE
   FROM forced_photometry fp
   INNER JOIN object_oid o ON fp.oid = o.oid) -- Step 5: Combine results using UNION

SELECT *
FROM detections
UNION ALL
SELECT *
FROM non_detections
UNION ALL
SELECT *
FROM forced_photometry
ORDER BY epoch_date;","
SELECT
    oid, mjd, fid, isdiffpos,
    magpsf, sigmapsf, NULL as diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'detection' as table
FROM
    detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, NULL as isdiffpos,
    NULL as magpsf, NULL as sigmapsf, diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'non_detection' as table
FROM
    non_detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, isdiffpos,
    NULL as magpsf, NULL as sigmapsf,
    NULL as diffmaglim,
    mag, e_mag,
    'forced_photometry' as table
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aamtvxb'
",,,,"(psycopg2.errors.UndefinedColumn) column ""object_id"" does not exist
LINE 5:    WHERE object_id = 'ZTF24aamtvxb'), -- Step 2: Sub-query f...
                 ^

[SQL: -- Step 1: Sub-query to get the oid for the object 'ZTF24aamtvxb'
WITH object_oid AS
  (SELECT oid
   FROM OBJECT
   WHERE object_id = 'ZTF24aamtvxb'), -- Step 2: Sub-query for detections
detections AS
  (SELECT d.oid,
          d.mjd AS epoch_date,
          d.fid AS filter_identifier,
          d.isdiffpos,
          d.magpsf AS detection_diff_mag,
          d.sigmapsf AS detection_diff_mag_uncertainty,
          NULL AS diffmaglim,
          NULL AS forcediffimflux,
          NULL AS forcediffimfluxunc,
          'detection' AS TABLE
   FROM detection d
   INNER JOIN object_oid o ON d.oid = o.oid), -- Step 3: Sub-query for non-detections
non_detections AS
  (SELECT nd.oid,
          nd.mjd AS epoch_date,
          nd.fid AS filter_identifier,
          NULL AS isdiffpos,
          NULL AS detection_diff_mag,
          NULL AS detection_diff_mag_uncertainty,
          nd.diffmaglim,
          NULL AS forcediffimflux,
          NULL AS forcediffimfluxunc,
          'non_detection' AS TABLE
   FROM non_detection nd
   INNER JOIN object_oid o ON nd.oid = o.oid), -- Step 4: Sub-query for forced photometry
forced_photometry AS
  (SELECT fp.oid,
          fp.mjd AS epoch_date,
          fp.fid AS filter_identifier,
          NULL AS isdiffpos,
          NULL AS detection_diff_mag,
          NULL AS detection_diff_mag_uncertainty,
          NULL AS diffmaglim,
          fp.forcediffimflux,
          fp.forcediffimfluxunc,
          'forced_photometry' AS TABLE
   FROM forced_photometry fp
   INNER JOIN object_oid o ON fp.oid = o.oid) -- Step 5: Combine results using UNION

SELECT *
FROM detections
UNION ALL
SELECT *
FROM non_detections
UNION ALL
SELECT *
FROM forced_photometry
ORDER BY epoch_date;]
(Background on this error at: https://sqlalche.me/e/20/f405)","{'Schema Linking': {'input_tokens': 3887, 'output_tokens': 11, 'total_tokens': 3898, 'total_cost': 0.0, 'input_cost': 0.0097175, 'output_cost': 0.00011, 'new_total_cost': 0.009827500000000001}, 'Classification': {'input_tokens': 487, 'output_tokens': 3, 'total_tokens': 490, 'input_cost': 0.0012175, 'output_cost': 3e-05, 'total_cost': 0.0012475000000000001, 'new_total_cost': 0.0012475000000000001}, 'Decompostion': {'input_tokens': 4210, 'output_tokens': 903, 'total_tokens': 5113, 'input_cost': 0.010525, 'output_cost': 0.00903, 'total_cost': 0.019555, 'new_total_cost': 0.019555}, 'Query generation': {'input_tokens': 2228, 'output_tokens': 504, 'total_tokens': 2732, 'input_cost': 0.00557, 'output_cost': 0.00504, 'total_cost': 0.010610000000000001, 'new_total_cost': 0.010610000000000001}, 'Self-correction': {'input_tokens': 4418, 'output_tokens': 479, 'total_tokens': 4897, 'input_cost': 0.011045, 'output_cost': 0.00479, 'total_cost': 0.015835}}","              oid           mjd  fid  isdiffpos     magpsf  sigmapsf  \
0    ZTF24aamtvxb  60440.276505    1        1.0  18.307241  0.082498   
1    ZTF24aamtvxb  60442.171227    1        1.0  15.560810  0.033140   
2    ZTF24aamtvxb  60444.229016    1        1.0  14.585193  0.024982   
3    ZTF24aamtvxb  60449.220266    1        1.0  13.173624  0.018505   
4    ZTF24aamtvxb  60449.310336    2        1.0  13.359071  0.016791   
..            ...           ...  ...        ...        ...       ...   
147  ZTF24aamtvxb  60592.533183    2        1.0        NaN       NaN   
148  ZTF24aamtvxb  60600.525556    2        1.0        NaN       NaN   
149  ZTF24aamtvxb  60599.535475    2        1.0        NaN       NaN   
150  ZTF24aamtvxb  60595.530752    2        1.0        NaN       NaN   
151  ZTF24aamtvxb  60594.531447    2        1.0        NaN       NaN   

     diffmaglim        mag     e_mag              table  
0           NaN        NaN       NaN          detection  
1           NaN        NaN       NaN          detection  
2           NaN        NaN       NaN          detection  
3           NaN        NaN       NaN          detection  
4           NaN        NaN       NaN          detection  
..          ...        ...       ...                ...  
147         NaN  17.383959  0.047817  forced_photometry  
148         NaN  17.480049  0.060428  forced_photometry  
149         NaN  17.442333  0.028261  forced_photometry  
150         NaN  17.347569  0.024500  forced_photometry  
151         NaN  17.469713  0.041608  forced_photometry  

[152 rows x 10 columns]","['oid' 'mjd' 'fid' 'isdiffpos' 'magpsf' 'sigmapsf' 'diffmaglim' 'mag'
 'e_mag' 'table']","['ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb'
 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb' 'ZTF24aamtvxb']"
50,"Find at most 30 ZTF objects that satisfy the following conditions: have more than 10 detections, a probability larger than 0.7 of being a bogus in the stamp classifier version 'stamp_classifier_1.0.4', and  a probability larger than 0.9 of being a transient in the light curve classifier top level. Return the following columns: ZTF identifier, number of detections, first detection date, probability in the stamp classifier (name this column 'prob_stamp_bogus'), and probability in the light curve classifier top level (name this column 'prob_lc_transient'). Order the results by the ZTF identifier of the objects classified as bogus in the stamp classifier.",gpt-4o,sql,True,"
SELECT o.oid AS ztf_identifier,
       o.ndet AS number_of_detections,
       o.firstmjd AS first_detection_date,

  (SELECT p.probability
   FROM probability p
   WHERE p.oid = o.oid
     AND p.classifier_name = 'stamp_classifier'
     AND p.classifier_version = 'stamp_classifier_1.0.4'
     AND p.class_name = 'bogus'
     AND p.ranking = 1) AS prob_stamp_bogus,

  (SELECT p.probability
   FROM probability p
   WHERE p.oid = o.oid
     AND p.classifier_name = 'lc_classifier_top'
     AND p.class_name = 'transient'
     AND p.ranking = 1) AS prob_lc_transient
FROM OBJECT o
WHERE o.ndet > 10
  AND o.oid IN
    (SELECT p.oid
     FROM probability p
     WHERE p.classifier_name = 'stamp_classifier'
       AND p.classifier_version = 'stamp_classifier_1.0.4'
       AND p.class_name = 'bogus'
       AND p.probability > 0.7
       AND p.ranking = 1)
  AND o.oid IN
    (SELECT p.oid
     FROM probability p
     WHERE p.classifier_name = 'lc_classifier_top'
       AND p.class_name = 'transient'
       AND p.probability > 0.9
       AND p.ranking = 1)
ORDER BY prob_stamp_bogus DESC
LIMIT 30;","
SELECT
    sq1.oid, sq1.ndet, sq1.firstmjd,
    sq1.probability as prob_stamp_bogus,
    sq2.probability as prob_lc_transient
FROM
(
SELECT
    object.oid, object.ndet, object.firstmjd,
    probability.class_name,
    probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    ndet > 10
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'bogus'
    AND probability > 0.7
    AND classifier_version = 'stamp_classifier_1.0.4'
) AS sq1
INNER JOIN
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier_top'
    AND class_name = 'Transient'
    AND probability > 0.9
) AS sq2
ON sq1.oid = sq2.oid
ORDER BY sq1.oid
LIMIT 30
","Empty DataFrame
Columns: [oid, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []","['oid' 'number_of_detections' 'first_detection_date' 'prob_stamp_bogus'
 'prob_lc_transient']",[],,"{'Schema Linking': {'input_tokens': 3984, 'output_tokens': 5, 'total_tokens': 3989, 'total_cost': 0.0, 'input_cost': 0.00996, 'output_cost': 5e-05, 'new_total_cost': 0.01001}, 'Classification': {'input_tokens': 526, 'output_tokens': 3, 'total_tokens': 529, 'input_cost': 0.001315, 'output_cost': 3e-05, 'total_cost': 0.001345, 'new_total_cost': 0.001345}, 'Decompostion': {'input_tokens': 0, 'output_tokens': 0, 'input_cost': 0.0, 'output_cost': 0.0, 'total_cost': 0.0, 'new_total_cost': 0.0}, 'Query generation': {'input_tokens': 4026, 'output_tokens': 357, 'total_tokens': 4383, 'input_cost': 0.010065, 'output_cost': 0.00357, 'total_cost': 0.013635, 'new_total_cost': 0.013635}, 'Self-correction': {'input_tokens': 4137, 'output_tokens': 334, 'total_tokens': 4471, 'input_cost': 0.0103425, 'output_cost': 0.00334, 'total_cost': 0.0136825}}","             oid  ndet      firstmjd  prob_stamp_bogus  prob_lc_transient
0   ZTF17aaahhwn    16  60168.430151          0.771008              1.000
1   ZTF18aajkcdn    11  59904.431377          0.767230              0.954
2   ZTF18abjrfqx    42  58325.466678          0.745006              1.000
3   ZTF18abmwnov    52  58346.359896          0.715889              1.000
4   ZTF18absdojk   365  58362.167813          0.705910              0.952
5   ZTF18abuicad    67  58371.378785          0.835837              0.956
6   ZTF18abzbkby    37  58385.452824          0.864839              0.994
7   ZTF18acbwxcc    23  58423.140255          0.777057              0.970
8   ZTF18acszayr    30  58456.220949          0.767309              0.938
9   ZTF19aaoyjoz    17  58580.254491          0.761249              0.982
10  ZTF19aauoiow   110  58636.423935          0.773761              1.000
11  ZTF19aavjzrz    94  58643.455984          0.794810              1.000
12  ZTF19aawsdlq    34  58636.421644          0.792299              1.000
13  ZTF19aazfvhh    57  58646.469097          0.722329              0.996
14  ZTF19abwsecm    26  58725.461806          0.808821              1.000
15  ZTF19abxjimu   127  58732.422708          0.721538              0.998
16  ZTF19abzqwpr    37  58746.390891          0.713936              0.998
17  ZTF19abzsnqm    20  58746.390394          0.788473              0.988
18  ZTF19acbkczc    20  58754.207940          0.911203              0.936
19  ZTF20aafpojg    23  58863.214120          0.729397              0.964
20  ZTF20abjsyqn    21  59036.374190          0.710259              0.922
21  ZTF20abylbuf    90  59096.384016          0.724529              1.000
22  ZTF20acjbhhp    60  59136.325822          0.703471              1.000
23  ZTF20acoyvdg    23  59157.236493          0.705165              0.996
24  ZTF20acpmgdz    64  59165.336678          0.724588              1.000
25  ZTF20acqzjqz   107  59169.318993          0.752268              1.000
26  ZTF20acwgxhk    48  59193.197292          0.739050              0.976
27  ZTF20acxdawc    17  59193.198241          0.861717              0.968
28  ZTF20adadmsg    30  59200.228530          0.870066              1.000
29  ZTF21aagnqnz    64  59248.255046          0.751137              0.968",['oid' 'ndet' 'firstmjd' 'prob_stamp_bogus' 'prob_lc_transient'],"['ZTF17aaahhwn' 'ZTF18aajkcdn' 'ZTF18abjrfqx' 'ZTF18abmwnov'
 'ZTF18absdojk' 'ZTF18abuicad' 'ZTF18abzbkby' 'ZTF18acbwxcc'
 'ZTF18acszayr' 'ZTF19aaoyjoz' 'ZTF19aauoiow' 'ZTF19aavjzrz'
 'ZTF19aawsdlq' 'ZTF19aazfvhh' 'ZTF19abwsecm' 'ZTF19abxjimu'
 'ZTF19abzqwpr' 'ZTF19abzsnqm' 'ZTF19acbkczc' 'ZTF20aafpojg'
 'ZTF20abjsyqn' 'ZTF20abylbuf' 'ZTF20acjbhhp' 'ZTF20acoyvdg'
 'ZTF20acpmgdz' 'ZTF20acqzjqz' 'ZTF20acwgxhk' 'ZTF20acxdawc'
 'ZTF20adadmsg' 'ZTF21aagnqnz']"
