code_tag,llm_used,prompt_version,query_id,query_run,sql_query,tab_schema,label,query_gen_time,query_gen_date,query_results,query_error,sql_time,sql_date,r_row,p_row,r_col,p_col,N_perfect_row,N_perfect_col
0.20.2,,,14,0,"SELECT
    det.oid, det.candid,
    det.drb, det.fid,
    det.mjd, det.magpsf, det.sigmapsf,
    det.has_stamp,
    ps1.sgscore1, ps1.distpsnr1
FROM
    (SELECT *
    FROM detection
    WHERE oid in ('ZTF23aavzgjg','ZTF23aaynzyk','ZTF23aavqxos','ZTF23aaknyni','ZTF23aavsdtc','ZTF18aandkua','ZTF23aaxfewt','ZTF23aavshwi','ZTF22aawasao','ZTF23aaxgvnt')
    ) as det
    INNER JOIN
    (SELECT *
    FROM ps1_ztf
    WHERE oid in ('ZTF23aavzgjg','ZTF23aaynzyk','ZTF23aavqxos','ZTF23aaknyni','ZTF23aavsdtc','ZTF18aandkua','ZTF23aaxfewt','ZTF23aavshwi','ZTF22aawasao','ZTF23aaxgvnt')
    ) as ps1
    ON det.oid=ps1.oid
WHERE
     (ps1.sgscore1 < 0.5 OR ps1.distpsnr1 < 1)
    AND det.drb > 0.5
",,,,,"[             oid               candid       drb  fid           mjd     magpsf  \
0   ZTF18aandkua  2434183903015015056  0.994159    1  60188.183901  17.907194   
1   ZTF18aandkua  2756269351915010002  0.993011    2  60510.269352  19.379133   
2   ZTF18aandkua  2772265531915010009  0.850113    2  60526.265532  19.641638   
3   ZTF18aandkua  2979404491915010015  0.696538    1  60733.404491  18.887863   
4   ZTF18aandkua  2434183903015015056  0.994159    1  60188.183901  17.907194   
5   ZTF18aandkua  2756269351915010002  0.993011    2  60510.269352  19.379133   
6   ZTF18aandkua  2772265531915010009  0.850113    2  60526.265532  19.641638   
7   ZTF18aandkua  2979404491915010015  0.696538    1  60733.404491  18.887863   
8   ZTF22aawasao  2754319833415015025  0.755912    2  60508.319838  18.594233   
9   ZTF22aawasao  2754319833415015025  0.755912    2  60508.319838  18.594233   
10  ZTF23aavqxos  2403456661315015121  0.949127    2  60157.456667  19.240726   
11  ZTF23aavqxos  3003155891315015002  0.921584    2  60757.155891  19.689983   
12  ZTF23aavsdtc  2404379221215015002  0.879817    1  60158.379225  19.220120   
13  ZTF23aavshwi  2404407764015015005  1.000000    2  60158.407766  18.168100   
14  ZTF23aavshwi  2407423334015015007  1.000000    1  60161.423333  18.688477   
15  ZTF23aavshwi  2407462734015015009  1.000000    2  60161.462732  18.336126   
16  ZTF23aavshwi  2414423484015015018  1.000000    1  60168.423484  19.307604   
17  ZTF23aavshwi  2414445984015015007  1.000000    2  60168.445984  18.701996   
18  ZTF23aavshwi  2416422074015015019  1.000000    2  60170.422072  18.754047   
19  ZTF23aavshwi  2419451634015015008  1.000000    2  60173.451632  18.789606   
20  ZTF23aavshwi  2419475694015015014  0.999999    1  60173.475694  19.894947   
21  ZTF23aavshwi  2424486604015015016  1.000000    2  60178.486609  18.973866   
22  ZTF23aavshwi  2428469354015015016  1.000000    2  60182.469352  19.151363   
23  ZTF23aavshwi  2430436074015015016  0.999985    1  60184.436076  20.503382   
24  ZTF23aavshwi  2430476444015015012  0.999998    2  60184.476447  19.384290   
25  ZTF23aavshwi  2432427924015015008  0.999994    2  60186.427928  19.566288   
26  ZTF23aavshwi  2440490024015015015  0.999963    2  60194.490023  19.956028   
27  ZTF23aavshwi  2446471444015015013  0.999977    2  60200.471447  20.102201   
28  ZTF23aavshwi  2448496784015015039  0.999999    2  60202.496782  20.105957   
29  ZTF23aaxfewt  2415290061315015127  0.999312    2  60169.290069  18.205078   

    sigmapsf  has_stamp  sgscore1  distpsnr1  
0   0.180156       True  0.075167   0.326697  
1   0.161114       True  0.075167   0.326697  
2   0.183068       True  0.075167   0.326697  
3   0.175351       True  0.075167   0.326697  
4   0.180156       True  0.075167   1.234589  
5   0.161114       True  0.075167   1.234589  
6   0.183068       True  0.075167   1.234589  
7   0.175351       True  0.075167   1.234589  
8   0.143780       True  0.380149   0.673811  
9   0.143780       True  0.380149   0.904783  
10  0.181016       True  0.024583   0.183817  
11  0.215474       True  0.024583   0.183817  
12  0.216384       True  0.209000   0.343322  
13  0.067061       True  0.009583   2.024725  
14  0.096587       True  0.009583   2.024725  
15  0.060204       True  0.009583   2.024725  
16  0.094521       True  0.009583   2.024725  
17  0.070969       True  0.009583   2.024725  
18  0.061804       True  0.009583   2.024725  
19  0.067233       True  0.009583   2.024725  
20  0.147604       True  0.009583   2.024725  
21  0.079126       True  0.009583   2.024725  
22  0.086399       True  0.009583   2.024725  
23  0.193578       True  0.009583   2.024725  
24  0.112882       True  0.009583   2.024725  
25  0.176278       True  0.009583   2.024725  
26  0.172092       True  0.009583   2.024725  
27  0.131913       True  0.009583   2.024725  
28  0.146235       True  0.009583   2.024725  
29  0.063636       True  0.134304   0.635949  ]",,3.352428913116455,2025-07-25T10:29:10,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,1,"-- [FINAL QUERY HERE]SELECT     o.oid,     d.candid,     d.fid,     d.mjd,     d.magpsf AS magnitude,     d.sigmapsf AS magnitude_error,     d.has_stamp,     d.drb AS deep_learning_real_bogus_score,     pz.sgscore1 AS star_galaxy_score_nearest,     pz.distpsnr1 AS distance_to_nearest_panstarrs_sourceFROM     object oINNER JOIN     detection d ON o.oid = d.oidINNER JOIN     ps1_ztf pz ON d.oid = pz.oid AND d.candid = pz.candidWHERE     o.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',               'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',               'ZTF22aawasao', 'ZTF23aaxgvnt')    AND d.drb > 0.5    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,54.924110889434814,2025-07-23T18:34:12,"[            oid               candid  fid           mjd  magnitude  \
0  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194   
1  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863   
2  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233   
3  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726   
4  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120   
5  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100   
6  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078   

   magnitude_error  has_stamp  deep_learning_real_bogus_score  \
0         0.180156       True                        0.994159   
1         0.175351       True                        0.696538   
2         0.143780       True                        0.755912   
3         0.181016       True                        0.949127   
4         0.216384       True                        0.879817   
5         0.067061       True                        1.000000   
6         0.063636       True                        0.999312   

   star_galaxy_score_nearest  distance_to_nearest_panstarrs_source  
0                   0.075167                              0.326697  
1                   0.075167                              1.234589  
2                   0.380149                              0.904783  
3                   0.024583                              0.183817  
4                   0.209000                              0.343322  
5                   0.009583                              2.024725  
6                   0.134304                              0.635949  ]",,10.105164527893066,2025-07-25T10:29:27,0.23333333333333334,4.285714285714286,0.5,0.5,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,14,2,"-- [FINAL QUERY HERE]SELECT     o.oid,     d.candid,     d.fid,     d.mjd,     d.magpsf,     d.sigmapsf,     d.has_stamp,     d.drb,     pz.sgscore1,     pz.distpsnr1FROM     object oINNER JOIN     detection d ON o.oid = d.oidINNER JOIN     ps1_ztf pz ON o.oid = pz.oidWHERE     o.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',               'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',               'ZTF22aawasao', 'ZTF23aaxgvnt')    AND d.drb > 0.5    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,26.73567295074463,2025-07-23T18:34:39,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
1   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
2   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
3   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
4   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
5   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
6   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
7   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
8   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
9   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
10  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   
11  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
12  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
13  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
14  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
15  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
16  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
17  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
18  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
19  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
20  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
21  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
22  ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
23  ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
24  ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
25  ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
26  ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
27  ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
28  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
29  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.696538  0.075167   0.326697  
1        True  0.850113  0.075167   0.326697  
2        True  0.993011  0.075167   0.326697  
3        True  0.994159  0.075167   0.326697  
4        True  0.696538  0.075167   1.234589  
5        True  0.850113  0.075167   1.234589  
6        True  0.993011  0.075167   1.234589  
7        True  0.994159  0.075167   1.234589  
8        True  0.755912  0.380149   0.673811  
9        True  0.755912  0.380149   0.904783  
10       True  0.921584  0.024583   0.183817  
11       True  0.949127  0.024583   0.183817  
12       True  0.879817  0.209000   0.343322  
13       True  0.999999  0.009583   2.024725  
14       True  0.999977  0.009583   2.024725  
15       True  0.999963  0.009583   2.024725  
16       True  0.999994  0.009583   2.024725  
17       True  0.999998  0.009583   2.024725  
18       True  0.999985  0.009583   2.024725  
19       True  1.000000  0.009583   2.024725  
20       True  1.000000  0.009583   2.024725  
21       True  0.999999  0.009583   2.024725  
22       True  1.000000  0.009583   2.024725  
23       True  1.000000  0.009583   2.024725  
24       True  1.000000  0.009583   2.024725  
25       True  1.000000  0.009583   2.024725  
26       True  1.000000  0.009583   2.024725  
27       True  1.000000  0.009583   2.024725  
28       True  1.000000  0.009583   2.024725  
29       True  0.999312  0.134304   0.635949  ]",,10.260632276535034,2025-07-25T10:29:41,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,3,"-- Query to retrieve the requested information from the ALeRCE databaseSELECT     o.oid, -- Unique object identifier    d.candid, -- Candidate identifier    d.fid, -- Filter identifier    d.mjd, -- Modified Julian date    d.magpsf AS magnitude, -- Magnitude    d.sigmapsf AS magnitude_error, -- Magnitude error    d.has_stamp, -- Whether the object has stamps    d.drb AS deep_learning_real_bogus_score, -- Deep learning real bogus score    pz.sgscore1 AS star_galaxy_score, -- Star-galaxy score of the nearest object    pz.distpsnr1 AS distance_to_nearest_source -- Distance to the nearest source in Pan-STARRSFROM     object oINNER JOIN     detection d ON o.oid = d.oidINNER JOIN     ps1_ztf pz ON d.oid = pz.oid AND d.candid = pz.candidWHERE     o.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',               'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',               'ZTF22aawasao', 'ZTF23aaxgvnt') -- Filter by the list of object identifiers    AND d.drb > 0.5 -- Deep learning real bogus score greater than 0.5    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1) -- Star-galaxy score < 0.5 OR distance to nearest source < 1 arcsec","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",medium,53.588807582855225,2025-07-23T18:35:33,"[            oid               candid  fid           mjd  magnitude  \
0  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194   
1  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863   
2  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233   
3  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726   
4  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120   
5  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100   
6  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078   

   magnitude_error  has_stamp  deep_learning_real_bogus_score  \
0         0.180156       True                        0.994159   
1         0.175351       True                        0.696538   
2         0.143780       True                        0.755912   
3         0.181016       True                        0.949127   
4         0.216384       True                        0.879817   
5         0.067061       True                        1.000000   
6         0.063636       True                        0.999312   

   star_galaxy_score  distance_to_nearest_source  
0           0.075167                    0.326697  
1           0.075167                    1.234589  
2           0.380149                    0.904783  
3           0.024583                    0.183817  
4           0.209000                    0.343322  
5           0.009583                    2.024725  
6           0.134304                    0.635949  ]",,11.803635597229004,2025-07-25T10:29:57,0.23333333333333334,4.285714285714286,0.5,0.5,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,14,4,"WITH selected_oids (oid) AS (    VALUES         ('ZTF23aavzgjg'),         ('ZTF23aaynzyk'),         ('ZTF23aavqxos'),         ('ZTF23aaknyni'),         ('ZTF23aavsdtc'),         ('ZTF18aandkua'),         ('ZTF23aaxfewt'),         ('ZTF23aavshwi'),         ('ZTF22aawasao'),         ('ZTF23aaxgvnt'))SELECT     o.oid,     d.candid,     d.fid,     d.mjd,     d.magpsf,     d.sigmapsf,     d.has_stamp,     d.drb,     pz.sgscore1,     pz.distpsnr1FROM     detection dINNER JOIN     selected_oids so ON d.oid = so.oidINNER JOIN     ps1_ztf pz ON d.oid = pz.oid AND d.candid = pz.candidINNER JOIN     object o ON d.oid = o.oidWHERE     d.drb > 0.5    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1)ORDER BY     d.mjd DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,39.97315812110901,2025-07-23T18:36:13,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
1  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
2  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
5  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
6  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.696538  0.075167   1.234589  
1       True  0.755912  0.380149   0.904783  
2       True  0.994159  0.075167   0.326697  
3       True  0.999312  0.134304   0.635949  
4       True  1.000000  0.009583   2.024725  
5       True  0.879817  0.209000   0.343322  
6       True  0.949127  0.024583   0.183817  ]",,15.409791946411133,2025-07-25T10:30:16,0.23333333333333334,4.285714285714286,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,5,"-- [FINAL QUERY HERE]SELECT     o.oid,     d.candid,     d.fid,     d.mjd,     d.magpsf AS magnitude,     d.sigmapsf AS magnitude_error,     d.has_stamp,     d.drb AS deep_learning_real_bogus_score,     pz.sgscore1 AS star_galaxy_score_nearest,     pz.distpsnr1 AS distance_to_nearest_panstarrs_sourceFROM     object oINNER JOIN     detection d ON o.oid = d.oidINNER JOIN     ps1_ztf pz ON o.oid = pz.oidWHERE     o.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',               'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',               'ZTF22aawasao', 'ZTF23aaxgvnt')    AND d.drb > 0.5    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,28.05098056793213,2025-07-23T18:36:41,"[             oid               candid  fid           mjd  magnitude  \
0   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863   
1   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638   
2   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133   
3   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194   
4   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863   
5   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638   
6   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133   
7   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194   
8   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233   
9   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233   
10  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983   
11  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726   
12  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120   
13  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957   
14  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201   
15  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028   
16  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288   
17  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290   
18  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382   
19  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363   
20  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866   
21  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947   
22  ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606   
23  ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047   
24  ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996   
25  ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604   
26  ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126   
27  ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477   
28  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100   
29  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078   

    magnitude_error  has_stamp  deep_learning_real_bogus_score  \
0          0.175351       True                        0.696538   
1          0.183068       True                        0.850113   
2          0.161114       True                        0.993011   
3          0.180156       True                        0.994159   
4          0.175351       True                        0.696538   
5          0.183068       True                        0.850113   
6          0.161114       True                        0.993011   
7          0.180156       True                        0.994159   
8          0.143780       True                        0.755912   
9          0.143780       True                        0.755912   
10         0.215474       True                        0.921584   
11         0.181016       True                        0.949127   
12         0.216384       True                        0.879817   
13         0.146235       True                        0.999999   
14         0.131913       True                        0.999977   
15         0.172092       True                        0.999963   
16         0.176278       True                        0.999994   
17         0.112882       True                        0.999998   
18         0.193578       True                        0.999985   
19         0.086399       True                        1.000000   
20         0.079126       True                        1.000000   
21         0.147604       True                        0.999999   
22         0.067233       True                        1.000000   
23         0.061804       True                        1.000000   
24         0.070969       True                        1.000000   
25         0.094521       True                        1.000000   
26         0.060204       True                        1.000000   
27         0.096587       True                        1.000000   
28         0.067061       True                        1.000000   
29         0.063636       True                        0.999312   

    star_galaxy_score_nearest  distance_to_nearest_panstarrs_source  
0                    0.075167                              0.326697  
1                    0.075167                              0.326697  
2                    0.075167                              0.326697  
3                    0.075167                              0.326697  
4                    0.075167                              1.234589  
5                    0.075167                              1.234589  
6                    0.075167                              1.234589  
7                    0.075167                              1.234589  
8                    0.380149                              0.673811  
9                    0.380149                              0.904783  
10                   0.024583                              0.183817  
11                   0.024583                              0.183817  
12                   0.209000                              0.343322  
13                   0.009583                              2.024725  
14                   0.009583                              2.024725  
15                   0.009583                              2.024725  
16                   0.009583                              2.024725  
17                   0.009583                              2.024725  
18                   0.009583                              2.024725  
19                   0.009583                              2.024725  
20                   0.009583                              2.024725  
21                   0.009583                              2.024725  
22                   0.009583                              2.024725  
23                   0.009583                              2.024725  
24                   0.009583                              2.024725  
25                   0.009583                              2.024725  
26                   0.009583                              2.024725  
27                   0.009583                              2.024725  
28                   0.009583                              2.024725  
29                   0.134304                              0.635949  ]",,12.699522733688354,2025-07-25T10:30:32,1.0,1.0,0.5,0.5,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,14,6,"-- [FINAL QUERY HERE]SELECT     o.oid,     d.candid,     d.fid,     d.mjd,     d.magpsf AS magnitude,     d.sigmapsf AS magnitude_error,     d.has_stamp,     d.drb AS deep_learning_real_bogus_score,     pz.sgscore1 AS star_galaxy_score,     pz.distpsnr1 AS distance_to_nearest_sourceFROM     object oINNER JOIN     detection d ON o.oid = d.oidINNER JOIN     ps1_ztf pz ON o.oid = pz.oidWHERE     o.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',               'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',               'ZTF22aawasao', 'ZTF23aaxgvnt')    AND d.drb > 0.5    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1)ORDER BY     o.oid, d.mjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,22.44264388084412,2025-07-23T18:37:03,"[             oid               candid  fid           mjd  magnitude  \
0   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194   
1   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194   
2   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133   
3   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133   
4   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638   
5   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638   
6   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863   
7   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863   
8   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233   
9   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233   
10  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726   
11  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983   
12  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120   
13  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100   
14  ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477   
15  ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126   
16  ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604   
17  ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996   
18  ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047   
19  ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606   
20  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947   
21  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866   
22  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363   
23  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382   
24  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290   
25  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288   
26  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028   
27  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201   
28  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957   
29  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078   

    magnitude_error  has_stamp  deep_learning_real_bogus_score  \
0          0.180156       True                        0.994159   
1          0.180156       True                        0.994159   
2          0.161114       True                        0.993011   
3          0.161114       True                        0.993011   
4          0.183068       True                        0.850113   
5          0.183068       True                        0.850113   
6          0.175351       True                        0.696538   
7          0.175351       True                        0.696538   
8          0.143780       True                        0.755912   
9          0.143780       True                        0.755912   
10         0.181016       True                        0.949127   
11         0.215474       True                        0.921584   
12         0.216384       True                        0.879817   
13         0.067061       True                        1.000000   
14         0.096587       True                        1.000000   
15         0.060204       True                        1.000000   
16         0.094521       True                        1.000000   
17         0.070969       True                        1.000000   
18         0.061804       True                        1.000000   
19         0.067233       True                        1.000000   
20         0.147604       True                        0.999999   
21         0.079126       True                        1.000000   
22         0.086399       True                        1.000000   
23         0.193578       True                        0.999985   
24         0.112882       True                        0.999998   
25         0.176278       True                        0.999994   
26         0.172092       True                        0.999963   
27         0.131913       True                        0.999977   
28         0.146235       True                        0.999999   
29         0.063636       True                        0.999312   

    star_galaxy_score  distance_to_nearest_source  
0            0.075167                    1.234589  
1            0.075167                    0.326697  
2            0.075167                    1.234589  
3            0.075167                    0.326697  
4            0.075167                    0.326697  
5            0.075167                    1.234589  
6            0.075167                    0.326697  
7            0.075167                    1.234589  
8            0.380149                    0.673811  
9            0.380149                    0.904783  
10           0.024583                    0.183817  
11           0.024583                    0.183817  
12           0.209000                    0.343322  
13           0.009583                    2.024725  
14           0.009583                    2.024725  
15           0.009583                    2.024725  
16           0.009583                    2.024725  
17           0.009583                    2.024725  
18           0.009583                    2.024725  
19           0.009583                    2.024725  
20           0.009583                    2.024725  
21           0.009583                    2.024725  
22           0.009583                    2.024725  
23           0.009583                    2.024725  
24           0.009583                    2.024725  
25           0.009583                    2.024725  
26           0.009583                    2.024725  
27           0.009583                    2.024725  
28           0.009583                    2.024725  
29           0.134304                    0.635949  ]",,10.602859258651733,2025-07-25T10:30:47,1.0,1.0,0.5,0.5,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,14,7,"-- [FINAL QUERY HERE]SELECT     d.oid,     d.candid,     d.fid,     d.mjd,     d.magpsf,     d.sigmapsf,     d.has_stamp,     d.drb,     pz.sgscore1,     pz.distpsnr1FROM     detection dINNER JOIN     ps1_ztf pz ON d.oid = pz.oidWHERE     d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',               'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',               'ZTF22aawasao', 'ZTF23aaxgvnt')    AND d.drb > 0.5    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,33.69431519508362,2025-07-23T18:37:37,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1   ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2   ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
3   ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
4   ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
5   ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
6   ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
7   ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
8   ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
9   ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
10  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
11  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
12  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
13  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
14  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
15  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
16  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
17  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
18  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
19  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
20  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
21  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
22  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
23  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
24  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
25  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
26  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
27  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   
28  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
29  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.949127  0.024583   0.183817  
1        True  0.879817  0.209000   0.343322  
2        True  1.000000  0.009583   2.024725  
3        True  1.000000  0.009583   2.024725  
4        True  1.000000  0.009583   2.024725  
5        True  1.000000  0.009583   2.024725  
6        True  1.000000  0.009583   2.024725  
7        True  1.000000  0.009583   2.024725  
8        True  0.999312  0.134304   0.635949  
9        True  1.000000  0.009583   2.024725  
10       True  0.999999  0.009583   2.024725  
11       True  0.994159  0.075167   0.326697  
12       True  0.999985  0.009583   2.024725  
13       True  1.000000  0.009583   2.024725  
14       True  1.000000  0.009583   2.024725  
15       True  0.999998  0.009583   2.024725  
16       True  0.999994  0.009583   2.024725  
17       True  0.994159  0.075167   1.234589  
18       True  0.999963  0.009583   2.024725  
19       True  0.999999  0.009583   2.024725  
20       True  0.999977  0.009583   2.024725  
21       True  0.755912  0.380149   0.673811  
22       True  0.850113  0.075167   0.326697  
23       True  0.850113  0.075167   1.234589  
24       True  0.993011  0.075167   0.326697  
25       True  0.993011  0.075167   1.234589  
26       True  0.755912  0.380149   0.904783  
27       True  0.921584  0.024583   0.183817  
28       True  0.696538  0.075167   0.326697  
29       True  0.696538  0.075167   1.234589  ]",,10.302624702453613,2025-07-25T10:31:01,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,8,"-- [FINAL QUERY HERE]SELECT DISTINCT     o.oid,     d.candid,     d.fid,     d.mjd,     d.magpsf AS magnitude,     d.sigmapsf AS magnitude_error,     d.has_stamp,     d.drb AS deep_learning_real_bogus_score,     pz.sgscore1 AS star_galaxy_score,     pz.distpsnr1 AS distance_to_nearest_panstarrs_sourceFROM     object oINNER JOIN     detection d ON o.oid = d.oidINNER JOIN     ps1_ztf pz ON d.oid = pz.oid AND d.candid = pz.candidWHERE     o.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',               'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',               'ZTF22aawasao', 'ZTF23aaxgvnt')    AND d.drb > 0.5    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1)ORDER BY     o.oid, d.mjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,25.753978729248047,2025-07-23T18:38:03,"[            oid               candid  fid           mjd  magnitude  \
0  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194   
1  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863   
2  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233   
3  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726   
4  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120   
5  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100   
6  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078   

   magnitude_error  has_stamp  deep_learning_real_bogus_score  \
0         0.180156       True                        0.994159   
1         0.175351       True                        0.696538   
2         0.143780       True                        0.755912   
3         0.181016       True                        0.949127   
4         0.216384       True                        0.879817   
5         0.067061       True                        1.000000   
6         0.063636       True                        0.999312   

   star_galaxy_score  distance_to_nearest_panstarrs_source  
0           0.075167                              0.326697  
1           0.075167                              1.234589  
2           0.380149                              0.904783  
3           0.024583                              0.183817  
4           0.209000                              0.343322  
5           0.009583                              2.024725  
6           0.134304                              0.635949  ]",,10.203001022338867,2025-07-25T10:31:15,0.23333333333333334,4.285714285714286,0.5,0.5,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,14,9,"-- [FINAL QUERY HERE]WITH filtered_oids AS (    -- Step 2: Define the list of object identifiers    SELECT UNNEST(ARRAY['ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',                         'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',                         'ZTF22aawasao', 'ZTF23aaxgvnt']) AS oid)SELECT     d.oid,                -- Unique object identifier    d.candid,             -- Candidate identifier    d.fid,                -- Filter identifier    d.mjd,                -- Modified Julian date    d.magpsf,             -- Magnitude    d.sigmapsf,           -- Magnitude error    d.has_stamp,          -- Whether the object has stamps    d.drb,                -- Deep learning real bogus score    pz.sgscore1,          -- Star galaxy score of the nearest object in Pan-STARRS    pz.distpsnr1          -- Distance to the nearest source in Pan-STARRSFROM     detection dINNER JOIN     filtered_oids fo ON d.oid = fo.oid -- Filter by the provided list of oidsINNER JOIN     ps1_ztf pz ON d.oid = pz.oid       -- Join with Pan-STARRS dataWHERE     d.drb > 0.5                        -- Deep learning real bogus score condition    AND (        pz.sgscore1 < 0.5              -- Star galaxy score condition        OR pz.distpsnr1 < 1            -- Distance to nearest Pan-STARRS source condition    )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,30.82866668701172,2025-07-23T18:38:34,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   
1   ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
2   ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
3   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
4   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
5   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
6   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
7   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
8   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
9   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
10  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
11  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
12  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
13  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
14  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
15  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
16  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
17  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
18  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
19  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
20  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
21  ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
22  ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
23  ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
24  ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
25  ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
26  ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
27  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
28  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
29  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.921584  0.024583   0.183817  
1        True  0.949127  0.024583   0.183817  
2        True  0.879817  0.209000   0.343322  
3        True  0.696538  0.075167   0.326697  
4        True  0.850113  0.075167   0.326697  
5        True  0.993011  0.075167   0.326697  
6        True  0.994159  0.075167   0.326697  
7        True  0.696538  0.075167   1.234589  
8        True  0.850113  0.075167   1.234589  
9        True  0.993011  0.075167   1.234589  
10       True  0.994159  0.075167   1.234589  
11       True  0.999312  0.134304   0.635949  
12       True  0.999999  0.009583   2.024725  
13       True  0.999977  0.009583   2.024725  
14       True  0.999963  0.009583   2.024725  
15       True  0.999994  0.009583   2.024725  
16       True  0.999998  0.009583   2.024725  
17       True  0.999985  0.009583   2.024725  
18       True  1.000000  0.009583   2.024725  
19       True  1.000000  0.009583   2.024725  
20       True  0.999999  0.009583   2.024725  
21       True  1.000000  0.009583   2.024725  
22       True  1.000000  0.009583   2.024725  
23       True  1.000000  0.009583   2.024725  
24       True  1.000000  0.009583   2.024725  
25       True  1.000000  0.009583   2.024725  
26       True  1.000000  0.009583   2.024725  
27       True  1.000000  0.009583   2.024725  
28       True  0.755912  0.380149   0.673811  
29       True  0.755912  0.380149   0.904783  ]",,12.147699356079102,2025-07-25T10:31:31,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,10,"-- Final QueryWITH oids_list AS (    -- Step 1: Define the list of oids    SELECT UNNEST(ARRAY['ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni',                         'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi',                         'ZTF22aawasao', 'ZTF23aaxgvnt']) AS oid)SELECT     o.oid,     d.candid,     d.fid,     d.mjd,     d.magpsf,     d.sigmapsf,     d.has_stamp,     d.drb,     pz.sgscore1,     pz.distpsnr1FROM     oids_list olINNER JOIN     detection d ON ol.oid = d.oidINNER JOIN     ps1_ztf pz ON d.oid = pz.oidWHERE     d.drb > 0.5 -- Step 4: Filter by deep learning real bogus score    AND (pz.sgscore1 < 0.5 OR pz.distpsnr1 < 1) -- Step 5: Apply conditions on sgscore1 and distpsnr1ORDER BY     o.oid, d.candid -- Step 9: Sort the results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,29.281567335128784,2025-07-23T18:39:03,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
1   ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
2   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
3   ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
4   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
5   ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
6   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
7   ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
8   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
9   ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
10  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
11  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   
12  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
13  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
14  ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
15  ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
16  ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
17  ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
18  ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
19  ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
20  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
21  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
22  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
23  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
24  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
25  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
26  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
27  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
28  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
29  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.994159  0.075167   0.326697  
1        True  0.994159  0.075167   1.234589  
2        True  0.993011  0.075167   0.326697  
3        True  0.993011  0.075167   1.234589  
4        True  0.850113  0.075167   0.326697  
5        True  0.850113  0.075167   1.234589  
6        True  0.696538  0.075167   1.234589  
7        True  0.696538  0.075167   0.326697  
8        True  0.755912  0.380149   0.673811  
9        True  0.755912  0.380149   0.904783  
10       True  0.949127  0.024583   0.183817  
11       True  0.921584  0.024583   0.183817  
12       True  0.879817  0.209000   0.343322  
13       True  1.000000  0.009583   2.024725  
14       True  1.000000  0.009583   2.024725  
15       True  1.000000  0.009583   2.024725  
16       True  1.000000  0.009583   2.024725  
17       True  1.000000  0.009583   2.024725  
18       True  1.000000  0.009583   2.024725  
19       True  1.000000  0.009583   2.024725  
20       True  0.999999  0.009583   2.024725  
21       True  1.000000  0.009583   2.024725  
22       True  1.000000  0.009583   2.024725  
23       True  0.999985  0.009583   2.024725  
24       True  0.999998  0.009583   2.024725  
25       True  0.999994  0.009583   2.024725  
26       True  0.999963  0.009583   2.024725  
27       True  0.999977  0.009583   2.024725  
28       True  0.999999  0.009583   2.024725  
29       True  0.999312  0.134304   0.635949  ]",,11.815477848052979,2025-07-25T10:31:47,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,12,0,"
SELECT o.oid, o.meanra, o.meandec

FROM (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
    AND probability.ranking = 1
    AND object.firstmjd > 59988.0
    AND object.firstmjd < 60197.0
) as o
WHERE
    q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);
",,,,,"[             oid      meanra    meandec
0   ZTF23aazxfdh   11.327556  -2.327343
1   ZTF23aazneeg  357.339861 -17.674648
2   ZTF23aazxair   14.098124   0.520434
3   ZTF23abawaav  359.369924  -5.159571
4   ZTF23abbbrbi  358.010245  -4.224612
5   ZTF23abbbygf   16.168206  -1.053601
6   ZTF23aazwytj    0.881927 -10.744196
7   ZTF23abbkepd   13.835889   5.077601
8   ZTF23abapoiv    5.230048  -1.758021
9   ZTF23abbjstt   13.706127  -3.710276
10  ZTF23ababooa  347.699685 -15.441363
11  ZTF23aazkvym  357.860400 -11.907847
12  ZTF23abbbybs   12.780815  -5.443683
13  ZTF23abaychv   12.394942  -3.037759
14  ZTF23aaovxwf  351.140762 -19.056710
15  ZTF23aapnlvr  352.465073 -11.202974
16  ZTF23aaowayh  356.647299 -13.542643
17  ZTF23aapvrkk    0.175006 -12.236802
18  ZTF23aapvzyq  359.503657 -11.916706
19  ZTF23aaohpnv    8.491958   4.082251
20  ZTF23aapgxic    7.748520   5.157252
21  ZTF23aapqtxd    8.879058   2.147919
22  ZTF23abbygzm  343.960147 -17.448733
23  ZTF23abcvivc  358.337513  -5.886772
24  ZTF23aaqixha    8.509318  -9.703939
25  ZTF23aazxiuu    6.501685  -0.884798
26  ZTF23aaqixyp    6.388770  -7.758614
27  ZTF23abbefkk    9.982778   6.622644
28  ZTF23aazwshk   10.101225   4.791153
29  ZTF23abawaqe  352.826653 -18.783349
30  ZTF23aaqygof  345.346057 -18.765263
31  ZTF23aapwihe   17.827492   0.742945
32  ZTF23aaretvs   15.263196  -2.912866
33  ZTF23aarfbvs   11.196881  -2.378468
34  ZTF23aarffak  356.743944 -19.262242
35  ZTF23aarfpck    6.464097   2.183000
36  ZTF23aaqluoo  358.419121 -17.190397
37  ZTF23aascfrd  354.052083  -7.437187
38  ZTF23abbbomo  345.634527 -19.724748
39  ZTF23aapgjtm  351.100632 -14.425906
40  ZTF23aasyvbf    9.411387  -4.281495
41  ZTF23aatzjdo    1.226893 -13.502189
42  ZTF23aaovzyu  349.534040 -12.976046
43  ZTF23aaumlxn    6.423729  -1.050326
44  ZTF23aaaweph    1.307964 -11.502395
45  ZTF23aaaweph    1.307964 -11.502395
46  ZTF23aazsfpa  356.794110 -16.513073
47  ZTF23abbjtdn    6.232715   1.033046
48  ZTF23aavlyvc  359.897395  -6.376741
49  ZTF23aavmycb    7.102145   0.441236
50  ZTF23aawqydv   19.468501   0.780816
51  ZTF23aaxavca    9.017651   1.801565
52  ZTF23aaxavca    9.017651   1.801565
53  ZTF23aaxbfyp    4.112309 -10.371170
54  ZTF23aaxbfzl   16.973081   1.732003
55  ZTF23aaxtrgs    1.760985  -9.567699
56  ZTF23abbitkh   10.628642   8.028922
57  ZTF23aaxtdpc    9.048410  -2.151892
58  ZTF22abrrqkf  351.152588 -13.510948]",,54.469019412994385,2025-07-25T10:32:42,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,12,1,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND EXISTS (    SELECT 1    FROM probability p    WHERE p.oid = o.oid      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,5.922004222869873,2025-07-23T18:40:19,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 19:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND EXISTS (
        SELECT 1
        FROM probability p
        WHERE 
            p.oid = o.oid  -- Join condition between object and probability tables
            AND p.classifier_name = 'lc_classifier'  -- Default condition for classifier_name
            AND p.ranking = 1  -- Default condition for ranking
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.408966779708862,2025-07-25T10:33:13,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,2,"SELECT     object.oid,     object.meanra,     object.meandecFROM     objectINNER JOIN     probability ON     object.oid = probability.oidWHERE     probability.ranking = 1    AND probability.classifier_name = 'lc_classifier'    AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types    AND object.firstmjd BETWEEN 59988.0 AND 60197.0 -- February 13 to September 10    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.423312902450561,2025-07-23T18:40:22,[None],"(psycopg2.errors.UndefinedColumn) column probability.class does not exist
LINE 16:     AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN...
                 ^

[SQL: 
-- Corrected SQL Query
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec
FROM 
    object
INNER JOIN 
    probability 
ON 
    object.oid = probability.oid
WHERE 
    probability.ranking = 1 -- Ensures only the most likely probabilities are selected
    AND probability.classifier_name = 'lc_classifier' -- Filters for classifications by the light curve classifier
    AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Filters for SNe types
    AND object.firstmjd BETWEEN 59988.0 AND 60197.0 -- Filters for objects first detected between February 13 and September 10
    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon) -- Filters for objects within the specified polygon
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.844277381896973,2025-07-25T10:33:44,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,3,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.393863916397095,2025-07-23T18:40:27,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Default condition for the light curve classifier
            AND p.ranking = 1  -- Default condition to only return the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.293460845947266,2025-07-25T10:34:15,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,4,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND EXISTS (    SELECT 1    FROM probability p    WHERE p.oid = o.oid      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.239537954330444,2025-07-23T18:40:31,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 19:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND EXISTS (
        SELECT 1
        FROM probability p
        WHERE 
            p.oid = o.oid  -- Join condition between object and probability tables
            AND p.classifier_name = 'lc_classifier'  -- Default condition for classifier
            AND p.ranking = 1  -- Default condition for ranking
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.888858795166016,2025-07-25T10:34:44,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,5,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.448026418685913,2025-07-23T18:40:35,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Default condition for the light curve classifier
            AND p.ranking = 1  -- Default condition to only return the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.973671197891235,2025-07-25T10:35:15,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,6,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.597583293914795,2025-07-23T18:40:39,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Use the light curve classifier
            AND p.ranking = 1  -- Only consider the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.044664859771729,2025-07-25T10:35:44,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,7,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.403985977172852,2025-07-23T18:40:43,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Use the light curve classifier
            AND p.ranking = 1  -- Only consider the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.916130781173706,2025-07-25T10:36:14,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,8,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND EXISTS (    SELECT 1    FROM probability p    WHERE p.oid = o.oid      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.277968645095825,2025-07-23T18:40:46,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 19:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND EXISTS (
        SELECT 1
        FROM probability p
        WHERE 
            p.oid = o.oid  -- Join condition between object and probability tables
            AND p.classifier_name = 'lc_classifier'  -- Default condition for classifier_name
            AND p.ranking = 1  -- Default condition for ranking
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.45153021812439,2025-07-25T10:36:45,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,9,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.02215838432312,2025-07-23T18:40:50,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Use the light curve classifier
            AND p.ranking = 1  -- Only consider the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.90465235710144,2025-07-25T10:37:14,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,10,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.1873936653137207,2025-07-23T18:40:53,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Use the light curve classifier
            AND p.ranking = 1  -- Only consider the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.537322998046875,2025-07-25T10:37:43,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,89,0,"SELECT
    *
FROM
    dataquality
WHERE
    oid in
(
SELECT
    oid
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'SN'
    AND probability > 0.7
LIMIT 50
)",,,,,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF24absznoi  2883447633815015001    1  2847.9617   309.9084  1.420286   
1    ZTF24absznoi  2890458323815015003    1  2854.6104   322.3511  3.057867   
2    ZTF24absznoi  2895536623815015001    1  2852.5040   343.2891  1.959134   
3    ZTF24absznoi  2897538933815015000    1  2867.3438   318.7103  2.431907   
4    ZTF24absznoi  2899511063815015004    1  2856.2970   324.6609  3.200858   
..            ...                  ...  ...        ...        ...       ...   
141  ZTF24abtqrfi  2932129601115015011    1   802.8843  2098.9126  0.768007   
142  ZTF24abtqrfi  2940151161115015013    1   779.9592  2136.6729  1.936411   
143  ZTF24absyxfg  2883405535615015011    2  1150.7253  2674.6794  1.200521   
144  ZTF24absyxfg  2883433845615015011    1  1142.9119  2720.6743  1.174735   
145  ZTF24absyxfg  2890481145615015006    2  1127.8730  2718.9377  0.747118   

          sky  fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   -1.231925  3.39     0.974    224.5383  ...     0.000025     0.035277   
1   -0.489907  2.19     0.982    217.8897  ...     0.000023     0.041545   
2   -0.656732  3.02     0.970    219.9960  ...     0.000029     0.040352   
3   -0.938209  3.05     0.991    205.1563  ...     0.000027     0.038810   
4   -0.934429  2.54     0.984    216.2028  ...     0.000027     0.044077   
..        ...   ...       ...         ...  ...          ...          ...   
141  0.900627  3.67     0.972    802.8843  ...     0.000077     0.055481   
142  0.207364  4.30     0.967    779.9592  ...     0.000075     0.047768   
143 -0.050634  2.35     0.695    405.8205  ...     0.000006     0.036153   
144 -0.088327  2.52     0.938    359.8257  ...     0.000011     0.034862   
145  0.142994  2.35     0.684    361.5622  ...     0.000006     0.034306   

     nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0         270 -0.040195  0.000037 -0.000028  26.201000   0.727  0.328586   
1         294 -0.081366  0.000030 -0.000024  26.223500   0.829  0.333605   
2         295 -0.055501  0.000039 -0.000031  26.279000   0.808  0.334468   
3         290 -0.051943  0.000037 -0.000029  26.287000   0.809  0.334577   
4         295 -0.083073  0.000036 -0.000029  26.279000   0.825  0.332984   
..        ...       ...       ...       ...        ...     ...       ...   
141       137 -0.125291  0.000138 -0.000095  26.316000   0.630  0.298330   
142       168 -0.067215  0.000118 -0.000087  26.272999   0.683  0.305706   
143       608  0.095221  0.000009 -0.000007  26.267000   0.706  0.299770   
144       598 -0.060100  0.000017 -0.000013  26.242000   0.688  0.296051   
145       612  0.087145  0.000009 -0.000007  26.290000   0.704  0.301723   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3       30.0  
4       30.0  
..       ...  
141     30.0  
142     30.0  
143     30.0  
144     30.0  
145     30.0  

[146 rows x 32 columns]]",,4.765682935714722,2025-07-25T10:37:48,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,1,-- Retrieve at most 50 ZTF objects classified as supernovae (SN) with a probability > 0.7-- in the stamp_classifier and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN probability p    ON dq.oid = p.oidWHERE p.class_name = 'SN' -- Filter for supernovae classification  AND p.classifier_name = 'stamp_classifier' -- Use the stamp classifier  AND p.ranking = 1 -- Only consider the most likely classification  AND p.probability > 0.7 -- Probability thresholdLIMIT 50 -- Limit the results to at most 50 rows,"['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,27.96042251586914,2025-07-23T18:50:46,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF24abtpjdj  2899123950215015009    2  1717.4437  1972.7426  1.730954   
1   ZTF24abubjhh  2899153140315015005    1  2135.1602  2407.5005  1.411530   
2   ZTF24abubjhh  2897197060315015007    1  2126.9620  2415.1614  0.914375   
3   ZTF24abubjhh  2897129490315015004    2  2150.2227  2417.9140  0.784808   
4   ZTF24abubjhh  2897129014915015001    2  1372.7722   380.9818  1.582811   
5   ZTF18abpzwla   880465390315015015    1  1432.0938  1920.3253  1.177930   
6   ZTF18abpzwla   601420940315015009    2  1384.0533  1969.9158  1.272910   
7   ZTF18abpzwla  1314386030315015005    2  1478.6743  1956.4490  1.558076   
8   ZTF18abpzwla   880432970315015010    2  1410.1416  1926.9532  1.484465   
9   ZTF24abvijwt  2897145794315015022    2  1117.2000  1732.6443  1.437432   
10  ZTF24abuclrs  2899167153315015012    2  2583.8790  2762.0273  0.744071   
11  ZTF24abswxgo  2897128071315015014    2   732.8858  1821.9175  0.804444   
12  ZTF24abswxgo  2893221771315015018    1   738.1234  1800.1486  0.863769   
13  ZTF24abvmcfc  2893242285715015057    1   657.2480   300.7153  1.791287   
14  ZTF24abuyefl  2938280150915015004    2  2543.0017  1490.7140  1.314510   
15  ZTF24abuyefl  2932365860915015000    2  2568.9120  1531.4279  1.021711   
16  ZTF24abuyefl  2920259620915015000    2  2571.7500  1458.0093  1.355491   
17  ZTF24abuyefl  2920244130915015001    1  2576.2004  1437.3937  1.361567   
18  ZTF24abuyefl  2905515010915015003    2  2562.3635  1481.2369  4.442573   
19  ZTF24abuyefl  2899322680915015002    1  2562.2725  1445.5557  3.368555   
20  ZTF24abuyefl  2899261430915015003    2  2553.2776  1419.2490  2.216950   
21  ZTF24abuyefl  2897489670915015001    1  2572.4177  1457.6150  4.454643   
22  ZTF24abuyefl  2897449490915015054    2  2580.5164  1451.0272  4.106434   
23  ZTF24abuyefl  2895470610915015007    2  2575.0686  1457.1613  1.036497   
24  ZTF24abuyefl  2895431270915015001    1  2576.4626  1458.5187  5.497341   
25  ZTF24abuyefl  2893394160915015007    2  2572.1301  1451.2218  1.536266   
26  ZTF24abugrwf  2938309243915015001    2   767.9334   625.0693  1.103005   
27  ZTF24abugrwf  2930318733915015002    2   781.0561   598.4568  1.247766   
28  ZTF24abugrwf  2926373803915015002    2   781.5462   659.6673  0.999262   
29  ZTF24abugrwf  2920270033915015001    2   796.4991   587.6032  1.129540   
30  ZTF24abugrwf  2914405713915015002    1   802.0266   614.0470  1.212068   
31  ZTF24abugrwf  2914349723915015006    2   792.2057   601.4752  2.553545   
32  ZTF24abugrwf  2899326923915015002    1   788.1423   569.9466  1.125460   
33  ZTF24abugrwf  2899260023915015002    2   772.6513   539.9728  1.078817   
34  ZTF24abugrwf  2897487783915015004    1   788.9118   585.3283  1.998052   
35  ZTF24abugrwf  2895474883915015004    2   785.4907   581.7845  5.367786   
36  ZTF24abugrwf  2893401563915015005    2   800.2614   579.0222  2.121048   
37  ZTF24abvousd  2893434391215015045    2  2881.8896  1902.2467  1.131185   
38  ZTF24abvrnpa  2897528543115015010    1  2255.9966  1286.4421  0.876997   
39  ZTF24abvrnpa  2895540573115015009    1  2254.5615  1321.6632  1.585630   
40  ZTF24abvrnpa  2893507653115015010    1  2243.8567  1313.2548  1.017167   
41  ZTF24abvtglw  2934136131115015012    2  1676.0093  2353.9014  0.939105   
42  ZTF24abvtglw  2934115275315015000    2   697.1615   254.7200  0.897909   
43  ZTF24abvtglw  2932114795315015000    2   699.2376   232.2871  1.609686   
44  ZTF24abvtglw  2930181571115015009    2  1665.2260  2334.5860  1.238664   
45  ZTF24abvtglw  2930181095315015000    2   676.5163   229.2905  1.344166   
46  ZTF24abvtglw  2927145391115015017    1  1674.3715  2372.1443  1.178827   
47  ZTF24abvtglw  2927111495315015001    2   726.6311   211.3643  2.814222   
48  ZTF24abvtglw  2927111951115015096    2  1712.9238  2318.8901  0.999958   
49  ZTF24abvtglw  2925144791115015011    2  1684.1542  2289.3550  1.517407   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.170498  2.700000     0.994   1107.7574  ...     0.000005     0.035523   
1  -0.330518  2.670000     0.977    672.9996  ...     0.000012     0.034144   
2   0.015994  2.640000     0.973    665.3386  ...     0.000011     0.036114   
3  -0.281139  2.300000     0.966    662.5859  ...     0.000005     0.038625   
4  -0.028857  3.220000     0.971    380.9818  ...     0.000006     0.035230   
5   0.148169  2.220000     0.744   1160.1747  ...     0.000007     0.035189   
6   0.060727  3.440000     0.974   1110.5842  ...     0.000009     0.039406   
7   0.286917  2.170000     0.982   1124.0510  ...     0.000006     0.039661   
8   0.089429  2.240000     0.933   1153.5468  ...     0.000004     0.038632   
9   0.663365  2.600000     0.971   1117.2000  ...     0.000006     0.038965   
10 -0.736771  1.256540     0.852    318.4726  ...     0.000005     0.043539   
11 -0.429452  2.600000     0.939    732.8858  ...     0.000008     0.044588   
12  0.119966  1.910000     0.965    738.1234  ...     0.000019     0.041285   
13 -2.671755  2.530000     0.957    300.7153  ...     0.000081     0.089803   
14  0.540724  1.359156     0.667    529.4984  ...     0.000009     0.037416   
15  0.759987  2.910000     0.935    503.5880  ...     0.000011     0.041847   
16  0.563181  4.320000     0.868    500.7501  ...     0.000018     0.050098   
17 -0.128297  3.840000     0.954    496.2996  ...     0.000020     0.044246   
18 -3.572985  1.990000     0.998    510.1364  ...     0.000015     0.042595   
19 -0.178445  3.510000     0.982    510.2275  ...     0.000018     0.041838   
20  0.001368  3.450000     0.983    519.2223  ...     0.000015     0.049501   
21  0.409863  3.050000     0.983    500.0823  ...     0.000014     0.047165   
22 -0.062900  2.240000     0.982    491.9837  ...     0.000010     0.040261   
23  0.736052  1.980000     0.973    497.4314  ...     0.000007     0.039114   
24  0.112878  2.580000     0.987    496.0373  ...     0.000012     0.056021   
25  0.365464  2.040000     0.998    500.3699  ...     0.000007     0.037487   
26  0.445434  1.231153     0.857    625.0693  ...     0.000009     0.045549   
27  0.559798  2.300000     0.972    598.4568  ...     0.000008     0.043660   
28 -0.085475  3.150000     0.915    659.6673  ...     0.000011     0.048640   
29  0.141232  6.690000     0.912    587.6032  ...     0.000012     0.049334   
30 -0.275519  1.970000     0.978    614.0470  ...     0.000011     0.039304   
31 -0.239683  1.750000     0.998    601.4752  ...     0.000011     0.044856   
32  0.045194  3.650000     0.974    569.9466  ...     0.000017     0.039799   
33  0.060803  4.090000     0.971    539.9728  ...     0.000016     0.052775   
34  0.120963  3.520000     0.941    585.3283  ...     0.000015     0.035857   
35  0.264504  2.500000     1.000    581.7845  ...     0.000008     0.042319   
36  0.585096  2.020000     0.983    579.0222  ...     0.000007     0.043042   
37 -0.878922  1.148893     0.929    190.6104  ...     0.000328     0.129044   
38  0.047729  2.450000     0.884    816.5033  ...     0.000014     0.039847   
39 -0.010001  2.430000     0.977    817.9385  ...     0.000012     0.037247   
40 -0.526737  2.610000     0.997    828.6433  ...     0.000075     0.069112   
41  0.595053  2.180000     0.978    726.5986  ...     0.000004     0.033465   
42 -0.694129  4.170000     0.979    254.7200  ...     0.000006     0.041889   
43  1.624457  1.790000     0.990    232.2871  ...     0.000003     0.032112   
44 -0.577936  3.150000     0.954    745.9140  ...     0.000009     0.047284   
45 -0.104167  3.480000     0.926    229.2905  ...     0.000010     0.047885   
46  0.624216  2.920000     0.976    708.3557  ...     0.000006     0.037258   
47 -0.663596  1.850000     0.983    211.3643  ...     0.000003     0.033269   
48  6.516121  1.800000     0.982    761.6099  ...     0.000007     0.042047   
49  0.090483  2.460000     0.983    791.1450  ...     0.000002     0.029214   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0        706  0.091222  0.000008 -0.000006  26.2430   0.679  0.303689     30.0  
1        639 -0.037117  0.000018 -0.000013  26.1550   0.642  0.299060     30.0  
2        650 -0.051718  0.000018 -0.000013  26.1210   0.654  0.303986     30.0  
3        677  0.100643  0.000008 -0.000006  26.1270   0.684  0.312752     30.0  
4        675  0.086870  0.000009 -0.000007  26.2460   0.670  0.305187     30.0  
5        826 -0.068163  0.000011 -0.000008  25.8890   0.640  0.302539     30.0  
6        832  0.075794  0.000014 -0.000010  26.0740   0.642  0.302254      0.0  
7        828  0.096068  0.000010 -0.000007  26.1380   0.640  0.303271     30.0  
8        830  0.102464  0.000007 -0.000005  25.8840   0.641  0.301924     30.0  
9        569  0.104345  0.000009 -0.000007  26.4670   0.701  0.309782     30.0  
10       776  0.116087  0.000007 -0.000006  26.3980   0.701  0.314644     30.0  
11       508  0.116143  0.000012 -0.000009  26.2500   0.697  0.319494     30.0  
12       493 -0.047507  0.000030 -0.000022  26.0730   0.651  0.316636     30.0  
13      2156 -0.078682  0.000155 -0.000109  25.5625   0.673  0.153972     30.0  
14       495  0.087266  0.000013 -0.000010  26.3210   0.685  0.316856     30.0  
15       501  0.098104  0.000016 -0.000012  26.3410   0.685  0.315711     30.0  
16       491  0.108663  0.000027 -0.000021  26.3130   0.686  0.316289     30.0  
17       433 -0.089421  0.000034 -0.000024  26.2660   0.619  0.293222     30.0  
18       490  0.084920  0.000022 -0.000017  26.2690   0.688  0.316877     30.0  
19       433 -0.081527  0.000031 -0.000022  26.2810   0.628  0.294034     30.0  
20       486  0.116944  0.000022 -0.000017  26.2765   0.678  0.316609     30.0  
21       484 -0.112603  0.000021 -0.000016  26.3365   0.674  0.311334     30.0  
22       461  0.095818  0.000015 -0.000011  26.1800   0.700  0.317974     30.0  
23       494  0.100165  0.000011 -0.000008  26.3210   0.685  0.316037     30.0  
24       490 -0.151312  0.000018 -0.000014  26.3100   0.686  0.314284     30.0  
25       491  0.095188  0.000010 -0.000008  26.2650   0.686  0.316230     30.0  
26       494  0.116567  0.000012 -0.000010  26.4010   0.735  0.325326     30.0  
27       499  0.113431  0.000011 -0.000008  26.3990   0.734  0.323556     30.0  
28       496  0.121968  0.000015 -0.000012  26.2805   0.742  0.325659     30.0  
29       498  0.123502  0.000016 -0.000013  26.3910   0.740  0.323817     30.0  
30       490 -0.082250  0.000016 -0.000012  26.2240   0.717  0.324685     30.0  
31       500  0.107678  0.000015 -0.000012  26.2630   0.735  0.324904     30.0  
32       466 -0.061324  0.000026 -0.000019  26.2570   0.670  0.317816     30.0  
33       495  0.124684  0.000023 -0.000018  26.3280   0.720  0.322616     30.0  
34       490 -0.046474  0.000021 -0.000016  26.2955   0.720  0.323297     30.0  
35       496  0.108250  0.000011 -0.000008  26.4100   0.735  0.324143     30.0  
36       497  0.111170  0.000010 -0.000008  26.3270   0.734  0.324818     30.0  
37       302  0.110593  0.000466 -0.000359  25.3400   0.717  0.329807     30.0  
38       430 -0.072068  0.000025 -0.000017  26.1870   0.592  0.315789     30.0  
39       441 -0.066927  0.000021 -0.000014  26.1970   0.602  0.317966     30.0  
40       352 -0.043490  0.000159 -0.000099  25.1640   0.538  0.287077     30.0  
41      1830  0.080992  0.000006 -0.000004  26.2760   0.633  0.250666     30.0  
42      1659  0.078528  0.000011 -0.000008  26.2670   0.613  0.268742     30.0  
43      1678  0.080521  0.000005 -0.000003  26.2900   0.613  0.266957     30.0  
44      1702  0.089268  0.000016 -0.000011  26.2590   0.633  0.253322     30.0  
45      1399  0.083296  0.000020 -0.000013  26.2330   0.597  0.258334     30.0  
46      1789 -0.066125  0.000011 -0.000008  26.2740   0.623  0.240782     30.0  
47      1674  0.076767  0.000006 -0.000004  26.2510   0.607  0.265998     30.0  
48      1827  0.078442  0.000012 -0.000009  26.2080   0.633  0.250328     30.0  
49      1830  0.082859  0.000004 -0.000003  26.3060   0.633  0.247715     30.0  

[50 rows x 32 columns]]",,9.483108043670654,2025-07-25T10:38:03,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,2,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the stamp_classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN'      AND classifier_name = 'stamp_classifier'      AND probability > 0.7      AND ranking = 1) p ON dq.oid = p.oidLIMIT 50","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.85085701942444,2025-07-23T18:51:09,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF24abwqvsu  2920472140015015004    1  2987.3662  1687.7393  1.741539   
1   ZTF24abwqvsu  2904457680015015014    2  2974.0537  1675.2467  1.408546   
2   ZTF24abwqvsu  2934383480015015021    2  2965.9263  1749.7351  1.388803   
3   ZTF24abwqvsu  2930322030015015001    2  2969.5780  1681.2148  1.605592   
4   ZTF24abwqvsu  2925449960015015002    2  2984.4420  1685.9021  1.408688   
5   ZTF24abwqvsu  2922467980015015005    1  2993.9077  1692.5814  1.490633   
6   ZTF24abwsvor  2896535452315015000    1   894.0690   368.6807  1.367834   
7   ZTF24abwsvpv  3004426932415015010    1   313.2269   973.1325  1.099929   
8   ZTF24abwsvpv  3000330502415015007    1   303.7828   971.0586  0.786658   
9   ZTF24abwsvpv  2990408502415015003    1   293.3720   973.1402  0.965795   
10  ZTF24abwsvpv  2979343862415015006    1   325.0400   939.9959  1.296109   
11  ZTF24abwsvpv  2971450082415015001    1   317.6445   995.1331  1.446198   
12  ZTF24abwsvpv  2960516622415015005    1   307.9749  1023.2618  1.094453   
13  ZTF24abwsvpv  2952472522415015005    1   299.6161   963.1735  1.728818   
14  ZTF24abwsvpv  2941436412415015001    1   289.7358   943.5399  1.639088   
15  ZTF24abwsvpv  2933510942415015001    2   292.5551   970.9593  1.288198   
16  ZTF24abwsvpv  2928431842415015006    1   298.7432   919.0792  1.292100   
17  ZTF24abwsvpv  2926454242415015002    1   292.2986   986.1960  1.362775   
18  ZTF24abwsvpv  2921517612415015006    1   313.2962   932.5026  1.656260   
19  ZTF24abwsvpv  2919553532415015011    1   315.3066   940.7360  3.350014   
20  ZTF24abwsvpv  2904572392415015002    2   303.6330   932.5492  1.266589   
21  ZTF24abwsvpv  2896535452415015003    1   305.0671   904.8878  1.294928   
22  ZTF24abwsvqd  2896535454015015011    1   320.1508  2087.9850  0.995168   
23  ZTF24abwsvtl  2898519520915015012    1  1026.7177  1588.3076  2.025010   
24  ZTF24abuvisd  2898520481915015008    1  1352.7025  2360.0464  0.995964   
25  ZTF24abuvisd  2896539233015015017    1  2685.4434  2368.0500  1.556186   
26  ZTF24abuvisd  2896539691915015009    1  1364.4943  2370.6206  1.521510   
27  ZTF24abuvirt  2898520482715015010    1  1542.6177  1327.5575  2.284569   
28  ZTF24abpqeun  3106303493915015010    2  2409.3984  1557.7251  2.316617   
29  ZTF24abpqeun  3106260243915015006    1  2449.3396  1551.5872  1.391682   
30  ZTF24abpqeun  3104329733915015007    1  2383.2822  1550.3838  1.867656   
31  ZTF24abpqeun  3104312483915015002    2  2423.1426  1549.6718  2.510683   
32  ZTF24abpqeun  3098327243915015005    2  2405.5270  1538.9932  2.708975   
33  ZTF24abpqeun  3098288263915015004    1  2409.4558  1548.8105  1.576674   
34  ZTF24abpqeun  3096359343915015006    2  2404.4640  1569.1241  2.938747   
35  ZTF24abpqeun  3096312183915015009    2  2405.5518  1571.9786  3.373613   
36  ZTF24abpqeun  3094353053915015006    1  2393.2970  1566.4800  1.790760   
37  ZTF24abpqeun  3094278813915015004    2  2444.9165  1580.8944  1.480904   
38  ZTF24abpqeun  3092336403915015017    2  2391.5027  1555.7476  2.307142   
39  ZTF24abpqeun  3090305103915015006    1  2413.4138  1550.1812  1.170292   
40  ZTF24abpqeun  3084310433915015002    2  2426.3480  1551.6802  1.857677   
41  ZTF24abpqeun  3082311603915015001    2  2446.4420  1559.6145  1.290685   
42  ZTF24abpqeun  3080252933915015002    2  2411.0032  1557.9071  1.558619   
43  ZTF24abpqeun  3078273423915015002    2  2418.3318  1567.1779  1.907310   
44  ZTF24abpqeun  3075403913915015025    2  2414.1400  1544.8438  1.789318   
45  ZTF24abpqeun  3075353663915015015    1  2420.8400  1539.9489  1.307782   
46  ZTF24abpqeun  3060368213915015002    2  2413.4000  1591.6359  2.173300   
47  ZTF24abpqeun  3060315773915015008    1  2428.0220  1594.2657  1.061060   
48  ZTF24abpqeun  3056352453915015003    1  2411.7615  1576.5810  1.174869   
49  ZTF24abpqeun  3050412933915015011    2  2411.8994  1551.2433  1.082722   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.109296  2.520000     0.967     85.1339  ...     0.000020     0.038967   
1   1.690467  1.146141     0.935     98.4463  ...     0.000028     0.050249   
2   5.412880  2.350000     0.675    106.5737  ...     0.000043     0.056893   
3  -0.256889  1.329797     0.940    102.9220  ...     0.000020     0.046536   
4  -0.175854  2.350000     0.719     88.0582  ...     0.000019     0.043808   
5  -0.365087  2.540000     0.747     78.5922  ...     0.000019     0.036430   
6   0.144187  3.880000     0.973    368.6807  ...     0.000023     0.052225   
7  -0.564190  1.900000     0.831    313.2269  ...     0.000011     0.041531   
8  -0.757395  2.470000     0.769    303.7828  ...     0.000012     0.034534   
9  -0.186526  3.420000     0.974    293.3720  ...     0.000020     0.040673   
10 -1.121265  4.320000     0.623    325.0400  ...     0.000027     0.047922   
11 -0.639691  2.790000     0.983    317.6445  ...     0.000014     0.041031   
12 -0.200415  2.140000     0.829    307.9749  ...     0.000022     0.047762   
13 -0.266453  3.060000     0.963    299.6161  ...     0.000013     0.040195   
14 -0.790322  3.500000     0.966    289.7358  ...     0.000022     0.043717   
15 -2.204173  3.120000     0.979    292.5551  ...     0.000017     0.053088   
16 -0.457047  3.390000     0.953    298.7432  ...     0.000028     0.047682   
17 -0.680212  5.700000     0.643    292.2986  ...     0.000027     0.045271   
18 -0.711346  4.170000     0.694    313.2962  ...     0.000018     0.043275   
19 -0.513050  2.170000     0.982    315.3066  ...     0.000011     0.043502   
20  1.759703  2.910000     1.000    303.6330  ...     0.000047     0.067885   
21 -0.360724  3.820000     0.987    305.0671  ...     0.000022     0.055302   
22  0.107373  4.390000     0.962    320.1508  ...     0.000020     0.042057   
23  0.216207  2.110000     0.980   1026.7177  ...     0.000027     0.052231   
24 -0.050591  1.329797     0.911    720.4535  ...     0.000026     0.039142   
25  0.108558  1.579446     0.815    387.0566  ...     0.000033     0.046562   
26 -0.048745  1.598327     0.748    709.8794  ...     0.000031     0.042240   
27 -0.433598  2.330000     0.979   1327.5575  ...     0.000027     0.047723   
28  0.317525  2.520000     0.997    663.1016  ...     0.000004     0.040450   
29  0.439062  2.350000     0.975    623.1605  ...     0.000008     0.034861   
30  0.247959  2.720000     0.972    689.2177  ...     0.000007     0.033950   
31  0.275565  2.000000     0.981    649.3574  ...     0.000004     0.038874   
32  0.090519  2.000000     0.981    666.9729  ...     0.000004     0.039629   
33  0.512658  1.950000     0.975    663.0443  ...     0.000008     0.036905   
34  0.399113  1.720000     0.997    668.0360  ...     0.000005     0.042962   
35  0.106590  2.030000     0.980    666.9482  ...     0.000005     0.041478   
36  0.221621  2.860000     0.960    679.2028  ...     0.000008     0.041842   
37  0.116842  3.080000     0.947    627.5836  ...     0.000004     0.040293   
38  0.546500  2.740000     0.996    680.9973  ...     0.000004     0.041162   
39  0.063749  2.830000     0.977    659.0861  ...     0.000007     0.033553   
40 -0.530338  2.390000     0.982    646.1521  ...     0.000005     0.042335   
41  0.603509  2.910000     0.925    626.0582  ...     0.000008     0.047307   
42  0.587013  1.840000     0.983    661.4969  ...     0.000005     0.043223   
43  0.120940  1.450000     0.973    654.1683  ...     0.000006     0.044229   
44 -0.161145  1.960000     0.981    658.3602  ...     0.000004     0.041327   
45  0.748196  2.350000     0.978    651.6599  ...     0.000006     0.037687   
46  0.507655  2.730000     0.987    659.1000  ...     0.000004     0.039719   
47  0.108893  5.760000     0.439    644.4781  ...     0.000012     0.040731   
48  0.468901  2.050000     0.977    660.7385  ...     0.000010     0.033938   
49 -0.597373  2.480000     0.983    660.6007  ...     0.000004     0.041754   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        286 -0.077379  0.000027 -0.000021  26.250500   0.759  0.334172   
1        289  0.106847  0.000038 -0.000030  26.092000   0.760  0.335918   
2        286  0.109401  0.000058 -0.000046  26.372000   0.773  0.337336   
3        288  0.107910  0.000027 -0.000021  26.223500   0.773  0.334285   
4        289  0.097415  0.000026 -0.000021  26.200000   0.785  0.335741   
5        287 -0.064608  0.000026 -0.000021  26.239000   0.760  0.336683   
6        454 -0.108594  0.000039 -0.000028  26.169500   0.637  0.304632   
7        436 -0.091781  0.000018 -0.000013  26.296501   0.664  0.327459   
8        428 -0.056206  0.000019 -0.000014  26.250500   0.637  0.326460   
9        383 -0.062514  0.000036 -0.000024  26.301000   0.575  0.304758   
10       386 -0.073935  0.000048 -0.000032  26.231500   0.581  0.310053   
11       433 -0.077472  0.000022 -0.000016  26.296000   0.650  0.327536   
12       412 -0.086538  0.000036 -0.000026  25.698000   0.617  0.318230   
13       432 -0.079815  0.000020 -0.000015  26.284500   0.664  0.327646   
14       374 -0.071523  0.000042 -0.000028  26.250000   0.569  0.303035   
15       432  0.120548  0.000027 -0.000020  26.423000   0.684  0.328423   
16       384 -0.065123  0.000050 -0.000034  26.148000   0.584  0.310258   
17       372 -0.060230  0.000050 -0.000033  26.195000   0.563  0.303682   
18       412 -0.075359  0.000031 -0.000022  26.221000   0.608  0.318494   
19       438 -0.101043  0.000017 -0.000012  26.301000   0.664  0.328282   
20       356  0.133933  0.000073 -0.000054  25.526000   0.660  0.323594   
21       402 -0.125610  0.000039 -0.000027  26.168000   0.597  0.312423   
22       401 -0.066460  0.000032 -0.000023  26.227000   0.656  0.318945   
23       294 -0.114471  0.000039 -0.000030  26.244000   0.708  0.332695   
24       265 -0.056303  0.000043 -0.000031  26.133000   0.641  0.324009   
25       263 -0.078868  0.000056 -0.000039  26.171000   0.628  0.321087   
26       263 -0.061395  0.000052 -0.000037  26.169000   0.646  0.320490   
27       252 -0.097565  0.000043 -0.000031  26.157000   0.682  0.334899   
28       745  0.112846  0.000007 -0.000005  26.339000   0.554  0.299162   
29       733 -0.048792  0.000016 -0.000010  26.242000   0.537  0.294437   
30       743 -0.056733  0.000013 -0.000009  26.192000   0.544  0.296526   
31       748  0.106576  0.000007 -0.000005  26.344000   0.555  0.299009   
32       745  0.108161  0.000008 -0.000005  26.182000   0.555  0.298006   
33       742 -0.060784  0.000016 -0.000010  26.024000   0.548  0.298997   
34       741  0.114233  0.000010 -0.000007  26.271000   0.554  0.298414   
35       741  0.112676  0.000009 -0.000006  26.308000   0.554  0.298764   
36       736 -0.088573  0.000016 -0.000011  26.200000   0.551  0.297628   
37       753  0.109050  0.000008 -0.000005  26.369000   0.557  0.301087   
38       744  0.115563  0.000008 -0.000005  26.375000   0.554  0.298367   
39       737 -0.053387  0.000014 -0.000009  26.235000   0.543  0.295257   
40       747  0.115209  0.000009 -0.000006  26.389000   0.555  0.299161   
41       751  0.119026  0.000014 -0.000009  26.368000   0.556  0.300075   
42       746  0.115435  0.000010 -0.000007  26.390000   0.554  0.299355   
43       741  0.117315  0.000011 -0.000007  26.330000   0.556  0.298840   
44       751  0.115004  0.000008 -0.000005  26.289000   0.554  0.299880   
45       746 -0.084091  0.000012 -0.000008  26.207000   0.554  0.299305   
46       740  0.107057  0.000008 -0.000005  26.368000   0.556  0.301637   
47       687 -0.054364  0.000026 -0.000016  26.248000   0.528  0.281589   
48       670 -0.004870  0.000022 -0.000014  26.270500   0.516  0.277781   
49       747  0.116141  0.000008 -0.000005  26.386000   0.552  0.298465   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.491322040557861,2025-07-25T10:38:17,0.04285714285714286,0.12,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,3,"-- Retrieve at most 50 ZTF objects classified as supernovae (SN) by the stamp_classifier-- with a probability greater than 0.7, returning all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN'      AND classifier_name = 'stamp_classifier'      AND probability > 0.7      AND ranking = 1) filtered_probabilitiesON dq.oid = filtered_probabilities.oidLIMIT 50","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.29758334159851,2025-07-23T18:51:31,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF24abykwta  2941476652115015009    2  1642.2773  2555.3320  1.351525   
1   ZTF24abykwta  2933510462115015003    2  1648.7343  2511.0227  1.104683   
2   ZTF24abykwta  2926559512115015015    1  1657.3022  2493.4084  1.653489   
3   ZTF24abykwta  2924518172115015020    1  1665.1863  2475.7686  1.350789   
4   ZTF24abykwta  2921531602115015007    2  1664.4631  2485.1560  2.098768   
5   ZTF24abykwta  2919549722115015019    1  1665.0850  2476.1829  2.837050   
6   ZTF24abykwta  2914575632115015007    2  1674.4012  2514.0542  1.802665   
7   ZTF24abyhlom  2944512710815015004    2  3022.9148  1790.9911  1.481940   
8   ZTF24abyhlom  2939463070815015001    2  2983.3809  1796.9075  1.060459   
9   ZTF24abyhlom  2937385040815015005    2  2977.1099  1819.7607  0.746158   
10  ZTF24abyhlom  2930451230815015005    1  2995.4915  1797.4576  0.834047   
11  ZTF24abyhlom  2930328410815015001    2  2993.8513  1763.3928  1.454935   
12  ZTF24abyhlom  2927391730815015008    1  3001.9922  1754.8880  1.413765   
13  ZTF24abyhlom  2927345330815015003    2  3010.7727  1738.3806  2.285097   
14  ZTF24abyhlom  2925434230815015011    1  2995.4956  1773.3542  1.471459   
15  ZTF24abyhlom  2920328090815015003    2  3014.1294  1749.8445  1.785200   
16  ZTF24abyhlom  2914390230815015004    1  3009.7913  1769.8326  1.305583   
17  ZTF24abyarea  2920471183315015017    1  2564.9400  2013.4106  2.067686   
18  ZTF24abyarea  2914428473315015007    1  2580.5168  2033.8481  2.623205   
19  ZTF24abyhhhl  2927564980615015010    1  1196.8016  2888.8070  0.969596   
20  ZTF24abyhhhl  2920575700615015009    1  1195.7367  2862.8340  0.947752   
21  ZTF24abyhhhl  2911542560615015005    1  1200.0638  2854.5696  1.393629   
22  ZTF24abyhhhl  2911502520615015012    2  1199.0603  2840.0970  1.367131   
23  ZTF24abykpfq  2920538482815015004    1  2661.1775  1129.7059  1.441208   
24  ZTF24abykybc  2928430860415015008    1  2692.8120  1921.1280  1.015248   
25  ZTF24abykybc  2926452370415015004    1  2680.5354  1991.7396  1.132271   
26  ZTF24abykybc  2920538480415015012    1  2679.3060  1946.6711  1.378216   
27  ZTF24abylbjv  2956534663315015007    2  2283.1453  1373.3959  1.312177   
28  ZTF24abylbjv  2956475193315015003    2  2283.1248  1354.9916  1.259504   
29  ZTF24abylbjv  2951410023315015005    2  2217.0278  1380.9587  0.916714   
30  ZTF24abylbjv  2941494783315015005    2  2239.9658  1436.7744  1.209812   
31  ZTF24abylbjv  2938517213315015004    2  2233.4773  1379.8574  2.236942   
32  ZTF24abylbjv  2934533703315015002    2  2239.3723  1412.3018  1.512739   
33  ZTF24abylbjv  2932446823315015003    2  2234.7632  1396.7317  1.609299   
34  ZTF24abylbjv  2927573803315015004    1  2249.6120  1388.8427  1.453912   
35  ZTF24abylbjv  2927557193315015002    2  2258.6213  1372.0610  4.592536   
36  ZTF24abylbjv  2921533963315015010    2  2261.7980  1360.4856  2.594554   
37  ZTF24abylbjv  2919551133315015005    1  2263.9350  1353.8099  1.133596   
38  ZTF24abylbjv  2919476313315015004    2  2256.6987  1320.4344  2.012909   
39  ZTF24abylbgi  2952498473015015002    2  2669.2207   882.5705  1.363713   
40  ZTF24abylbgi  2941493841915015003    2  2181.3853   982.1737  1.186365   
41  ZTF24abylbgi  2941469893015015003    2  2662.1720   925.6411  1.140011   
42  ZTF24abylbgi  2939488583015015001    2  2657.3890   874.4772  1.791936   
43  ZTF24abylbgi  2938514721915015003    2  2168.8784   920.0517  0.776934   
44  ZTF24abylbgi  2932448241915015002    2  2180.6482   942.6810  1.266464   
45  ZTF24abylbgi  2927550061915015000    2  2199.8145   914.8095  1.123526   
46  ZTF24abylbgi  2921535863015015000    2  2692.7678   859.2151  1.201963   
47  ZTF24abylbgi  2921496821915015002    2  2207.3620   878.0667  0.821670   
48  ZTF24abylbgi  2919552093015015004    1  2695.7760   856.4883  1.461389   
49  ZTF24abylbgi  2919511903015015004    2  2684.1506   844.1876  1.591020   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.201801  1.369571     0.797    525.1679  ...     0.000009     0.046917   
1   0.227518  2.660000     0.932    569.4774  ...     0.000016     0.051472   
2   0.296552  5.140000     0.957    587.0916  ...     0.000024     0.050308   
3   0.311083  2.510000     0.971    604.7314  ...     0.000024     0.048061   
4   0.137953  2.760000     0.982    595.3441  ...     0.000008     0.044997   
5   0.093189  2.970000     0.981    604.3172  ...     0.000022     0.058143   
6  -0.773541  1.780000     0.999    566.4457  ...     0.000009     0.046281   
7   0.234222  2.910000     0.513     49.5853  ...     0.000024     0.051687   
8   0.265017  2.330000     0.838     89.1192  ...     0.000016     0.037727   
9   0.013798  1.428261     0.833     95.3901  ...     0.000019     0.042241   
10 -0.039115  4.680000     0.504     77.0086  ...     0.000062     0.048988   
11 -0.354239  3.390000     0.870     78.6488  ...     0.000017     0.039366   
12 -0.080647  4.640000     0.962     70.5078  ...     0.000029     0.054512   
13 -0.426659  2.560000     0.936     61.7274  ...     0.000013     0.040604   
14 -0.576582  4.690000     0.855     77.0045  ...     0.000037     0.051911   
15 -0.372041  3.780000     0.975     58.3705  ...     0.000013     0.041576   
16 -0.047580  4.530000     0.949     62.7088  ...     0.000055     0.064324   
17 -0.145639  1.453464     0.722    507.5601  ...     0.000028     0.044319   
18 -0.555476  2.430000     0.978    491.9832  ...     0.000021     0.039534   
19 -0.096316  2.790000     0.969    191.6932  ...     0.000009     0.045749   
20  1.056967  3.750000     0.969    217.6659  ...     0.000015     0.043067   
21  0.244217  3.660000     0.858    225.9303  ...     0.000014     0.046374   
22  1.245005  1.820000     0.981    240.4030  ...     0.000005     0.036847   
23  0.013045  3.250000     0.688    411.3225  ...     0.000011     0.041829   
24 -0.250678  4.710000     0.759    379.6879  ...     0.000024     0.048798   
25  0.157197  3.330000     0.805    391.9647  ...     0.000021     0.040762   
26 -0.283117  3.660000     0.946    393.1941  ...     0.000018     0.048137   
27  0.097937  2.600000     0.973    789.3547  ...     0.000005     0.039727   
28 -0.117011  1.750000     0.970    789.3753  ...     0.000005     0.040071   
29  0.510267  3.500000     0.976    855.4721  ...     0.000020     0.055148   
30 -0.247681  2.560000     0.978    832.5343  ...     0.000006     0.041445   
31  0.259599  2.850000     0.986    839.0228  ...     0.000007     0.044916   
32 -0.481790  2.560000     0.981    833.1276  ...     0.000011     0.047974   
33  0.267510  2.420000     0.982    837.7367  ...     0.000012     0.048477   
34  0.409426  2.200000     0.983    822.8880  ...     0.000011     0.033979   
35 -0.052279  2.340000     0.984    813.8786  ...     0.000004     0.038184   
36  0.026553  2.940000     0.983    810.7019  ...     0.000005     0.040320   
37 -0.301463  2.290000     0.980    808.5650  ...     0.000009     0.032757   
38  0.129212  3.160000     0.986    815.8013  ...     0.000007     0.043151   
39 -0.072656  3.670000     0.907    403.2794  ...     0.000005     0.042018   
40 -0.195790  2.480000     0.976    891.1147  ...     0.000007     0.042620   
41  0.375102  4.140000     0.883    410.3280  ...     0.000007     0.045196   
42 -0.193146  2.250000     0.998    415.1112  ...     0.000007     0.042201   
43 -0.043265  2.490000     0.974    903.6217  ...     0.000006     0.040892   
44  0.789213  3.690000     0.997    891.8518  ...     0.000011     0.049251   
45  0.183432  2.210000     0.980    872.6856  ...     0.000006     0.040117   
46 -0.385138  2.280000     0.970    379.7321  ...     0.000006     0.042883   
47  0.322383  2.760000     0.969    865.1380  ...     0.000008     0.044210   
48 -0.116288  2.810000     0.958    376.7240  ...     0.000008     0.038803   
49 -0.247825  1.660000     0.971    388.3494  ...     0.000005     0.041715   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        541  0.117700  0.000015 -0.000011  26.360000   0.617  0.315271   
1        548  0.107486  0.000027 -0.000019  26.374000   0.612  0.316640   
2        508 -0.071212  0.000044 -0.000030  26.186500   0.573  0.303096   
3        479 -0.065467  0.000048 -0.000031  25.594000   0.564  0.291927   
4        551  0.112433  0.000014 -0.000010  26.359000   0.612  0.317532   
5        543 -0.119023  0.000037 -0.000026  26.209000   0.598  0.315072   
6        546  0.114469  0.000015 -0.000011  26.336500   0.607  0.316453   
7        427  0.113680  0.000033 -0.000026  26.341000   0.737  0.314031   
8        433  0.071893  0.000022 -0.000018  26.371000   0.759  0.311290   
9        437  0.085696  0.000025 -0.000020  26.335000   0.773  0.311186   
10       248 -0.077175  0.000123 -0.000081  26.328499   0.593  0.256988   
11       428  0.076375  0.000023 -0.000018  26.334000   0.758  0.313722   
12       389 -0.127073  0.000043 -0.000033  26.295000   0.693  0.300140   
13       429  0.094866  0.000018 -0.000015  26.334000   0.766  0.313093   
14       328 -0.113582  0.000065 -0.000045  26.244000   0.632  0.280798   
15       427  0.099997  0.000018 -0.000015  26.327000   0.759  0.312040   
16       304 -0.159039  0.000103 -0.000070  25.844500   0.604  0.270172   
17       364 -0.077000  0.000041 -0.000032  26.229000   0.752  0.307798   
18       356 -0.076552  0.000031 -0.000024  26.210000   0.741  0.304926   
19       829 -0.105619  0.000020 -0.000012  26.241000   0.513  0.276361   
20       675 -0.071091  0.000039 -0.000022  26.248000   0.476  0.243141   
21       704 -0.093165  0.000037 -0.000021  26.197000   0.485  0.248393   
22       874  0.083694  0.000010 -0.000006  26.213000   0.531  0.296008   
23       551 -0.093189  0.000018 -0.000013  26.246000   0.657  0.306464   
24       389 -0.103899  0.000041 -0.000029  26.196000   0.614  0.298134   
25       373 -0.075500  0.000038 -0.000026  26.228000   0.584  0.287953   
26       408 -0.114709  0.000030 -0.000021  26.283000   0.630  0.302532   
27       578  0.108514  0.000009 -0.000006  26.353000   0.573  0.303159   
28       577  0.110925  0.000009 -0.000006  26.355000   0.576  0.304041   
29       579  0.110600  0.000036 -0.000024  26.285000   0.574  0.303022   
30       572  0.112632  0.000010 -0.000007  26.364000   0.584  0.305065   
31       579  0.119396  0.000013 -0.000009  26.336000   0.572  0.303941   
32       571  0.113755  0.000021 -0.000014  26.359000   0.579  0.305483   
33       580  0.111546  0.000022 -0.000015  26.253000   0.579  0.306535   
34       557 -0.038015  0.000021 -0.000014  26.254000   0.562  0.296652   
35       577  0.107709  0.000007 -0.000005  26.361000   0.572  0.302742   
36       579  0.110630  0.000009 -0.000006  26.347000   0.574  0.303733   
37       572 -0.046993  0.000017 -0.000011  26.232000   0.571  0.303072   
38       575  0.111485  0.000013 -0.000009  26.277000   0.576  0.304554   
39       620  0.112467  0.000009 -0.000006  26.319000   0.641  0.312873   
40       612  0.107946  0.000011 -0.000008  26.325000   0.653  0.315104   
41       621  0.115297  0.000012 -0.000009  26.300000   0.636  0.312834   
42       618  0.107101  0.000011 -0.000008  26.302000   0.635  0.310971   
43       610  0.103793  0.000010 -0.000007  26.317000   0.654  0.317252   
44       614  0.116186  0.000018 -0.000013  26.240000   0.650  0.316137   
45       613  0.102616  0.000009 -0.000007  26.325000   0.655  0.316920   
46       624  0.112223  0.000010 -0.000007  26.309000   0.637  0.312309   
47       619  0.108192  0.000012 -0.000009  26.175000   0.655  0.317273   
48       620 -0.086374  0.000013 -0.000009  26.217000   0.631  0.310925   
49       622  0.112377  0.000008 -0.000006  26.297000   0.633  0.312627   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.6776864528656,2025-07-25T10:38:32,0.026615969581749048,0.14,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,4,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the stamp_classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN'      AND classifier_name = 'stamp_classifier'      AND probability > 0.7      AND ranking = 1) p ON dq.oid = p.oidLIMIT 50","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,21.27705931663513,2025-07-23T18:51:53,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF24abzvypl  2928408026315015006    1   792.3970  1154.4525  1.184594   
1   ZTF24abzvypl  2924533886315015009    2   800.8861  1156.7600  1.609233   
2   ZTF24abzvypl  2924406116315015006    1   790.3662  1163.9537  2.150907   
3   ZTF24abzvypl  2921491626315015008    2   799.8868  1145.0883  0.937342   
4   ZTF24abzvypl  2921461736315015007    1   814.4239  1140.0392  1.374588   
5   ZTF24abzvypl  2919451906315015007    1   809.9008  1128.5431  2.884865   
6   ZTF24abzvrls  2919454282915015017    1  1717.4489  2740.8600  1.737087   
7   ZTF24abzvrls  2920531131615015019    1  1010.0677  2737.2615  0.951948   
8   ZTF24abzvrls  2921465092915015029    1  1723.1788  2749.5847  2.094063   
9   ZTF24abzvrls  2926427991615015012    1   994.9380  2800.1475  0.820101   
10  ZTF24abzvrls  2928415402915015023    1  1696.9471  2764.7970  0.809198   
11  ZTF24abzwfsu  2919468985415015003    2  2486.8152   984.6654  0.755653   
12  ZTF24abzwnym  2979380974715015003    2  2313.5867  3036.7314  1.562700   
13  ZTF24abzwnym  2977516374715015016    2  2339.9720  3065.1040  2.156916   
14  ZTF24abzwnym  2951409074715015005    2  2249.9526  3043.2554  1.067098   
15  ZTF24abzwnym  2938519094715015008    2  2282.9720  3033.0520  0.979758   
16  ZTF24abzwnym  2933518174715015005    2  2282.3008  3045.1526  0.730460   
17  ZTF24abzwnym  2927559544715015012    2  2306.4230  3027.6638  4.624193   
18  ZTF24abzwnym  2921532084715015005    2  2303.3733  3018.0823  1.623622   
19  ZTF24abzwnym  2919496924715015004    2  2291.3290  2993.5105  2.553201   
20  ZTF24abzwoej  2921497296115015007    2   862.8465  1699.1183  0.993603   
21  ZTF24abzwoej  2919551604815015007    1  1837.2452  1595.9393  1.054789   
22  ZTF24abzwoej  2919511436115015011    2   854.2852  1701.7367  1.525643   
23  ZTF24abzwoej  2919495494815015002    2  1835.5999  1569.0435  1.519417   
24  ZTF24abzwpda  2921545823815015004    1  2696.0605  1400.1887  1.012620   
25  ZTF24abzwpda  2921529253815015002    2  2690.7942  1391.9560  0.603112   
26  ZTF24abzwpda  2919509073815015006    2  2682.2056  1374.8578  0.680902   
27  ZTF24abzwpdu  2977529293815015009    2  2665.2970  1206.7478  1.129037   
28  ZTF24abzwpdu  2971520563815015007    2  2641.0860  1216.8315  0.899489   
29  ZTF24abzwpdu  2956475673815015004    2  2657.9363  1139.8710  1.213829   
30  ZTF24abzwpdu  2921550053815015017    1  2641.0012  1150.2612  1.127286   
31  ZTF24abzwpdu  2921534903815015005    2  2634.2000  1143.9994  1.090468   
32  ZTF24abzwpdu  2919510963815015003    2  2626.6355  1123.8683  1.629471   
33  ZTF24abzwpeq  2985482174615015008    2  1235.7626  1516.7086  1.363785   
34  ZTF24abzwpeq  2977525464615015011    2  1255.9812  1537.1118  0.840742   
35  ZTF24abzwpeq  2977524503515015006    2   353.3731  1422.6154  1.867951   
36  ZTF24abzwpeq  2975503764615015008    2  1238.1405  1514.2732  1.267567   
37  ZTF24abzwpeq  2975493583515015009    2   330.0713  1396.8026  0.880612   
38  ZTF24abzwpeq  2971490774615015006    2  1225.3267  1542.5680  1.859271   
39  ZTF24abzwpeq  2956533704615015004    2  1247.3624  1494.4556  2.040923   
40  ZTF24abzwpeq  2951548063515015006    1   311.3401  1408.2631  1.416921   
41  ZTF24abzwpeq  2945490384615015003    2  1197.1587  1493.6376  1.240689   
42  ZTF24abzwpeq  2941495713515015004    2   304.5416  1436.2110  1.168152   
43  ZTF24abzwpeq  2940518634615015006    2  1199.9219  1496.9849  1.475637   
44  ZTF24abzwpeq  2939507833515015003    2   289.5555  1399.2577  1.548760   
45  ZTF24abzwpeq  2937578114615015004    2  1210.1085  1518.0352  1.069932   
46  ZTF24abzwpeq  2927558133515015000    2   325.2422  1373.2473  1.305033   
47  ZTF24abzwpeq  2927556254615015003    2  1218.4952  1490.8646  3.138619   
48  ZTF24abzwpeq  2921533033515015003    2   325.3820  1356.0623  1.169665   
49  ZTF24abzwpeq  2919510023515015004    2   320.6087  1332.2994  1.386336   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.970673  4.960000     0.880    792.3970  ...     0.000019     0.033900   
1   6.223274  2.530000     0.965    800.8861  ...     0.000022     0.051654   
2   5.210329  3.660000     0.172    790.3662  ...     0.000020     0.036367   
3   2.825806  3.420000     0.753    799.8868  ...     0.000028     0.054052   
4   2.475455  4.530000     0.660    814.4239  ...     0.000022     0.037928   
5   1.233700  2.210000     0.981    809.9008  ...     0.000013     0.035487   
6   0.198880  2.240000     0.974    339.6398  ...     0.000021     0.050446   
7   0.293465  3.900000     0.301    343.2385  ...     0.000034     0.045831   
8   0.448981  3.030000     0.960    330.9153  ...     0.000021     0.043534   
9   0.206542  4.240000     0.686    280.3526  ...     0.000042     0.043778   
10  0.470324  2.920000     0.858    315.7030  ...     0.000024     0.038623   
11  1.241379  2.200000     0.780    585.6847  ...     0.000007     0.038461   
12 -0.548126  3.940000     0.975     43.7685  ...     0.000008     0.050219   
13  0.096777  2.060000     0.983     15.3961  ...     0.000005     0.043422   
14 -0.203229  3.470000     0.978     37.2447  ...     0.000008     0.049574   
15  0.279655  2.150000     0.982     47.4480  ...     0.000006     0.046426   
16 -0.559165  3.030000     0.977     35.3475  ...     0.000010     0.051137   
17 -0.963716  2.320000     0.987     52.8363  ...     0.000005     0.042508   
18 -0.167634  2.810000     0.975     62.4178  ...     0.000005     0.044147   
19  0.031659  2.510000     0.979     86.9894  ...     0.000009     0.047055   
20  0.059458  5.100000     0.846    862.8465  ...     0.000010     0.046050   
21 -0.032654  2.760000     0.971   1235.2548  ...     0.000016     0.040631   
22  0.028580  2.910000     0.976    854.2852  ...     0.000005     0.037587   
23 -0.563601  2.730000     0.964   1236.9001  ...     0.000010     0.044675   
24  0.056719  3.300000     0.961    376.4395  ...     0.000011     0.038247   
25  0.003228  1.420502     0.849    381.7059  ...     0.000005     0.042948   
26  0.211059  1.240098     0.856    390.2944  ...     0.000005     0.041522   
27 -0.066643  1.182751     0.731    407.2028  ...     0.000004     0.040397   
28  0.682465  1.550000     0.867    431.4141  ...     0.000005     0.040791   
29  0.539345  2.830000     0.974    414.5637  ...     0.000005     0.043060   
30  0.435372  3.270000     0.912    431.4989  ...     0.000012     0.037175   
31  0.073853  3.350000     0.970    438.3001  ...     0.000006     0.043867   
32  0.037754  2.080000     0.981    445.8645  ...     0.000005     0.040139   
33  0.554145  3.170000     0.827   1235.7626  ...     0.000005     0.040752   
34  0.178219  1.800000     0.977   1255.9812  ...     0.000003     0.035944   
35  0.351772  2.920000     0.946    353.3731  ...     0.000003     0.037167   
36  0.234078  1.740000     0.981   1238.1405  ...     0.000003     0.036781   
37  0.244093  1.740000     0.978    330.0713  ...     0.000004     0.039188   
38  0.429083  1.151638     0.962   1225.3267  ...     0.000004     0.039843   
39 -0.293139  2.790000     0.981   1247.3624  ...     0.000005     0.040662   
40  0.134515  3.460000     0.896    311.3401  ...     0.000012     0.048633   
41 -0.505892  4.780000     0.945   1197.1587  ...     0.000007     0.046829   
42  0.705567  6.190000     0.962    304.5416  ...     0.000007     0.046224   
43  0.402982  1.930000     0.981   1199.9219  ...     0.000004     0.041493   
44  0.594128  2.270000     0.980    289.5555  ...     0.000005     0.042662   
45  0.054791  2.020000     0.977   1210.1085  ...     0.000005     0.039800   
46  0.375900  2.380000     0.981    325.2422  ...     0.000004     0.039066   
47  0.068177  2.540000     0.979   1218.4952  ...     0.000004     0.038446   
48 -0.155299  2.930000     0.995    325.3820  ...     0.000006     0.043251   
49  0.990519  2.800000     0.963    320.6087  ...     0.000006     0.041073   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        349 -0.031330  0.000029 -0.000021  26.139000   0.709  0.322658   
1        378  0.113199  0.000032 -0.000025  25.468000   0.762  0.328012   
2        365 -0.041103  0.000029 -0.000022  25.982000   0.742  0.325875   
3        378  0.111615  0.000039 -0.000031  25.689499   0.766  0.327183   
4        357 -0.045432  0.000032 -0.000024  26.110000   0.711  0.324609   
5        375 -0.067845  0.000019 -0.000015  26.192000   0.756  0.327479   
6        275 -0.114949  0.000029 -0.000023  26.293000   0.789  0.346561   
7        278 -0.069482  0.000046 -0.000036  26.273500   0.792  0.345297   
8        273 -0.087522  0.000029 -0.000023  26.286000   0.773  0.347960   
9        248 -0.032682  0.000063 -0.000047  26.164501   0.688  0.339388   
10       273 -0.056260  0.000034 -0.000026  26.272000   0.765  0.347040   
11       597  0.095960  0.000011 -0.000008  26.312000   0.642  0.306672   
12       632  0.131495  0.000015 -0.000010  26.375000   0.594  0.306310   
13       632  0.121151  0.000009 -0.000006  26.415000   0.594  0.305366   
14       637  0.129239  0.000015 -0.000010  26.309000   0.597  0.305323   
15       635  0.125962  0.000011 -0.000008  26.377000   0.597  0.305040   
16       639  0.127458  0.000018 -0.000013  26.387000   0.597  0.305514   
17       631  0.119977  0.000008 -0.000006  26.387000   0.594  0.304112   
18       630  0.123371  0.000010 -0.000007  26.373000   0.594  0.302617   
19       630  0.115962  0.000016 -0.000011  26.330000   0.599  0.306028   
20       619  0.106846  0.000017 -0.000012  25.981000   0.635  0.309876   
21       568 -0.036224  0.000027 -0.000019  26.075000   0.623  0.312860   
22       622  0.097056  0.000008 -0.000006  26.077000   0.648  0.310142   
23       575  0.103326  0.000017 -0.000012  26.080000   0.644  0.312523   
24       694 -0.043695  0.000022 -0.000014  26.163000   0.548  0.291600   
25       711  0.115448  0.000010 -0.000006  26.327000   0.563  0.301656   
26       710  0.109041  0.000010 -0.000007  26.320000   0.560  0.299977   
27       639  0.109675  0.000008 -0.000005  26.409000   0.577  0.308692   
28       632  0.109174  0.000009 -0.000006  26.395500   0.576  0.308766   
29       640  0.114065  0.000010 -0.000007  26.365000   0.573  0.308348   
30       602 -0.026778  0.000025 -0.000016  25.869000   0.550  0.294830   
31       637  0.115001  0.000011 -0.000007  26.355000   0.573  0.309155   
32       638  0.105772  0.000009 -0.000006  26.330000   0.576  0.309153   
33       876  0.109887  0.000009 -0.000006  26.121000   0.540  0.288211   
34       870  0.103911  0.000005 -0.000003  26.362500   0.551  0.288909   
35       860  0.105597  0.000007 -0.000004  26.392000   0.539  0.286557   
36       868  0.105735  0.000006 -0.000004  26.358000   0.540  0.287458   
37       851  0.110309  0.000008 -0.000005  26.393000   0.540  0.285198   
38       877  0.111424  0.000008 -0.000005  26.344000   0.542  0.286584   
39       878  0.108122  0.000009 -0.000006  26.317000   0.541  0.287489   
40       843 -0.086939  0.000025 -0.000016  26.271000   0.537  0.287092   
41       881  0.116737  0.000015 -0.000009  26.302000   0.536  0.287177   
42       855  0.120915  0.000013 -0.000009  26.356000   0.538  0.286667   
43       882  0.115930  0.000009 -0.000006  26.314000   0.538  0.286373   
44       848  0.116352  0.000010 -0.000007  26.353000   0.539  0.285464   
45       876  0.105210  0.000009 -0.000006  26.334000   0.538  0.286363   
46       845  0.109996  0.000008 -0.000005  26.364000   0.542  0.287650   
47       884  0.108757  0.000007 -0.000005  26.318000   0.538  0.285747   
48       841  0.115374  0.000011 -0.000007  26.332000   0.542  0.286570   
49       844  0.104580  0.000011 -0.000007  26.279000   0.543  0.288167   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,8.978142738342285,2025-07-25T10:38:45,0.03,0.12,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,5,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the 'stamp_classifier' -- with a probability greater than 0.7, and return all columns from the 'dataquality' table.SELECT dq.*FROM dataquality dqINNER JOIN probability p    ON dq.oid = p.oidWHERE p.classifier_name = 'stamp_classifier' -- Use the stamp classifier  AND p.class_name = 'SN'                   -- Classify as supernova ('SN')  AND p.ranking = 1                         -- Only the most likely classification  AND p.probability > 0.7                   -- Probability greater than 0.7LIMIT 50                                   -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.14957046508789,2025-07-23T18:52:15,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF24acahvpq  2921530673815015000    2   257.2121   788.1957  0.943943   
1   ZTF24abpygzx  2921533035415015006    2   531.3270  2468.8342  1.136995   
2   ZTF24acahvqw  2941495714315015004    2  1321.3698   956.6847  1.483317   
3   ZTF24acahvqw  2939507834315015006    2  1306.9210   918.8942  1.049662   
4   ZTF24acahvqw  2933517694315015002    2  1319.0732   905.8326  0.927744   
5   ZTF24acahvqw  2927575214315015004    1  1336.7034   908.3338  1.444791   
6   ZTF24acahvqw  2927558134315015004    2  1344.1172   891.4884  2.220399   
7   ZTF24acahvqw  2925556264315015004    1  1341.6093   901.7023  1.156678   
8   ZTF24acahvqw  2921548634315015002    1  1348.0920   884.7235  1.287775   
9   ZTF24acahvqw  2921533034315015002    2  1340.4396   878.1381  1.191844   
10  ZTF24acahvqx  2951548064115015006    1   139.3226   854.7698  1.694469   
11  ZTF24acahvqx  2941529614115015004    1   141.8179   896.6605  0.935205   
12  ZTF24acahvqx  2941495714115015002    2   129.4689   888.3955  1.105887   
13  ZTF24acahvqx  2939507834115015001    2   115.3339   850.5095  2.145900   
14  ZTF24acahvqx  2937554834115015077    2   131.8274   840.4165  3.104503   
15  ZTF24acahvqx  2927575214115015002    1   145.1532   839.7449  2.561738   
16  ZTF24acahvqx  2927558134115015003    2   152.5273   822.5965  3.875343   
17  ZTF24acahvqx  2925556264115015004    1   149.6832   833.3222  1.276553   
18  ZTF24acahvqx  2921533034115015005    2   148.7274   810.3372  0.938489   
19  ZTF19acfuzwh  1021114875415015007    1   932.5920  1758.3900  1.282230   
20  ZTF19acfuzwh  1033116455415015005    2   948.1916  1766.7324  1.294820   
21  ZTF19acfuzwh  1021094825415015002    2   948.0412  1768.2622  0.886668   
22  ZTF19acfuzwh  2921534435415015012    2   976.8463  1836.4779  1.556008   
23  ZTF19acfuzwh  1028109915415015003    2   929.5530  1747.5984  1.482707   
24  ZTF19acfuzwh  1024116725415015005    1   930.7130  1776.5400  1.111910   
25  ZTF24acahvrz  2921534901315015005    2   412.3408  1316.0600  0.862102   
26  ZTF24abyhmih  2927555313115015008    2   841.0617  2764.2370  1.339574   
27  ZTF24abyhmih  2921535383115015003    2   841.7032  2751.3455  1.319753   
28  ZTF24acahvsh  2940518146015015016    2   662.3929  2093.2170  1.420197   
29  ZTF24acahvsh  2940493226015015013    1   659.8814  2098.2756  1.409430   
30  ZTF24acahvsh  2938497186015015017    2   650.7182  2152.6255  1.610146   
31  ZTF24acahvsh  2938476286015015006    1   643.6679  2143.4730  1.351461   
32  ZTF24acahvsh  2933516756015015011    2   658.7441  2101.7100  1.537242   
33  ZTF24acahvsh  2926558096015015004    1   671.9450  2088.1640  1.623301   
34  ZTF24acahvsh  2921550056015015027    1   689.0526  2081.3699  1.576675   
35  ZTF24acahvsh  2921534906015015019    2   681.7896  2075.6510  2.083279   
36  ZTF24abzwreb  2938496592115015000    2   607.6369   254.7261  1.074868   
37  ZTF24abzwreb  2921536812115015001    2   644.3340   173.0238  1.160308   
38  ZTF18aawgiuu  2927576155515015001    1  1960.6497   146.9709  0.831991   
39  ZTF18aawgiuu  2921547695515015004    1  1970.1590   123.5208  1.253083   
40  ZTF22abojxte  3004259654715015006    1  1390.9030  1424.4879  1.411034   
41  ZTF22abojxte  3000279624715015004    1  1384.4955  1437.1046  1.167640   
42  ZTF22abojxte  2927389694715015016    1  1393.0763  1400.8228  0.924852   
43  ZTF22abojxte  2922360904715015004    1  1400.3153  1400.9653  1.337102   
44  ZTF24acabzjg  2926352841215015003    1  1117.6830  1457.8594  1.025355   
45  ZTF24acabzjg  2922469881215015007    1  1137.9348  1481.8679  1.043761   
46  ZTF24abzvsbq  2941346201415015003    1    93.1843   531.9979  1.190181   
47  ZTF24abzvsbq  2930455031415015006    1    94.7347   545.8783  0.650608   
48  ZTF24abzvsbq  2926352841415015002    1    93.5165   497.1193  1.248323   
49  ZTF24abzvsbq  2922469881415015003    1   115.2125   520.2391  1.922350   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.170771  2.450000     0.951    257.2121  ...     0.000007     0.044628   
1   0.376874  1.477170     0.765    531.3270  ...     0.000004     0.040945   
2  -0.470946  3.240000     0.979    956.6847  ...     0.000010     0.050251   
3   0.082712  2.460000     0.980    918.8942  ...     0.000005     0.042034   
4   0.335950  3.530000     0.978    905.8326  ...     0.000011     0.051049   
5  -0.493369  2.310000     0.983    908.3338  ...     0.000010     0.036294   
6  -0.214558  3.140000     0.968    891.4884  ...     0.000004     0.039765   
7  -0.576709  4.890000     0.914    901.7023  ...     0.000016     0.040396   
8  -0.675588  3.860000     0.925    884.7235  ...     0.000010     0.035446   
9   0.377792  2.900000     0.668    878.1381  ...     0.000006     0.043454   
10  0.033153  3.420000     0.988    139.3226  ...     0.000007     0.034790   
11 -0.429619  5.510000     0.797    141.8179  ...     0.000016     0.037412   
12  0.543965  3.740000     0.973    129.4689  ...     0.000009     0.047255   
13  0.181384  2.940000     0.980    115.3339  ...     0.000005     0.042669   
14 -0.018244  2.000000     0.983    131.8274  ...     0.000006     0.044402   
15 -0.075097  3.570000     0.982    145.1532  ...     0.000009     0.032415   
16 -0.173364  2.630000     0.999    152.5273  ...     0.000004     0.039436   
17  0.296739  5.620000     0.659    149.6832  ...     0.000015     0.039680   
18 -0.102869  3.510000     0.951    148.7274  ...     0.000005     0.042992   
19  1.064720  3.050000     0.939    932.5920  ...     0.000012     0.038926   
20 -0.362838  3.920000     0.676    948.1916  ...     0.000019     0.054060   
21 -0.361669  1.790000     0.985    948.0412  ...     0.000005     0.040771   
22 -0.148448  2.350000     0.877    976.8463  ...     0.000004     0.040806   
23  0.674622  3.080000     0.980    929.5530  ...     0.000008     0.045161   
24  0.480990  4.700000     0.940    930.7130  ...     0.000010     0.034456   
25 -0.411724  1.471816     0.619    412.3408  ...     0.000011     0.047571   
26  0.600343  1.860000     0.988    316.2629  ...     0.000004     0.038689   
27  0.147842  3.230000     0.939    329.1546  ...     0.000005     0.041999   
28 -0.500033  2.130000     0.997    662.3929  ...     0.000006     0.040158   
29 -0.065521  1.810000     0.967    659.8814  ...     0.000012     0.036158   
30 -0.046974  3.070000     0.997    650.7182  ...     0.000007     0.044110   
31 -0.070872  3.660000     0.968    643.6679  ...     0.000016     0.038273   
32 -0.458188  3.070000     0.979    658.7441  ...     0.000013     0.050357   
33 -0.207545  4.470000     0.966    671.9450  ...     0.000021     0.041032   
34 -0.465021  2.780000     0.979    689.0526  ...     0.000012     0.037748   
35  0.170755  2.480000     0.980    681.7896  ...     0.000005     0.038935   
36  0.526380  1.234994     0.889    254.7261  ...     0.000006     0.039603   
37 -0.415583  2.790000     0.963    173.0238  ...     0.000005     0.040047   
38 -0.086402  1.410463     0.965    146.9709  ...     0.000019     0.039611   
39  0.564406  1.585433     0.794    123.5208  ...     0.000014     0.037958   
40 -0.315493  1.275249     0.950   1390.9030  ...     0.000014     0.036221   
41  1.314646  1.158473     0.735   1384.4955  ...     0.000081     0.071074   
42  0.139056  1.291244     0.707   1393.0763  ...     0.000017     0.043507   
43 -0.184005  1.375323     0.824   1400.3153  ...     0.000019     0.047323   
44 -0.118402  4.450000     0.675   1117.6830  ...     0.000063     0.054022   
45  0.170925  2.710000     0.958   1137.9348  ...     0.000027     0.037020   
46 -0.317275  2.370000     0.747     93.1843  ...     0.000051     0.046672   
47  0.094727  5.300000     0.583     94.7347  ...     0.000051     0.047316   
48  0.002835  3.900000     0.681     93.5165  ...     0.000060     0.054185   
49 -0.257279  2.200000     0.966    115.2125  ...     0.000039     0.044926   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0      515.0  0.119818  0.000011 -0.000008  26.376000   0.612  0.316129   
1      843.0  0.108064  0.000008 -0.000005  26.279000   0.577  0.301231   
2      760.0  0.122181  0.000018 -0.000012  26.443000   0.571  0.297854   
3      758.0  0.113603  0.000009 -0.000006  26.432000   0.571  0.297402   
4      751.0  0.122762  0.000019 -0.000013  26.432000   0.571  0.297042   
5      715.0 -0.055277  0.000020 -0.000013  26.316000   0.545  0.276304   
6      755.0  0.111095  0.000008 -0.000005  26.442000   0.571  0.296340   
7      604.0 -0.056556  0.000040 -0.000024  26.094000   0.505  0.244105   
8      712.0 -0.037014  0.000021 -0.000013  26.075000   0.546  0.279653   
9      758.0  0.111686  0.000012 -0.000008  26.416500   0.572  0.298054   
10     733.0 -0.060997  0.000013 -0.000009  26.342000   0.563  0.299820   
11     551.0 -0.023615  0.000040 -0.000023  26.343000   0.492  0.248650   
12     721.0  0.116504  0.000016 -0.000011  26.442000   0.563  0.297486   
13     723.0  0.116273  0.000009 -0.000006  26.440000   0.565  0.300424   
14     716.0  0.116020  0.000012 -0.000008  26.349000   0.573  0.299756   
15     694.0 -0.020808  0.000018 -0.000012  26.334000   0.536  0.283917   
16     729.0  0.110750  0.000007 -0.000005  26.446000   0.565  0.299268   
17     599.0 -0.044590  0.000036 -0.000021  26.125000   0.500  0.260048   
18     731.0  0.117626  0.000009 -0.000006  26.427000   0.565  0.299376   
19       NaN -0.022441  0.000026       NaN        NaN     NaN       NaN   
20     551.0  0.110962  0.000038 -0.000024  26.080000   0.528  0.297300   
21     736.0  0.103164  0.000010 -0.000007  26.111500   0.564  0.304819   
22     744.0  0.107398  0.000008 -0.000006  26.285000   0.575  0.306551   
23     740.0  0.105057  0.000015 -0.000010  26.117000   0.564  0.304523   
24       NaN -0.026092  0.000020       NaN        NaN     NaN       NaN   
25     462.0  0.114285  0.000018 -0.000013  26.220500   0.599  0.324972   
26     721.0  0.104762  0.000008 -0.000005  26.315000   0.561  0.300982   
27     722.0  0.109740  0.000010 -0.000007  26.285000   0.562  0.302264   
28     655.0  0.097179  0.000010 -0.000007  26.180000   0.602  0.316527   
29     577.0 -0.029274  0.000025 -0.000016  26.127000   0.539  0.293758   
30     650.0  0.106139  0.000013 -0.000009  26.152000   0.607  0.316574   
31     514.0 -0.018056  0.000034 -0.000021  26.086000   0.515  0.287638   
32     640.0  0.103377  0.000023 -0.000016  26.176000   0.604  0.315873   
33     466.0 -0.017541  0.000049 -0.000029  26.089000   0.494  0.270313   
34     612.0 -0.039948  0.000023 -0.000015  25.808000   0.562  0.301888   
35     657.0  0.096838  0.000009 -0.000006  26.170000   0.604  0.316760   
36     748.0  0.096313  0.000010 -0.000007  26.321000   0.653  0.306109   
37     751.0  0.102736  0.000009 -0.000006  26.331000   0.656  0.307459   
38     575.0 -0.017527  0.000042 -0.000026  26.283000   0.530  0.254326   
39     633.0 -0.025886  0.000029 -0.000019  26.152000   0.556  0.276431   
40     384.0 -0.067826  0.000020 -0.000015  26.293000   0.739  0.327514   
41     373.0 -0.055667  0.000119 -0.000090  26.058000   0.716  0.326393   
42     380.0 -0.092258  0.000023 -0.000018  26.298500   0.762  0.329663   
43     380.0 -0.102783  0.000027 -0.000021  26.232500   0.751  0.327407   
44     263.0 -0.066411  0.000094 -0.000071  26.280000   0.648  0.317045   
45     288.0 -0.047932  0.000037 -0.000029  26.322500   0.726  0.326877   
46     222.0 -0.061389  0.000071 -0.000055  26.169500   0.757  0.334504   
47     192.0 -0.071153  0.000079 -0.000058  26.168999   0.637  0.332436   
48     200.0 -0.090218  0.000089 -0.000067  26.094500   0.678  0.336216   
49     253.0 -0.070029  0.000050 -0.000041  26.157000   0.889  0.339867   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19      NaN  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24      NaN  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,8.669252872467041,2025-07-25T10:38:58,0.0061162079510703364,0.04,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,6,"-- Retrieve at most 50 ZTF objects classified as supernovae (SN) by the stamp_classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE classifier_name = 'stamp_classifier' -- Use the stamp classifier      AND class_name = 'SN' -- Classify as supernovae      AND probability > 0.7 -- Probability greater than 0.7      AND ranking = 1 -- Only the most likely classification) p ON dq.oid = p.oidLIMIT 50 -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.459919214248657,2025-07-23T18:52:38,"[             oid               candid  fid       xpos       ypos     chipsf  \
0   ZTF25aabosqc  2932114325515015009    2  2328.0132  2100.0227   1.106803   
1   ZTF25aabqdqc  2934407220115015133    1   422.1293  2035.2264   1.080094   
2   ZTF25aabqdqc  2934264910115015004    2   410.8267  2094.2970   1.128931   
3   ZTF25aabqdqc  2932358050115015012    2   448.8592  2073.1763   1.071041   
4   ZTF25aabqdqc  2978231680115015021    2   448.3474  2011.2421   1.580013   
5   ZTF25aabqdqc  2974252890115015009    1   435.3657  1985.0436   1.445427   
6   ZTF25aabqdqc  2974213490115015012    2   446.2367  1980.4297   2.278976   
7   ZTF25aabqdqc  2960414400115015008    1   428.1822  2021.7498   1.226333   
8   ZTF25aabqdqc  2960370630115015070    2   436.7151  2013.5358   1.120752   
9   ZTF25aabqdqc  2945364720115015015    1   434.2954  2005.3142   8.150932   
10  ZTF25aabqdqc  2943269740115015065    2   421.2183  2008.3782   0.971002   
11  ZTF25aabqdqc  2940250390115015012    1   418.1079  2007.7118  12.769098   
12  ZTF25aabqdqc  2938232430115015005    1   423.0526  2030.3624   2.459906   
13  ZTF25aabqdqc  2936381160115015009    2   426.2772  2034.9757   1.265377   
14  ZTF25aabqdqc  2936240600115015007    1   426.1935  2051.0920   0.989023   
15  ZTF25aabqiec  2940425101015015008    2  2389.6538  1920.9340   0.912938   
16  ZTF25aabqiec  2932368361015015005    2  2382.0474  1967.8368   0.776369   
17  ZTF24abuuyen  2951309993915015000    2  3033.8164   448.1944   1.133539   
18  ZTF24abuuyen  2941320063915015002    2  3044.2842   444.2730   1.773410   
19  ZTF24abuuyen  2941282773915015004    1  3041.1260   425.5176   1.380619   
20  ZTF24abuuyen  2937384503915015000    2  3024.0380   459.3160   1.001825   
21  ZTF24abuuyen  2932422483915015000    2  3026.8293   475.6994   1.444944   
22  ZTF24abuuyen  2930326973915015000    2  3043.4001   416.2332   1.132044   
23  ZTF24abuuyen  2927327463915015001    2  3052.9485   375.1041   1.198017   
24  ZTF24abuuyen  2925352853915015001    2  3058.5460   394.0048   1.845825   
25  ZTF24abuuyen  2925262903915015001    1  3059.2627   353.3363   1.314814   
26  ZTF24abuuyen  2914387393915015002    1  3055.2568   415.4897   7.907905   
27  ZTF24abuuyen  2905529973915015002    2  3042.1067   422.4313   3.219555   
28  ZTF24abuuyen  2899535113915015002    2  3043.9420   410.6555   4.800725   
29  ZTF24abuuyen  2899320763915015000    1  3050.3252   360.7395   2.146718   
30  ZTF24abuuyen  2897510423915015001    1  3057.8494   396.0237   1.860378   
31  ZTF24abuuyen  2895469663915015003    2  3055.3728   391.7713   4.318788   
32  ZTF24abuuyen  2895436013915015001    1  3056.3030   381.1264   2.930819   
33  ZTF24abuuyen  2890475603915015002    2  3044.8843   419.1713   0.984828   
34  ZTF25aabreco  2932443053815015000    2  2649.7327   284.0428   1.023893   
35  ZTF25aabskal  2945400533415015000    1   180.6443   447.5046  12.798498   
36  ZTF25aabskal  2933460493415015001    1   170.8714   465.4589   3.299876   
37  ZTF25aabsnun  2945451845815015005    1  2637.3113   680.2403   1.819489   
38  ZTF25aabsnun  2945491445815015003    2  2648.8650   675.3648   1.520717   
39  ZTF25aabsnun  2940495655815015003    1  2645.1394   684.3217   1.053921   
40  ZTF25aabsnun  2938478685815015002    1  2625.2666   738.7711   1.282258   
41  ZTF25aabsnun  2936515745815015002    2  2630.6282   683.3399   1.231757   
42  ZTF25aabsnun  2933509985815015003    2  2639.8088   692.0534   1.134083   
43  ZTF25aabsnwc  3006339372215015016    2  2748.0388  1833.5693   2.848111   
44  ZTF25aabsnwc  3004385342215015004    2  2735.2456  1890.2151   1.182742   
45  ZTF25aabsnwc  3001501552215015007    2  2721.6682  1940.7916   0.872539   
46  ZTF25aabsnwc  2979389122215015012    2  2736.4019  1902.0483   1.391409   
47  ZTF25aabsnwc  2977477932215015016    1  2743.3826  1917.7725   1.436784   
48  ZTF25aabsnwc  2977409202215015006    2  2716.4580  1908.3210   7.033377   
49  ZTF25aabsnwc  2971403352215015002    1  2709.2632  1854.1477   1.048603   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.463623  1.370000     0.974    744.4868  ...     0.000003     0.036883   
1  -0.215335  2.360000     0.966    422.1293  ...     0.000015     0.040992   
2   0.651416  3.250000     0.982    410.8267  ...     0.000006     0.044037   
3   0.217441  3.110000     0.977    448.8592  ...     0.000002     0.028903   
4   0.336265  2.230000     0.982    448.3474  ...     0.000001     0.026576   
5   0.200215  2.470000     0.973    435.3657  ...     0.000002     0.024428   
6   0.125111  2.480000     0.984    446.2367  ...     0.000001     0.026723   
7  -1.180299  4.400000     0.974    428.1822  ...     0.000008     0.039888   
8  -0.920560  2.920000     0.978    436.7151  ...     0.000012     0.055536   
9   0.144043  3.200000     0.983    434.2954  ...     0.000003     0.031087   
10 -2.859020  3.450000     0.982    421.2183  ...     0.000007     0.045563   
11  0.200731  2.280000     0.983    418.1079  ...     0.000002     0.025422   
12 -0.500230  2.480000     0.984    423.0526  ...     0.000005     0.038248   
13 -0.060537  4.840000     0.983    426.2772  ...     0.000007     0.046807   
14 -1.649023  6.050000     0.969    426.1935  ...     0.000028     0.046469   
15 -0.337033  1.377617     0.904    682.8462  ...     0.000014     0.034892   
16 -0.479497  3.900000     0.883    690.4526  ...     0.000022     0.041944   
17 -0.499986  2.680000     0.926     38.6836  ...     0.000014     0.050318   
18 -0.358605  2.030000     0.980     28.2159  ...     0.000011     0.045710   
19 -0.221008  2.530000     0.641     31.3741  ...     0.000022     0.048496   
20 -0.133284  2.200000     0.978     48.4620  ...     0.000017     0.051196   
21  0.479001  2.750000     0.980     45.6707  ...     0.000015     0.050221   
22 -0.642217  2.310000     0.982     29.0998  ...     0.000014     0.049826   
23 -0.191823  1.970000     0.983     19.5515  ...     0.000012     0.047243   
24 -0.522243  3.010000     0.982     13.9540  ...     0.000014     0.047874   
25 -0.253294  3.150000     0.977     13.2373  ...     0.000023     0.042743   
26 -0.386752  2.100000     0.987     17.2432  ...     0.000020     0.044099   
27  0.576606  2.000000     0.983     30.3934  ...     0.000017     0.049343   
28 -0.096332  2.090000     0.983     28.5582  ...     0.000011     0.046793   
29 -0.259649  4.800000     0.664     22.1749  ...     0.000039     0.045204   
30 -0.186263  2.150000     0.983     14.6506  ...     0.000019     0.041608   
31 -0.232323  2.220000     0.988     17.1273  ...     0.000011     0.045718   
32 -0.068991  2.100000     0.983     16.1969  ...     0.000020     0.051080   
33 -0.269999  2.030000     0.912     27.6158  ...     0.000011     0.044375   
34 -0.720526  2.530000     0.985    284.0428  ...     0.000010     0.049987   
35 -0.051361  4.260000     0.970    180.6443  ...     0.000029     0.041397   
36 -0.438297  3.530000     0.983    170.8714  ...     0.000044     0.042456   
37  0.133262  4.170000     0.973    435.1886  ...     0.000022     0.036561   
38 -0.564144  3.250000     0.982    423.6350  ...     0.000013     0.046989   
39  0.322970  2.590000     0.982    427.3605  ...     0.000023     0.036469   
40  0.498617  3.150000     0.983    447.2333  ...     0.000029     0.039694   
41  0.116684  3.980000     0.977    441.8719  ...     0.000031     0.057198   
42 -0.436758  3.920000     0.960    432.6912  ...     0.000030     0.057493   
43  0.417606  1.750000     0.978    324.4611  ...     0.000007     0.037807   
44  0.375668  2.430000     0.993    337.2545  ...     0.000006     0.034128   
45  0.948719  2.540000     0.975    350.8317  ...     0.000006     0.036526   
46 -0.625721  4.300000     0.978    336.0981  ...     0.000021     0.055579   
47  0.337575  5.960000     0.728    329.1175  ...     0.000014     0.053162   
48  0.599173  2.150000     1.000    356.0421  ...     0.000005     0.032506   
49  0.644209  2.930000     0.968    363.2367  ...     0.000016     0.049557   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0       1699  0.089159  0.000005 -0.000003  26.2970   0.589  0.288623     30.0  
1       1039 -0.044865  0.000053 -0.000026  26.1660   0.455  0.171521     30.0  
2       1869  0.087443  0.000015 -0.000009  26.2790   0.501  0.231468     30.0  
3       1994  0.074777  0.000005 -0.000003  26.3050   0.500  0.225297     30.0  
4       1984  0.081496  0.000004 -0.000002  26.2650   0.499  0.225771     30.0  
5       1992 -0.053872  0.000004 -0.000002  26.2750   0.498  0.227169     30.0  
6       1990  0.078075  0.000004 -0.000002  26.2770   0.499  0.225293     30.0  
7       1504 -0.025327  0.000026 -0.000013  26.1630   0.471  0.201000     30.0  
8       1430  0.089883  0.000032 -0.000018  25.5920   0.492  0.238028     30.0  
9       1986 -0.051738  0.000008 -0.000005  26.2990   0.498  0.227588     30.0  
10      1637  0.075301  0.000019 -0.000011  25.2090   0.498  0.236964     30.0  
11      1996 -0.051468  0.000005 -0.000003  26.2540   0.497  0.225619     30.0  
12      1908 -0.055804  0.000014 -0.000008  26.2250   0.490  0.219729     30.0  
13      1554  0.092314  0.000019 -0.000011  26.2870   0.500  0.240805     30.0  
14       784 -0.037929  0.000105 -0.000051  26.2540   0.454  0.160769     30.0  
15       352  0.081142  0.000021 -0.000016  26.2770   0.714  0.294042     30.0  
16       351  0.093484  0.000032 -0.000025  26.2670   0.722  0.295804     30.0  
17       421  0.129615  0.000019 -0.000015  26.3870   0.787  0.318690     30.0  
18       420  0.119605  0.000015 -0.000012  26.4090   0.800  0.317865     30.0  
19       418 -0.103522  0.000030 -0.000024  26.2260   0.789  0.318667     30.0  
20       423  0.127125  0.000023 -0.000018  26.3990   0.790  0.318654     30.0  
21       420  0.127731  0.000020 -0.000016  26.4050   0.789  0.318108     30.0  
22       416  0.129019  0.000019 -0.000015  26.3960   0.788  0.318722     30.0  
23       415  0.122984  0.000017 -0.000013  26.3770   0.803  0.318209     30.0  
24       414  0.120868  0.000019 -0.000015  26.3990   0.808  0.320111     30.0  
25       395 -0.073249  0.000033 -0.000026  26.1940   0.767  0.316272     30.0  
26       407 -0.088657  0.000028 -0.000022  26.0480   0.775  0.317854     30.0  
27       420  0.120477  0.000023 -0.000018  26.3590   0.794  0.318310     30.0  
28       416  0.123312  0.000015 -0.000012  26.3410   0.789  0.319197     30.0  
29       321 -0.037711  0.000063 -0.000045  26.1820   0.653  0.308258     30.0  
30       412 -0.080318  0.000025 -0.000020  26.2670   0.794  0.320495     30.0  
31       414  0.119742  0.000015 -0.000012  26.3940   0.803  0.319944     30.0  
32       416 -0.121152  0.000026 -0.000021  26.2240   0.803  0.319006     30.0  
33       418  0.114738  0.000015 -0.000012  26.3785   0.789  0.318213     30.0  
34       599  0.117712  0.000018 -0.000012  26.2980   0.564  0.319965     30.0  
35       283 -0.046726  0.000049 -0.000034  26.3420   0.587  0.326419     30.0  
36       209 -0.038507  0.000088 -0.000056  26.3440   0.548  0.301885     30.0  
37       349 -0.024405  0.000036 -0.000026  26.3450   0.620  0.316847     30.0  
38       373  0.115234  0.000020 -0.000015  26.3520   0.679  0.326615     30.0  
39       322 -0.028860  0.000043 -0.000029  26.3435   0.598  0.301339     30.0  
40       298 -0.033302  0.000056 -0.000037  26.3220   0.564  0.298412     30.0  
41       360  0.118149  0.000047 -0.000035  26.3515   0.681  0.325510     30.0  
42       368  0.115740  0.000047 -0.000034  26.3535   0.673  0.329135     30.0  
43       932  0.092075  0.000011 -0.000008  26.3590   0.650  0.275798     30.0  
44       921  0.083383  0.000009 -0.000007  26.3880   0.643  0.272934     30.0  
45       934  0.094900  0.000010 -0.000007  26.3095   0.641  0.272679     30.0  
46       922  0.101904  0.000034 -0.000025  26.3850   0.642  0.272308     30.0  
47       892 -0.143865  0.000023 -0.000017  26.2110   0.634  0.261255     30.0  
48       925  0.085354  0.000008 -0.000006  26.3950   0.642  0.272284     30.0  
49       823 -0.128763  0.000029 -0.000020  26.1790   0.611  0.245921     30.0  

[50 rows x 32 columns]]",,9.530386447906494,2025-07-25T10:39:13,0.003875968992248062,0.02,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,7,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier-- with a probability greater than 0.7, and return all columns from the 'dataquality' table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN' -- Filter for supernovae classification      AND classifier_name = 'stamp_classifier' -- Use the stamp classifier      AND probability > 0.7 -- Probability threshold      AND ranking = 1 -- Only the most likely classification) p ON dq.oid = p.oidLIMIT 50 -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.43987345695496,2025-07-23T18:53:02,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF25aackkec  2941280406215015003    1  1735.0732   391.0657  0.897828   
1   ZTF25aacqgbm  2951309994015015032    2  1727.8650  1916.0860  1.340344   
2   ZTF25aacqgbm  2941320064015015008    2  1737.8604  1912.7940  0.967802   
3   ZTF25aacqgbm  2941282774015015008    1  1734.1674  1895.0442  1.021441   
4   ZTF25aacibgj  2941517486115015003    1   920.1899  1371.2975  0.752744   
5   ZTF25aacmhpv  2941528206315015005    1   453.5864  2261.7437  0.895309   
6   ZTF25aacrydo  2980394740715015000    1  2905.8590   585.9070  1.208759   
7   ZTF25aacrydo  2980342490715015002    2  2917.4590   568.0152  1.210129   
8   ZTF25aacrydo  2976446220715015000    1  2912.7560   608.3292  1.686575   
9   ZTF25aacrydo  2944411870715015002    1  2918.8962   597.8485  2.044669   
10  ZTF18aajhlcs  2944408104815015006    1   367.2450  2589.3928  1.143091   
11  ZTF18aajhlcs  2941344796015015012    1  3055.1313  2678.3867  1.722517   
12  ZTF18aajhlcs   675524914815010739    2   292.7480  2512.6335  6.045546   
13  ZTF18aajhlcs   672495404815010007    1   306.1370  2497.9800  1.179280   
14  ZTF25aabyzbj  2945109290815015010    2  1161.2485  2832.9617  0.840050   
15  ZTF25aacljwu  2945377463915015008    1  2059.8200  3043.3728  1.336367   
16  ZTF25aacljwu  2940380793915015015    1  2063.8074  3054.3528  1.311550   
17  ZTF25aacasop  2945380782815015015    1   302.6477  2304.9944  2.877207   
18  ZTF25aadacaj  2945400534915015006    1  2388.6160  1470.2107  1.127931   
19  ZTF25aaddjzf  2980412093115015000    1  2972.4756   663.8484  3.071095   
20  ZTF25aaddjzf  2978387873115015003    1  2980.4000   660.8990  5.155407   
21  ZTF25aaddjzf  2974433683115015003    1  2974.1646   684.0388  1.657406   
22  ZTF25aaddjzf  2972401373115015014    1  2951.4414   671.2837  8.002606   
23  ZTF25aaddjzf  2945409053115015003    1  2952.6953   666.2817  2.407717   
24  ZTF25aacpwyg  2945416092915015005    1   392.5107   880.9072  1.511746   
25  ZTF25aaddwqr  2945489270015015005    2  1227.7654  2417.2075  0.892869   
26  ZTF25aacrwsr  2945491925515015005    2  2075.7983  1276.2786  0.844758   
27  ZTF25aaddzdm  2945505704315015003    2  1614.2902   774.7277  0.824001   
28  ZTF25aaddzex  3010470774615015003    2  2622.8452   203.8655  0.951933   
29  ZTF25aaddzex  3005465424615015001    2  2659.2320   154.5800  2.148067   
30  ZTF25aaddzex  2985467784615015001    2  2626.9492   166.3397  0.820369   
31  ZTF25aaddzex  2977531453415015002    2   873.2061   400.6505  1.202503   
32  ZTF25aaddzex  2975510633415015002    2   865.4962   370.8018  1.949080   
33  ZTF25aaddzex  2975488714615015000    2  2624.4495   155.6980  1.377494   
34  ZTF25aaddzex  2971516304615015002    2  2628.7627   195.4245  1.364065   
35  ZTF25aaddzex  2971496493415015000    2   861.7762   395.2935  1.548294   
36  ZTF25aaddzex  2956529813415015001    2   880.2248   336.1575  0.730804   
37  ZTF25aaddzex  2956572964615015001    2  2652.0977   148.4660  1.367112   
38  ZTF25aaddzex  2945506663415015002    2   845.3353   332.3750  0.829519   
39  ZTF25aaddzfw  2956529816015015003    2   919.9245   536.9274  1.127570   
40  ZTF25aaddzfw  2952506870715015004    2  2705.9866  2802.9200  1.023213   
41  ZTF25aaddzfw  2945506666015015002    2   881.0684   540.3229  1.263619   
42  ZTF25aaddzhg  2945506661115015004    2  1762.6027  2460.8003  1.443593   
43  ZTF25aaddzhg  2952507815215015000    2   313.3209   194.5029  1.384087   
44  ZTF25aaddzhg  2956529811115015016    2  1802.9698  2460.9697  1.260643   
45  ZTF25aaddzhg  2975510631115015013    2  1791.9861  2491.8428  0.923833   
46  ZTF25aadcylv  2951302561315015006    2   732.5436   638.3500  4.636711   
47  ZTF25aadcylv  2960405541315015006    2   741.5807   628.1063  2.623603   
48  ZTF25aadcylv  2960442971315015012    1   726.9452   616.6949  1.719319   
49  ZTF25aadcylv  2971246301315015001    2   736.7428   575.0276  1.707796   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.052339  1.960000     0.936    391.0657  ...     0.000005     0.029675   
1  -0.294613  1.459968     0.671   1164.4140  ...     0.000008     0.045042   
2   0.306812  1.271529     0.805   1167.7060  ...     0.000007     0.042088   
3   0.072356  2.290000     0.968   1185.4558  ...     0.000011     0.038542   
4  -0.169974  3.460000     0.899    920.1899  ...     0.000027     0.046270   
5   0.401755  3.700000     0.699    453.5864  ...     0.000021     0.040462   
6  -0.213231  3.580000     0.980    166.6412  ...     0.000025     0.040652   
7   1.219029  2.240000     0.980    155.0410  ...     0.000145     0.089055   
8   0.204803  2.630000     0.982    159.7438  ...     0.000061     0.057461   
9  -0.286911  3.540000     0.982    153.6037  ...     0.000033     0.042455   
10  0.094823  3.800000     0.644    367.2450  ...     0.000068     0.046992   
11 -0.018917  2.500000     0.712     17.3686  ...     0.000034     0.035052   
12 -0.209614  2.910000     0.996    292.7480  ...     0.000349     0.063107   
13 -0.574194  1.242640     0.742    306.1370  ...     0.000000     0.000000   
14 -0.127633  2.740000     0.798    247.5384  ...     0.000032     0.044850   
15  0.057968  4.740000     0.934     37.1272  ...     0.000027     0.038555   
16  0.146794  3.340000     0.979     26.1471  ...     0.000029     0.038817   
17 -0.161936  5.450000     0.959    302.6477  ...     0.000034     0.039583   
18 -0.324960  4.390000     0.940    683.8840  ...     0.000037     0.038826   
19  0.029500  3.370000     0.983    100.0244  ...     0.000017     0.040787   
20  0.125729  2.230000     0.983     92.1000  ...     0.000012     0.043544   
21 -0.028205  3.690000     0.981     98.3354  ...     0.000019     0.033918   
22 -0.060897  2.450000     0.983    121.0585  ...     0.000015     0.047654   
23  0.068280  4.200000     0.981    119.8047  ...     0.000020     0.041517   
24 -0.079776  4.560000     0.964    392.5107  ...     0.000029     0.038311   
25  0.213095  3.120000     0.734    663.2924  ...     0.000013     0.043232   
26  0.061302  3.480000     0.946    996.7016  ...     0.000014     0.047288   
27  0.869671  1.487820     0.657    774.7277  ...     0.000003     0.036091   
28 -0.188782  1.316672     0.796    203.8655  ...     0.000009     0.048970   
29 -0.075046  3.010000     0.959    154.5800  ...     0.000002     0.033946   
30  0.276510  2.350000     0.974    166.3397  ...     0.000002     0.034017   
31  0.409692  2.920000     0.976    400.6505  ...     0.000002     0.034087   
32 -0.299346  2.020000     0.976    370.8018  ...     0.000002     0.034121   
33 -0.133073  2.890000     0.999    155.6980  ...     0.000002     0.032158   
34 -0.027414  1.860000     0.979    195.4245  ...     0.000002     0.034625   
35  0.417868  1.920000     0.981    395.2935  ...     0.000002     0.036985   
36  0.068690  2.660000     0.972    336.1575  ...     0.000002     0.036799   
37  0.496271  2.320000     0.980    148.4660  ...     0.000002     0.034507   
38  0.154037  3.390000     0.978    332.3750  ...     0.000003     0.040315   
39 -0.607082  3.740000     0.908    536.9274  ...     0.000004     0.034917   
40  0.486434  2.800000     0.778    277.5800  ...     0.000005     0.033859   
41 -0.748047  3.240000     0.974    540.3229  ...     0.000005     0.038758   
42  0.022848  4.430000     0.909    619.6998  ...     0.000004     0.037339   
43  1.522485  3.050000     0.956    194.5029  ...     0.000003     0.035051   
44  0.209429  2.200000     0.974    619.5302  ...     0.000002     0.030577   
45  0.224632  1.227299     0.869    588.6572  ...     0.000002     0.030737   
46 -1.117530  2.540000     0.977    638.3500  ...     0.000011     0.043190   
47 -4.032431  2.700000     0.982    628.1063  ...     0.000017     0.050827   
48  1.426225  3.920000     0.979    616.6949  ...     0.000034     0.043066   
49 -0.323300  2.210000     0.976    575.0276  ...     0.000017     0.047967   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0      756.0 -0.060480  0.000009 -0.000006  26.208000   0.653  0.294348   
1      463.0  0.118292  0.000012 -0.000009  26.474000   0.715  0.322587   
2      463.0  0.112307  0.000010 -0.000008  26.489000   0.701  0.320604   
3      460.0 -0.083266  0.000017 -0.000013  26.325000   0.694  0.319249   
4      378.0 -0.038205  0.000060 -0.000036  26.122000   0.488  0.298175   
5      455.0 -0.032828  0.000040 -0.000026  26.271000   0.563  0.290007   
6      248.0 -0.073361  0.000040 -0.000029  26.262000   0.640  0.329083   
7      256.0  0.119617  0.000220 -0.000163  25.609000   0.650  0.334971   
8      231.0 -0.089850  0.000103 -0.000072  25.835000   0.618  0.321496   
9      237.0 -0.064601  0.000057 -0.000039  26.334000   0.609  0.319328   
10     188.0 -0.039344  0.000101 -0.000076  26.147500   0.712  0.327650   
11     201.0 -0.043375  0.000050 -0.000038  26.201000   0.743  0.319638   
12      55.0  0.090174  0.000566 -0.000406  26.715000   0.641  0.318505   
13       NaN  0.000000  0.000000       NaN        NaN     NaN       NaN   
14     221.0  0.091968  0.000047 -0.000035  26.343000   0.700  0.327640   
15     284.0 -0.044184  0.000047 -0.000033  26.311000   0.609  0.310805   
16     285.0 -0.034532  0.000050 -0.000035  26.280000   0.617  0.313079   
17     221.0 -0.047406  0.000056 -0.000040  26.306000   0.618  0.327640   
18     243.0 -0.023999  0.000068 -0.000046  26.252000   0.598  0.297948   
19     341.0 -0.075586  0.000026 -0.000019  26.187000   0.603  0.337210   
20     347.0 -0.101113  0.000018 -0.000013  26.243000   0.618  0.338972   
21     331.0 -0.015161  0.000030 -0.000021  26.285000   0.591  0.335729   
22     343.0 -0.108928  0.000023 -0.000017  26.262000   0.614  0.338163   
23     314.0 -0.074084  0.000033 -0.000023  26.235500   0.570  0.328479   
24     280.0 -0.043540  0.000041 -0.000032  26.313500   0.740  0.330880   
25     427.0  0.103367  0.000019 -0.000014  26.201000   0.695  0.313883   
26     386.0  0.114239  0.000021 -0.000016  26.335499   0.661  0.324202   
27    1880.0  0.097604  0.000007 -0.000004  26.362000   0.499  0.242488   
28    1342.0  0.099388  0.000017 -0.000011  26.079000   0.572  0.270340   
29    1351.0  0.100788  0.000004 -0.000003  26.332000   0.566  0.269387   
30    1350.0  0.100180  0.000004 -0.000003  26.322000   0.568  0.269842   
31    1536.0  0.097718  0.000004 -0.000002  26.407000   0.569  0.278755   
32    1528.0  0.095934  0.000004 -0.000002  26.405000   0.569  0.278714   
33    1346.0  0.094294  0.000004 -0.000003  26.295000   0.566  0.269700   
34    1343.0  0.101605  0.000005 -0.000003  26.318000   0.571  0.269422   
35    1541.0  0.103579  0.000004 -0.000003  26.383000   0.568  0.278537   
36    1518.0  0.103906  0.000004 -0.000003  26.392000   0.569  0.278169   
37    1350.0  0.099273  0.000005 -0.000003  26.337000   0.566  0.268990   
38    1528.0  0.110354  0.000006 -0.000004  26.348000   0.567  0.278644   
39     973.0  0.092918  0.000006 -0.000004  26.175000   0.616  0.289766   
40     844.0  0.084090  0.000008 -0.000006  26.270500   0.600  0.287031   
41     993.0  0.099503  0.000008 -0.000006  26.144000   0.610  0.290582   
42    1165.0  0.091782  0.000008 -0.000005  26.249000   0.581  0.282217   
43    1255.0  0.092944  0.000006 -0.000004  26.228000   0.589  0.277659   
44    1160.0  0.085657  0.000004 -0.000003  26.289000   0.581  0.281932   
45    1157.0  0.083398  0.000004 -0.000003  26.301000   0.581  0.283167   
46     436.0  0.108309  0.000016 -0.000012  26.274000   0.738  0.317605   
47     435.0  0.121763  0.000024 -0.000019  26.229000   0.737  0.318990   
48     314.0 -0.050333  0.000063 -0.000043  26.175000   0.607  0.287371   
49     440.0  0.107860  0.000025 -0.000019  26.129000   0.738  0.318694   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13      NaN  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.723988771438599,2025-07-25T10:39:28,0.0025974025974025974,0.02,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,8,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the 'stamp_classifier'-- with a probability greater than 0.7 and ranking equal to 1, returning all columns from the 'dataquality' table.SELECT dq.*FROM dataquality dqINNER JOIN probability p    ON dq.oid = p.oidWHERE p.classifier_name = 'stamp_classifier' -- Use the stamp classifier  AND p.class_name = 'SN'                   -- Classify as supernovae  AND p.ranking = 1                         -- Only the most likely classification  AND p.probability > 0.7                   -- Probability greater than 0.7LIMIT 50                                   -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,19.49210286140442,2025-07-23T18:53:21,"[             oid               candid  fid       xpos       ypos     chipsf  \
0   ZTF25aadntob  2985238391315015027    2  1547.6866  2205.8190   2.219352   
1   ZTF25aadntob  2980317441315015023    2  1570.5201  2177.9650   1.382199   
2   ZTF25aadntob  2980300531315015018    1  1574.1089  2173.5770   1.839687   
3   ZTF25aadntob  2978353751315015028    1  1574.7382  2164.5283   2.630197   
4   ZTF25aadntob  2978277281315015040    2  1578.2477  2164.0283   2.004873   
5   ZTF25aadntob  2976359301315015017    2  1565.6174  2199.9348   1.570698   
6   ZTF25aadntob  2976297021315015022    1  1561.4637  2196.6820   2.104195   
7   ZTF25aadntob  2974337471315015149    2  1559.6182  2166.4631   1.590501   
8   ZTF25aadntob  2972417541315015027    2  1540.3499  2190.6880   3.553615   
9   ZTF25aadntob  2972339991315015027    1  1562.2440  2188.4033   5.141135   
10  ZTF25aadntob  2956375301315015034    2  1578.5349  2163.1746   2.528848   
11  ZTF25aadntob  2955432611315015099    2  1585.4482  2190.6526   1.496497   
12  ZTF25aadntob  2955410431315015069    2  1590.9980  2193.5340   2.993240   
13  ZTF25aadntob  2955388271315015059    2  1590.5334  2193.8591   6.502522   
14  ZTF25aadntob  2955366111315015060    2  1586.6628  2194.2705   5.615113   
15  ZTF25aadntob  2955321721315015068    2  1574.5366  2189.7760  15.106682   
16  ZTF25aadntob  2955343911315015060    2  1579.3966  2192.6558  17.823975   
17  ZTF25aadntob  2955277381315015095    2  1565.5135  2183.6428   2.376794   
18  ZTF25aadntob  2954466841315015074    1  1546.1693  2193.8900   5.438616   
19  ZTF25aadntob  2954443371315015075    2  1555.3767  2194.2850  20.593515   
20  ZTF25aadntob  2954256561315015068    2  1543.2512  2181.5605  16.317099   
21  ZTF25aadntob  2953466201315015048    1  1548.9707  2189.9888   1.451893   
22  ZTF25aadntob  2953442751315015062    2  1558.4072  2189.7320   9.440625   
23  ZTF25aadntob  2953419371315015072    1  1564.9917  2190.8882   2.020466   
24  ZTF25aadntob  2953396041315015056    2  1565.6044  2191.6829   5.817254   
25  ZTF25aadntob  2953372731315015054    1  1562.0942  2191.4536   4.147745   
26  ZTF25aadntob  2953351261315015063    2  1558.8885  2199.1353   1.723418   
27  ZTF25aadntob  2953327961315015045    1  1556.2455  2197.2153   3.432450   
28  ZTF25aadntob  2953304641315015057    2  1552.5259  2198.8838   4.430258   
29  ZTF25aadntob  2953281341315015053    1  1546.3008  2194.9382   3.796079   
30  ZTF25aadnxae  2985238864915015012    2   735.3134  1289.0450   2.736665   
31  ZTF25aadnxae  2980318864915015008    2   757.3117  1258.2095   2.340748   
32  ZTF25aadnxae  2980301954915015014    1   764.3005  1257.0312   1.391704   
33  ZTF25aadnxae  2978318534915015008    1   758.1116  1251.8909   1.320900   
34  ZTF25aadnxae  2978253904915015016    2   755.4104  1275.7864   2.097611   
35  ZTF25aadnxae  2976316814915015012    1   751.3959  1278.7415   2.066262   
36  ZTF25aadnxae  2974337954915015015    2   747.6157  1246.8306   2.258399   
37  ZTF25aadnxae  2972429744915015016    2   724.4509  1266.9291   4.793866   
38  ZTF25aadnxae  2972338574915015012    1   745.9417  1274.0592   1.705386   
39  ZTF25aadnxae  2962405234915015005    1   740.2995  1276.8337   1.634847   
40  ZTF25aadnxae  2955461434915015037    2   757.4644  1267.8925  11.566182   
41  ZTF25aadnxae  2955439274915015009    2   770.2917  1269.7452   2.049278   
42  ZTF25aadnxae  2955417084915015077    2   773.2121  1273.2598   3.511786   
43  ZTF25aadnxae  2955394904915015122    2   776.6720  1276.4840  19.060774   
44  ZTF25aadnxae  2955372744915015147    2   772.9718  1278.1810   3.458962   
45  ZTF25aadnxae  2955350544915015118    2   770.5300  1276.6173  22.042332   
46  ZTF25aadnxae  2955328354915015150    2   764.4773  1275.7407  36.397648   
47  ZTF25aadnxae  2955306184915015186    2   759.7154  1271.9218  11.092732   
48  ZTF25aadnxae  2955284014915015189    2   756.7973  1268.8206  11.702063   
49  ZTF25aadnxae  2955261874915015149    2   749.3459  1267.1415  12.173710   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.113851  2.070000     0.950    874.6810  ...     0.000013     0.048017   
1  -0.051938  1.972408     0.353    902.5350  ...     0.000023     0.053824   
2   0.401278  2.430000     0.967    906.9230  ...     0.000018     0.039004   
3   0.129393  1.810000     0.980    915.9717  ...     0.000013     0.032551   
4  -0.170097  1.590000     1.000    916.4717  ...     0.000009     0.042699   
5   0.214707  1.608175     0.718    880.5653  ...     0.000013     0.047504   
6  -0.076217  2.610000     0.992    883.8181  ...     0.000019     0.038821   
7  -0.329574  3.300000     0.810    914.0369  ...     0.000017     0.049835   
8   0.254284  2.710000     1.000    889.8121  ...     0.000011     0.046737   
9   0.245701  1.960000     0.991    892.0968  ...     0.000012     0.033971   
10  0.254360  3.630000     1.000    917.3254  ...     0.000021     0.055295   
11  5.386102  2.920000     0.943    889.8474  ...     0.000027     0.057695   
12  0.722611  1.710000     0.961    886.9660  ...     0.000011     0.050527   
13  0.226801  3.050000     1.000    886.6408  ...     0.000012     0.049312   
14 -1.876035  2.040000     1.000    886.2296  ...     0.000012     0.049404   
15 -0.138188  2.050000     0.984    890.7242  ...     0.000008     0.044607   
16  0.764922  3.090000     0.990    887.8443  ...     0.000008     0.045032   
17  1.280659  3.200000     0.998    896.8571  ...     0.000012     0.049290   
18  0.174862  2.400000     0.984    886.6102  ...     0.000005     0.023155   
19  0.092262  2.410000     0.999    886.2150  ...     0.000009     0.044741   
20  1.395166  2.380000     1.000    898.9395  ...     0.000007     0.042027   
21  0.618873  2.380000     0.984    890.5113  ...     0.000009     0.028984   
22  0.572549  4.400000     0.982    890.7680  ...     0.000008     0.045271   
23 -0.066560  2.590000     0.983    889.6118  ...     0.000008     0.027970   
24 -0.415565  2.320000     0.998    888.8172  ...     0.000009     0.044266   
25  0.340533  2.960000     0.989    889.0463  ...     0.000010     0.036907   
26 -0.564485  3.170000     0.996    881.3647  ...     0.000008     0.043019   
27  0.525315  2.600000     0.984    883.2847  ...     0.000010     0.037136   
28  0.934055  2.230000     0.982    881.6163  ...     0.000008     0.042879   
29  0.877857  2.850000     0.984    885.5617  ...     0.000010     0.044977   
30  0.235785  3.410000     0.971    735.3134  ...     0.000014     0.041025   
31 -0.050243  3.760000     0.968    757.3117  ...     0.000020     0.048452   
32 -0.064553  5.180000     0.970    764.3005  ...     0.000028     0.044399   
33 -0.209378  3.210000     0.970    758.1116  ...     0.000037     0.049644   
34 -0.012456  3.000000     0.999    755.4104  ...     0.000017     0.046172   
35 -0.509080  4.450000     0.992    751.3959  ...     0.000031     0.043260   
36  0.129897  3.140000     0.982    747.6157  ...     0.000021     0.047080   
37  0.037048  2.430000     0.984    724.4509  ...     0.000013     0.042818   
38 -0.056263  2.680000     0.983    745.9417  ...     0.000027     0.047469   
39 -0.821400  2.480000     0.983    740.2995  ...     0.000036     0.037825   
40  0.023342  3.750000     0.986    757.4644  ...     0.000008     0.037526   
41 -0.554341  3.370000     0.995    770.2917  ...     0.000018     0.045673   
42  2.167166  2.740000     0.984    773.2121  ...     0.000015     0.043940   
43 -2.477022  3.210000     0.999    776.6720  ...     0.000007     0.036044   
44  1.159480  4.230000     0.989    772.9718  ...     0.000008     0.038929   
45  1.707623  6.130000     0.989    770.5300  ...     0.000008     0.039444   
46  2.568512  6.900000     0.994    764.4773  ...     0.000008     0.039047   
47  2.754259  5.130000     0.995    759.7154  ...     0.000007     0.038728   
48  2.105536  3.600000     0.983    756.7973  ...     0.000007     0.038375   
49  0.771166  5.480000     0.986    749.3459  ...     0.000007     0.039020   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0        463  0.110626  0.000019 -0.000015  26.1950   0.674  0.329385     30.0  
1        462  0.105088  0.000034 -0.000025  26.1680   0.670  0.328871     30.0  
2        456 -0.042420  0.000028 -0.000020  26.2580   0.656  0.325528     30.0  
3        462 -0.023070  0.000020 -0.000015  26.2150   0.659  0.327471     30.0  
4        466  0.104729  0.000013 -0.000010  26.2610   0.674  0.327473     30.0  
5        458  0.109827  0.000019 -0.000014  26.2955   0.659  0.328253     30.0  
6        426 -0.037054  0.000032 -0.000023  26.2720   0.622  0.318243     30.0  
7        461  0.107075  0.000025 -0.000019  26.2570   0.660  0.327108     30.0  
8        463  0.113466  0.000016 -0.000012  26.2030   0.674  0.328309     30.0  
9        459 -0.047382  0.000018 -0.000014  26.2560   0.664  0.330613     30.0  
10       466  0.117450  0.000031 -0.000023  26.3150   0.670  0.328500     30.0  
11       387  0.126849  0.000042 -0.000031  26.7470   0.655  0.320364    180.0  
12       462  0.126276  0.000016 -0.000012  27.7425   0.675  0.329189    180.0  
13       464  0.117380  0.000018 -0.000014  28.0650   0.675  0.330191    180.0  
14       467  0.120437  0.000017 -0.000013  27.9280   0.676  0.329985    180.0  
15       463  0.112899  0.000012 -0.000009  28.1180   0.675  0.329053    180.0  
16       463  0.115768  0.000011 -0.000009  28.1620   0.675  0.329299    180.0  
17       463  0.118327  0.000018 -0.000013  27.2450   0.675  0.330424    180.0  
18       466 -0.035064  0.000008 -0.000006  28.1590   0.674  0.330323    180.0  
19       463  0.110750  0.000013 -0.000010  28.1480   0.674  0.329533    180.0  
20       465  0.105904  0.000011 -0.000008  28.1890   0.676  0.329819    180.0  
21       464 -0.035002  0.000014 -0.000010  27.8360   0.663  0.329688    180.0  
22       468  0.114593  0.000012 -0.000009  27.9610   0.674  0.330075    180.0  
23       463 -0.042335  0.000012 -0.000009  28.0090   0.673  0.330812    180.0  
24       465  0.108388  0.000013 -0.000010  27.8780   0.675  0.331057    180.0  
25       465 -0.074491  0.000015 -0.000011  28.0240   0.674  0.331572    180.0  
26       472  0.106136  0.000012 -0.000009  28.1145   0.674  0.330785    180.0  
27       467 -0.076277  0.000015 -0.000011  27.9980   0.674  0.329552    180.0  
28       468  0.106244  0.000012 -0.000009  27.9600   0.674  0.329291    180.0  
29       467 -0.107352  0.000015 -0.000012  27.9770   0.675  0.328862    180.0  
30       385  0.094945  0.000019 -0.000015  26.2170   0.757  0.319206     30.0  
31       386  0.111099  0.000028 -0.000022  26.1020   0.762  0.319561     30.0  
32       372 -0.067606  0.000041 -0.000032  26.2320   0.745  0.314871     30.0  
33       365 -0.069614  0.000055 -0.000041  26.2330   0.722  0.314667     30.0  
34       383  0.107937  0.000024 -0.000019  26.2420   0.757  0.319745     30.0  
35       341 -0.052193  0.000051 -0.000037  26.2360   0.672  0.304807     30.0  
36       386  0.102264  0.000029 -0.000023  26.2475   0.762  0.320479     30.0  
37       385  0.105362  0.000018 -0.000014  26.2180   0.760  0.318670     30.0  
38       379 -0.085836  0.000039 -0.000030  26.2170   0.746  0.319197     30.0  
39       244 -0.031545  0.000072 -0.000047  26.2420   0.584  0.276801     30.0  
40       385  0.098464  0.000011 -0.000008  27.8970   0.757  0.319485    180.0  
41       382  0.102285  0.000026 -0.000020  26.7860   0.765  0.321313    180.0  
42       384  0.104169  0.000021 -0.000016  27.5180   0.765  0.320475    180.0  
43       383  0.094620  0.000010 -0.000008  28.0200   0.765  0.319302    180.0  
44       382  0.103013  0.000011 -0.000009  28.1790   0.762  0.319798    180.0  
45       387  0.103154  0.000012 -0.000009  27.7660   0.765  0.320160    180.0  
46       379  0.102935  0.000011 -0.000009  28.2120   0.760  0.320448    180.0  
47       380  0.104042  0.000010 -0.000008  28.2100   0.762  0.318838    180.0  
48       381  0.103051  0.000010 -0.000008  28.1490   0.760  0.317403    180.0  
49       381  0.105515  0.000010 -0.000008  28.1830   0.760  0.317782    180.0  

[50 rows x 32 columns]]",,8.958440780639648,2025-07-25T10:39:41,0.0821917808219178,0.6,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,9,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN' -- Filter for supernovae      AND classifier_name = 'stamp_classifier' -- Use the stamp classifier      AND probability > 0.7 -- Probability threshold      AND ranking = 1 -- Only the most likely classification) p ON dq.oid = p.oidLIMIT 50 -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,18.65030217170716,2025-07-23T18:53:40,"[             oid               candid  fid       xpos       ypos     chipsf  \
0   ZTF25aafdvhm  2956473310515015013    2   406.3009  2996.9050   1.221399   
1   ZTF25aafdvhv  2956473310515015015    2   497.3548  2989.9453   1.252607   
2   ZTF20abozwjh  2956472843315015083    2  2127.0454   591.9971   1.409644   
3   ZTF18aawrfcs  2956472843315015087    2  2383.7417   637.8417   1.123874   
4   ZTF18adqhnig  2956473315115015061    2   641.4173  2742.7983   1.803672   
5   ZTF25aafdznv  2956510271015015015    2   279.6975   856.7947   1.062744   
6   ZTF25aafdzsy  2971495532515015005    2  1195.3066  1217.0035   1.750216   
7   ZTF25aafdzsy  2956511282515015006    2  1212.9501  1150.1372   1.644909   
8   ZTF25aafdzvp  2956511286315015013    2  1837.3641  1057.5732   1.187114   
9   ZTF25aafdzxq  3124277921415015007    2  2632.7100   635.3713   1.272027   
10  ZTF25aafdzxq  3111298501415015004    2  2622.3918   626.7384   1.274054   
11  ZTF25aafdzxq  3109366661415015005    1  2646.0364   633.1813   1.170639   
12  ZTF25aafdzxq  3108407910315015006    1   818.0706   516.0523   0.358746   
13  ZTF25aafdzxq  3107426561415015007    1  2622.0680   631.5372   1.524108   
14  ZTF25aafdzxq  3105351351415015003    1  2609.2876   633.1104   1.052786   
15  ZTF25aafdzxq  3103322061415015007    1  2617.6584   629.3024   1.204952   
16  ZTF25aafdzxq  3099333391415015005    1  2640.6565   631.8149   1.269581   
17  ZTF25aafdzxq  3097388121415015003    2  2626.0688   647.3713   1.873797   
18  ZTF25aafdzxq  3095220641415015005    1  2621.4487   620.9539   1.660716   
19  ZTF25aafdzxq  3089301701415015008    1  2653.9673   593.4870   1.068554   
20  ZTF25aafdzxq  3080411340315015003    1   836.8784   515.7625   0.788700   
21  ZTF25aafdzxq  3078430101415015004    2  2615.1714   646.8456   1.089986   
22  ZTF25aafdzxq  3078405201415015006    1  2626.3690   644.6078   1.665879   
23  ZTF25aafdzxq  3075366231415015004    1  2593.0420   614.9682   0.795187   
24  ZTF25aafdzxq  3070427071415015007    1  2622.1648   650.3442   1.084988   
25  ZTF25aafdzxq  3043447660315015026    1   809.9953   531.1518   0.824276   
26  ZTF25aafdzxq  3033484491415015001    2  2595.4873   656.0402   1.745765   
27  ZTF25aafdzxq  3033405971415015008    1  2600.0960   620.3331   1.690726   
28  ZTF25aafdzxq  2956511280315015002    2   817.8838   421.6670   0.642838   
29  ZTF18abglmzd  2956472846015015019    2  1450.6488    89.3127   1.762657   
30  ZTF18abkzzal  2956472846015015149    2  2293.8657   633.9941   1.535241   
31  ZTF18aaqvujc  2956472843215015074    2  1264.3494  2773.0708   0.869020   
32  ZTF25aafedas  3070447845915015008    2  2513.0408   443.2910   1.391728   
33  ZTF25aafedas  3057385465915015005    2  2530.1630   438.9253   1.102836   
34  ZTF25aafedas  3040361125915015004    2  2510.7078   430.4470   2.501069   
35  ZTF25aafedas  3019427775915015004    2  2539.0670   439.3141   1.451363   
36  ZTF25aafedas  3001494065915015004    2  2499.2070   456.0393   1.849452   
37  ZTF25aafedas  2996446015915015006    2  2508.7300   422.3055   2.047647   
38  ZTF25aafedas  2977531455915015002    2  2530.0664   448.9840   1.300963   
39  ZTF25aafedas  2971496495915015002    2  2519.2744   448.5012  12.468320   
40  ZTF25aafedas  2961561855915015002    1  2520.8875   427.8067   0.932930   
41  ZTF25aafedas  2956529815915015001    2  2538.4200   390.1089   3.194465   
42  ZTF25aafedjz  2956533700915015005    2   580.3748  2256.4065   2.417037   
43  ZTF25aacrxvs  2956539915715015017    2  1912.7135  2569.1309   1.396945   
44  ZTF18aaiwswb  2956534180315015098    2   585.5807  2031.0098   1.796634   
45  ZTF25aafeixc  3000495020015015012    2  1888.6948  1571.6270   1.189738   
46  ZTF25aafeixc  2977553580015015002    2  1916.7960  1580.7050   1.496058   
47  ZTF25aafeixc  2977472040015015014    1  1909.9009  1579.3516   1.456101   
48  ZTF25aafeixc  2971508190015015008    2  1893.7502  1567.9542   1.555309   
49  ZTF25aafeixc  2956572000015015005    2  1905.9713  1532.9340   1.367595   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -3.034880  1.184085     0.844     83.5949  ...     0.000380     0.179616   
1  -2.606970  1.184085     0.785     90.5547  ...     0.000380     0.179616   
2  -1.199036  1.276486     0.832    591.9971  ...     0.000069     0.093753   
3  -0.785962  1.276486     0.852    637.8417  ...     0.000069     0.093753   
4  -0.966207  1.255283     0.636    337.7017  ...     0.000228     0.151122   
5   0.347686  2.870000     0.944    279.6975  ...     0.000004     0.030957   
6  -0.036967  1.159835     0.989   1195.3066  ...     0.000002     0.034513   
7   0.575721  1.342794     0.954   1150.1372  ...     0.000003     0.034989   
8   0.276908  1.386756     0.626   1057.5732  ...     0.000005     0.036445   
9  -0.058587  1.254025     0.783    439.7900  ...     0.000004     0.035684   
10  1.114680  1.079455     0.932    450.1081  ...     0.000004     0.035367   
11  0.126372  2.290000     0.949    426.4637  ...     0.000009     0.046870   
12 -0.088124  1.334538     0.663    516.0523  ...     0.000005     0.034951   
13 -0.131892  1.320000     0.821    450.4318  ...     0.000009     0.049255   
14  0.060025  2.390000     0.798    463.2123  ...     0.000011     0.056417   
15  0.120598  2.100000     0.909    454.8415  ...     0.000006     0.042245   
16 -0.224654  3.000000     0.759    431.8435  ...     0.000008     0.048930   
17  0.323584  1.158473     0.936    446.4312  ...     0.000003     0.032819   
18 -0.085814  1.730000     0.920    451.0513  ...     0.000009     0.050882   
19 -0.408118  2.610000     0.772    418.5328  ...     0.000008     0.045565   
20  0.431969  1.238824     0.808    515.7625  ...     0.000006     0.036215   
21  0.049468  1.199979     0.705    457.3286  ...     0.000003     0.033385   
22 -0.032181  1.910000     0.916    446.1310  ...     0.000006     0.041216   
23 -0.271004  1.490000     0.869    479.4581  ...     0.000009     0.050331   
24 -0.063684  2.210000     0.903    450.3351  ...     0.000006     0.041292   
25  1.093835  2.720000     0.849    531.1518  ...     0.000004     0.033804   
26 -0.116263  1.347489     0.798    477.0128  ...     0.000003     0.033362   
27  0.076131  1.500000     0.897    472.4041  ...     0.000006     0.042889   
28  1.428237  1.439273     0.537    421.6670  ...     0.000003     0.034539   
29 -1.769375  2.530000     0.750     89.3127  ...     0.000258     0.157427   
30  0.003643  2.340000     0.693    633.9941  ...     0.000258     0.157427   
31 -0.465521  2.350000     0.505    307.4292  ...     0.000113     0.116382   
32  1.098243  1.670000     0.957    443.2910  ...     0.000003     0.034220   
33 -4.346172  1.293687     0.892    438.9253  ...     0.000005     0.039144   
34  0.776793  1.240000     0.995    430.4470  ...     0.000003     0.034272   
35  0.562615  1.740000     0.980    439.3141  ...     0.000004     0.036072   
36  0.340379  4.360000     0.974    456.0393  ...     0.000005     0.040548   
37  0.292025  2.040000     0.983    422.3055  ...     0.000004     0.038658   
38  0.298163  2.100000     0.983    448.9840  ...     0.000003     0.034801   
39  1.156087  1.840000     1.000    448.5012  ...     0.000003     0.036184   
40 -0.562127  2.060000     0.981    427.8067  ...     0.000026     0.044296   
41 -0.189514  2.620000     0.983    390.1089  ...     0.000003     0.036526   
42 -0.009046  2.490000     0.998    580.3748  ...     0.000003     0.033972   
43  0.066435  1.215666     0.960    511.3691  ...     0.000003     0.035888   
44  0.183289  1.348660     0.613    585.5807  ...     0.000058     0.088603   
45  0.282700  2.530000     0.786   1183.8052  ...     0.000001     0.022204   
46  0.458821  2.080000     0.982   1155.7040  ...     0.000001     0.023554   
47 -0.069479  2.410000     0.970   1162.5991  ...     0.000002     0.023689   
48  0.929307  2.420000     0.983   1178.7498  ...     0.000001     0.024872   
49 -0.166298  3.450000     0.995   1166.5287  ...     0.000002     0.027743   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        509  0.029133  0.000636 -0.000449  25.685000   0.603  0.315324   
1        509  0.029133  0.000636 -0.000449  25.685000   0.603  0.315324   
2        613  0.107443  0.000128 -0.000085  25.570000   0.556  0.312610   
3        613  0.107443  0.000128 -0.000085  25.570000   0.556  0.312610   
4        550  0.075096  0.000382 -0.000268  25.581501   0.617  0.325249   
5        591  0.081456  0.000008 -0.000005  26.288000   0.621  0.291321   
6       1244  0.100350  0.000005 -0.000003  26.364000   0.585  0.275114   
7       1218  0.099688  0.000005 -0.000003  26.368000   0.586  0.276060   
8        843  0.095861  0.000008 -0.000006  26.216000   0.612  0.286755   
9       1609  0.083573  0.000008 -0.000005  26.114000   0.559  0.258071   
10      1604  0.078932  0.000008 -0.000005  26.091000   0.562  0.257944   
11      1547 -0.083987  0.000020 -0.000012  26.088000   0.551  0.241599   
12      1411 -0.063961  0.000010 -0.000006  26.106000   0.544  0.258791   
13      1601 -0.091357  0.000018 -0.000012  26.100000   0.562  0.256050   
14      1590 -0.111110  0.000023 -0.000015  26.144000   0.559  0.253733   
15      1603 -0.085523  0.000012 -0.000008  26.118000   0.560  0.257838   
16      1542 -0.111359  0.000018 -0.000011  26.067000   0.552  0.244654   
17      1607  0.079288  0.000006 -0.000004  26.068000   0.563  0.257568   
18      1583 -0.097105  0.000019 -0.000013  26.006000   0.557  0.253609   
19      1564 -0.080230  0.000017 -0.000011  26.124000   0.555  0.249803   
20      1395 -0.060497  0.000012 -0.000008  26.077000   0.542  0.253729   
21      1600  0.084664  0.000006 -0.000004  26.036000   0.561  0.257188   
22      1610 -0.075057  0.000012 -0.000008  26.010000   0.561  0.258598   
23      1599 -0.100462  0.000018 -0.000012  26.063000   0.559  0.255503   
24      1607 -0.071812  0.000013 -0.000008  26.087000   0.560  0.257390   
25      1413 -0.072997  0.000008 -0.000005  26.047000   0.547  0.262738   
26      1592  0.084953  0.000006 -0.000004  26.095000   0.563  0.257002   
27      1603 -0.089153  0.000013 -0.000008  26.051000   0.559  0.255000   
28      1421  0.088288  0.000007 -0.000004  26.048000   0.547  0.259683   
29       541  0.117524  0.000431 -0.000304  25.570000   0.616  0.316815   
30       541  0.117524  0.000431 -0.000304  25.570000   0.616  0.316815   
31       626  0.102476  0.000198 -0.000136  25.545000   0.581  0.317573   
32       963  0.092077  0.000006 -0.000004  26.294000   0.582  0.287771   
33       953  0.101488  0.000009 -0.000006  26.310000   0.578  0.285375   
34       963  0.094345  0.000006 -0.000004  26.270000   0.581  0.286297   
35       958  0.092133  0.000008 -0.000005  26.263000   0.577  0.286967   
36       955  0.108343  0.000009 -0.000006  26.258000   0.582  0.287272   
37       964  0.104061  0.000008 -0.000005  26.303000   0.579  0.286212   
38       953  0.099287  0.000005 -0.000003  26.323000   0.581  0.287001   
39       958  0.099010  0.000006 -0.000004  26.301000   0.582  0.286665   
40       577 -0.020532  0.000074 -0.000041  25.086000   0.486  0.213041   
41       961  0.102242  0.000006 -0.000004  26.312000   0.579  0.284181   
42       911  0.096201  0.000005 -0.000003  26.312000   0.574  0.289278   
43       835  0.096912  0.000005 -0.000003  26.250000   0.551  0.306077   
44       745  0.092888  0.000101 -0.000070  25.466000   0.600  0.305774   
45      1953  0.074142  0.000003 -0.000002  26.190000   0.475  0.206886   
46      1953  0.077718  0.000003 -0.000002  26.205000   0.475  0.207841   
47      1949 -0.039459  0.000006 -0.000003  26.140000   0.475  0.209780   
48      1948  0.076254  0.000005 -0.000002  26.180000   0.475  0.205839   
49      1944  0.084897  0.000005 -0.000003  26.215000   0.477  0.208346   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.161306381225586,2025-07-25T10:39:56,0.005263157894736842,0.02,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,10,"-- Retrieve at most 50 ZTF objects classified as supernovae (SN) by the stamp_classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN' -- Filter for supernovae classification      AND classifier_name = 'stamp_classifier' -- Use the stamp classifier      AND probability > 0.7 -- Probability threshold      AND ranking = 1 -- Most likely classification) p ON dq.oid = p.oidLIMIT 50 -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.56733012199402,2025-07-23T18:54:03,"[             oid               candid  fid       xpos       ypos     chipsf  \
0   ZTF25aagbifh  2996469593415015002    2  2741.2302  1434.0920   1.502909   
1   ZTF25aagbifh  2981394093415015010    1  2757.3113  1395.6511   2.820946   
2   ZTF25aagbifh  2979344343415015010    1  2769.0410  1392.0140   1.311818   
3   ZTF25aagbifh  2977452363415015014    1  2755.7993  1460.9340   1.806918   
4   ZTF25aagbifh  2971470763415015011    2  2744.7556  1448.9694   1.296242   
5   ZTF25aafiprb  2978519933815015001    2  1895.2725    44.1319   1.024055   
6   ZTF25aafiprb  2976525243815015000    2  1889.4117    65.6380   1.511007   
7   ZTF25aafiprb  2974483763815015001    2  1873.6294    63.0622   1.729085   
8   ZTF25aafiprb  2971472733815015001    2  1868.7318    70.8083   0.922293   
9   ZTF25aadtgiq  2976477485315015005    1  2662.2551  2896.9165   1.014376   
10  ZTF25aadtgiq  2974469985315015006    2  2663.9731  2889.0881   1.393695   
11  ZTF25aadtgiq  2972419235315015013    1  2650.9585  2891.1865   0.834292   
12  ZTF25aadtgiq  2971477155315015016    2  2670.2114  2917.5046   2.297812   
13  ZTF25aagbnzs  2975504233715015000    2   483.3117    71.7454   1.165285   
14  ZTF25aagbnzs  2971490313715015000    2   473.0460    99.4368   1.389756   
15  ZTF18aanpaau  2386256246215010214    2  2905.3533  2143.9082   1.277357   
16  ZTF18aanpaau   787551315015010169    2    56.0516  2214.1890   1.405436   
17  ZTF18aanpaau  2977528816215015019    2  2848.1948  2198.4973   2.070079   
18  ZTF18aanpaau  2977529295015015007    2   149.7588  2270.9970   1.248729   
19  ZTF18aanpaau  2977499346215015021    1  2853.3384  2196.6873   1.617829   
20  ZTF18aanpaau  2977499805015015015    1   153.5712  2264.7703   1.614602   
21  ZTF18aanpaau  2971520565015015002    2   126.1290  2280.2230   1.449825   
22  ZTF18aanpaau  2971489836215015006    2  2818.7397  2201.7524   1.400842   
23  ZTF25aagboyr  2977527876215015005    2   688.5635   567.3492   2.013930   
24  ZTF25aagboyr  2977527405115015005    2   978.7771   438.8418   1.037918   
25  ZTF25aagboyr  2971506786215015006    2   669.6885   572.8430   1.364551   
26  ZTF25aagboyr  2971490315115015003    2   952.3001   439.7370   1.030454   
27  ZTF25aagbpag  3005445743715015004    2  1460.1842   665.2781   1.805289   
28  ZTF25aagbpag  2990446713715015002    2  1416.2373   675.2788   1.775861   
29  ZTF25aagbpag  2985468253715015004    2  1423.4961   681.1261   7.556628   
30  ZTF25aagbpag  2977555003715015006    2  1459.5190   716.8563  20.155762   
31  ZTF25aagbpag  2977494523715015005    1  1453.4716   695.4639   4.642164   
32  ZTF25aagbpag  2971495043715015004    2  1422.2849   702.7311   6.106616   
33  ZTF25aagbqjy  2971498395415015012    2  1910.0087  1893.8202   0.923330   
34  ZTF25aagbqyv  2977512763915015014    2  1416.1316  1664.6827   0.768598   
35  ZTF25aagbqyv  2971495533915015013    2  1402.8147  1664.3206   1.071601   
36  ZTF25aagbrej  2977508931615015007    2   652.7841  2286.6196   1.089923   
37  ZTF25aagbrej  2971498391615015014    2   649.6721  2301.7450   1.395238   
38  ZTF25aagbrjw  2977531451915015000    2  1336.7094   292.9844   1.002700   
39  ZTF25aagbrjw  2971496491915015001    2  1323.2639   286.3840   1.553603   
40  ZTF25aagbrpb  3106342174315015000    2  2908.0356    20.0728   1.611238   
41  ZTF25aagbrpb  3104276004315015000    2  2918.2446    32.1314   2.730217   
42  ZTF25aagbrpb  3100349674315015000    2  2896.3604    19.2087   3.080550   
43  ZTF25aagbrpb  3096372184315015000    2  2901.0012    27.1362   2.919854   
44  ZTF25aagbrpb  3096311714315015000    2  2903.3865    43.8276   6.584587   
45  ZTF25aagbrpb  3094332074315015000    1  2899.3574    43.2895   1.594213   
46  ZTF25aagbrpb  3094308284315015000    2  2922.0059    37.1750   1.794262   
47  ZTF25aagbrpb  3092316134315015000    2  2928.3767    22.4116   9.139976   
48  ZTF25aagbrpb  3092299864315015000    1  2929.6802    23.6036   2.442662   
49  ZTF25aagbrpb  3084309964315015000    2  2924.2742    21.9153   2.044662   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.495131  1.600000     0.998    331.2697  ...     0.000009     0.046349   
1  -0.095379  2.370000     0.998    315.1886  ...     0.000056     0.072665   
2  -0.106259  3.710000     0.978    303.4590  ...     0.000022     0.042617   
3  -0.246080  2.530000     0.982    316.7007  ...     0.000012     0.036804   
4  -0.165513  2.250000     0.976    327.7444  ...     0.000008     0.043203   
5   0.146554  2.770000     0.960     44.1319  ...     0.000004     0.039605   
6  -0.105629  2.430000     0.999     65.6380  ...     0.000005     0.040785   
7   0.005921  3.280000     0.970     63.0622  ...     0.000005     0.042277   
8  -0.718042  2.380000     0.998     70.8083  ...     0.000006     0.041181   
9  -0.189393  2.480000     0.992    183.5834  ...     0.000012     0.037012   
10 -0.259568  1.910000     0.983    191.4118  ...     0.000006     0.037689   
11  0.288561  2.910000     0.981    189.3134  ...     0.000015     0.040873   
12  0.474574  2.120000     0.988    162.9953  ...     0.000006     0.037975   
13  1.301387  1.209155     0.912     71.7454  ...     0.000002     0.038687   
14  0.156868  1.186749     0.985     99.4368  ...     0.000002     0.040000   
15  0.319866  1.368418     0.778    167.1467  ...     0.000024     0.063294   
16 -0.198795  1.799092     0.704     56.0516  ...     0.000069     0.090841   
17  0.282807  2.820000     0.931    224.3051  ...     0.000003     0.035959   
18 -0.151666  2.880000     0.995    149.7588  ...     0.000004     0.036505   
19  0.520867  2.590000     0.967    219.1615  ...     0.000004     0.027427   
20 -0.017962  3.110000     0.964    153.5712  ...     0.000008     0.039433   
21  0.413579  1.147518     0.929    126.1290  ...     0.000004     0.038221   
22  0.743987  1.232435     0.912    253.7603  ...     0.000006     0.041487   
23 -0.017378  2.130000     0.973    567.3492  ...     0.000002     0.034420   
24 -0.221704  3.020000     0.933    438.8418  ...     0.000003     0.036071   
25  0.209961  1.890000     0.974    572.8430  ...     0.000003     0.036462   
26  0.003392  2.180000     0.999    439.7370  ...     0.000003     0.037335   
27  0.224026  2.390000     0.916    665.2781  ...     0.000001     0.021687   
28 -0.064649  2.800000     0.998    675.2788  ...     0.000002     0.024097   
29  0.624838  2.310000     0.983    681.1261  ...     0.000001     0.021334   
30  0.485809  1.930000     1.000    716.8563  ...     0.000001     0.021531   
31  0.522870  2.190000     0.986    695.4639  ...     0.000002     0.020032   
32  1.047309  1.880000     0.995    702.7311  ...     0.000001     0.022084   
33  0.919284  1.111168     0.816   1162.4913  ...     0.000010     0.042648   
34  0.358669  2.290000     0.734   1415.8173  ...     0.000002     0.032186   
35  0.625743  1.180078     0.848   1402.8147  ...     0.000008     0.046114   
36 -0.160484  2.370000     0.979    652.7841  ...     0.000004     0.039788   
37  0.014221  1.162554     0.885    649.6721  ...     0.000005     0.041599   
38  0.311721  1.810000     0.751    292.9844  ...     0.000002     0.034212   
39  0.120472  2.530000     0.773    286.3840  ...     0.000002     0.036688   
40  1.809086  2.000000     0.982     20.0728  ...     0.000004     0.038300   
41  1.652183  2.050000     0.983     32.1314  ...     0.000004     0.038467   
42  0.984605  2.030000     0.983     19.2087  ...     0.000008     0.042451   
43  0.107510  2.000000     0.983     27.1362  ...     0.000005     0.039080   
44 -0.157326  2.010000     0.990     43.8276  ...     0.000004     0.039761   
45  0.112718  3.590000     0.979     43.2895  ...     0.000008     0.040898   
46 -0.368337  1.970000     0.983     37.1750  ...     0.000003     0.035328   
47 -0.009740  2.180000     0.989     22.4116  ...     0.000004     0.037193   
48  0.000527  2.610000     0.983     23.6036  ...     0.000006     0.039982   
49 -0.335072  2.450000     0.984     21.9153  ...     0.000005     0.041351   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0        559  0.118911  0.000014 -0.000010  26.4370   0.637  0.312662     30.0  
1        532 -0.078846  0.000091 -0.000065  25.7955   0.628  0.311263     30.0  
2        482 -0.039505  0.000040 -0.000027  26.2340   0.591  0.295808     30.0  
3        551 -0.060834  0.000019 -0.000013  26.3140   0.637  0.311663     30.0  
4        554  0.111495  0.000012 -0.000009  26.4340   0.635  0.311387     30.0  
5        686  0.112524  0.000008 -0.000005  26.3735   0.548  0.295619     30.0  
6        688  0.113547  0.000009 -0.000006  26.3830   0.548  0.296909     30.0  
7        693  0.119682  0.000009 -0.000006  26.3740   0.547  0.295980     30.0  
8        690  0.109313  0.000011 -0.000007  26.3670   0.548  0.296734     30.0  
9        550 -0.051821  0.000024 -0.000016  26.1960   0.560  0.294709     30.0  
10       577  0.094786  0.000011 -0.000007  26.2600   0.577  0.304712     30.0  
11       553 -0.051507  0.000030 -0.000020  26.2540   0.559  0.293812     30.0  
12       574  0.095054  0.000011 -0.000008  26.2690   0.574  0.303807     30.0  
13      1125  0.111014  0.000004 -0.000003  26.3460   0.532  0.294383     30.0  
14      1129  0.113076  0.000005 -0.000003  26.3310   0.532  0.294469     30.0  
15       688  0.108506  0.000044 -0.000030  26.5280   0.564  0.308394     30.0  
16       629  0.103035  0.000125 -0.000085  26.6050   0.585  0.304407     30.0  
17       772  0.094983  0.000006 -0.000004  26.2230   0.577  0.306697     30.0  
18       842  0.093261  0.000006 -0.000004  26.3640   0.579  0.307381     30.0  
19       771 -0.044783  0.000008 -0.000005  26.2140   0.568  0.307334     30.0  
20       844 -0.063295  0.000015 -0.000010  26.3250   0.576  0.306462     30.0  
21       840  0.098207  0.000007 -0.000005  26.3500   0.581  0.306576     30.0  
22       773  0.101686  0.000010 -0.000007  26.2050   0.578  0.306405     30.0  
23      1114  0.093204  0.000004 -0.000003  26.2205   0.535  0.295891     30.0  
24      1139  0.089529  0.000006 -0.000004  26.2530   0.535  0.296082     30.0  
25      1118  0.095604  0.000005 -0.000003  26.2040   0.536  0.296625     30.0  
26      1144  0.098196  0.000005 -0.000003  26.2290   0.536  0.297505     30.0  
27      2123  0.084233  0.000004 -0.000002  26.2860   0.513  0.177605     30.0  
28      2101  0.081978  0.000006 -0.000003  26.2710   0.512  0.178108     30.0  
29      2112  0.083244  0.000004 -0.000002  26.2860   0.512  0.177587     30.0  
30      2116  0.078882  0.000004 -0.000002  26.3220   0.512  0.178934     30.0  
31      2117 -0.047450  0.000005 -0.000003  26.1370   0.512  0.180560     30.0  
32      2105  0.081623  0.000004 -0.000002  26.2570   0.512  0.179316     30.0  
33       555  0.101469  0.000016 -0.000011  26.3110   0.671  0.309351     30.0  
34      1302  0.098686  0.000004 -0.000003  26.3530   0.585  0.262155     30.0  
35      1302  0.103934  0.000016 -0.000011  26.2570   0.582  0.261369     30.0  
36       799  0.105706  0.000007 -0.000005  26.3340   0.620  0.306738     30.0  
37       799  0.111071  0.000008 -0.000005  26.3320   0.621  0.306478     30.0  
38      1628  0.097656  0.000003 -0.000002  26.3150   0.575  0.280158     30.0  
39      1622  0.103394  0.000004 -0.000003  26.2860   0.575  0.279655     30.0  
40       757  0.104486  0.000008 -0.000005  26.3810   0.571  0.297031     30.0  
41       762  0.103478  0.000008 -0.000005  26.4320   0.572  0.296114     30.0  
42       742  0.095205  0.000015 -0.000010  26.4090   0.572  0.297005     30.0  
43       754  0.104042  0.000009 -0.000006  26.3650   0.571  0.295796     30.0  
44       758  0.108359  0.000008 -0.000006  26.3870   0.571  0.296340     30.0  
45       758 -0.087982  0.000014 -0.000010  26.2900   0.569  0.299155     30.0  
46       758  0.097026  0.000006 -0.000004  26.4485   0.572  0.296489     30.0  
47       757  0.103151  0.000007 -0.000005  26.4680   0.572  0.296251     30.0  
48       754 -0.099698  0.000011 -0.000007  26.3370   0.571  0.296018     30.0  
49       758  0.112692  0.000009 -0.000006  26.4700   0.574  0.296231     30.0  

[50 rows x 32 columns]]",,9.688266515731812,2025-07-25T10:40:10,0.01483679525222552,0.1,1.0,1.0,0.0,1.0
0.20.2,,,92,0,"SELECT
    oid, classifier_version, class_name, probability
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking = 1
    AND oid in
(
SELECT
    oid
FROM
    magstat
WHERE
    fid = 1
    AND ndet >= 10
    AND ndubious = 0
ORDER BY oid
LIMIT 500
)
",,,,,"[              oid     classifier_version      class_name  probability
0    ZTF17aaaaaxb  hierarchical_rf_1.1.0  Periodic-Other     0.402136
1    ZTF17aaaaaxb   lc_classifier_1.1.13  Periodic-Other     0.307064
2    ZTF17aaaadiz  hierarchical_rf_1.1.0               E     0.282672
3    ZTF17aaaadiz   lc_classifier_1.1.13  Periodic-Other     0.258560
4    ZTF17aaaadyg  hierarchical_rf_1.1.0  Periodic-Other     0.553136
..            ...                    ...             ...          ...
941  ZTF17aaaaaas   lc_classifier_1.1.13  Periodic-Other     0.254528
942  ZTF17aaaaegw  hierarchical_rf_1.1.0             YSO     0.717024
943  ZTF17aaaaegw   lc_classifier_1.1.13             YSO     0.604632
944  ZTF17aaaabel  hierarchical_rf_1.1.0               E     0.371840
945  ZTF17aaaabel   lc_classifier_1.1.13  Periodic-Other     0.439200

[946 rows x 4 columns]]",,4.464001178741455,2025-07-25T10:40:15,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,92,1,"-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1-- for the light curve classifier.SELECT     p.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     probability p-- Join with a subquery to filter objects with at least 10 detections in the g band and no dubious correctionsINNER JOIN (    SELECT         d.oid    FROM         detection d    WHERE         d.fid = 1 -- g band        AND d.dubious = FALSE -- no dubious corrections    GROUP BY         d.oid    HAVING         COUNT(d.oid) >= 10 -- at least 10 detections) filtered_objects ON p.oid = filtered_objects.oidWHERE     p.ranking = 1 -- only the most likely classification    AND p.classifier_name = 'lc_classifier' -- light curve classifierORDER BY     p.oid ASC -- order by ZTF identifierLIMIT 500 -- limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,23.453742027282715,2025-07-23T19:11:58,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query
-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,
-- no dubious corrections in that filter, and classification probabilities with ranking 1
-- for the light curve classifier.

SELECT 
    p.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    probability p
-- Join with a subquery to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- no dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(d.oid) >= 10 -- at least 10 detections
) filtered_objects 
ON 
    p.oid = filtered_objects.oid
WHERE 
    p.ranking = 1 -- only the most likely classification
    AND p.classifier_name = 'lc_classifier' -- light curve classifier
ORDER BY 
    p.oid ASC -- order by ZTF identifier
LIMIT 500 -- limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.38462853431702,2025-07-25T10:42:30,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,2,"-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.SELECT     o.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     object o-- Join with a subquery to filter detections in the g band with no dubious correctionsINNER JOIN (    SELECT         d.oid    FROM         detection d    WHERE         d.fid = 1 -- g band        AND d.dubious = FALSE    GROUP BY         d.oid    HAVING         COUNT(d.oid) >= 10 -- At least 10 detections) d_filtered ON o.oid = d_filtered.oid-- Join with the probability table to filter by ranking and classifierINNER JOIN probability p ON o.oid = p.oidWHERE     p.ranking = 1 -- Only the most likely class    AND p.classifier_name = 'lc_classifier' -- Light curve classifierORDER BY     o.oid ASC -- Order by ZTF identifierLIMIT 500 -- Limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,27.30911874771118,2025-07-23T19:12:25,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,
-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.

SELECT 
    o.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with a subquery to filter detections in the g band with no dubious corrections
INNER JOIN (
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- No dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(d.oid) >= 10 -- At least 10 detections
) d_filtered ON o.oid = d_filtered.oid
-- Join with the probability table to filter by ranking and classifier
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only the most likely class
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid ASC -- Order by ZTF identifier
LIMIT 500 -- Limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.6729028224945,2025-07-25T10:44:45,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,3,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.WITH filtered_detections AS (    -- Subquery to filter objects with at least 10 detections in the g band and no dubious corrections    SELECT        oid    FROM        detection    WHERE        fid = 1 -- g band        AND dubious = FALSE    GROUP BY        oid    HAVING        COUNT(*) >= 10),filtered_probabilities AS (    -- Subquery to filter classification probabilities with ranking 1 for the light curve classifier    SELECT        oid,        classifier_version,        class_name,        probability    FROM        probability    WHERE        ranking = 1        AND classifier_name = 'lc_classifier')-- Combine the filtered detections and probabilities, and limit the results to 500 rowsSELECT    p.oid,    p.classifier_version,    p.class_name,    p.probabilityFROM    filtered_detections dINNER JOIN    filtered_probabilities pON    d.oid = p.oidORDER BY    p.oid ASCLIMIT 500","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,21.42437148094177,2025-07-23T19:12:47,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,
-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.

WITH filtered_detections AS (
    -- Subquery to filter objects with at least 10 detections in the g band and no dubious corrections
    SELECT
        oid
    FROM
        detection
    WHERE
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY
        oid
    HAVING
        COUNT(*) >= 10
),
filtered_probabilities AS (
    -- Subquery to filter classification probabilities with ranking 1 for the light curve classifier
    SELECT
        oid,
        classifier_version,
        class_name,
        probability
    FROM
        probability
    WHERE
        ranking = 1
        AND classifier_name = 'lc_classifier'
)
-- Combine the filtered detections and probabilities, and limit the results to 500 rows
SELECT
    p.oid,
    p.classifier_version,
    p.class_name,
    p.probability
FROM
    filtered_detections d
INNER JOIN
    filtered_probabilities p
ON
    d.oid = p.oid
ORDER BY
    p.oid ASC
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.03166675567627,2025-07-25T10:46:59,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,4,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.WITH filtered_objects AS (    -- Step 1: Filter objects with at least 10 detections in the g band and no dubious corrections    SELECT        d.oid    FROM        detection d    WHERE        d.fid = 1 -- g band        AND d.dubious = FALSE -- no dubious corrections    GROUP BY        d.oid    HAVING        COUNT(*) >= 10 -- at least 10 detections),classified_objects AS (    -- Step 2: Retrieve classification information for objects with ranking 1 and lc_classifier    SELECT        p.oid,        p.class_name,        p.classifier_version,        p.probability    FROM        probability p    WHERE        p.ranking = 1 -- most likely classification        AND p.classifier_name = 'lc_classifier' -- light curve classifier)-- Step 3: Join filtered objects with classification information and limit resultsSELECT    fo.oid AS ztf_identifier,    co.classifier_version,    co.class_name,    co.probabilityFROM    filtered_objects foINNER JOIN    classified_objects coON    fo.oid = co.oidORDER BY    fo.oid ASC -- order by oidLIMIT 500 -- limit to 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,21.43982100486756,2025-07-23T19:13:08,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,
-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.

WITH filtered_objects AS (
    -- Step 1: Filter objects with at least 10 detections in the g band and no dubious corrections
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- no dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(*) >= 10 -- at least 10 detections
),
classified_objects AS (
    -- Step 2: Retrieve classification information for objects with ranking 1 and lc_classifier
    SELECT 
        p.oid, 
        p.class_name, 
        p.classifier_version, 
        p.probability
    FROM 
        probability p
    WHERE 
        p.ranking = 1 -- most likely classification
        AND p.classifier_name = 'lc_classifier' -- light curve classifier
)
-- Step 3: Join filtered objects with classification information and limit results
SELECT 
    fo.oid AS ztf_identifier, 
    co.classifier_version, 
    co.class_name, 
    co.probability
FROM 
    filtered_objects fo
INNER JOIN 
    classified_objects co
ON 
    fo.oid = co.oid
ORDER BY 
    fo.oid ASC -- order by oid
LIMIT 500 -- limit to 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.0261745452881,2025-07-25T10:49:14,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,5,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.SELECT     p.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     probability p-- Join with a subquery to filter objects with at least 10 detections in the g band and no dubious correctionsINNER JOIN (    SELECT         d.oid    FROM         detection d    WHERE         d.fid = 1 -- g band        AND d.dubious = FALSE -- no dubious corrections    GROUP BY         d.oid    HAVING         COUNT(*) >= 10 -- at least 10 detections) AS filtered_objectsON     p.oid = filtered_objects.oidWHERE     p.ranking = 1 -- only include probabilities with ranking 1    AND p.classifier_name = 'lc_classifier' -- light curve classifierORDER BY     p.oid ASC -- order by oidLIMIT 500 -- limit to 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,22.400028944015503,2025-07-23T19:13:31,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,
-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.

SELECT 
    p.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    probability p
-- Join with a subquery to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- no dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(*) >= 10 -- at least 10 detections
) AS filtered_objects
ON 
    p.oid = filtered_objects.oid
WHERE 
    p.ranking = 1 -- only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- light curve classifier
ORDER BY 
    p.oid ASC -- order by oid
LIMIT 500 -- limit to 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.80331325531006,2025-07-25T10:51:30,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,6,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.WITH filtered_detections AS (    SELECT        oid    FROM        detection    WHERE        fid = 1 -- g band        AND dubious = FALSE -- no dubious corrections    GROUP BY        oid    HAVING        COUNT(*) >= 10 -- at least 10 detections),filtered_objects AS (    SELECT        o.oid    FROM        object o    INNER JOIN        filtered_detections fd ON o.oid = fd.oid),final_results AS (    SELECT        po.oid,        po.classifier_version,        po.class_name,        po.probability    FROM        probability po    INNER JOIN        filtered_objects fo ON po.oid = fo.oid    WHERE        po.ranking = 1 -- only the most likely classification        AND po.classifier_name = 'lc_classifier' -- light curve classifier)SELECT    oid,    classifier_version,    class_name,    probabilityFROM    final_resultsORDER BY    oid ASCLIMIT 500","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,32.38863587379456,2025-07-23T19:14:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,
-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.

WITH filtered_detections AS (
    SELECT
        oid
    FROM
        detection
    WHERE
        fid = 1 -- g band
        AND dubious = FALSE -- no dubious corrections
    GROUP BY
        oid
    HAVING
        COUNT(*) >= 10 -- at least 10 detections
),
filtered_objects AS (
    SELECT
        o.oid
    FROM
        object o
    INNER JOIN
        filtered_detections fd ON o.oid = fd.oid
),
final_results AS (
    SELECT
        po.oid,
        po.classifier_version,
        po.class_name,
        po.probability
    FROM
        probability po
    INNER JOIN
        filtered_objects fo ON po.oid = fo.oid
    WHERE
        po.ranking = 1 -- only the most likely classification
        AND po.classifier_name = 'lc_classifier' -- light curve classifier
)
SELECT
    oid,
    classifier_version,
    class_name,
    probability
FROM
    final_results
ORDER BY
    oid ASC -- Corrected syntax for ordering
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.82652521133423,2025-07-25T10:53:46,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,7,"-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.SELECT     o.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     object o-- Join with detection table to filter objects with at least 10 detections in g band and no dubious correctionsINNER JOIN (    SELECT DISTINCT oid    FROM detection    WHERE fid = 1 -- g band      AND dubious = FALSE -- no dubious corrections) d ON o.oid = d.oid-- Join with probability table to filter probabilities with ranking 1 for the light curve classifierINNER JOIN probability p ON o.oid = p.oidWHERE     o.ndet >= 10 -- at least 10 detections    AND p.ranking = 1 -- only the most likely class    AND p.classifier_name = 'lc_classifier' -- light curve classifierORDER BY     o.oid ASC -- order by ZTF identifierLIMIT 500 -- limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,19.0737042427063,2025-07-23T19:14:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,
-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.

SELECT 
    o.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with detection table to filter objects with at least 10 detections in g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE -- no dubious corrections
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10 -- at least 10 detections in g band
) d ON o.oid = d.oid
-- Join with probability table to filter probabilities with ranking 1 for the light curve classifier
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- only the most likely class
    AND p.classifier_name = 'lc_classifier' -- light curve classifier
ORDER BY 
    o.oid ASC -- order by ZTF identifier
LIMIT 500 -- limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.07328510284424,2025-07-25T10:56:02,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,8,"-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1-- for the light curve classifier.SELECT     o.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     object o-- Join with the detection table to filter detections in the g band and exclude dubious onesINNER JOIN (    SELECT DISTINCT oid    FROM detection    WHERE fid = 1 -- g band      AND dubious = FALSE) d ON o.oid = d.oid-- Join with the probability table to get classification informationINNER JOIN probability p ON o.oid = p.oidWHERE     o.ndet >= 10 -- At least 10 detections    AND p.ranking = 1 -- Only the most likely classification    AND p.classifier_name = 'lc_classifier' -- Light curve classifierORDER BY     o.oid ASC -- Order by ZTF identifierLIMIT 500 -- Limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,23.353625059127808,2025-07-23T19:14:46,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,
-- no dubious corrections in that filter, and classification probabilities with ranking 1
-- for the light curve classifier.

SELECT 
    o.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter detections in the g band and exclude dubious ones
INNER JOIN (
    SELECT 
        oid 
    FROM 
        detection 
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE -- Exclude dubious corrections
    GROUP BY 
        oid -- Ensure unique oids
    HAVING 
        COUNT(*) >= 10 -- At least 10 detections in the g band
) d ON o.oid = d.oid
-- Join with the probability table to get classification information
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only the most likely classification
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid ASC -- Order by ZTF identifier
LIMIT 500 -- Limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",135.18652272224426,2025-07-25T10:58:22,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,9,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.WITH filtered_detections AS (    -- Subquery 1: Filter detections in the g band (fid = 1) with no dubious corrections and count detections per object    SELECT        oid    FROM        detection    WHERE        fid = 1 -- g band        AND dubious = FALSE    GROUP BY        oid    HAVING        COUNT(*) >= 10 -- At least 10 detections),filtered_probabilities AS (    -- Subquery 2: Filter probabilities with ranking = 1 and classifier_name = 'lc_classifier'    SELECT        oid,        classifier_version,        class_name,        probability    FROM        probability    WHERE        ranking = 1        AND classifier_name = 'lc_classifier')-- Final query: Join filtered detections, probabilities, and objects, and apply sorting and limitingSELECT    o.oid AS ztf_identifier,    p.classifier_version,    p.class_name,    p.probabilityFROM    object oINNER JOIN    filtered_detections d ON o.oid = d.oidINNER JOIN    filtered_probabilities p ON o.oid = p.oidORDER BY    o.oid ASCLIMIT 500","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,24.88426351547241,2025-07-23T19:15:11,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
WITH filtered_detections AS (
    -- Subquery 1: Filter detections in the g band (fid = 1) with no dubious corrections and count detections per object
    SELECT
        oid
    FROM
        detection
    WHERE
        fid = 1 -- g band
        AND dubious = FALSE -- No dubious corrections
    GROUP BY
        oid
    HAVING
        COUNT(*) >= 10 -- At least 10 detections
),
filtered_probabilities AS (
    -- Subquery 2: Filter probabilities with ranking = 1 and classifier_name = 'lc_classifier'
    SELECT
        oid,
        classifier_version,
        class_name,
        probability
    FROM
        probability
    WHERE
        ranking = 1 -- Only the most likely probabilities
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Final query: Join filtered detections, probabilities, and objects, and apply sorting and limiting
SELECT
    o.oid AS ztf_identifier,
    p.classifier_version,
    p.class_name,
    p.probability
FROM
    object o
INNER JOIN
    filtered_detections d ON o.oid = d.oid -- Join with filtered detections
INNER JOIN
    filtered_probabilities p ON o.oid = p.oid -- Join with filtered probabilities
ORDER BY
    o.oid ASC -- Order by object identifier
LIMIT 500 -- Limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.87051677703857,2025-07-25T11:00:38,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,10,"-- Retrieve at most 500 ZTF objects with at least 10 detections in the g band (fid = 1),-- no dubious corrections, and classification probabilities with ranking = 1 for the light curve classifier.SELECT     o.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     object o-- Join with a subquery that filters detections in the g band (fid = 1) with no dubious corrections-- and counts the number of such detections per object.INNER JOIN (    SELECT         d.oid    FROM         detection d    WHERE         d.fid = 1 -- g band        AND d.dubious = FALSE -- no dubious corrections    GROUP BY         d.oid    HAVING         COUNT(*) >= 10 -- at least 10 detections) d_filtered ON o.oid = d_filtered.oid-- Join with the probability table to get classification informationINNER JOIN probability p ON o.oid = p.oidWHERE     p.ranking = 1 -- only the most likely classification    AND p.classifier_name = 'lc_classifier' -- light curve classifierORDER BY     o.oid ASC -- order by ZTF identifierLIMIT 500 -- limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,25.414546251297,2025-07-23T19:15:36,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
-- Retrieve at most 500 ZTF objects with at least 10 detections in the g band (fid = 1),
-- no dubious corrections, and classification probabilities with ranking = 1 for the light curve classifier.

SELECT 
    o.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with a subquery that filters detections in the g band (fid = 1) with no dubious corrections
-- and counts the number of such detections per object.
INNER JOIN (
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- no dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(*) >= 10 -- at least 10 detections
) d_filtered ON o.oid = d_filtered.oid
-- Join with the probability table to get classification information
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- only the most likely classification
    AND p.classifier_name = 'lc_classifier' -- light curve classifier
ORDER BY 
    o.oid ASC -- order by ZTF identifier
LIMIT 500 -- limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.40694880485535,2025-07-25T11:02:56,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,83,0,"SELECT
    *
FROM
    allwise
WHERE
    oid_catalog in
(
SELECT
    oid_catalog
FROM
    xmatch
WHERE
    oid = 'ZTF21aazqwxv'
)",,,,,"[           oid_catalog          ra       dec  w1mpro  w2mpro  w3mpro  w4mpro  \
0  J131116.64+045854.7  197.819368  4.981863  13.319  13.129   9.839   7.761   

   w1sigmpro  w2sigmpro  w3sigmpro  w4sigmpro  j_m_2mass  h_m_2mass  \
0      0.033      0.037      0.056      0.247     15.331     14.491   

   k_m_2mass  j_msig_2mass  h_msig_2mass  k_msig_2mass  
0     14.027         0.109           0.1           0.1  ]",,4.169222831726074,2025-07-25T11:03:00,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,83,1,-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE oid_catalog = (    SELECT oid    FROM object    WHERE oid = 'ZTF21aazqwxv'),"['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.0954394340515137,2025-07-23T19:41:16,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE oid_catalog = (
    SELECT oid_catalog
    FROM object
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",147.4987826347351,2025-07-25T11:05:32,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,2,"-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 0.000277778 degrees corresponds to 1 arcsecond","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.344205379486084,2025-07-23T19:41:20,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout
CONTEXT:  SQL function ""q3c_radial_query"" statement 1

[SQL: 
-- Corrected Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_radial_query(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.98051619529724,2025-07-25T11:07:50,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,3,"-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 1 arcsecond radius in degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.332351922988892,2025-07-23T19:41:24,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout
CONTEXT:  SQL function ""q3c_join"" statement 1

[SQL: 
-- Corrected Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_join(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778 -- 1 arcsecond radius in degrees
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",137.9480972290039,2025-07-25T11:10:12,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,4,"-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 1 arcsecond radius in degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.4931681156158447,2025-07-23T19:41:28,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout
CONTEXT:  SQL function ""q3c_join"" statement 1

[SQL: 
-- Corrected Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_join(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778 -- 1 arcsecond radius in degrees
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",128.46476244926453,2025-07-25T11:12:24,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,5,-- Retrieve all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT allwise.*FROM objectINNER JOIN allwise ON object.oid = allwise.oid_catalogWHERE object.oid = 'ZTF21aazqwxv',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,29.47672867774964,2025-07-23T19:41:57,"[Empty DataFrame
Columns: [oid_catalog, ra, dec, w1mpro, w2mpro, w3mpro, w4mpro, w1sigmpro, w2sigmpro, w3sigmpro, w4sigmpro, j_m_2mass, h_m_2mass, k_m_2mass, j_msig_2mass, h_msig_2mass, k_msig_2mass]
Index: []]",,9.440690755844116,2025-07-25T11:12:37,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,83,6,-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE oid_catalog IN (    SELECT oid    FROM object    WHERE oid = 'ZTF21aazqwxv'),"['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.88637375831604,2025-07-23T19:42:00,"[Empty DataFrame
Columns: [oid_catalog, ra, dec, w1mpro, w2mpro, w3mpro, w4mpro, w1sigmpro, w2sigmpro, w3sigmpro, w4sigmpro, j_m_2mass, h_m_2mass, k_m_2mass, j_msig_2mass, h_msig_2mass, k_msig_2mass]
Index: []]",,7.992586135864258,2025-07-25T11:12:49,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,83,7,"-- Query to get all columns in the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 0.000277778 degrees = 1 arcsecond","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.013084888458252,2025-07-23T19:42:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout
CONTEXT:  SQL function ""q3c_radial_query"" statement 1

[SQL: 
-- Corrected Query to get all columns in the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_radial_query(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778 -- 0.000277778 degrees = 1 arcsecond
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",128.68493556976318,2025-07-25T11:15:02,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,8,"-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 0.000277778 degrees = 1 arcsecond","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.083969116210937,2025-07-23T19:42:06,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout
CONTEXT:  SQL function ""q3c_join"" statement 1

[SQL: 
-- Corrected Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_join(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778 -- 0.000277778 degrees = 1 arcsecond
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",128.0389907360077,2025-07-25T11:17:14,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,9,-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE oid_catalog = (    SELECT oid    FROM object    WHERE oid = 'ZTF21aazqwxv'),"['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.5708096027374268,2025-07-23T19:42:09,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE oid_catalog = (
    SELECT oid_catalog
    FROM object
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.8926284313202,2025-07-25T11:19:31,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,10,-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE oid_catalog IN (    SELECT oid    FROM object    WHERE oid = 'ZTF21aazqwxv'),"['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.003185272216797,2025-07-23T19:42:12,"[Empty DataFrame
Columns: [oid_catalog, ra, dec, w1mpro, w2mpro, w3mpro, w4mpro, w1sigmpro, w2sigmpro, w3sigmpro, w4sigmpro, j_m_2mass, h_m_2mass, k_m_2mass, j_msig_2mass, h_msig_2mass, k_msig_2mass]
Index: []]",,8.023988962173462,2025-07-25T11:19:43,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,84,0,"SELECT
    oid, xmatch.oid_catalog, dist,
    w1mpro, w2mpro, w3mpro, w4mpro
FROM
    xmatch INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    xmatch.oid = 'ZTF19aascdol'",,,,,"[            oid          oid_catalog      dist  w1mpro  w2mpro  w3mpro  w4mpro
0  ZTF19aascdol  J154334.93+152539.5  0.000043  15.286  14.354  11.747   8.611]",,3.116166591644287,2025-07-25T11:19:46,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,84,1,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_object_id, -- ALLWISE object identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Distance between counterparts    a.w1mpro AS w1_magnitude, -- WISE W1 magnitude    a.w2mpro AS w2_magnitude, -- WISE W2 magnitude    a.w3mpro AS w3_magnitude, -- WISE W3 magnitude    a.w4mpro AS w4_magnitude -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_radial_query(o.meanra, o.meandec, a.ra, a.dec, 0.00138889) -- Match within 5 arcsecondsWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by distance to prioritize closest matches","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,28.604894876480103,2025-07-23T19:42:41,"[  ztf_object_id    allwise_object_id  angular_distance  w1_magnitude  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038        15.286   

   w2_magnitude  w3_magnitude  w4_magnitude  
0        14.354        11.747         8.611  ]",,15.35548210144043,2025-07-25T11:20:05,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,2,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     object.oid AS ztf_identifier, -- ZTF object identifier    allwise.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier    q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) AS distance, -- Angular distance between counterparts    allwise.w1mpro, -- WISE W1 magnitude    allwise.w2mpro, -- WISE W2 magnitude    allwise.w3mpro, -- WISE W3 magnitude    allwise.w4mpro  -- WISE W4 magnitudeFROM     objectINNER JOIN     allwiseON     q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 0.00138889) -- Match within 5 arcseconds (0.00138889 degrees)WHERE     object.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,19.75937795639038,2025-07-23T19:43:01,"[            oid   allwise_identifier  distance  w1mpro  w2mpro  w3mpro  w4mpro
0  ZTF19aascdol  J154334.93+152539.5  0.000038  15.286  14.354  11.747   8.611]",,14.225684642791748,2025-07-25T11:20:23,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,3,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_object_id, -- ALLWISE object identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro AS w1_magnitude, -- WISE W1 magnitude    a.w2mpro AS w2_magnitude, -- WISE W2 magnitude    a.w3mpro AS w3_magnitude, -- WISE W3 magnitude    a.w4mpro AS w4_magnitude -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_radial_query(o.meanra, o.meandec, a.ra, a.dec, 0.00139) -- Match within 5 arcseconds (0.00139 degrees)WHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,27.88888931274414,2025-07-23T19:43:29,"[  ztf_object_id    allwise_object_id  angular_distance  w1_magnitude  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038        15.286   

   w2_magnitude  w3_magnitude  w4_magnitude  
0        14.354        11.747         8.611  ]",,13.155896186828613,2025-07-25T11:20:40,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,4,"-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_identifier, -- ZTF object identifier    a.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro AS w1_magnitude, -- WISE W1 magnitude    a.w2mpro AS w2_magnitude, -- WISE W2 magnitude    a.w3mpro AS w3_magnitude, -- WISE W3 magnitude    a.w4mpro AS w4_magnitude -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_radial_query(o.meanra, o.meandec, a.ra, a.dec, 0.00027778) -- Spatial match within 1 arcsecondWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,22.05002927780152,2025-07-23T19:43:51,"[            oid   allwise_identifier  angular_distance  w1_magnitude  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038        15.286   

   w2_magnitude  w3_magnitude  w4_magnitude  
0        14.354        11.747         8.611  ]",,14.046863079071045,2025-07-25T11:20:58,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,5,"-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_identifier, -- ZTF object identifier    a.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Distance between counterparts    a.w1mpro AS w1_magnitude, -- WISE W1 magnitude    a.w2mpro AS w2_magnitude, -- WISE W2 magnitude    a.w3mpro AS w3_magnitude, -- WISE W3 magnitude    a.w4mpro AS w4_magnitude -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 1.0 / 3600.0) -- Spatial join with a 1 arcsecond radiusWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,23.00326776504517,2025-07-23T19:44:14,"[            oid   allwise_identifier  angular_distance  w1_magnitude  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038        15.286   

   w2_magnitude  w3_magnitude  w4_magnitude  
0        14.354        11.747         8.611  ]",,12.762193202972412,2025-07-25T11:21:14,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,6,"-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)-- Includes ZTF identifier, ALLWISE catalog identifier, angular distance, and WISE magnitudes (W1 to W4)SELECT     object.oid AS ztf_oid, -- ZTF object identifier    allwise.oid_catalog AS allwise_oid, -- ALLWISE catalog identifier    q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) AS angular_distance, -- Angular distance between counterparts    allwise.w1mpro, -- WISE W1 magnitude    allwise.w2mpro, -- WISE W2 magnitude    allwise.w3mpro, -- WISE W3 magnitude    allwise.w4mpro  -- WISE W4 magnitudeFROM     objectINNER JOIN     allwiseON     q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 5.0 / 3600.0) -- Match within 5 arcsecondsWHERE     object.oid = 'ZTF19aascdol' -- Filter for the specific ZTF object","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,27.719233989715576,2025-07-23T19:44:42,"[            oid          allwise_oid  angular_distance  w1mpro  w2mpro  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038  15.286  14.354   

   w3mpro  w4mpro  
0  11.747   8.611  ]",,12.428690671920776,2025-07-25T11:21:30,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,7,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_catalog_id, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro, -- WISE W1 magnitude    a.w2mpro, -- WISE W2 magnitude    a.w3mpro, -- WISE W3 magnitude    a.w4mpro  -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.00027778) -- Match within 1 arcsecond (0.00027778 degrees)WHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,20.34419798851013,2025-07-23T19:45:02,"[  ztf_object_id   allwise_catalog_id  angular_distance  w1mpro  w2mpro  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038  15.286  14.354   

   w3mpro  w4mpro  
0  11.747   8.611  ]",,11.724035024642944,2025-07-25T11:21:45,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,8,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)-- including identifiers, angular distance, and WISE magnitudes (W1 to W4)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_catalog_id, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro, -- WISE W1 magnitude    a.w2mpro, -- WISE W2 magnitude    a.w3mpro, -- WISE W3 magnitude    a.w4mpro  -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.00138889) -- Match within 5 arcseconds (0.00138889 degrees)WHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,21.121541261672974,2025-07-23T19:45:23,"[  ztf_object_id   allwise_catalog_id  angular_distance  w1mpro  w2mpro  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038  15.286  14.354   

   w3mpro  w4mpro  
0  11.747   8.611  ]",,12.93306589126587,2025-07-25T11:22:02,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,9,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)-- including identifiers, angular distance, and WISE magnitudes (W1 to W4)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_catalog_id, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro, -- WISE W1 magnitude    a.w2mpro, -- WISE W2 magnitude    a.w3mpro, -- WISE W3 magnitude    a.w4mpro  -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 5.0 / 3600.0) -- Match within 5 arcsecondsWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,23.788135766983032,2025-07-23T19:45:47,"[  ztf_object_id   allwise_catalog_id  angular_distance  w1mpro  w2mpro  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038  15.286  14.354   

   w3mpro  w4mpro  
0  11.747   8.611  ]",,12.273735761642456,2025-07-25T11:22:18,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,10,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_oid, -- ZTF object identifier    a.oid_catalog AS allwise_oid, -- ALLWISE object identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS distance_arcsec, -- Angular distance in arcseconds    a.w1mpro, -- WISE W1 magnitude    a.w2mpro, -- WISE W2 magnitude    a.w3mpro, -- WISE W3 magnitude    a.w4mpro  -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 5.0 / 3600.0) -- Match within 5 arcsecondsWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     distance_arcsec ASC -- Sort by distance in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,23.76579523086548,2025-07-23T19:46:11,"[            oid          allwise_oid  distance_arcsec  w1mpro  w2mpro  w3mpro  \
0  ZTF19aascdol  J154334.93+152539.5         0.000038  15.286  14.354  11.747   

   w4mpro  
0   8.611  ]",,12.896109819412231,2025-07-25T11:22:34,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,,,96,0,"SELECT
    ss_ztf.*, detection.mjd, detection.fid,
    detection.isdiffpos, detection.ra, detection.dec,
    detection.magpsf, detection.sigmapsf
FROM
    ss_ztf INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ssnamenr IN ('2003FP134','2009UK56')
    AND ssdistnr < 2
ORDER BY ssnamenr, mjd",,,,,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,27.075018882751465,2025-07-25T11:23:01,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,96,1,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Define the Solar System objects and their coordinates    SELECT '2003FP134' AS ssnamenr, 123.456 AS ra, -12.345 AS dec    UNION ALL    SELECT '2009UK56', 234.567, -23.456)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd, -- Detection date    detection.fid, -- Filter identifier    detection.isdiffpos, -- Is difference positive flag    detection.ra, -- Right Ascension    detection.dec, -- Declination    detection.magpsf, -- Difference magnitude    detection.sigmapsf -- Uncertainty in difference magnitudeFROM     ss_ztfINNER JOIN     detection ON ss_ztf.candid = detection.candid -- Join ss_ztf and detection tables on candidINNER JOIN     catalog ON ss_ztf.ssnamenr = catalog.ssnamenr -- Match Solar System object namesWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objects    AND ss_ztf.ssdistnr <= 2 / 3600.0 -- Ensure distance is within 2 arcseconds    AND q3c_radial_query(detection.ra, detection.dec, catalog.ra, catalog.dec, 2 / 3600.0) -- Spatial filtering using Q3CORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Then sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,30.67071843147278,2025-07-23T19:46:42,[None],"(psycopg2.errors.UndefinedColumn) column ss_ztf.ra does not exist
LINE 27:     AND q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, ...
                                  ^

[SQL: 
-- Corrected Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH catalog AS (
    -- Define the Solar System objects and their coordinates
    SELECT '2003FP134' AS ssnamenr, 123.456 AS ra, -12.345 AS dec
    UNION ALL
    SELECT '2009UK56', 234.567, -23.456
)
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd, -- Detection date
    detection.fid, -- Filter identifier
    detection.isdiffpos, -- Is difference positive flag
    detection.ra, -- Right Ascension
    detection.dec, -- Declination
    detection.magpsf, -- Difference magnitude
    detection.sigmapsf -- Uncertainty in difference magnitude
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid -- Join ss_ztf and detection tables on candid
INNER JOIN 
    catalog ON ss_ztf.ssnamenr = catalog.ssnamenr -- Match Solar System object names
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objects
    AND ss_ztf.ssdistnr <= 2 / 3600.0 -- Ensure distance is within 2 arcseconds
    AND q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 2 / 3600.0) -- Spatial filtering using Q3C
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Then sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.240652084350586,2025-07-25T11:23:18,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,2,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog (ssnamenr, ra, dec) AS (    VALUES         ('2003FP134', <ra_value1>, <dec_value1>), -- Replace <ra_value1> and <dec_value1> with actual RA/Dec values        ('2009UK56', <ra_value2>, <dec_value2>)  -- Replace <ra_value2> and <dec_value2> with actual RA/Dec values),filtered_detections AS (    SELECT         d.*    FROM         detection d    INNER JOIN catalog c        ON q3c_radial_query(d.ra, d.dec, c.ra, c.dec, 0.0005556) -- 2 arcseconds in degrees),filtered_ss_ztf AS (    SELECT         s.*    FROM         ss_ztf s    WHERE         s.ssnamenr IN ('2003FP134', '2009UK56'))SELECT     s.*,     d.mjd,     d.fid,     d.isdiffpos,     d.ra,     d.dec,     d.magpsf,     d.sigmapsfFROM     filtered_ss_ztf sINNER JOIN     filtered_detections d    ON s.oid = d.oidORDER BY     s.ssnamenr ASC,     d.mjd ASC","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.83741450309753,2025-07-23T19:47:07,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""<""
LINE 5:         ('2003FP134', <ra_value1>, <dec_value1>), -- Replace...
                              ^

[SQL: 
-- Corrected Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH catalog (ssnamenr, ra, dec) AS (
    VALUES 
        ('2003FP134', <ra_value1>, <dec_value1>), -- Replace <ra_value1> and <dec_value1> with actual RA/Dec values
        ('2009UK56', <ra_value2>, <dec_value2>)  -- Replace <ra_value2> and <dec_value2> with actual RA/Dec values
),
filtered_detections AS (
    SELECT 
        d.*
    FROM 
        detection d
    INNER JOIN 
        catalog c
    ON 
        q3c_radial_query(d.ra, d.dec, c.ra, c.dec, 0.0005556) -- 2 arcseconds in degrees
),
filtered_ss_ztf AS (
    SELECT 
        s.*
    FROM 
        ss_ztf s
    WHERE 
        s.ssnamenr IN ('2003FP134', '2009UK56')
)
SELECT 
    s.*, 
    d.mjd, 
    d.fid, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf
FROM 
    filtered_ss_ztf s
INNER JOIN 
    filtered_detections d
ON 
    s.candid = d.candid -- Corrected join condition to use 'candid' as the common key
ORDER BY 
    s.ssnamenr ASC, 
    d.mjd ASC
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.853455305099487,2025-07-25T11:23:36,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,3,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Define the Solar System identifiers and their coordinates    VALUES        ('2003FP134', ra1, dec1),        ('2009UK56', ra2, dec2)    AS catalog(ssnamenr, ra, dec)),filtered_ss_ztf AS (    -- Filter objects in ss_ztf table within 2 arcseconds of the Solar System identifiers    SELECT *    FROM ss_ztf    WHERE EXISTS (        SELECT 1        FROM catalog        WHERE q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556)          AND ss_ztf.ssnamenr = catalog.ssnamenr    )),detection_data AS (    -- Join the filtered ss_ztf results with the detection table    SELECT        ss_ztf.*,        detection.mjd,        detection.fid,        detection.isdiffpos,        detection.ra,        detection.dec,        detection.magpsf,        detection.sigmapsf    FROM filtered_ss_ztf    INNER JOIN detection ON filtered_ss_ztf.oid = detection.oid)-- Final result combining and sorting the dataSELECT *FROM detection_dataORDER BY ssnamenr, mjd","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.54387331008911,2025-07-23T19:47:31,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""ss_ztf""
LINE 20:         ss_ztf.*,
                 ^

[SQL: 
-- Corrected Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH catalog AS (
    -- Define the Solar System identifiers
    SELECT 
        '2003FP134' AS ssnamenr, NULL AS ra, NULL AS dec
    UNION ALL
    SELECT 
        '2009UK56' AS ssnamenr, NULL AS ra, NULL AS dec
),
filtered_ss_ztf AS (
    -- Filter objects in ss_ztf table for the specified Solar System identifiers
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
),
detection_data AS (
    -- Join the filtered ss_ztf results with the detection table
    SELECT 
        ss_ztf.*,
        detection.mjd,
        detection.fid,
        detection.isdiffpos,
        detection.ra,
        detection.dec,
        detection.magpsf,
        detection.sigmapsf
    FROM filtered_ss_ztf
    INNER JOIN detection ON filtered_ss_ztf.candid = detection.candid
)
-- Final result combining and sorting the data
SELECT *
FROM detection_data
ORDER BY ssnamenr, mjd
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.240707159042358,2025-07-25T11:23:56,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,4,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH solar_system_objects AS (    -- Define the RA/Dec coordinates for the Solar System identifiers    SELECT DISTINCT ssnamenr, oid, candid, ssdistnr, ssmagnr    FROM ss_ztf    WHERE ssnamenr IN ('2003FP134', '2009UK56')),filtered_objects AS (    -- Perform spatial filtering using q3c_radial_query to find objects within 2 arcseconds    SELECT sso.*, d.*    FROM solar_system_objects sso    INNER JOIN detection d ON sso.candid = d.candid    WHERE q3c_radial_query(d.ra, d.dec, sso.ssdistnr, 0.0005556) -- 2 arcseconds in degrees)-- Select required columns and sort the resultsSELECT     sso.*,     d.mjd AS detection_date,     d.fid AS filter_identifier,     d.isdiffpos,     d.ra,     d.dec,     d.magpsf AS difference_magnitude,     d.sigmapsf AS magnitude_uncertaintyFROM filtered_objects ssoORDER BY sso.ssnamenr, d.mjd","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.2495596408844,2025-07-23T19:47:57,[None],"(psycopg2.errors.UndefinedFunction) function q3c_radial_query(double precision, double precision, real, numeric) does not exist
LINE 26:     WHERE q3c_radial_query(d.ra, d.dec, sso.ssdistnr, 0.0005...
                   ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: 
-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH solar_system_objects AS (
    -- Step 1: Select relevant Solar System objects based on their names
    SELECT DISTINCT ssnamenr, oid, candid, ssdistnr, ssmagnr
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
),
filtered_objects AS (
    -- Step 2: Perform spatial filtering using q3c_radial_query to find objects within 2 arcseconds
    SELECT 
        sso.oid, 
        sso.ssnamenr, 
        sso.candid, 
        sso.ssdistnr, 
        sso.ssmagnr, 
        d.mjd AS detection_date, 
        d.fid AS filter_identifier, 
        d.isdiffpos, 
        d.ra, 
        d.dec, 
        d.magpsf AS difference_magnitude, 
        d.sigmapsf AS magnitude_uncertainty
    FROM solar_system_objects sso
    INNER JOIN detection d ON sso.candid = d.candid
    WHERE q3c_radial_query(d.ra, d.dec, sso.ssdistnr, 0.0005556) -- 2 arcseconds in degrees
)
-- Step 3: Select required columns and sort the results
SELECT 
    sso.ssnamenr, 
    sso.oid, 
    sso.candid, 
    sso.ssdistnr, 
    sso.ssmagnr, 
    d.detection_date, 
    d.filter_identifier, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.difference_magnitude, 
    d.magnitude_uncertainty
FROM filtered_objects d
ORDER BY sso.ssnamenr, d.detection_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.717766523361206,2025-07-25T11:24:15,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,5,"-- Final Query to retrieve detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Temporary table containing Solar System objects of interest with their RA/Dec coordinates    VALUES        ('2003FP134', 123.456, -45.678), -- Replace with actual RA/Dec for '2003FP134'        ('2009UK56', 234.567, -12.345)  -- Replace with actual RA/Dec for '2009UK56') AS c(ssnamenr, ra, dec)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd, -- Detection date    detection.fid, -- Filter identifier    detection.isdiffpos, -- Is difference positive flag    detection.ra, -- Right Ascension    detection.dec, -- Declination    detection.magpsf, -- Difference magnitude    detection.sigmapsf -- Magnitude uncertaintyFROM ss_ztfINNER JOIN detection    ON ss_ztf.candid = detection.candid -- Join ss_ztf and detection on candidINNER JOIN catalog    ON q3c_radial_query(c.ra, c.dec, ss_ztf.ra, ss_ztf.dec, 0.0005556) -- Spatial filtering within 2 arcsecondsWHERE ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objectsORDER BY ss_ztf.ssnamenr, detection.mjd -- Sort by MPC name and detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.896572828292847,2025-07-23T19:48:20,"[Empty DataFrame
Columns: [oid, candid, ssdistnr, ssmagnr, ssnamenr, mjd, fid, isdiffpos, ra, dec, magpsf, sigmapsf]
Index: []]",,18.77896285057068,2025-07-25T11:24:41,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,96,6,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Define the Solar System objects of interest with their RA/Dec coordinates    SELECT '2003FP134' AS source_id, ra_value1 AS ra, dec_value1 AS dec    UNION ALL    SELECT '2009UK56' AS source_id, ra_value2 AS ra, dec_value2 AS dec)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd AS detection_date, -- Detection date    detection.fid AS filter_identifier, -- Filter identifier    detection.isdiffpos, -- Isdiffpos flag    detection.ra, -- RA coordinate    detection.dec, -- Dec coordinate    detection.magpsf AS difference_magnitude, -- Difference magnitude    detection.sigmapsf AS magnitude_uncertainty -- Magnitude uncertaintyFROM     ss_ztfINNER JOIN     catalog    ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcsecondsINNER JOIN     detection    ON ss_ztf.oid = detection.oid -- Join with detection table on oidWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objectsORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.099454164505005,2025-07-23T19:48:43,[None],"(psycopg2.errors.UndefinedColumn) column ss_ztf.ra does not exist
LINE 5:     SELECT '2003FP134' AS source_id, ss_ztf.ra AS ra, ss_ztf...
                                             ^

[SQL: 
-- Corrected Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH catalog AS (
    -- Define the Solar System objects of interest with their RA/Dec coordinates
    SELECT '2003FP134' AS source_id, ss_ztf.ra AS ra, ss_ztf.dec AS dec
    FROM ss_ztf
    WHERE ss_ztf.ssnamenr = '2003FP134'
    UNION ALL
    SELECT '2009UK56' AS source_id, ss_ztf.ra AS ra, ss_ztf.dec AS dec
    FROM ss_ztf
    WHERE ss_ztf.ssnamenr = '2009UK56'
)
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd AS detection_date, -- Detection date
    detection.fid AS filter_identifier, -- Filter identifier
    detection.isdiffpos, -- Isdiffpos flag
    detection.ra, -- RA coordinate
    detection.dec, -- Dec coordinate
    detection.magpsf AS difference_magnitude, -- Difference magnitude
    detection.sigmapsf AS magnitude_uncertainty -- Magnitude uncertainty
FROM 
    ss_ztf
INNER JOIN 
    catalog
    ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcseconds
INNER JOIN 
    detection
    ON ss_ztf.oid = detection.oid -- Join with detection table on oid
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objects
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.527241468429565,2025-07-25T11:25:00,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,7,"-- [FINAL QUERY HERE]SELECT     ss_ztf.*,    detection.mjd AS detection_date,    detection.fid AS filter_identifier,    detection.isdiffpos,    detection.ra,    detection.dec,    detection.magpsf AS difference_magnitude,    detection.sigmapsf AS magnitude_uncertaintyFROM     ss_ztfINNER JOIN     detection ON ss_ztf.oid = detection.oidWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')    AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra, ss_ztf.dec, 0.0005556)ORDER BY     ss_ztf.ssnamenr ASC,     detection.mjd ASC","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.67548441886902,2025-07-23T19:49:09,"[Empty DataFrame
Columns: [oid, candid, ssdistnr, ssmagnr, ssnamenr, detection_date, filter_identifier, isdiffpos, ra, dec, difference_magnitude, magnitude_uncertainty]
Index: []]",,17.35476851463318,2025-07-25T11:25:24,0.0,0.0,0.6666666666666666,0.6666666666666666,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,8,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd AS detection_date, -- Detection date    detection.fid AS filter_identifier, -- Filter identifier    detection.isdiffpos, -- Is difference positive flag    detection.ra, -- Right Ascension    detection.dec, -- Declination    detection.magpsf AS difference_magnitude, -- Difference magnitude    detection.sigmapsf AS magnitude_uncertainty -- Magnitude uncertaintyFROM     ss_ztfINNER JOIN     detectionON     ss_ztf.oid = detection.oid -- Join on object identifierWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System identifiers    AND q3c_radial_query(ss_ztf.ra, ss_ztf.dec, detection.ra, detection.dec, 2/3600.0) -- Spatial query within 2 arcsecondsORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.2930645942688,2025-07-23T19:49:34,[None],"(psycopg2.errors.UndefinedColumn) column ss_ztf.ra does not exist
LINE 20: ...AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra,...
                                                              ^

[SQL: 
-- Corrected Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd AS detection_date, -- Detection date
    detection.fid AS filter_identifier, -- Filter identifier
    detection.isdiffpos, -- Is difference positive flag
    detection.ra, -- Right Ascension
    detection.dec, -- Declination
    detection.magpsf AS difference_magnitude, -- Difference magnitude
    detection.sigmapsf AS magnitude_uncertainty -- Magnitude uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection
ON 
    ss_ztf.candid = detection.candid -- Join on candidate identifier (candid)
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System identifiers
    AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra, ss_ztf.dec, 2/3600.0) -- Spatial query within 2 arcseconds
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.495673656463623,2025-07-25T11:25:40,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,9,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Define the Solar System identifiers and their RA/Dec coordinates    VALUES        ('2003FP134', <ra_value1>, <dec_value1>), -- Replace <ra_value1> and <dec_value1> with actual RA/Dec values for 2003FP134        ('2009UK56', <ra_value2>, <dec_value2>)  -- Replace <ra_value2> and <dec_value2> with actual RA/Dec values for 2009UK56) AS catalog(source_id, ra, dec)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd, -- Detection date    detection.fid, -- Filter identifier    detection.isdiffpos, -- Difference image flag    detection.ra, -- Right ascension    detection.dec, -- Declination    detection.magpsf, -- Difference magnitude    detection.sigmapsf -- Difference magnitude uncertaintyFROM     ss_ztfINNER JOIN     detection ON ss_ztf.oid = detection.oid -- Join ss_ztf with detection table on oidINNER JOIN     catalog ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcsecondsWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter by Solar System identifiersORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.893096208572388,2025-07-23T19:49:56,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""<""
LINE 6:         '2003FP134' AS source_id, <ra_value1> AS ra, <dec_va...
                                          ^

[SQL: 
-- Corrected Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH catalog AS (
    -- Define the Solar System identifiers and their RA/Dec coordinates
    SELECT 
        '2003FP134' AS source_id, <ra_value1> AS ra, <dec_value1> AS dec
    UNION ALL
    SELECT 
        '2009UK56' AS source_id, <ra_value2> AS ra, <dec_value2> AS dec
)
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd, -- Detection date
    detection.fid, -- Filter identifier
    detection.isdiffpos, -- Difference image flag
    detection.ra, -- Right ascension
    detection.dec, -- Declination
    detection.magpsf, -- Difference magnitude
    detection.sigmapsf -- Difference magnitude uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid -- Join ss_ztf with detection table on candid
INNER JOIN 
    catalog ON q3c_radial_query(ss_ztf.ssdistnr, ss_ztf.ssmagnr, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcseconds
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter by Solar System identifiers
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.750162124633789,2025-07-25T11:26:00,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,10,"-- [FINAL QUERY HERE]WITH catalog AS (    -- Define the Solar System identifiers and their RA/Dec coordinates    VALUES        ('2003FP134', ra_value1, dec_value1), -- Replace ra_value1 and dec_value1 with actual coordinates        ('2009UK56', ra_value2, dec_value2)  -- Replace ra_value2 and dec_value2 with actual coordinates) AS catalog(source_id, ra, dec)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd, -- Detection date    detection.fid, -- Filter identifier    detection.isdiffpos, -- Difference image flag    detection.ra, -- Right ascension    detection.dec, -- Declination    detection.magpsf, -- Difference magnitude    detection.sigmapsf -- Difference magnitude uncertaintyFROM     ss_ztfINNER JOIN     detection ON ss_ztf.oid = detection.oid -- Join ss_ztf and detection tables on oidINNER JOIN     catalog ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcsecondsWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter by Solar System identifiersORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,30.969363927841187,2025-07-23T19:50:27,[None],"(psycopg2.errors.UndefinedColumn) column ""ra_value1"" does not exist
LINE 6:         '2003FP134' AS source_id, ra_value1 AS ra, dec_value...
                                          ^

[SQL: 
-- [FINAL QUERY HERE]
WITH catalog AS (
    -- Define the Solar System identifiers and their RA/Dec coordinates
    SELECT 
        '2003FP134' AS source_id, ra_value1 AS ra, dec_value1 AS dec -- Replace ra_value1 and dec_value1 with actual coordinates
    UNION ALL
    SELECT 
        '2009UK56' AS source_id, ra_value2 AS ra, dec_value2 AS dec -- Replace ra_value2 and dec_value2 with actual coordinates
)
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd, -- Detection date
    detection.fid, -- Filter identifier
    detection.isdiffpos, -- Difference image flag
    detection.ra, -- Right ascension
    detection.dec, -- Declination
    detection.magpsf, -- Difference magnitude
    detection.sigmapsf -- Difference magnitude uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid -- Join ss_ztf and detection tables on candid
INNER JOIN 
    catalog ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcseconds
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter by Solar System identifiers
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",19.167131662368774,2025-07-25T11:26:25,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,94,0,"SELECT
    *
FROM
    object INNER JOIN
    reference
    ON object.oid = reference.oid
WHERE
    reference_change
LIMIT 50",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19aasdkdx         6      3189  58599.287859  60666.571632       True   
1   ZTF19aasdkdx         6      3189  58599.287859  60666.571632       True   
2   ZTF20aaknrxd         6      2354  58602.250000  60086.250000       True   
3   ZTF20aaknrxd         6      2354  58602.250000  60086.250000       True   
4   ZTF20ackydsn         3      2034  59141.229549  60733.548218       True   
5   ZTF20ackydsn         3      2034  59141.229549  60733.548218       True   
6   ZTF20acksrap        10      2190  59141.105324  60709.558229       True   
7   ZTF20acksrap        10      2190  59141.105324  60709.558229       True   
8   ZTF19aasdnnd         5      1270  58599.290463  60679.561366       True   
9   ZTF19aasdnnd         5      1270  58599.290463  60679.561366       True   
10  ZTF19aasdnnd         5      1270  58599.290463  60679.561366       True   
11  ZTF19aassrbg        25      2032  58259.419363  60733.548218       True   
12  ZTF19aassrbg        25      2032  58259.419363  60733.548218       True   
13  ZTF19aassrbg        25      2032  58259.419363  60733.548218       True   
14  ZTF19abktdam        20      1475  58695.277847  60485.247037       True   
15  ZTF19abktdam        20      1475  58695.277847  60485.247037       True   
16  ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
17  ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
18  ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
19  ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
20  ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
21  ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
22  ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
23  ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
24  ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
25  ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
26  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
27  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
28  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
29  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
30  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
31  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
32  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
33  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
34  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
35  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
36  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
37  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
38  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
39  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
40  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
41  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
42  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
43  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
44  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
45  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
46  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
47  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
48  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
49  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3       NaN           NaN  ...    482  16.087000     0.018   
1     False     3       NaN           NaN  ...    483  16.103000     0.019   
2     False     3 -0.581045      0.570296  ...    860  17.626000     0.011   
3     False     3 -0.581045      0.570296  ...    861  16.983000     0.020   
4      True     2       NaN           NaN  ...    490  14.802000     0.016   
5      True     2       NaN           NaN  ...   1536  14.632000     0.019   
6      True     2       NaN           NaN  ...    435  14.785999     0.019   
7      True     2       NaN           NaN  ...   1480  14.823000     0.014   
8      True     6       NaN           NaN  ...    431  14.920000     0.016   
9      True     6       NaN           NaN  ...    431  15.488999     0.021   
10     True     6       NaN           NaN  ...   1476  14.938999     0.018   
11     True     6       NaN           NaN  ...    490  15.007999     0.020   
12     True     6       NaN           NaN  ...    490  15.488999     0.017   
13     True     6       NaN           NaN  ...   1536  15.014999     0.024   
14    False     6  0.858662      0.670966  ...    875  13.285999     0.027   
15    False     6  0.858662      0.670966  ...    875  13.888000     0.014   
16    False     2  0.769047      0.690778  ...    755  17.713000     0.068   
17    False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
18    False     6  1.004988      0.971847  ...    677  15.651999     0.011   
19     True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
20     True     3  1.894829      1.172141  ...    631  16.586000     0.017   
21     True     3  1.894829      1.172141  ...    631  16.050000     0.023   
22     True     2  1.819681      1.278482  ...    686  13.476000     0.015   
23     True     2  1.819681      1.278482  ...    686  14.671000     0.011   
24     True     3  0.866386      0.179226  ...    639  14.021000     0.015   
25     True     3  0.866386      0.179226  ...    639  14.325000     0.013   
26    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
27    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
28     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
29     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
30     True     4       NaN           NaN  ...    539  14.521999     0.021   
31     True     4       NaN           NaN  ...    590  14.481999     0.023   
32    False     9       NaN           NaN  ...    539  14.398000     0.014   
33    False     9       NaN           NaN  ...    539  12.988000     0.022   
34     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
35     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
36    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
37    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
38    False    28       NaN           NaN  ...    686  18.521000     0.033   
39    False    28       NaN           NaN  ...    686  19.056000     0.026   
40     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
41     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
42     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
43     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
44     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
45     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
46    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
47    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
48    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
49    False    17  0.312500      0.215178  ...    769  13.552000     0.013   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.603   -0.014  250.369254   5.422791  58198.439502  58282.294329   
1   1.036   -0.056  250.369232   5.422779  58186.500000  58363.250000   
2   0.248    0.007  167.731950  78.054698  58249.202928  58308.191655   
3   0.440   -0.040  167.731949  78.054688  58231.250000  59741.250000   
4   0.606   -0.028  301.668938   7.408591  58231.482500  58348.352569   
5   0.475    0.000  301.668945   7.408566  58443.000000  59403.250000   
6   0.798   -0.041  275.152449  -2.001240  58217.505266  58306.356227   
7   0.195    0.006  275.152466  -2.001256  58593.250000  59826.250000   
8   0.640   -0.056  250.359299  -1.644691  58219.469688  58340.168993   
9   1.339   -0.043  250.359299  -1.644700  58204.500000  58337.250000   
10  0.496   -0.029  250.359283  -1.644709  58618.250000  59826.250000   
11  0.491   -0.030  301.191474   5.886741  58226.500567  58366.317083   
12  0.182    0.004  301.191474   5.886726  58231.482500  58363.192720   
13  0.731   -0.056  301.191498   5.886713  58443.000000  59471.250000   
14  0.966   -0.058  248.077776  85.750924  58634.345069  58694.187847   
15  0.294   -0.027  248.077641  85.750927  58634.243924  58696.308507   
16  6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
17  0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
18  0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
19  0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
20  0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
21  0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
22  0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
23  0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
24  0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
25  0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
26  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
27  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
28  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
29  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
30  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
31  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
32  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
33  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
34  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
35  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
36  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
37  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
38  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
39  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
40  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
41  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
42  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
43  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
44  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
45  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
46  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
47  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
48  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
49  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   

   nframesref  
0          15  
1          15  
2          15  
3         100  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         16  
11         15  
12         15  
13         15  
14         15  
15         15  
16         15  
17         15  
18         15  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         40  
27         15  
28         15  
29         15  
30         15  
31         29  
32         15  
33         40  
34         40  
35         15  
36         15  
37         15  
38         15  
39         15  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,3.5061428546905518,2025-07-25T11:26:29,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,1,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,22.20355105400085,2025-07-23T20:00:35,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.715957403182983,2025-07-25T11:26:42,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,2,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where the reference image has changed, limiting the result to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,33.746368169784546,2025-07-23T20:01:09,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.342265605926514,2025-07-25T11:26:55,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,3,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limiting the result to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,23.755464792251587,2025-07-23T20:01:32,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.41095519065857,2025-07-25T11:27:07,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,4,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,20.364339351654053,2025-07-23T20:01:53,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.773479700088501,2025-07-25T11:27:20,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,5,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,18.596433639526367,2025-07-23T20:02:12,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.886436223983765,2025-07-25T11:27:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,6,-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects with a reference change-- Limit the result to 50 rowsSELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,16.77010178565979,2025-07-23T20:02:28,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,7.355738639831543,2025-07-25T11:27:44,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,7,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- that had a change in the reference image, limited to 50 rows.SELECT     object.*,     reference.* FROM     objectINNER JOIN     reference ON     object.oid = reference.oidWHERE     object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,19.98659086227417,2025-07-23T20:02:49,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.29308271408081,2025-07-25T11:27:56,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,8,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limiting the result to 50 rows.SELECT     object.*,     reference.*FROM     objectINNER JOIN     referenceON     object.oid = reference.oidWHERE     object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,19.28803539276123,2025-07-23T20:03:08,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.621058702468872,2025-07-25T11:28:08,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,9,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,17.697061777114868,2025-07-23T20:03:26,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.222314596176147,2025-07-25T11:28:20,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,10,"-- Query to retrieve all columns from the 'object' and 'reference' tables-- for ZTF objects that had a change in the reference, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,16.29969334602356,2025-07-23T20:03:42,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazgukc         9       143  58187.319618  58279.196817       True   
1   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
2   ZTF18aazjnog        11      2246  58279.250000  60080.250000       True   
3   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
4   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
5   ZTF18aazjkaf         3      1088  58279.311863  59452.239757       True   
6   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
7   ZTF18aazlmic         4       443  58279.370405  58436.087963       True   
8   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
9   ZTF18aazlolz         3        60  58279.372326  58315.374606       True   
10  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
11  ZTF18aazluag         6      2943  58279.374699  60773.379815       True   
12  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
13  ZTF18aazloqf         9      2502  58279.372789  60509.396238       True   
14  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
15  ZTF18aazmfbq         4        95  58279.400012  58308.335081       True   
16  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
17  ZTF18aazltzk        15      2873  58279.374699  60773.379815       True   
18  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
19  ZTF18aazluop         7      1355  58279.375150  59629.541250       True   
20  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
21  ZTF18aazlnnv        10      2144  58279.370405  60802.477650       True   
22  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
23  ZTF18aazlkmg        47      2131  58279.370405  60843.383773       True   
24  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
25  ZTF18aazmras         5      1492  58279.409699  59025.391401       True   
26  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
27  ZTF18aazmwas         9      1260  58279.443357  59180.097743       True   
28  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
29  ZTF18aazmxfl        13      1508  58279.443357  59622.564734       True   
30  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
31  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
32  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
33  ZTF18aazndvp        27      4582  58271.431134  60288.113565       True   
34  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
35  ZTF18aazndbb        10      1357  58279.450880  59076.348380       True   
36  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
37  ZTF18aazmvux         6      2427  58279.443357  60708.573403       True   
38  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
39  ZTF18aazmjvs        76      2264  58257.455324  60463.408669       True   
40  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
41  ZTF18aazmzwq         5      1893  58279.450880  59690.482859       True   
42  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
43  ZTF18aaznadq        58      3692  58259.433530  60476.381644       True   
44  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
45  ZTF18aazmxhj        26      2167  58279.443357  60723.551215       True   
46  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
47  ZTF18aazukpf        20       109  58280.412141  58372.167014      False   
48  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   
49  ZTF18aazuwif         6        58  58280.410775  58322.355810       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     2  0.769047      0.690778  ...    755  17.713000     0.068   
1     False     6  1.004988      0.971847  ...   1674  15.217999     0.012   
2     False     6  1.004988      0.971847  ...    677  15.651999     0.011   
3      True     3  1.894829      1.172141  ...   1675  16.050000     0.015   
4      True     3  1.894829      1.172141  ...    631  16.586000     0.017   
5      True     3  1.894829      1.172141  ...    631  16.050000     0.023   
6      True     2  1.819681      1.278482  ...    686  13.476000     0.015   
7      True     2  1.819681      1.278482  ...    686  14.671000     0.011   
8      True     3  0.866386      0.179226  ...    639  14.021000     0.015   
9      True     3  0.866386      0.179226  ...    639  14.325000     0.013   
10    False     5  3.232659      2.067468  ...    539  13.579000     0.020   
11    False     5  3.232659      2.067468  ...    539  15.388000     0.015   
12     True     5  3.504098      1.081620  ...    591  14.204000     0.014   
13     True     5  3.504098      1.081620  ...    591  14.729000     0.016   
14     True     4       NaN           NaN  ...    539  14.521999     0.021   
15     True     4       NaN           NaN  ...    590  14.481999     0.023   
16    False     9       NaN           NaN  ...    539  14.398000     0.014   
17    False     9       NaN           NaN  ...    539  12.988000     0.022   
18     True     8  1.495447      0.912474  ...    488  12.802000     0.020   
19     True     8  1.495447      0.912474  ...    488  13.473000     0.015   
20    False     6  1.023900      1.746406  ...    686  13.813999     0.018   
21    False     6  1.023900      1.746406  ...    686  15.492000     0.025   
22    False    28       NaN           NaN  ...    686  18.521000     0.033   
23    False    28       NaN           NaN  ...    686  19.056000     0.026   
24     True     3  0.624638      0.713163  ...    830  14.856000     0.011   
25     True     3  0.624638      0.713163  ...    830  15.549000     0.015   
26     True     2  1.474035      1.242341  ...    540  15.658000     0.018   
27     True     2  1.474035      1.242341  ...    540  14.509999     0.020   
28     True     9  0.850458      1.238286  ...    540  13.250000     0.017   
29     True     9  0.850458      1.238286  ...    540  14.455000     0.019   
30    False    17  0.312500      0.215178  ...    768  13.101999     0.016   
31    False    17  0.312500      0.215178  ...    769  13.138000     0.023   
32    False    17  0.312500      0.215178  ...    768  13.510000     0.025   
33    False    17  0.312500      0.215178  ...    769  13.552000     0.013   
34     True    11  1.071093      0.614641  ...    768  14.197000     0.011   
35     True    11  1.071093      0.614641  ...    768  14.811000     0.014   
36     True     3       NaN           NaN  ...    540  15.096000     0.016   
37     True     3       NaN           NaN  ...   1535  14.429000     0.020   
38    False    28  1.626075      2.039775  ...    640  17.461000     0.028   
39    False    28  1.626075      2.039775  ...   1684  17.434000     0.022   
40     True     2  1.073828      0.512802  ...    768  14.066999     0.019   
41     True     2  1.073828      0.512802  ...    768  13.532000     0.015   
42    False    16       NaN           NaN  ...    730  12.618000     0.015   
43    False    16       NaN           NaN  ...    731  12.635000     0.025   
44     True     8  0.145818      1.516211  ...    540  13.509999     0.015   
45     True     8  0.145818      1.516211  ...    540  14.882000     0.018   
46    False    14  0.752701           NaN  ...    487  20.262000     0.074   
47    False    14  0.752701           NaN  ...    487  20.064000     0.124   
48     True     6  0.997112      0.746044  ...    540  15.535999     0.015   
49     True     6  0.997112      0.746044  ...    540  16.331000     0.021   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   6.460    0.319  185.900715  44.545054  58166.401366  58277.195336   
1   0.272    0.001  224.170515  31.539597  58160.469745  58589.239028   
2   0.456   -0.015  224.170477  31.539601  58166.535845  58205.505498   
3   0.489   -0.005  231.101454  28.850490  58160.491100  58593.308785   
4   0.534   -0.015  231.101453  28.850502  58166.483889  58274.272801   
5   0.894   -0.059  231.101453  28.850506  58160.491597  58226.377546   
6   0.367    0.019  297.671208  33.156446  58217.489294  58322.388657   
7   0.165    0.013  297.671214  33.156441  58205.514028  58255.426065   
8   0.442   -0.013  294.267694  24.469902  58186.532512  58292.328079   
9   0.208    0.015  294.267695  24.469904  58203.506921  58247.392778   
10  0.513    0.043  284.383791  12.377444  58217.507188  58334.298588   
11  0.814   -0.048  284.383798  12.377444  58204.507674  58263.441956   
12  0.241    0.014  299.019802  19.967364  58218.497106  58294.333785   
13  0.641   -0.019  299.019806  19.967356  58203.507847  58255.420394   
14  0.678   -0.021  288.067282  15.336058  58217.507188  58274.334606   
15  0.900   -0.028  288.067278  15.336038  58186.533102  58293.316713   
16  0.528   -0.040  284.272405  12.673596  58204.507674  58263.441956   
17  0.540    0.035  284.272400  12.673592  58217.507188  58334.298588   
18  0.335    0.028  287.016143   4.258751  58320.345463  58340.298287   
19  0.531    0.034  287.016132   4.258759  58205.509873  58278.379167   
20  0.507   -0.032  298.690552  30.783025  58217.489294  58314.413993   
21  1.621   -0.092  298.690554  30.783025  58205.514028  58263.444699   
22  0.849    0.000  297.265360  34.791414  58217.512060  58344.304699   
23  0.673   -0.006  297.265358  34.791425  58204.513900  58252.441331   
24  0.343    0.001  325.707541  61.896502  58217.492604  58275.428148   
25  0.254    0.000  325.707539  61.896501  58206.523056  58283.428310   
26  0.709   -0.060  294.321590  10.470824  58205.510799  58276.394178   
27  0.815   -0.029  294.321593  10.470828  58218.487685  58301.356898   
28  0.554   -0.017  292.628559  10.996445  58218.487685  58317.401354   
29  0.984   -0.041  292.628552  10.996438  58205.510799  58276.394178   
30  0.475   -0.015  316.775931  47.177949  58216.512708  58290.385266   
31  0.688    0.033  316.775892  47.177942  58219.508715  58318.364757   
32  1.334   -0.038  316.775922  47.177948  58206.522095  58273.463194   
33  0.324    0.013  316.775888  47.177944  58228.490035  58274.444572   
34  0.276   -0.012  311.514274  45.089738  58216.512708  58305.394687   
35  0.522   -0.037  311.514269  45.089734  58206.522095  58276.411412   
36  0.529   -0.026  295.128422   8.546085  58205.510799  58277.373611   
37  0.389   -0.015  295.128418   8.546084  58300.500000  59379.500000   
38  0.709   -0.033  299.688996  26.633470  58217.488831  58276.425266   
39  0.541   -0.001  299.689000  26.633437  58244.493819  58443.088218   
40  0.844   -0.043  310.041214  50.328208  58206.522095  58271.465451   
41  0.487   -0.040  310.041231  50.328213  58216.512708  58287.449676   
42  0.735    0.006  316.828598  37.231868  58206.524132  58275.449155   
43  0.907   -0.038  316.828537  37.231857  58230.492130  58363.301771   
44  0.476   -0.040  292.400935  10.872261  58218.487685  58317.401354   
45  0.665   -0.052  292.400932  10.872261  58205.510799  58276.394178   
46  2.085    0.049  282.284304   1.617065  58205.509410  58273.443530   
47  4.430    0.425  282.283547   1.617115  58217.484491  58301.358750   
48  0.226   -0.020  294.206614  14.175056  58218.487685  58293.298171   
49  0.858   -0.034  294.206618  14.175059  58205.510799  58263.442870   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         40  
11         15  
12         15  
13         15  
14         15  
15         29  
16         15  
17         40  
18         40  
19         15  
20         15  
21         15  
22         15  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         15  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         24  
40         15  
41         15  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,7.858500719070435,2025-07-25T11:28:32,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,90,0,"SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking <= 2
    AND oid in
(
SELECT
    oid
FROM
    feature
WHERE
    name = 'Multiband_period'
    AND version = 'lc_classifier_1.2.1-P'
    AND value < 5
LIMIT 100
)",,,,,"[              oid classifier_name     classifier_version class_name  \
0    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        CEP   
1    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0       DSCT   
2    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        RRL   
3    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0        RRL   
4    ZTF18abadjvy   lc_classifier  hierarchical_rf_1.1.0          E   
..            ...             ...                    ...        ...   
341  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0          E   
342  ZTF18abasovn   lc_classifier   lc_classifier_1.1.13          E   
343  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0        RRL   
344  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0     Blazar   
345  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0        QSO   

     probability  ranking  
0       0.161280        2  
1       0.283360        1  
2       0.190720        1  
3       0.227040        2  
4       0.093744        2  
..           ...      ...  
341     0.424664        1  
342     0.309624        1  
343     0.188956        2  
344     0.205800        2  
345     0.678160        1  

[346 rows x 6 columns]]",,3.4607481956481934,2025-07-25T11:28:36,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,1,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_features AS (    -- Subquery 1: Filter the 'feature' table for 'multiband_period' with value < 5 and specific version    SELECT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter the 'probability' table for relevant objects and conditions    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2)      AND oid IN (SELECT oid FROM filtered_features))-- Final Query: Limit the results to 100 rowsSELECT *FROM filtered_probabilitiesLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,31.50260758399964,2025-07-23T20:04:14,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days
-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table
-- for the light curve classifier with rankings 1 or 2.

WITH filtered_features AS (
    -- Subquery 1: Filter the 'feature' table for 'multiband_period' with value < 5 and specific version
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),
filtered_probabilities AS (
    -- Subquery 2: Filter the 'probability' table for relevant objects and conditions
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
      AND oid IN (SELECT oid FROM filtered_features) -- Ensure the subquery is correctly referenced
)
-- Final Query: Limit the results to 100 rows
SELECT *
FROM filtered_probabilities
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",129.09520173072815,2025-07-25T11:30:50,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,90,2,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_features AS (    -- Subquery 1: Filter objects based on multiband period    SELECT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter probabilities for the light curve classifier    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Combine the filters using an INNER JOINSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_features fON p.oid = f.oid-- Limit the results to at most 100 objectsLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,30.014174222946167,2025-07-23T20:04:44,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.874474287033081,2025-07-25T11:31:04,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,3,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings of 1 or 2.WITH filtered_features AS (    -- Subquery 1: Filter the 'feature' table for objects with multiband_period < 5    SELECT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter the 'probability' table for the light curve classifier with rankings 1 or 2    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND (ranking = 1 OR ranking = 2))-- Final Query: Join the filtered results and limit to 100 rowsSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_features fON p.oid = f.oidLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,22.95187830924988,2025-07-23T20:05:07,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.991734027862549,2025-07-25T11:31:17,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,4,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.SELECT *FROM probabilityWHERE oid IN (    -- Subquery to filter objects based on the 'feature' table    SELECT DISTINCT f.oid    FROM feature f    WHERE f.name = 'multiband_period'      AND f.value < 5      AND f.version = 'lc_classifier_1.2.1-P')AND classifier_name = 'lc_classifier'AND ranking IN (1, 2)LIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,25.2764630317688,2025-07-23T20:05:32,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.6172935962677,2025-07-25T11:31:30,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,5,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- and return all columns from the 'probability' table for the light curve classifier-- with rankings either 1 or 2.WITH filtered_objects AS (    -- Subquery 1: Filter objects based on multiband period    SELECT DISTINCT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter probabilities for light curve classifier    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Final Query: Join the filtered objects with the filtered probabilitiesSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_objects oON p.oid = o.oidLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,33.1457622051239,2025-07-23T20:06:05,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.404194593429565,2025-07-25T11:31:43,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,6,"-- Final Query to retrieve at most 100 ZTF objects with the specified conditionsWITH filtered_objects AS (    -- Subquery 1: Filter objects based on the 'multiband_period' feature    SELECT DISTINCT f.oid    FROM feature f    INNER JOIN object o ON f.oid = o.oid    WHERE f.name = 'multiband_period'      AND f.value < 5      AND f.version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter probabilities for the selected objects    SELECT p.*    FROM probability p    INNER JOIN filtered_objects fo ON p.oid = fo.oid    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking IN (1, 2))-- Final Query: Retrieve all columns from the 'probability' table for the filtered objectsSELECT *FROM filtered_probabilitiesLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,22.64985418319702,2025-07-23T20:06:28,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.461798191070557,2025-07-25T11:31:56,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,7,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_features AS (    -- Subquery to filter objects based on the multiband period condition    SELECT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery to filter probabilities for the light curve classifier with rankings 1 or 2    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Combine the results of the two subqueries using an INNER JOINSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_features fON p.oid = f.oidLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,23.84159469604492,2025-07-23T20:06:52,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.708341598510742,2025-07-25T11:32:09,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,8,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- and return all columns from the 'probability' table for the light curve classifier-- with rankings of 1 or 2.WITH filtered_objects AS (    -- Sub-query to filter objects based on the multiband period    SELECT DISTINCT oid    FROM feature    WHERE name = 'MultibandPeriod'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Sub-query to filter classification data from the probability table    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Combine results by performing an INNER JOIN on the oid columnSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_objects oON p.oid = o.oidLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,34.20009136199951,2025-07-23T20:07:26,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.490437269210815,2025-07-25T11:32:21,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,9,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_objects AS (    -- Subquery 1: Filter objects based on multiband period    SELECT DISTINCT oid    FROM feature    WHERE name = 'MultibandPeriod'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter probabilities for light curve classifier    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Combine the two subqueries using an INNER JOINSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_objects oON p.oid = o.oid-- Limit the results to at most 100 objectsLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,24.92752361297608,2025-07-23T20:07:51,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.332790851593018,2025-07-25T11:32:34,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,10,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_objects AS (    -- Step 1: Filter objects based on the multiband period    SELECT DISTINCT oid    FROM feature    WHERE name = 'MultibandPeriod'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Step 2: Filter probabilities for the relevant objects    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2)      AND oid IN (SELECT oid FROM filtered_objects))-- Step 3: Limit the results to at most 100 objectsSELECT *FROM filtered_probabilitiesLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,29.481520652771,2025-07-23T20:08:21,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,9.11355996131897,2025-07-25T11:32:47,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,39,0,"SELECT
  sq.oid, sq.meanra, sq.meandec,
  detection.candid, detection.fid as f_id,detection.magpsf, detection.sigmapsf_corr, detection.sigmapsf_corr_ext
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier_stochastic'
    AND probability.class_name='CV/Nova'
    AND probability.ranking = 1
) AS sq
  INNER JOIN detection
  ON sq.oid = detection.oid
WHERE
  sq.ndet < 50
  AND detection.fid = 2
ORDER BY oid
LIMIT 1000
",,,,,"[              oid      meanra    meandec               candid  f_id  \
0    ZTF17aaaaanb  324.816860  45.593583   537475640115015008     2   
1    ZTF17aaaaanb  324.816860  45.593583   607270780115015027     2   
2    ZTF17aaaaanb  324.816860  45.593583   613325340115010003     2   
3    ZTF17aaaaanb  324.816860  45.593583   536383390115015014     2   
4    ZTF17aaaaanb  324.816860  45.593583   529390300115015005     2   
..            ...         ...        ...                  ...   ...   
995  ZTF17aaadgdr  116.399044  32.744831  2793498875315010003     2   
996  ZTF17aaadgdr  116.399044  32.744831  2784509095315010123     2   
997  ZTF17aaadgdr  116.399044  32.744831  2494492412515010004     2   
998  ZTF17aaadgdr  116.399044  32.744831  2203255402515010007     2   
999  ZTF17aaadine  101.589363  -3.744657  2094499972315015001     2   

        magpsf  sigmapsf_corr  sigmapsf_corr_ext  
0    19.760700       0.021343           0.031418  
1    19.648392       0.026439           0.034795  
2    19.791729       0.025855           0.043814  
3    19.882864       0.022219           0.032339  
4    19.678644     100.000000           0.019559  
..         ...            ...                ...  
995  16.723570     100.000000           0.024235  
996  17.873495       0.013963           0.024816  
997  17.323240     100.000000           0.013592  
998  16.954084       0.001079           0.019867  
999  17.999685       0.008147           0.013642  

[1000 rows x 8 columns]]",,6.62623405456543,2025-07-25T11:32:54,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,39,1,"-- [FINAL QUERY HERE]WITH filtered_probabilities AS (    SELECT         oid    FROM         probability    WHERE         ranking = 1        AND class_name = 'CV/Nova'        AND classifier_name = 'lc_classifier_stochastic'),filtered_objects AS (    SELECT         o.oid,         o.meanra,         o.meandec,         o.ndet    FROM         object o    INNER JOIN         filtered_probabilities fp    ON         o.oid = fp.oid    WHERE         o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.magpsf    FROM         detection d    INNER JOIN         filtered_objects fo    ON         d.oid = fo.oid    WHERE         d.fid = 2),r_band_magstats AS (    SELECT         m.oid,         (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects fo    ON         m.oid = fo.oid    WHERE         m.fid = 2)SELECT     rbd.oid,     rbd.candid,     rbd.fid AS f_id,     fo.meanra AS ra,     fo.meandec AS dec,     rbd.magpsf_corr,     rbd.magpsf,     rbm.max_riseFROM     r_band_detections rbdINNER JOIN     filtered_objects foON     rbd.oid = fo.oidINNER JOIN     r_band_magstats rbmON     rbd.oid = rbm.oidORDER BY     rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,45.71933388710022,2025-07-23T20:22:48,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_probabilities AS (
    -- Filter probabilities for the most likely class 'CV/Nova' using the stochastic light curve classifier
    SELECT 
        oid
    FROM 
        probability
    WHERE 
        ranking = 1
        AND class_name = 'CV/Nova'
        AND classifier_name = 'lc_classifier_stochastic'
),
filtered_objects AS (
    -- Filter objects with at most 50 detections and join with filtered probabilities
    SELECT 
        o.oid, 
        o.meanra, 
        o.meandec, 
        o.ndet
    FROM 
        object o
    INNER JOIN 
        filtered_probabilities fp
    ON 
        o.oid = fp.oid
    WHERE 
        o.ndet <= 50
),
r_band_detections AS (
    -- Select detections in the r-band (fid = 2) and join with filtered objects
    SELECT 
        d.oid, 
        d.candid, 
        d.fid, 
        d.magpsf_corr, 
        d.magpsf
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo
    ON 
        d.oid = fo.oid
    WHERE 
        d.fid = 2
),
r_band_magstats AS (
    -- Calculate the maximum rise (magmax_corr - magmin_corr) in the r-band (fid = 2) and join with filtered objects
    SELECT 
        m.oid, 
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects fo
    ON 
        m.oid = fo.oid
    WHERE 
        m.fid = 2
)
-- Final query to combine all the results and retrieve the required columns
SELECT 
    rbd.oid, 
    rbd.candid, 
    rbd.fid AS f_id, 
    fo.meanra AS ra, 
    fo.meandec AS dec, 
    rbd.magpsf_corr, 
    rbd.magpsf, 
    rbm.max_rise
FROM 
    r_band_detections rbd
INNER JOIN 
    filtered_objects fo
ON 
    rbd.oid = fo.oid
INNER JOIN 
    r_band_magstats rbm
ON 
    rbd.oid = rbm.oid
ORDER BY 
    rbd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.4608325958252,2025-07-25T11:35:14,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,2,"-- [FINAL QUERY HERE]WITH classified_objects AS (    SELECT         p.oid    FROM         probability p    WHERE         p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier_stochastic'        AND p.ranking = 1),filtered_objects AS (    SELECT         o.oid,         o.meanra AS ra,         o.meandec AS dec    FROM         object o    INNER JOIN         classified_objects co ON o.oid = co.oid    WHERE         o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.sigmapsf_corr    FROM         detection d    WHERE         d.fid = 2),r_band_magstats AS (    SELECT         m.oid,         (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    WHERE         m.fid = 2)SELECT     fo.oid,     rbd.candid,     rbd.fid,     fo.ra,     fo.dec,     rbd.magpsf_corr,     rbd.sigmapsf_corr,     rbm.max_riseFROM     filtered_objects foINNER JOIN     r_band_detections rbd ON fo.oid = rbd.oidINNER JOIN     r_band_magstats rbm ON fo.oid = rbm.oidORDER BY     fo.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,34.42355036735535,2025-07-23T20:23:23,"[              oid               candid  fid          ra        dec  \
0    ZTF17aaaaanb   537475640115015008    2  324.816860  45.593583   
1    ZTF17aaaaanb   607270780115015027    2  324.816860  45.593583   
2    ZTF17aaaaanb   613325340115010003    2  324.816860  45.593583   
3    ZTF17aaaaanb   536383390115015014    2  324.816860  45.593583   
4    ZTF17aaaaanb   529390300115015005    2  324.816860  45.593583   
..            ...                  ...  ...         ...        ...   
995  ZTF17aaadapx   793152873615010003    2   83.292583   5.590759   
996  ZTF17aaadapx   718273263615010003    2   83.292583   5.590759   
997  ZTF17aaadasq   687376274015010001    2   71.777250  -1.224087   
998  ZTF17aaadasq  1466249294015015003    2   71.777250  -1.224087   
999  ZTF17aaadasq   674374274015015015    2   71.777250  -1.224087   

     magpsf_corr  sigmapsf_corr  max_rise  
0      17.878054       0.021343  0.524338  
1      17.857359       0.026439  0.524338  
2      18.342743       0.025855  0.524338  
3      17.898651       0.022219  0.524338  
4      17.863106     100.000000  0.524338  
..           ...            ...       ...  
995    15.696300     100.000000  0.512533  
996    15.786064     100.000000  0.512533  
997    15.967023     100.000000  0.308908  
998    15.671734     100.000000  0.308908  
999    15.672545     100.000000  0.308908  

[1000 rows x 8 columns]]",,16.785509824752808,2025-07-25T11:35:35,0.939,0.942,0.375,0.375,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,3,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         p.oid    FROM         probability p    INNER JOIN         object o ON p.oid = o.oid    WHERE         p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier_stochastic'        AND p.ranking = 1        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,        d.candid,        d.fid,        d.ra,        d.dec,        d.magpsf_corr,        d.sigmapsf_corr    FROM         detection d    INNER JOIN         filtered_objects fo ON d.oid = fo.oid    WHERE         d.fid = 2 -- r-band filter),r_band_magstats AS (    SELECT         m.oid,        (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects fo ON m.oid = fo.oid    WHERE         m.fid = 2 -- r-band filter)SELECT     rbd.oid,    rbd.candid,    rbd.fid AS f_id,    rbd.ra,    rbd.dec,    rbd.magpsf_corr,    rbd.sigmapsf_corr,    rbm.max_riseFROM     r_band_detections rbdLEFT JOIN     r_band_magstats rbm ON rbd.oid = rbm.oidORDER BY     rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,29.421626806259155,2025-07-23T20:23:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Filter objects classified as 'CV/Nova' by the stochastic light curve classifier
    -- with ranking = 1 and number of detections (ndet) <= 50
    SELECT 
        p.oid
    FROM 
        probability p
    INNER JOIN 
        object o ON p.oid = o.oid
    WHERE 
        p.class_name = 'CV/Nova' -- Class name for CV/Nova
        AND p.classifier_name = 'lc_classifier_stochastic' -- Stochastic light curve classifier
        AND p.ranking = 1 -- Only the most likely probability
        AND o.ndet <= 50 -- Number of detections at most 50
),
r_band_detections AS (
    -- Get detections in the r-band filter (fid = 2) for the filtered objects
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.ra,
        d.dec,
        d.magpsf_corr,
        d.sigmapsf_corr
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo ON d.oid = fo.oid
    WHERE 
        d.fid = 2 -- r-band filter
),
r_band_magstats AS (
    -- Calculate the maximum rise (magmax_corr - magmin_corr) in the r-band filter for the filtered objects
    SELECT 
        m.oid,
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects fo ON m.oid = fo.oid
    WHERE 
        m.fid = 2 -- r-band filter
)
-- Final query to combine detections and magnitude statistics
SELECT 
    rbd.oid,
    rbd.candid,
    rbd.fid AS f_id,
    rbd.ra,
    rbd.dec,
    rbd.magpsf_corr,
    rbd.sigmapsf_corr,
    rbm.max_rise
FROM 
    r_band_detections rbd
LEFT JOIN 
    r_band_magstats rbm ON rbd.oid = rbm.oid
ORDER BY 
    rbd.oid -- Order by object identifier
LIMIT 1000 -- Limit to the first 1000 rows
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.92992734909058,2025-07-25T11:37:52,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,4,"-- [FINAL QUERY HERE]WITH classified_objects AS (    -- Step 1: Filter objects classified as 'CV/Nova' with the highest probability    SELECT p.oid    FROM probability p    WHERE p.class_name = 'CV/Nova'      AND p.classifier_name = 'lc_classifier_stochastic'      AND p.ranking = 1),filtered_objects AS (    -- Step 2: Filter objects with ndet <= 50    SELECT o.oid, o.meanra AS ra, o.meandec AS dec    FROM object o    INNER JOIN classified_objects co ON o.oid = co.oid    WHERE o.ndet <= 50),r_band_detections AS (    -- Step 3: Filter detections in the r-band filter (fid = 2)    SELECT d.oid, d.candid, d.fid, d.magpsf_corr, d.sigmapsf_corr    FROM detection d    INNER JOIN filtered_objects fo ON d.oid = fo.oid    WHERE d.fid = 2),magnitude_stats AS (    -- Step 4: Calculate maximum rise in magnitude for the r-band filter    SELECT m.oid, (m.magmax_corr - m.magmin_corr) AS max_rise    FROM magstat m    WHERE m.fid = 2)-- Step 5: Combine results and limit to 1000 rowsSELECT rbd.oid, rbd.candid, rbd.fid AS f_id, fo.ra, fo.dec,        rbd.magpsf_corr, rbd.sigmapsf_corr, ms.max_riseFROM r_band_detections rbdINNER JOIN filtered_objects fo ON rbd.oid = fo.oidINNER JOIN magnitude_stats ms ON rbd.oid = ms.oidORDER BY rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,29.58437752723694,2025-07-23T20:24:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH classified_objects AS (
    -- Step 1: Filter objects classified as 'CV/Nova' with the highest probability
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'CV/Nova'
      AND p.classifier_name = 'lc_classifier_stochastic'
      AND p.ranking = 1
),
filtered_objects AS (
    -- Step 2: Filter objects with ndet <= 50
    SELECT o.oid, o.meanra AS ra, o.meandec AS dec
    FROM object o
    INNER JOIN classified_objects co ON o.oid = co.oid
    WHERE o.ndet <= 50
),
r_band_detections AS (
    -- Step 3: Filter detections in the r-band filter (fid = 2)
    SELECT d.oid, d.candid, d.fid, d.magpsf_corr, d.sigmapsf_corr
    FROM detection d
    INNER JOIN filtered_objects fo ON d.oid = fo.oid
    WHERE d.fid = 2
),
magnitude_stats AS (
    -- Step 4: Calculate maximum rise in magnitude for the r-band filter
    SELECT m.oid, (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM magstat m
    WHERE m.fid = 2
)
-- Step 5: Combine results and limit to 1000 rows
SELECT rbd.oid, rbd.candid, rbd.fid AS f_id, fo.ra, fo.dec, 
       rbd.magpsf_corr, rbd.sigmapsf_corr, ms.max_rise
FROM r_band_detections rbd
INNER JOIN filtered_objects fo ON rbd.oid = fo.oid
INNER JOIN magnitude_stats ms ON rbd.oid = ms.oid
ORDER BY rbd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.26857209205627,2025-07-25T11:40:07,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,5,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         p.oid    FROM         probability p    INNER JOIN         object o ON p.oid = o.oid    WHERE         p.ranking = 1        AND p.classifier_name = 'lc_classifier'        AND p.class_name = 'CV/Nova'        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,        d.candid,        d.fid,        d.ra AS meanra,        d.dec AS meandec,        d.magpsf_corr,        d.magpsf    FROM         detection d    INNER JOIN         filtered_objects fo ON d.oid = fo.oid    WHERE         d.fid = 2 -- r-band filter),r_band_magstats AS (    SELECT         m.oid,        m.fid,        (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects fo ON m.oid = fo.oid    WHERE         m.fid = 2 -- r-band filter)SELECT     rbd.oid,    rbd.candid,    rbd.fid AS f_id,    rbd.meanra,    rbd.meandec,    rbd.magpsf_corr,    rbd.magpsf,    rbm.max_riseFROM     r_band_detections rbdINNER JOIN     r_band_magstats rbm ON rbd.oid = rbm.oid AND rbd.fid = rbm.fidORDER BY     rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,26.56500649452209,2025-07-23T20:24:48,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Filter objects with the highest probability class as 'CV/Nova' by the 'lc_classifier' and with ndet <= 50
    SELECT 
        p.oid
    FROM 
        probability p
    INNER JOIN 
        object o ON p.oid = o.oid
    WHERE 
        p.ranking = 1 -- Default condition for the most likely probability
        AND p.classifier_name = 'lc_classifier' -- Default condition for the light curve classifier
        AND p.class_name = 'CV/Nova' -- Filter for the 'CV/Nova' class
        AND o.ndet <= 50 -- Filter for objects with at most 50 detections
),
r_band_detections AS (
    -- Get detections in the r-band filter (fid = 2) for the filtered objects
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.ra AS meanra,
        d.dec AS meandec,
        d.magpsf_corr,
        d.magpsf
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo ON d.oid = fo.oid
    WHERE 
        d.fid = 2 -- r-band filter
),
r_band_magstats AS (
    -- Calculate the maximum rise (magmax_corr - magmin_corr) in the r-band filter for the filtered objects
    SELECT 
        m.oid,
        m.fid,
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects fo ON m.oid = fo.oid
    WHERE 
        m.fid = 2 -- r-band filter
)
-- Combine the detections and magnitude statistics for the r-band filter
SELECT 
    rbd.oid,
    rbd.candid,
    rbd.fid AS f_id,
    rbd.meanra,
    rbd.meandec,
    rbd.magpsf_corr,
    rbd.magpsf,
    rbm.max_rise
FROM 
    r_band_detections rbd
INNER JOIN 
    r_band_magstats rbm ON rbd.oid = rbm.oid AND rbd.fid = rbm.fid
ORDER BY 
    rbd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.68077397346497,2025-07-25T11:42:25,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,6,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,        o.ndet    FROM         object o    INNER JOIN         probability p    ON         o.oid = p.oid    WHERE         p.ranking = 1        AND p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier_stochastic'        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,        d.candid,        d.fid,        d.ra,        d.dec,        d.magpsf_corr,        d.sigmapsf_corr    FROM         detection d    INNER JOIN         filtered_objects fo    ON         d.oid = fo.oid    WHERE         d.fid = 2),magnitude_stats AS (    SELECT         oid,        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise    FROM         r_band_detections    GROUP BY         oid)SELECT     rbd.oid,    rbd.candid,    rbd.fid AS f_id,    rbd.ra,    rbd.dec,    rbd.magpsf_corr,    rbd.sigmapsf_corr,    ms.max_riseFROM     r_band_detections rbdINNER JOIN     magnitude_stats msON     rbd.oid = ms.oidORDER BY     rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.45722913742065,2025-07-23T20:25:13,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Step 1: Filter objects with the highest probability class as 'CV/Nova' by the stochastic light curve classifier
    -- and with a number of detections (ndet) of at most 50.
    SELECT 
        o.oid,
        o.ndet
    FROM 
        object o
    INNER JOIN 
        probability p
    ON 
        o.oid = p.oid
    WHERE 
        p.ranking = 1 -- Default condition for the most likely probability
        AND p.class_name = 'CV/Nova' -- Filter for the 'CV/Nova' class
        AND p.classifier_name = 'lc_classifier_stochastic' -- Filter for the stochastic light curve classifier
        AND o.ndet <= 50 -- Filter for objects with at most 50 detections
),
r_band_detections AS (
    -- Step 2: Filter detections in the r-band (fid = 2) for the objects identified in the previous step.
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.ra,
        d.dec,
        d.magpsf_corr,
        d.sigmapsf_corr
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo
    ON 
        d.oid = fo.oid
    WHERE 
        d.fid = 2 -- Filter for the r-band (fid = 2)
),
magnitude_stats AS (
    -- Step 3: Calculate the maximum rise in corrected magnitude (magpsf_corr) for each object in the r-band.
    SELECT 
        oid,
        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise
    FROM 
        r_band_detections
    GROUP BY 
        oid
)
-- Step 4: Combine the r-band detections with the calculated maximum rise and return the first 1000 rows.
SELECT 
    rbd.oid,
    rbd.candid,
    rbd.fid AS f_id,
    rbd.ra,
    rbd.dec,
    rbd.magpsf_corr,
    rbd.sigmapsf_corr,
    ms.max_rise
FROM 
    r_band_detections rbd
INNER JOIN 
    magnitude_stats ms
ON 
    rbd.oid = ms.oid
ORDER BY 
    rbd.oid -- Order by object identifier
LIMIT 1000 -- Limit the result to the first 1000 rows
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.32555294036865,2025-07-25T11:44:43,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,7,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    -- Step 1: Filter objects classified as 'CV/Nova' with the highest probability    SELECT         p.oid    FROM         probability p    WHERE         p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier_stochastic'        AND p.ranking = 1),filtered_objects_with_detections AS (    -- Step 2: Filter objects with ndet <= 50    SELECT         o.oid    FROM         object o    INNER JOIN         filtered_objects fo ON o.oid = fo.oid    WHERE         o.ndet <= 50),detection_data AS (    -- Step 3: Retrieve detection-level data for r-band filter (fid = 2)    SELECT         d.oid,        d.candid,        d.fid,        d.ra,        d.dec,        d.magpsf_corr,        d.sigmapsf_corr    FROM         detection d    INNER JOIN         filtered_objects_with_detections fod ON d.oid = fod.oid    WHERE         d.fid = 2),magnitude_stats AS (    -- Step 4: Calculate maximum rise from minimum magnitude for r-band filter (fid = 2)    SELECT         m.oid,        (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects_with_detections fod ON m.oid = fod.oid    WHERE         m.fid = 2)-- Step 5: Combine results and limit to 1000 rowsSELECT     dd.oid,    dd.candid,    dd.fid AS f_id,    dd.ra,    dd.dec,    dd.magpsf_corr,    dd.sigmapsf_corr,    ms.max_riseFROM     detection_data ddINNER JOIN     magnitude_stats ms ON dd.oid = ms.oidORDER BY     dd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.90203070640564,2025-07-23T20:25:44,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Step 1: Filter objects classified as 'CV/Nova' with the highest probability
    SELECT 
        p.oid
    FROM 
        probability p
    WHERE 
        p.class_name = 'CV/Nova' 
        AND p.classifier_name = 'lc_classifier_stochastic' 
        AND p.ranking = 1
),
filtered_objects_with_detections AS (
    -- Step 2: Filter objects with ndet <= 50
    SELECT 
        o.oid
    FROM 
        object o
    INNER JOIN 
        filtered_objects fo ON o.oid = fo.oid
    WHERE 
        o.ndet <= 50
),
detection_data AS (
    -- Step 3: Retrieve detection-level data for r-band filter (fid = 2)
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.ra,
        d.dec,
        d.magpsf_corr,
        d.sigmapsf_corr
    FROM 
        detection d
    INNER JOIN 
        filtered_objects_with_detections fod ON d.oid = fod.oid
    WHERE 
        d.fid = 2
),
magnitude_stats AS (
    -- Step 4: Calculate maximum rise from minimum magnitude for r-band filter (fid = 2)
    SELECT 
        m.oid,
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects_with_detections fod ON m.oid = fod.oid
    WHERE 
        m.fid = 2
)
-- Step 5: Combine results and limit to 1000 rows
SELECT 
    dd.oid,
    dd.candid,
    dd.fid AS f_id,
    dd.ra,
    dd.dec,
    dd.magpsf_corr,
    dd.sigmapsf_corr,
    ms.max_rise
FROM 
    detection_data dd
INNER JOIN 
    magnitude_stats ms ON dd.oid = ms.oid
ORDER BY 
    dd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.52132725715637,2025-07-25T11:46:59,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,8,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,         o.meanra,         o.meandec,         o.ndet    FROM         object o    INNER JOIN         probability p    ON         o.oid = p.oid    WHERE         p.ranking = 1         AND p.classifier_name = 'lc_classifier'         AND p.class_name = 'CV/Nova'        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.magpsf    FROM         detection d    INNER JOIN         filtered_objects fo    ON         d.oid = fo.oid    WHERE         d.fid = 2 -- r-band filter),r_band_magstats AS (    SELECT         m.oid,         m.magmax_corr,         m.magmin_corr,         (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects fo    ON         m.oid = fo.oid    WHERE         m.fid = 2 -- r-band filter)SELECT     fo.oid,     rd.candid,     rd.fid AS f_id,     fo.meanra,     fo.meandec,     rd.magpsf_corr,     rd.magpsf,     rms.max_riseFROM     filtered_objects foINNER JOIN     r_band_detections rdON     fo.oid = rd.oidINNER JOIN     r_band_magstats rmsON     fo.oid = rms.oidORDER BY     fo.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,33.55208945274353,2025-07-23T20:26:18,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Filter objects with the highest probability class as 'CV/Nova' by the 'lc_classifier' and ndet <= 50
    SELECT 
        o.oid, 
        o.meanra, 
        o.meandec, 
        o.ndet
    FROM 
        object o
    INNER JOIN 
        probability p
    ON 
        o.oid = p.oid
    WHERE 
        p.ranking = 1 -- Default condition for the most likely probability
        AND p.classifier_name = 'lc_classifier' -- Default condition for the light curve classifier
        AND p.class_name = 'CV/Nova' -- Filter for the 'CV/Nova' class
        AND o.ndet <= 50 -- Filter for objects with at most 50 detections
),
r_band_detections AS (
    -- Get detections in the r-band filter (fid = 2) for the filtered objects
    SELECT 
        d.oid, 
        d.candid, 
        d.fid, 
        d.magpsf_corr, 
        d.magpsf
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo
    ON 
        d.oid = fo.oid
    WHERE 
        d.fid = 2 -- r-band filter
),
r_band_magstats AS (
    -- Get corrected magnitude statistics in the r-band filter (fid = 2) and calculate the maximum rise
    SELECT 
        m.oid, 
        m.magmax_corr, 
        m.magmin_corr, 
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects fo
    ON 
        m.oid = fo.oid
    WHERE 
        m.fid = 2 -- r-band filter
)
-- Final query to combine the results and retrieve the required columns
SELECT 
    fo.oid, 
    rd.candid, 
    rd.fid AS f_id, 
    fo.meanra, 
    fo.meandec, 
    rd.magpsf_corr, 
    rd.magpsf, 
    rms.max_rise
FROM 
    filtered_objects fo
INNER JOIN 
    r_band_detections rd
ON 
    fo.oid = rd.oid
INNER JOIN 
    r_band_magstats rms
ON 
    fo.oid = rms.oid
ORDER BY 
    fo.oid -- Order by object identifier
LIMIT 1000 -- Limit the result to the first 1000 rows
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.80784678459167,2025-07-25T11:49:17,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,9,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,         o.meanra,         o.meandec,         o.ndet    FROM         object o    INNER JOIN         probability p    ON         o.oid = p.oid    WHERE         p.ranking = 1         AND p.class_name = 'CV/Nova'         AND p.classifier_name = 'lc_classifier_stochastic'        AND o.ndet <= 50),detections_r_band AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.magpsf    FROM         detection d    INNER JOIN         filtered_objects fo    ON         d.oid = fo.oid    WHERE         d.fid = 2 -- r-band filter),magstats_r_band AS (    SELECT         m.oid,         m.magmax_corr,         m.magmin_corr    FROM         magstat m    INNER JOIN         filtered_objects fo    ON         m.oid = fo.oid    WHERE         m.fid = 2 -- r-band filter)SELECT     d.oid,     d.candid,     d.fid AS f_id,     fo.meanra,     fo.meandec,     d.magpsf_corr,     d.magpsf,     (m.magmax_corr - m.magmin_corr) AS max_riseFROM     detections_r_band dINNER JOIN     magstats_r_band mON     d.oid = m.oidINNER JOIN     filtered_objects foON     d.oid = fo.oidORDER BY     d.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,41.020668268203735,2025-07-23T20:26:59,"[              oid               candid  f_id      meanra    meandec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816860  45.593583   
1    ZTF17aaaaanb   607270780115015027     2  324.816860  45.593583   
2    ZTF17aaaaanb   613325340115010003     2  324.816860  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816860  45.593583   
4    ZTF17aaaaanb   529390300115015005     2  324.816860  45.593583   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaadapx   793152873615010003     2   83.292583   5.590759   
996  ZTF17aaadapx   718273263615010003     2   83.292583   5.590759   
997  ZTF17aaadasq   687376274015010001     2   71.777250  -1.224087   
998  ZTF17aaadasq  1466249294015015003     2   71.777250  -1.224087   
999  ZTF17aaadasq   674374274015015015     2   71.777250  -1.224087   

     magpsf_corr     magpsf  max_rise  
0      17.878054  19.760700  0.524338  
1      17.857359  19.648392  0.524338  
2      18.342743  19.791729  0.524338  
3      17.898651  19.882864  0.524338  
4      17.863106  19.678644  0.524338  
..           ...        ...       ...  
995    15.696300  17.327000  0.512533  
996    15.786064  16.996100  0.512533  
997    15.967023  17.493600  0.308908  
998    15.671734  18.894800  0.308908  
999    15.672545  18.910700  0.308908  

[1000 rows x 8 columns]]",,27.690428733825684,2025-07-25T11:49:49,0.939,0.942,0.75,0.75,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,10,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,         o.meanra,         o.meandec,         o.ndet    FROM         object o    INNER JOIN         probability p    ON         o.oid = p.oid    WHERE         p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier'        AND p.ranking = 1        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.magpsf    FROM         detection d    WHERE         d.fid = 2 -- r-band filter),r_band_magstats AS (    SELECT         m.oid,         m.magmax_corr,         m.magmin_corr,         (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    WHERE         m.fid = 2 -- r-band filter)SELECT     fo.oid,     rd.candid,     rd.fid AS f_id,     fo.meanra,     fo.meandec,     rd.magpsf_corr,     rd.magpsf,     rms.max_riseFROM     filtered_objects foINNER JOIN     r_band_detections rdON     fo.oid = rd.oidINNER JOIN     r_band_magstats rmsON     fo.oid = rms.oidORDER BY     fo.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.519238471984863,2025-07-23T20:27:29,"[              oid               candid  f_id     meanra    meandec  \
0    ZTF17aaaagbn  2144326145315010012     2  86.961766  36.581581   
1    ZTF17aaaagbn  2146359715315010004     2  86.961766  36.581581   
2    ZTF17aaaagbn  2148379005315010068     2  86.961766  36.581581   
3    ZTF17aaaagbn  2429471815315010008     2  86.961766  36.581581   
4    ZTF17aaaagbn  2767487322415015006     2  86.961766  36.581581   
..            ...                  ...   ...        ...        ...   
995  ZTF17aabgohw  2786499423115010003     2  98.666799  14.032232   
996  ZTF17aabgohw  2785500173115015010     2  98.666799  14.032232   
997  ZTF17aabgohw  2785500173115015009     2  98.666799  14.032232   
998  ZTF17aabgohw  2784499363115015006     2  98.666799  14.032232   
999  ZTF17aabgohw  2784495993115015011     2  98.666799  14.032232   

     magpsf_corr     magpsf  max_rise  
0      17.639595  16.610700  0.995937  
1      16.394550  18.551500  0.995937  
2      16.667952  17.504500  0.995937  
3      16.957747  17.059800  0.995937  
4      16.190163  18.536910  0.995937  
..           ...        ...       ...  
995    16.522040  18.626333  0.000000  
996    16.105429  17.746517  0.000000  
997    16.062378  17.563713  0.000000  
998    15.820771  16.814713  0.000000  
999    15.777356  16.709350  0.000000  

[1000 rows x 8 columns]]",,16.70556139945984,2025-07-25T11:50:10,0.107,0.079,0.75,0.75,0.0,0.0
