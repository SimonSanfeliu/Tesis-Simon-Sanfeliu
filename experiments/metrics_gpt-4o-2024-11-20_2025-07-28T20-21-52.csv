code_tag,llm_used,prompt_version,query_id,query_run,sql_query,tab_schema,label,query_gen_time,query_gen_date,query_results,query_error,sql_time,sql_date,r_row,p_row,r_col,p_col,N_perfect_row,N_perfect_col
0.20.2,,,8,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygrgk        11      4240  58389.123657  60532.194988      False   
1    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
2    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
183  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   
184  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
185  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
186  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     2       NaN           NaN  ...  60173.182234  60532.194988   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.169005  60173.169005   
3      False     1       NaN           NaN  ...  60173.178461  60173.178461   
4      False     1       NaN           NaN  ...  60173.176100  60173.176100   
..       ...   ...       ...           ...  ...           ...           ...   
182     True     2       NaN           NaN  ...  60175.189734  60820.339375   
183    False     1       NaN           NaN  ...  60175.194340  60175.194340   
184    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
185     True     2       NaN           NaN  ...  60175.185301  60465.343935   
186     True     2       NaN           NaN  ...  60175.192697  60182.239526   

     step_id_corr  diffpos  reference_change   classifier_name  \
0        24.5.2a6     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182        27.5.6     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   
185        24.5.1     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.416646       1  
1    stamp_classifier_1.0.4          SN     0.639198       1  
2    stamp_classifier_1.0.4          SN     0.514766       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.526146       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.321883       1  
183  stamp_classifier_1.0.4          SN     0.569558       1  
184  stamp_classifier_1.0.4          SN     0.698527       1  
185  stamp_classifier_1.0.4          SN     0.317975       1  
186  stamp_classifier_1.0.4          SN     0.631699       1  

[187 rows x 27 columns]]",,22.522587299346924,2025-07-28T15:52:50,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
1    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
2    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
3    ZTF23aaucgeg        83      1389  60149.250000  60201.250000      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     2       NaN           NaN  ...  60150.202280  60152.248021   
1      False    13 -0.039900      0.696680  ...  60150.192847  60179.176910   
2      False     2       NaN           NaN  ...  60150.203218  60553.257732   
3      False    10  0.101021           NaN  ...  60150.308704  60201.211516   
4      False     4  0.134600      0.192719  ...  60150.214896  60162.228056   
..       ...   ...       ...           ...  ...           ...           ...   
340    False    48       NaN           NaN  ...  60153.465174  60592.424248   
341    False     1       NaN           NaN  ...  60153.473704  60153.473704   
342    False     1       NaN           NaN  ...  60153.490694  60153.490694   
343    False    10       NaN           NaN  ...  60153.488264  60161.484780   
344    False    11       NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2        24.5.2a6     True             False  stamp_classifier   
3           1.2.1     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340      24.5.2a6     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.412764       1  
1    stamp_classifier_1.0.4          SN     0.639903       1  
2    stamp_classifier_1.0.4          SN     0.410632       1  
3    stamp_classifier_1.0.4          SN     0.622625       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.615143       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.540236       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,23.105437994003296,2025-07-28T15:53:13,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaukrec         1      1165  60150.250000  60150.250000       True   
1    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
2    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
3    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
4    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
341  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
342  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
343  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1      NaN           NaN  ...  60150.369815  60150.369815   
1      False    13  -0.0399       0.69668  ...  60150.192847  60179.176910   
2      False     2      NaN           NaN  ...  60150.202280  60152.248021   
3       True   154      NaN           NaN  ...  60150.202743  60876.277164   
4      False     2      NaN           NaN  ...  60150.203218  60553.257732   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    10      NaN           NaN  ...  60153.488264  60161.484780   
341    False    48      NaN           NaN  ...  60153.465174  60592.424248   
342    False     1      NaN           NaN  ...  60153.473704  60153.473704   
343    False     2      NaN           NaN  ...  60153.488264  60760.241343   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3          27.5.6     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341      24.5.2a6     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343        27.5.2     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.544984       1  
1    stamp_classifier_1.0.4          SN     0.639903       1  
2    stamp_classifier_1.0.4          SN     0.412764       1  
3    stamp_classifier_1.0.4          SN     0.388430       1  
4    stamp_classifier_1.0.4          SN     0.410632       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.511295       1  
341  stamp_classifier_1.0.4          SN     0.615143       1  
342  stamp_classifier_1.0.4          SN     0.521393       1  
343  stamp_classifier_1.0.4          SN     0.362726       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,10.712292909622192,2025-07-28T15:53:24,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.440136909484863,2025-07-28T15:53:35,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,12.057996988296509,2025-07-28T15:53:48,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.66891360282898,2025-07-28T15:53:59,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,13.257810592651367,2025-07-28T15:54:12,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,16.60610342025757,2025-07-28T15:54:29,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF18abhccag         3      2568  58315.250000  60233.250000      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13 -0.039900       0.69668  ...  60150.192847  60179.176910   
1      False     2       NaN           NaN  ...  60150.202280  60152.248021   
2       True   154       NaN           NaN  ...  60150.202743  60876.277164   
3      False     2       NaN           NaN  ...  60150.203218  60553.257732   
4      False     2  1.778375           NaN  ...  60150.227512  60233.127049   
..       ...   ...       ...           ...  ...           ...           ...   
340    False    21       NaN           NaN  ...  60153.466181  60223.450579   
341    False    11       NaN           NaN  ...  60153.495544  60162.481875   
342    False     2       NaN           NaN  ...  60153.488264  60760.241343   
343    False     1       NaN           NaN  ...  60153.490694  60153.490694   
344    False    10       NaN           NaN  ...  60153.488264  60161.484780   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.1     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.332478       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.672242       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.511295       1  

[345 rows x 27 columns]]",,10.53470754623413,2025-07-28T15:54:40,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,14.55016827583313,2025-07-28T15:54:55,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,8,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.52993106842041,2025-07-28T15:55:06,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,27,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
1    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
2    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
3    ZTF23aaygxxt         7      1990  60173.250000  60183.250000      False   
4    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   
183  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
184  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
185  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
186  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.176100  60173.176100   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.169005  60173.169005   
3      False     3 -0.024101           NaN  ...  60173.196076  60183.185579   
4      False     1       NaN           NaN  ...  60173.178461  60173.178461   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     1       NaN           NaN  ...  60175.194340  60175.194340   
183     True     2       NaN           NaN  ...  60175.185301  60465.343935   
184     True     2       NaN           NaN  ...  60175.189734  60820.339375   
185    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
186     True     2       NaN           NaN  ...  60175.192697  60182.239526   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183        24.5.1     True             False  stamp_classifier   
184        27.5.6     True             False  stamp_classifier   
185         1.2.0     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.526146       1  
1    stamp_classifier_1.0.4          SN     0.639198       1  
2    stamp_classifier_1.0.4          SN     0.514766       1  
3    stamp_classifier_1.0.4          SN     0.707308       1  
4    stamp_classifier_1.0.4          SN     0.657241       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.569558       1  
183  stamp_classifier_1.0.4          SN     0.317975       1  
184  stamp_classifier_1.0.4          SN     0.321883       1  
185  stamp_classifier_1.0.4          SN     0.698527       1  
186  stamp_classifier_1.0.4          SN     0.631699       1  

[187 rows x 27 columns]]",,4.268059492111206,2025-07-28T15:55:11,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
341  ZTF23aapjbxt         5      1621  60118.500000  60153.500000       True   
342  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
343  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    10      NaN           NaN  ...  60153.488264  60161.484780   
341    False     1      NaN           NaN  ...  60153.466181  60153.466181   
342    False    21      NaN           NaN  ...  60153.466181  60223.450579   
343    False     2      NaN           NaN  ...  60153.488264  60760.241343   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.1     True             False  stamp_classifier   
343        27.5.2     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.511295       1  
341  stamp_classifier_1.0.4          SN     0.664004       1  
342  stamp_classifier_1.0.4          SN     0.798089       1  
343  stamp_classifier_1.0.4          SN     0.362726       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.92061448097229,2025-07-28T15:55:23,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    48      NaN           NaN  ...  60153.465174  60592.424248   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False    11      NaN           NaN  ...  60153.495544  60162.481875   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340      24.5.2a6     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.615143       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,10.76599097251892,2025-07-28T15:55:35,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,13.14687156677246,2025-07-28T15:55:48,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.529870986938477,2025-07-28T15:55:59,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.893426656723022,2025-07-28T15:56:11,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,14.487812519073486,2025-07-28T15:56:26,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.689976453781128,2025-07-28T15:56:38,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
4    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
4      False     2      NaN           NaN  ...  60150.203218  60553.257732   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.480507       1  
4    stamp_classifier_1.0.4          SN     0.410632       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.32528042793274,2025-07-28T15:56:48,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.437682628631592,2025-07-28T15:57:00,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,27,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.89592146873474,2025-07-28T15:57:11,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,17,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
183  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
184  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   
185  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
186  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.176100  60173.176100   
3      False     1       NaN           NaN  ...  60173.178461  60173.178461   
4      False     6       NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
183     True     2       NaN           NaN  ...  60175.192697  60182.239526   
184    False     1       NaN           NaN  ...  60175.194340  60175.194340   
185     True     2       NaN           NaN  ...  60175.185301  60465.343935   
186     True     2       NaN           NaN  ...  60175.189734  60820.339375   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   
185        24.5.1     True             False  stamp_classifier   
186        27.5.6     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.698527       1  
183  stamp_classifier_1.0.4          SN     0.631699       1  
184  stamp_classifier_1.0.4          SN     0.569558       1  
185  stamp_classifier_1.0.4          SN     0.317975       1  
186  stamp_classifier_1.0.4          SN     0.321883       1  

[187 rows x 27 columns]]",,4.266796827316284,2025-07-28T15:57:16,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
3    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2      False     2      NaN           NaN  ...  60150.203218  60553.257732   
3       True   154      NaN           NaN  ...  60150.202743  60876.277164   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2        24.5.2a6     True             False  stamp_classifier   
3          27.5.6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.410632       1  
3    stamp_classifier_1.0.4          SN     0.388430       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.83229947090149,2025-07-28T15:57:27,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
3    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2      False     2      NaN           NaN  ...  60150.203218  60553.257732   
3       True   154      NaN           NaN  ...  60150.202743  60876.277164   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False    11      NaN           NaN  ...  60153.495544  60162.481875   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2        24.5.2a6     True             False  stamp_classifier   
3          27.5.6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.410632       1  
3    stamp_classifier_1.0.4          SN     0.388430       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.672242       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,10.083595514297484,2025-07-28T15:57:38,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.51288366317749,2025-07-28T15:57:49,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.073568344116213,2025-07-28T15:58:00,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.840585708618164,2025-07-28T15:58:12,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,12.19280219078064,2025-07-28T15:58:25,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.458810806274414,2025-07-28T15:58:37,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False    11      NaN           NaN  ...  60153.495544  60162.481875   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,12.490228176116943,2025-07-28T15:58:51,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,13.67190933227539,2025-07-28T15:59:05,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,17,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.867135763168337,2025-07-28T15:59:18,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,37,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygxxt         7      1990  60173.250000  60183.250000      False   
1    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
2    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
3    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
4    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF18aadvuhz         2      4538  59097.500000  60174.500000       True   
183  ZTF23aazhliv         2       853  60175.178183  60883.233322       True   
184  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
185  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
186  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     3 -0.024101           NaN  ...  60173.196076  60183.185579   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.169005  60173.169005   
3      False     1       NaN           NaN  ...  60173.176100  60173.176100   
4      False     1       NaN           NaN  ...  60173.178461  60173.178461   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     1       NaN           NaN  ...  60174.505822  60174.505822   
183     True     2       NaN           NaN  ...  60175.178183  60883.233322   
184     True     2       NaN           NaN  ...  60175.189734  60820.339375   
185     True     2       NaN           NaN  ...  60175.192697  60182.239526   
186    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183        27.5.6     True             False  stamp_classifier   
184        27.5.6     True             False  stamp_classifier   
185         1.2.0     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.707308       1  
1    stamp_classifier_1.0.4          SN     0.639198       1  
2    stamp_classifier_1.0.4          SN     0.514766       1  
3    stamp_classifier_1.0.4          SN     0.526146       1  
4    stamp_classifier_1.0.4          SN     0.657241       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.654818       1  
183  stamp_classifier_1.0.4          SN     0.433982       1  
184  stamp_classifier_1.0.4          SN     0.321883       1  
185  stamp_classifier_1.0.4          SN     0.631699       1  
186  stamp_classifier_1.0.4          SN     0.569558       1  

[187 rows x 27 columns]]",,4.3222737312316895,2025-07-28T15:59:23,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aauxssd        66      1202  59739.438391  60878.316250       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavdzpd        51      1402  60153.500000  60211.500000       True   
341  ZTF23aaveabg        10      2964  59087.250000  60202.250000      False   
342  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
343  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
344  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13 -0.039900      0.696680  ...  60150.192847  60179.176910   
1      False     2       NaN           NaN  ...  60150.202280  60152.248021   
2       True   154       NaN           NaN  ...  60150.202743  60876.277164   
3      False     2       NaN           NaN  ...  60150.203218  60553.257732   
4      False    15       NaN           NaN  ...  60150.312002  60878.316250   
..       ...   ...       ...           ...  ...           ...           ...   
340    False    28 -0.121210      0.004293  ...  60153.434687  60211.428993   
341    False     2  0.349134           NaN  ...  60153.442037  60202.223102   
342    False    48       NaN           NaN  ...  60153.465174  60592.424248   
343    False     1       NaN           NaN  ...  60153.473704  60153.473704   
344    False     2       NaN           NaN  ...  60153.488264  60760.241343   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4          27.5.6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.1     True             False  stamp_classifier   
342      24.5.2a6     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344        27.5.2     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.644368       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.575311       1  
341  stamp_classifier_1.0.4          SN     0.322426       1  
342  stamp_classifier_1.0.4          SN     0.615143       1  
343  stamp_classifier_1.0.4          SN     0.521393       1  
344  stamp_classifier_1.0.4          SN     0.362726       1  

[345 rows x 27 columns]]",,12.173713207244871,2025-07-28T15:59:36,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aauhzmk        91      1504  60150.250000  60207.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23abadofi       281      2689  59461.403287  60694.127512       True   
341  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13 -0.039900      0.696680  ...  60150.192847  60179.176910   
1      False     2       NaN           NaN  ...  60150.202280  60152.248021   
2       True   154       NaN           NaN  ...  60150.202743  60876.277164   
3      False     2       NaN           NaN  ...  60150.203218  60553.257732   
4      False    37  0.109176      0.210222  ...  60150.309178  60207.186643   
..       ...   ...       ...           ...  ...           ...           ...   
340    False   100       NaN           NaN  ...  60153.460463  60694.127512   
341    False    48       NaN           NaN  ...  60153.465174  60592.424248   
342    False    10       NaN           NaN  ...  60153.488264  60161.484780   
343    False     1       NaN           NaN  ...  60153.490694  60153.490694   
344    False    11       NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.1     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340        27.0.0     True             False  stamp_classifier   
341      24.5.2a6     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.691511       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.745618       1  
341  stamp_classifier_1.0.4          SN     0.615143       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.065747261047363,2025-07-28T15:59:48,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.983066082000732,2025-07-28T16:00:00,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.2535297870636,2025-07-28T16:00:12,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,12.134321212768556,2025-07-28T16:00:25,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.883570909500122,2025-07-28T16:00:38,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,13.07578182220459,2025-07-28T16:00:52,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False    11      NaN           NaN  ...  60153.495544  60162.481875   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,11.1103093624115,2025-07-28T16:01:04,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.782443761825562,2025-07-28T16:01:16,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,37,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.59688663482666,2025-07-28T16:01:27,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,34,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23abdxsnm       532      3488  58875.487419  60877.301296       True   
1    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
2    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
3    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
4    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazhprx         2       578  60083.250000  60175.250000       True   
183  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
184  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
185  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
186  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False   280       NaN           NaN  ...  60173.217801  60877.301296   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.169005  60173.169005   
3      False     1       NaN           NaN  ...  60173.176100  60173.176100   
4      False     1       NaN           NaN  ...  60173.178461  60173.178461   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     1       NaN           NaN  ...  60175.179132  60175.179132   
183    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
184     True     2       NaN           NaN  ...  60175.189734  60820.339375   
185     True     2       NaN           NaN  ...  60175.192697  60182.239526   
186    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0          27.5.6     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   
184        27.5.6     True             False  stamp_classifier   
185         1.2.0     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.612238       1  
1    stamp_classifier_1.0.4          SN     0.639198       1  
2    stamp_classifier_1.0.4          SN     0.514766       1  
3    stamp_classifier_1.0.4          SN     0.526146       1  
4    stamp_classifier_1.0.4          SN     0.657241       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.574371       1  
183  stamp_classifier_1.0.4          SN     0.698527       1  
184  stamp_classifier_1.0.4          SN     0.321883       1  
185  stamp_classifier_1.0.4          SN     0.631699       1  
186  stamp_classifier_1.0.4          SN     0.569558       1  

[187 rows x 27 columns]]",,4.463166236877441,2025-07-28T16:01:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF18abhccag         3      2568  58315.250000  60233.250000      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13 -0.039900       0.69668  ...  60150.192847  60179.176910   
1      False     2       NaN           NaN  ...  60150.202280  60152.248021   
2       True   154       NaN           NaN  ...  60150.202743  60876.277164   
3      False     2       NaN           NaN  ...  60150.203218  60553.257732   
4      False     2  1.778375           NaN  ...  60150.227512  60233.127049   
..       ...   ...       ...           ...  ...           ...           ...   
340    False    21       NaN           NaN  ...  60153.466181  60223.450579   
341    False     1       NaN           NaN  ...  60153.473704  60153.473704   
342    False    10       NaN           NaN  ...  60153.488264  60161.484780   
343    False     1       NaN           NaN  ...  60153.490694  60153.490694   
344    False    11       NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.1     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.332478       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.120890140533447,2025-07-28T16:01:44,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aapjbxt         5      1621  60118.500000  60153.500000       True   
341  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.466181  60153.466181   
341    False    21      NaN           NaN  ...  60153.466181  60223.450579   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.1     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.664004       1  
341  stamp_classifier_1.0.4          SN     0.798089       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.458173274993896,2025-07-28T16:01:56,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.800487756729126,2025-07-28T16:02:08,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.698864698410034,2025-07-28T16:02:21,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.25942063331604,2025-07-28T16:02:34,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,14.501672744750977,2025-07-28T16:02:50,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.465934753417969,2025-07-28T16:03:02,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaukpbf         1       474  60150.250000  60150.250000       True   
1    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
2    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
3    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
4    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1      NaN           NaN  ...  60150.365104  60150.365104   
1      False    13  -0.0399       0.69668  ...  60150.192847  60179.176910   
2      False     2      NaN           NaN  ...  60150.202280  60152.248021   
3       True   154      NaN           NaN  ...  60150.202743  60876.277164   
4      False     2      NaN           NaN  ...  60150.203218  60553.257732   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    11      NaN           NaN  ...  60153.495544  60162.481875   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3          27.5.6     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.563693       1  
1    stamp_classifier_1.0.4          SN     0.639903       1  
2    stamp_classifier_1.0.4          SN     0.412764       1  
3    stamp_classifier_1.0.4          SN     0.388430       1  
4    stamp_classifier_1.0.4          SN     0.410632       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,10.237059831619264,2025-07-28T16:03:13,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.426223278045654,2025-07-28T16:03:26,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,34,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,12.223615646362305,2025-07-28T16:03:40,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,1,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF23aaygxxt         7      1990  60173.250000  60183.250000      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
183  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
184  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
185  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
186  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.176100  60173.176100   
3      False     1       NaN           NaN  ...  60173.178461  60173.178461   
4      False     3 -0.024101           NaN  ...  60173.196076  60183.185579   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
183     True     2       NaN           NaN  ...  60175.189734  60820.339375   
184     True     2       NaN           NaN  ...  60175.185301  60465.343935   
185     True     2       NaN           NaN  ...  60175.192697  60182.239526   
186    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183        27.5.6     True             False  stamp_classifier   
184        24.5.1     True             False  stamp_classifier   
185         1.2.0     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.707308       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.698527       1  
183  stamp_classifier_1.0.4          SN     0.321883       1  
184  stamp_classifier_1.0.4          SN     0.317975       1  
185  stamp_classifier_1.0.4          SN     0.631699       1  
186  stamp_classifier_1.0.4          SN     0.569558       1  

[187 rows x 27 columns]]",,4.7271130084991455,2025-07-28T16:03:46,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    48      NaN           NaN  ...  60153.465174  60592.424248   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False     1      NaN           NaN  ...  60153.490694  60153.490694   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340      24.5.2a6     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.615143       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.540236       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.903475046157835,2025-07-28T16:03:59,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaukpbf         1       474  60150.250000  60150.250000       True   
1    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
2    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
3    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
4    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1      NaN           NaN  ...  60150.365104  60150.365104   
1      False    13  -0.0399       0.69668  ...  60150.192847  60179.176910   
2      False     2      NaN           NaN  ...  60150.202280  60152.248021   
3       True   154      NaN           NaN  ...  60150.202743  60876.277164   
4      False     2      NaN           NaN  ...  60150.203218  60553.257732   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    11      NaN           NaN  ...  60153.495544  60162.481875   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3          27.5.6     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.563693       1  
1    stamp_classifier_1.0.4          SN     0.639903       1  
2    stamp_classifier_1.0.4          SN     0.412764       1  
3    stamp_classifier_1.0.4          SN     0.388430       1  
4    stamp_classifier_1.0.4          SN     0.410632       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,10.671327829360962,2025-07-28T16:04:11,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.179585695266724,2025-07-28T16:04:23,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.08827829360962,2025-07-28T16:04:36,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.521794557571411,2025-07-28T16:04:49,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.584076642990112,2025-07-28T16:05:01,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.603532552719116,2025-07-28T16:05:13,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    11      NaN           NaN  ...  60153.495544  60162.481875   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,11.474385976791382,2025-07-28T16:05:26,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,12.082921504974363,2025-07-28T16:05:40,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,1,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,13.86865210533142,2025-07-28T16:05:56,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,16,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
183  ZTF23aazhliv         2       853  60175.178183  60883.233322       True   
184  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
185  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
186  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.176100  60173.176100   
3      False     1       NaN           NaN  ...  60173.178461  60173.178461   
4      False     6       NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
183     True     2       NaN           NaN  ...  60175.178183  60883.233322   
184     True     2       NaN           NaN  ...  60175.192697  60182.239526   
185     True     2       NaN           NaN  ...  60175.189734  60820.339375   
186    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183        27.5.6     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   
185        27.5.6     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.698527       1  
183  stamp_classifier_1.0.4          SN     0.433982       1  
184  stamp_classifier_1.0.4          SN     0.631699       1  
185  stamp_classifier_1.0.4          SN     0.321883       1  
186  stamp_classifier_1.0.4          SN     0.569558       1  

[187 rows x 27 columns]]",,4.33201265335083,2025-07-28T16:06:02,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aauhzmk        91      1504  60150.250000  60207.250000       True   
1    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37  0.109176      0.210222  ...  60150.309178  60207.186643   
1      False    13 -0.039900      0.696680  ...  60150.192847  60179.176910   
2       True   154       NaN           NaN  ...  60150.202743  60876.277164   
3      False     2       NaN           NaN  ...  60150.203218  60553.257732   
4      False     4  0.134600      0.192719  ...  60150.214896  60162.228056   
..       ...   ...       ...           ...  ...           ...           ...   
340    False    21       NaN           NaN  ...  60153.466181  60223.450579   
341    False     1       NaN           NaN  ...  60153.473704  60153.473704   
342    False    10       NaN           NaN  ...  60153.488264  60161.484780   
343    False    11       NaN           NaN  ...  60153.495544  60162.481875   
344    False     1       NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.1     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.691511       1  
1    stamp_classifier_1.0.4          SN     0.639903       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,10.751274824142456,2025-07-28T16:06:15,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.767341136932371,2025-07-28T16:06:28,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.72895121574402,2025-07-28T16:06:42,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.693433046340942,2025-07-28T16:06:54,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.153661012649536,2025-07-28T16:07:05,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.151492357254028,2025-07-28T16:07:17,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.033920526504517,2025-07-28T16:07:29,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aauhzmk        91      1504  60150.250000  60207.250000       True   
1    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
2    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
3    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
4    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
343  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37  0.109176      0.210222  ...  60150.309178  60207.186643   
1      False    13 -0.039900      0.696680  ...  60150.192847  60179.176910   
2      False     2       NaN           NaN  ...  60150.202280  60152.248021   
3       True   154       NaN           NaN  ...  60150.202743  60876.277164   
4      False     2       NaN           NaN  ...  60150.203218  60553.257732   
..       ...   ...       ...           ...  ...           ...           ...   
340    False     1       NaN           NaN  ...  60153.473704  60153.473704   
341    False    10       NaN           NaN  ...  60153.488264  60161.484780   
342    False     1       NaN           NaN  ...  60153.490694  60153.490694   
343    False     2       NaN           NaN  ...  60153.488264  60760.241343   
344    False    11       NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.1     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3          27.5.6     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343        27.5.2     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.691511       1  
1    stamp_classifier_1.0.4          SN     0.639903       1  
2    stamp_classifier_1.0.4          SN     0.412764       1  
3    stamp_classifier_1.0.4          SN     0.388430       1  
4    stamp_classifier_1.0.4          SN     0.410632       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.540236       1  
343  stamp_classifier_1.0.4          SN     0.362726       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.19090723991394,2025-07-28T16:07:42,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,9.888400077819824,2025-07-28T16:07:54,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,16,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,12.06432557106018,2025-07-28T16:08:08,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,19,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
183  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
184  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
185  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   
186  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.176100  60173.176100   
3      False     1       NaN           NaN  ...  60173.178461  60173.178461   
4      False     6       NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
183     True     2       NaN           NaN  ...  60175.185301  60465.343935   
184     True     2       NaN           NaN  ...  60175.192697  60182.239526   
185    False     1       NaN           NaN  ...  60175.194340  60175.194340   
186     True     2       NaN           NaN  ...  60175.189734  60820.339375   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183        24.5.1     True             False  stamp_classifier   
184         1.2.0     True             False  stamp_classifier   
185         1.2.0     True             False  stamp_classifier   
186        27.5.6     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.698527       1  
183  stamp_classifier_1.0.4          SN     0.317975       1  
184  stamp_classifier_1.0.4          SN     0.631699       1  
185  stamp_classifier_1.0.4          SN     0.569558       1  
186  stamp_classifier_1.0.4          SN     0.321883       1  

[187 rows x 27 columns]]",,4.1298136711120605,2025-07-28T16:08:14,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
341  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
342  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     2      NaN           NaN  ...  60153.488264  60760.241343   
341    False    48      NaN           NaN  ...  60153.465174  60592.424248   
342    False     1      NaN           NaN  ...  60153.473704  60153.473704   
343    False    11      NaN           NaN  ...  60153.495544  60162.481875   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340        27.5.2     True             False  stamp_classifier   
341      24.5.2a6     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.362726       1  
341  stamp_classifier_1.0.4          SN     0.615143       1  
342  stamp_classifier_1.0.4          SN     0.521393       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,10.115272521972656,2025-07-28T16:08:26,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     1      NaN           NaN  ...  60153.490694  60153.490694   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.540236       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,9.553457021713257,2025-07-28T16:08:38,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.694368600845335,2025-07-28T16:08:52,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.479180097579956,2025-07-28T16:09:05,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.230104923248293,2025-07-28T16:09:18,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,12.914685249328612,2025-07-28T16:09:32,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.739989757537842,2025-07-28T16:09:45,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.504059314727783,2025-07-28T16:09:59,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.751877784729004,2025-07-28T16:10:13,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,19,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.585952520370483,2025-07-28T16:10:26,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,14,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazhofz         2      1852  59788.250000  60175.250000       True   
183  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
184  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
185  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
186  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1      NaN           NaN  ...  60173.169005  60173.169005   
1      False     1      NaN           NaN  ...  60173.169005  60173.169005   
2      False     1      NaN           NaN  ...  60173.176100  60173.176100   
3      False     1      NaN           NaN  ...  60173.178461  60173.178461   
4      False     6      NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...      ...           ...  ...           ...           ...   
182    False     1      NaN           NaN  ...  60175.181007  60175.181007   
183     True     2      NaN           NaN  ...  60175.189734  60820.339375   
184     True     2      NaN           NaN  ...  60175.185301  60465.343935   
185     True     2      NaN           NaN  ...  60175.192697  60182.239526   
186    False     1      NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183        27.5.6     True             False  stamp_classifier   
184        24.5.1     True             False  stamp_classifier   
185         1.2.0     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.622088       1  
183  stamp_classifier_1.0.4          SN     0.321883       1  
184  stamp_classifier_1.0.4          SN     0.317975       1  
185  stamp_classifier_1.0.4          SN     0.631699       1  
186  stamp_classifier_1.0.4          SN     0.569558       1  

[187 rows x 27 columns]]",,4.240772247314453,2025-07-28T16:10:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
1    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
341  ZTF23aapjbxt         5      1621  60118.500000  60153.500000       True   
342  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
343  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
344  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     2      NaN           NaN  ...  60150.202280  60152.248021   
1      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    11      NaN           NaN  ...  60153.495544  60162.481875   
341    False     1      NaN           NaN  ...  60153.466181  60153.466181   
342    False    21      NaN           NaN  ...  60153.466181  60223.450579   
343    False     2      NaN           NaN  ...  60153.488264  60760.241343   
344    False    10      NaN           NaN  ...  60153.488264  60161.484780   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.1     True             False  stamp_classifier   
343        27.5.2     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.412764       1  
1    stamp_classifier_1.0.4          SN     0.639903       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.672242       1  
341  stamp_classifier_1.0.4          SN     0.664004       1  
342  stamp_classifier_1.0.4          SN     0.798089       1  
343  stamp_classifier_1.0.4          SN     0.362726       1  
344  stamp_classifier_1.0.4          SN     0.511295       1  

[345 rows x 27 columns]]",,11.272550106048584,2025-07-28T16:10:47,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.490694  60153.490694   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.540236       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.389719486236572,2025-07-28T16:11:00,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.25205898284912,2025-07-28T16:11:12,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.515976667404177,2025-07-28T16:11:25,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.085453033447266,2025-07-28T16:11:39,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.426708936691284,2025-07-28T16:11:52,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,15.081489086151125,2025-07-28T16:12:09,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aauhzmk        91      1504  60150.250000  60207.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13 -0.039900      0.696680  ...  60150.192847  60179.176910   
1      False     2       NaN           NaN  ...  60150.202280  60152.248021   
2       True   154       NaN           NaN  ...  60150.202743  60876.277164   
3      False     2       NaN           NaN  ...  60150.203218  60553.257732   
4      False    37  0.109176      0.210222  ...  60150.309178  60207.186643   
..       ...   ...       ...           ...  ...           ...           ...   
340    False    21       NaN           NaN  ...  60153.466181  60223.450579   
341    False    11       NaN           NaN  ...  60153.495544  60162.481875   
342    False     2       NaN           NaN  ...  60153.488264  60760.241343   
343    False    10       NaN           NaN  ...  60153.488264  60161.484780   
344    False     1       NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.1     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.691511       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.672242       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,9.989853382110596,2025-07-28T16:12:21,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.181354522705078,2025-07-28T16:12:34,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,14,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.477488994598389,2025-07-28T16:12:46,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,30,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
2    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
3    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
183  ZTF23aazihap         4      2012  58561.436933  60820.339375       True   
184  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
185  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
186  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.178461  60173.178461   
2      False     1       NaN           NaN  ...  60173.169005  60173.169005   
3      False     1       NaN           NaN  ...  60173.176100  60173.176100   
4      False     6       NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
183     True     2       NaN           NaN  ...  60175.189734  60820.339375   
184     True     2       NaN           NaN  ...  60175.185301  60465.343935   
185     True     2       NaN           NaN  ...  60175.192697  60182.239526   
186    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183        27.5.6     True             False  stamp_classifier   
184        24.5.1     True             False  stamp_classifier   
185         1.2.0     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.657241       1  
2    stamp_classifier_1.0.4          SN     0.514766       1  
3    stamp_classifier_1.0.4          SN     0.526146       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.698527       1  
183  stamp_classifier_1.0.4          SN     0.321883       1  
184  stamp_classifier_1.0.4          SN     0.317975       1  
185  stamp_classifier_1.0.4          SN     0.631699       1  
186  stamp_classifier_1.0.4          SN     0.569558       1  

[187 rows x 27 columns]]",,4.121909856796265,2025-07-28T16:12:54,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
341  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
342  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     2      NaN           NaN  ...  60153.488264  60760.241343   
341    False    11      NaN           NaN  ...  60153.495544  60162.481875   
342    False     1      NaN           NaN  ...  60153.473704  60153.473704   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340        27.5.2     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.362726       1  
341  stamp_classifier_1.0.4          SN     0.672242       1  
342  stamp_classifier_1.0.4          SN     0.521393       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,11.031714677810667,2025-07-28T16:13:08,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aaukpbf         1       474  60150.250000  60150.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
341  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399       0.69668  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     1      NaN           NaN  ...  60150.365104  60150.365104   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    48      NaN           NaN  ...  60153.465174  60592.424248   
341    False     1      NaN           NaN  ...  60153.490694  60153.490694   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340      24.5.2a6     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.563693       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.615143       1  
341  stamp_classifier_1.0.4          SN     0.540236       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,9.92654585838318,2025-07-28T16:13:21,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.915709733963013,2025-07-28T16:13:35,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.08051300048828,2025-07-28T16:13:48,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.380645275115969,2025-07-28T16:14:01,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,12.918846607208252,2025-07-28T16:14:16,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,13.171745538711548,2025-07-28T16:14:32,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
3    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
4    ZTF23aauhzmk        91      1504  60150.250000  60207.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13 -0.039900      0.696680  ...  60150.192847  60179.176910   
1      False     2       NaN           NaN  ...  60150.202280  60152.248021   
2      False     2       NaN           NaN  ...  60150.203218  60553.257732   
3       True   154       NaN           NaN  ...  60150.202743  60876.277164   
4      False    37  0.109176      0.210222  ...  60150.309178  60207.186643   
..       ...   ...       ...           ...  ...           ...           ...   
340    False     2       NaN           NaN  ...  60153.488264  60760.241343   
341    False     1       NaN           NaN  ...  60153.473704  60153.473704   
342    False    10       NaN           NaN  ...  60153.488264  60161.484780   
343    False    11       NaN           NaN  ...  60153.495544  60162.481875   
344    False     1       NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2        24.5.2a6     True             False  stamp_classifier   
3          27.5.6     True             False  stamp_classifier   
4           1.2.1     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340        27.5.2     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.410632       1  
3    stamp_classifier_1.0.4          SN     0.388430       1  
4    stamp_classifier_1.0.4          SN     0.691511       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.362726       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.672242       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,9.939101457595823,2025-07-28T16:14:44,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    10      NaN           NaN  ...  60153.488264  60161.484780   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.50996208190918,2025-07-28T16:14:57,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,30,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,9.92535400390625,2025-07-28T16:15:09,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,22,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
1    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
2    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
3    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
4    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
..            ...       ...       ...           ...           ...        ...   
182  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
183  ZTF23aazhprx         2       578  60083.250000  60175.250000       True   
184  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
185  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
186  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.169005  60173.169005   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.176100  60173.176100   
3      False     1       NaN           NaN  ...  60173.178461  60173.178461   
4      False     6       NaN           NaN  ...  60173.180822  60532.194178   
..       ...   ...       ...           ...  ...           ...           ...   
182    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
183    False     1       NaN           NaN  ...  60175.179132  60175.179132   
184     True     2       NaN           NaN  ...  60175.185301  60465.343935   
185     True     2       NaN           NaN  ...  60175.192697  60182.239526   
186    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
182         1.2.0     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   
184        24.5.1     True             False  stamp_classifier   
185         1.2.0     True             False  stamp_classifier   
186         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639198       1  
1    stamp_classifier_1.0.4          SN     0.514766       1  
2    stamp_classifier_1.0.4          SN     0.526146       1  
3    stamp_classifier_1.0.4          SN     0.657241       1  
4    stamp_classifier_1.0.4          SN     0.306560       1  
..                      ...         ...          ...     ...  
182  stamp_classifier_1.0.4          SN     0.698527       1  
183  stamp_classifier_1.0.4          SN     0.574371       1  
184  stamp_classifier_1.0.4          SN     0.317975       1  
185  stamp_classifier_1.0.4          SN     0.631699       1  
186  stamp_classifier_1.0.4          SN     0.569558       1  

[187 rows x 27 columns]]",,4.553363561630249,2025-07-28T16:15:15,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,1,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,25.851146697998047,2025-07-23T17:58:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
341  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    48      NaN           NaN  ...  60153.465174  60592.424248   
341    False    11      NaN           NaN  ...  60153.495544  60162.481875   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340      24.5.2a6     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.615143       1  
341  stamp_classifier_1.0.4          SN     0.672242       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,11.19461464881897,2025-07-28T16:15:29,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,2,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classifier is 'stamp_classifier'  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.433448314666748,2025-07-23T17:58:42,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aaukrec         1      1165  60150.250000  60150.250000       True   
4    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavefel        73      1483  59906.259201  60592.424248       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399       0.69668  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     1      NaN           NaN  ...  60150.369815  60150.369815   
4      False     2      NaN           NaN  ...  60150.203218  60553.257732   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    48      NaN           NaN  ...  60153.465174  60592.424248   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340      24.5.2a6     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.544984       1  
4    stamp_classifier_1.0.4          SN     0.410632       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.615143       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.598124742507936,2025-07-28T16:15:41,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,3,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150.0 AND 60154.0 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.76308822631836,2025-07-23T17:59:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.29366374015808,2025-07-28T16:15:53,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,4,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.633710384368896,2025-07-23T17:59:28,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.999984741210938,2025-07-28T16:16:06,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,5,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier -- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.85179662704468,2025-07-23T17:59:49,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.78452730178833,2025-07-28T16:16:19,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,6,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, 2023, with a probability > 0.5 or at least 2 detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least 2 detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,27.689382791519165,2025-07-23T18:00:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.35616135597229,2025-07-28T16:16:31,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,7,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.80577397346497,2025-07-23T18:00:41,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,10.75000286102295,2025-07-28T16:16:45,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,8,"-- Query to retrieve all objects first classified as 'SN' by the stamp classifier-- between August 17 and August 21, with a probability > 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,29.65048789978028,2025-07-23T18:01:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False    11      NaN           NaN  ...  60153.495544  60162.481875   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.672242       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,12.979931831359863,2025-07-28T16:17:01,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,9,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability    ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Most likely classification  AND (      probability.probability > 0.5 -- Probability greater than 0.5      OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,35.96009922027588,2025-07-23T18:01:46,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,14.336446523666382,2025-07-28T16:17:17,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,22,10,"-- Query to retrieve all objects classified as 'SN' by the stamp classifier between August 17 and August 21, 2023,-- with a probability greater than 0.5 or at least two detections.SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidWHERE probability.class_name = 'SN' -- Classification as 'SN'  AND probability.classifier_name = 'stamp_classifier' -- Classified by the stamp classifier  AND probability.ranking = 1 -- Only the most likely classification  AND (    probability.probability > 0.5 -- Probability greater than 0.5    OR object.ndet >= 2 -- At least two detections  )  AND object.firstmjd BETWEEN 60150 AND 60154 -- First detection time between August 17 and August 21, 2023ORDER BY object.firstmjd ASC -- Sort results by first detection time in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.081214666366577,2025-07-23T18:02:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1165      2709  58218.508056  60876.277164       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
341  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
342  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   154      NaN           NaN  ...  60150.202743  60876.277164   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False     1      NaN           NaN  ...  60153.473704  60153.473704   
341    False     2      NaN           NaN  ...  60153.488264  60760.241343   
342    False    10      NaN           NaN  ...  60153.488264  60161.484780   
343    False     1      NaN           NaN  ...  60153.490694  60153.490694   
344    False    11      NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2          27.5.6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.0     True             False  stamp_classifier   
341        27.5.2     True             False  stamp_classifier   
342         1.2.0     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.521393       1  
341  stamp_classifier_1.0.4          SN     0.362726       1  
342  stamp_classifier_1.0.4          SN     0.511295       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,11.685245275497437,2025-07-28T16:17:32,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,12,0,"
SELECT
    object.oid, object.meanra, object.meandec, object.ndet,
    object.firstMJD, object.deltajd, object.g_r_max,
    probability.classifier_name, probability.class_name,
    probability.ranking, probability.probability
FROM
    object INNER JOIN probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name = 'lc_classifier'
    AND object.ndet >= 100
    AND object.oid IN
(
SELECT
    oid
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND class_name IN ('CEP')
    AND ranking = 1
    AND probability > 0.76
)
",,,,,"[               oid      meanra    meandec  ndet      firstmjd      deltajd  \
0     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
1     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
2     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
3     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
4     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
...            ...         ...        ...   ...           ...          ...   
5515  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5516  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5517  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5518  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5519  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   

      g_r_max classifier_name class_name  ranking  probability  
0         NaN   lc_classifier        AGN       14     0.000104  
1         NaN   lc_classifier        AGN       15     0.000976  
2         NaN   lc_classifier     Blazar       13     0.000312  
3         NaN   lc_classifier     Blazar       13     0.003416  
4         NaN   lc_classifier        CEP        1     0.791208  
...       ...             ...        ...      ...          ...  
5515      NaN   lc_classifier      SNIbc       12     0.000452  
5516      NaN   lc_classifier       SNII       10     0.017820  
5517      NaN   lc_classifier       SNII       12     0.000452  
5518      NaN   lc_classifier        YSO        2     0.092564  
5519      NaN   lc_classifier        YSO        4     0.033216  

[5520 rows x 11 columns]]",,6.347864389419556,2025-07-28T16:17:41,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,12,1,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND EXISTS (    SELECT 1    FROM probability p    WHERE p.oid = o.oid      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,5.922004222869873,2025-07-23T18:40:19,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 19:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND EXISTS (
        SELECT 1
        FROM probability p
        WHERE 
            p.oid = o.oid  -- Join condition between object and probability tables
            AND p.classifier_name = 'lc_classifier'  -- Default condition for classifier_name
            AND p.ranking = 1  -- Default condition for ranking
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.516453504562378,2025-07-28T16:24:59,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,2,"SELECT     object.oid,     object.meanra,     object.meandecFROM     objectINNER JOIN     probability ON     object.oid = probability.oidWHERE     probability.ranking = 1    AND probability.classifier_name = 'lc_classifier'    AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types    AND object.firstmjd BETWEEN 59988.0 AND 60197.0 -- February 13 to September 10    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.423312902450561,2025-07-23T18:40:22,[None],"(psycopg2.errors.UndefinedColumn) column probability.class does not exist
LINE 16:     AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN...
                 ^

[SQL: 
-- Corrected SQL Query
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec
FROM 
    object
INNER JOIN 
    probability 
ON 
    object.oid = probability.oid
WHERE 
    probability.ranking = 1 -- Default condition for probability table
    AND probability.classifier_name = 'lc_classifier' -- Default condition for classifier
    AND probability.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- SNe types
    AND object.firstmjd BETWEEN 59988.0 AND 60197.0 -- February 13 to September 10
    AND q3c_poly_query(object.meanra, object.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon) -- Spatial filter
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.683995246887209,2025-07-28T16:25:29,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,3,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.393863916397095,2025-07-23T18:40:27,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for objects first detected between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Use the light curve classifier
            AND p.ranking = 1  -- Only consider the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.170948266983032,2025-07-28T16:26:01,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,4,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND EXISTS (    SELECT 1    FROM probability p    WHERE p.oid = o.oid      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.239537954330444,2025-07-23T18:40:31,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 19:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND EXISTS (
        SELECT 1
        FROM probability p
        WHERE 
            p.oid = o.oid  -- Join condition between object and probability tables
            AND p.classifier_name = 'lc_classifier'  -- Default condition for classifier_name
            AND p.ranking = 1  -- Default condition for ranking
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.39458155632019,2025-07-28T16:26:32,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,5,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.448026418685913,2025-07-23T18:40:35,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Use the light curve classifier
            AND p.ranking = 1  -- Only consider the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.57963514328003,2025-07-28T16:27:05,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,6,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.597583293914795,2025-07-23T18:40:39,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Default condition for classifier_name
            AND p.ranking = 1  -- Default condition for ranking
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.753755807876589,2025-07-28T16:27:37,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,7,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.403985977172852,2025-07-23T18:40:43,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Default condition for classifier_name
            AND p.ranking = 1  -- Default condition for ranking
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.301772356033323,2025-07-28T16:28:08,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,8,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND EXISTS (    SELECT 1    FROM probability p    WHERE p.oid = o.oid      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.277968645095825,2025-07-23T18:40:46,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 19:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for objects first detected between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND EXISTS (
        SELECT 1
        FROM probability p
        WHERE 
            p.oid = o.oid  -- Join condition between object and probability tables
            AND p.classifier_name = 'lc_classifier'  -- Use the light curve classifier
            AND p.ranking = 1  -- Only consider the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.796127080917358,2025-07-28T16:28:40,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,9,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.02215838432312,2025-07-23T18:40:50,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Default condition for classifier_name
            AND p.ranking = 1  -- Default condition for ranking
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.81239128112793,2025-07-28T16:29:10,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,12,10,"SELECT o.oid, o.meanra, o.meandecFROM object oWHERE o.firstmjd BETWEEN 59988.0 AND 60197.0  AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  AND o.oid IN (    SELECT p.oid    FROM probability p    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  )","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.1873936653137207,2025-07-23T18:40:53,[None],"(psycopg2.errors.UndefinedColumn) column p.class does not exist
LINE 20:             AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')...
                         ^

[SQL: 
-- Corrected Query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec
FROM 
    object o
WHERE 
    o.firstmjd BETWEEN 59988.0 AND 60197.0  -- Filter for first detection between February 13 and September 10
    AND q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon)  -- Filter for objects within the specified polygon
    AND o.oid IN (
        SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.classifier_name = 'lc_classifier'  -- Use the light curve classifier
            AND p.ranking = 1  -- Only consider the most likely probabilities
            AND p.class IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Filter for SNe classes
    )
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.558351993560793,2025-07-28T16:29:41,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,57,0,"WITH catalog (id, obj_ra, obj_dec, r_deg) AS (
VALUES
('id_1', 354.67, 15.954, 0.00833333),
('id_2', 20.7993, 1.00331, 0.00555556)
)
SELECT
    c.id, c.obj_ra, c.obj_dec, r_deg, oid, ndet,
    meanra, meandec, firstmjd
FROM
    catalog AS c, object AS o
WHERE
    q3c_join(c.obj_ra, c.obj_dec, o.meanra, o.meandec, c.r_deg)
ORDER BY lastmjd DESC",,,,,"[     id    obj_ra   obj_dec     r_deg           oid  ndet      meanra  \
0  id_1  354.6700  15.95400  0.008333  ZTF18acfqezx     2  354.671235   
1  id_1  354.6700  15.95400  0.008333  ZTF22acabgbb     1  354.663704   
2  id_1  354.6700  15.95400  0.008333  ZTF20abyptpc    96  354.670313   
3  id_2   20.7993   1.00331  0.005556  ZTF20abywohm    89   20.799247   
4  id_2   20.7993   1.00331  0.005556  ZTF18abqyaix    46   20.799251   

     meandec      firstmjd  
0  15.954552  58431.216979  
1  15.955837  59935.163229  
2  15.954038  59098.360544  
3   1.003320  59073.419086  
4   1.003313  59073.419086  ]",,3.979871273040772,2025-07-28T16:29:45,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,57,1,"-- Final Query to retrieve ZTF objects within specified angular distances of id_1 and id_2WITH catalog AS (    -- Define the input objects with their identifiers, coordinates, and search radii    SELECT         'id_1' AS identifier,         354.67 AS ra,         15.954 AS dec,         0.008333 AS search_radius -- 30 arcseconds in degrees    UNION ALL    SELECT         'id_2' AS identifier,         20.7993 AS ra,         1.00331 AS dec,         0.005556 AS search_radius -- 20 arcseconds in degrees),spatial_matches AS (    -- Perform spatial filtering using q3c_radial_query for each input object    SELECT         c.identifier,         c.ra AS input_ra,         c.dec AS input_dec,         c.search_radius,         o.oid,         o.ndet,         o.meanra,         o.meandec,         o.firstmjd,         o.lastmjd    FROM         catalog c    INNER JOIN         object o    ON         q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.search_radius))-- Final result with sorting by last detection date in descending orderSELECT     identifier,     input_ra AS ra,     input_dec AS dec,     search_radius,     oid,     ndet,     meanra,     meandec,     firstmjd,     lastmjdFROM     spatial_matchesORDER BY     lastmjd DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,34.58311104774475,2025-07-23T18:41:28,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve ZTF objects within specified angular distances of id_1 and id_2
WITH catalog AS (
    -- Define the input objects with their identifiers, coordinates, and search radii
    SELECT 
        'id_1' AS identifier, 
        354.67 AS ra, 
        15.954 AS dec, 
        0.008333 AS search_radius -- 30 arcseconds in degrees
    UNION ALL
    SELECT 
        'id_2' AS identifier, 
        20.7993 AS ra, 
        1.00331 AS dec, 
        0.005556 AS search_radius -- 20 arcseconds in degrees
),
spatial_matches AS (
    -- Perform spatial filtering using q3c_radial_query for each input object
    SELECT 
        c.identifier, 
        c.ra AS input_ra, 
        c.dec AS input_dec, 
        c.search_radius, 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd
    FROM 
        catalog c
    INNER JOIN 
        object o
    ON 
        q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.search_radius)
)
-- Final result with sorting by last detection date in descending order
SELECT 
    identifier, 
    input_ra AS ra, 
    input_dec AS dec, 
    search_radius, 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd
FROM 
    spatial_matches
ORDER BY 
    lastmjd DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.3323197364807,2025-07-28T16:32:02,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,2,"-- Step 1: Define the input objects and their search parametersWITH input_objects AS (    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 0.008333 AS search_radius    UNION ALL    SELECT 'id_2', 20.7993, 1.00331, 0.005556),-- Step 2: Perform spatial filtering using q3c_radial_queryfiltered_objects AS (    SELECT         io.identifier AS input_identifier,        io.ra AS input_ra,        io.dec AS input_dec,        io.search_radius,        o.oid AS ztf_identifier,        o.ndet AS number_of_detections,        o.meanra AS mean_ra,        o.meandec AS mean_dec,        o.firstmjd AS first_detection_date,        o.lastmjd AS last_detection_date    FROM input_objects io    JOIN object o    ON (        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)    )),-- Step 3: Aggregate detection dataaggregated_detections AS (    SELECT         oid,        MAX(mjd) AS last_detection_date    FROM detection    GROUP BY oid)-- Step 4: Combine input and output data, and Step 5: Apply sortingSELECT     fo.input_identifier AS identifier,    fo.input_ra AS input_ra,    fo.input_dec AS input_dec,    fo.search_radius AS search_radius,    fo.ztf_identifier AS ztf_identifier,    fo.number_of_detections AS number_of_detections,    fo.mean_ra AS mean_ra,    fo.mean_dec AS mean_dec,    fo.first_detection_date AS first_detection_date,    ad.last_detection_date AS last_detection_dateFROM filtered_objects foJOIN aggregated_detections adON fo.ztf_identifier = ad.oidORDER BY ad.last_detection_date DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.96187973022461,2025-07-23T18:41:54,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Step 1: Define the input objects and their search parameters
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 0.008333 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 0.005556
),

-- Step 2: Perform spatial filtering using q3c_radial_query
filtered_objects AS (
    SELECT 
        io.identifier AS input_identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius,
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date
    FROM input_objects io
    JOIN object o
    ON q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)
),

-- Step 3: Aggregate detection data
aggregated_detections AS (
    SELECT 
        oid,
        MAX(mjd) AS last_detection_date
    FROM detection
    GROUP BY oid
)

-- Step 4: Combine input and output data, and Step 5: Apply sorting
SELECT 
    fo.input_identifier AS identifier,
    fo.input_ra AS input_ra,
    fo.input_dec AS input_dec,
    fo.search_radius AS search_radius,
    fo.ztf_identifier AS ztf_identifier,
    fo.number_of_detections AS number_of_detections,
    fo.mean_ra AS mean_ra,
    fo.mean_dec AS mean_dec,
    fo.first_detection_date AS first_detection_date,
    ad.last_detection_date AS last_detection_date
FROM filtered_objects fo
JOIN aggregated_detections ad
ON fo.ztf_identifier = ad.oid
ORDER BY ad.last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.9005584716797,2025-07-28T16:34:19,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,3,"-- Final QueryWITH input_objects AS (    SELECT         'id_1' AS identifier,         354.67 AS ra,         15.954 AS dec,         0.008333 AS search_radius    UNION ALL    SELECT         'id_2' AS identifier,         20.7993 AS ra,         1.00331 AS dec,         0.005556 AS search_radius),filtered_objects AS (    SELECT         io.identifier AS input_identifier,        io.ra AS input_ra,        io.dec AS input_dec,        io.search_radius,        o.oid,        o.ndet,        o.meanra,        o.meandec,        o.firstmjd,        o.lastmjd    FROM         input_objects io    INNER JOIN         object o    ON         q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)),aggregated_detections AS (    SELECT         fo.input_identifier,        fo.input_ra,        fo.input_dec,        fo.search_radius,        fo.oid,        fo.ndet,        fo.meanra,        fo.meandec,        fo.firstmjd,        fo.lastmjd,        COUNT(d.mjd) AS total_detections,        AVG(d.ra) AS avg_ra,        AVG(d.dec) AS avg_dec,        MIN(d.mjd) AS first_detection_date,        MAX(d.mjd) AS last_detection_date    FROM         filtered_objects fo    INNER JOIN         detection d    ON         fo.oid = d.oid    GROUP BY         fo.input_identifier, fo.input_ra, fo.input_dec, fo.search_radius,         fo.oid, fo.ndet, fo.meanra, fo.meandec, fo.firstmjd, fo.lastmjd)SELECT     input_identifier AS identifier,    input_ra AS ra,    input_dec AS dec,    search_radius,    oid AS ztf_identifier,    total_detections AS number_of_detections,    avg_ra AS mean_ra,    avg_dec AS mean_dec,    first_detection_date,    last_detection_dateFROM     aggregated_detectionsORDER BY     last_detection_date DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,71.27064490318298,2025-07-23T18:43:05,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query
WITH input_objects AS (
    -- Define the input objects with their identifiers, coordinates, and search radii
    SELECT 
        'id_1' AS identifier, 
        354.67 AS ra, 
        15.954 AS dec, 
        0.008333 AS search_radius -- 30 arcsec in degrees
    UNION ALL
    SELECT 
        'id_2' AS identifier, 
        20.7993 AS ra, 
        1.00331 AS dec, 
        0.005556 AS search_radius -- 20 arcsec in degrees
),
filtered_objects AS (
    -- Filter objects from the 'object' table that lie within the search radius of the input objects
    SELECT 
        io.identifier AS input_identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius,
        o.oid,
        o.ndet,
        o.meanra,
        o.meandec,
        o.firstmjd,
        o.lastmjd
    FROM 
        input_objects io
    INNER JOIN 
        object o
    ON 
        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius) -- Use q3c_radial_query for spatial matching
),
aggregated_detections AS (
    -- Aggregate detection data for the filtered objects
    SELECT 
        fo.input_identifier,
        fo.input_ra,
        fo.input_dec,
        fo.search_radius,
        fo.oid,
        fo.ndet,
        fo.meanra,
        fo.meandec,
        fo.firstmjd,
        fo.lastmjd,
        COUNT(d.mjd) AS total_detections, -- Count the total detections
        AVG(d.ra) AS avg_ra, -- Average RA of detections
        AVG(d.dec) AS avg_dec, -- Average Dec of detections
        MIN(d.mjd) AS first_detection_date, -- Earliest detection date
        MAX(d.mjd) AS last_detection_date -- Latest detection date
    FROM 
        filtered_objects fo
    INNER JOIN 
        detection d
    ON 
        fo.oid = d.oid -- Join on object identifier
    GROUP BY 
        fo.input_identifier, fo.input_ra, fo.input_dec, fo.search_radius, 
        fo.oid, fo.ndet, fo.meanra, fo.meandec, fo.firstmjd, fo.lastmjd
)
-- Final selection and ordering of results
SELECT 
    input_identifier AS identifier, -- Input object identifier
    input_ra AS ra, -- Input object RA
    input_dec AS dec, -- Input object Dec
    search_radius, -- Search radius used
    oid AS ztf_identifier, -- ZTF object identifier
    total_detections AS number_of_detections, -- Total number of detections
    avg_ra AS mean_ra, -- Mean RA of detections
    avg_dec AS mean_dec, -- Mean Dec of detections
    first_detection_date, -- First detection date
    last_detection_date -- Last detection date
FROM 
    aggregated_detections
ORDER BY 
    last_detection_date DESC -- Sort by last detection date in descending order
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",138.25916934013367,2025-07-28T16:36:41,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,4,"-- Final Query to retrieve ZTF objects within specified search radii of input objectsWITH input_objects AS (    SELECT         'id_1' AS identifier,         354.67 AS ra,         15.954 AS dec,         0.008333 AS search_radius -- 30 arcsec in degrees    UNION ALL    SELECT         'id_2' AS identifier,         20.7993 AS ra,         1.00331 AS dec,         0.005556 AS search_radius -- 20 arcsec in degrees),filtered_objects AS (    SELECT         io.identifier AS input_identifier,        io.ra AS input_ra,        io.dec AS input_dec,        io.search_radius,        o.oid AS ztf_identifier,        o.ndet AS number_of_detections,        o.meanra AS mean_ra,        o.meandec AS mean_dec,        o.firstmjd AS first_detection_date,        o.lastmjd AS last_detection_date    FROM         input_objects io    INNER JOIN         object o    ON         q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius))SELECT     input_identifier AS identifier,    input_ra AS ra,    input_dec AS dec,    search_radius,    ztf_identifier AS oid,    number_of_detections AS ndet,    mean_ra AS meanra,    mean_dec AS meandec,    first_detection_date AS firstmjd,    last_detection_date AS lastmjdFROM     filtered_objectsORDER BY     last_detection_date DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,37.29324507713318,2025-07-23T18:43:42,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query to retrieve ZTF objects within specified search radii of input objects
WITH input_objects AS (
    -- Define the input objects with their identifiers, coordinates, and search radii
    SELECT 
        'id_1' AS identifier, 
        354.67 AS ra, 
        15.954 AS dec, 
        0.008333 AS search_radius -- 30 arcsec in degrees
    UNION ALL
    SELECT 
        'id_2' AS identifier, 
        20.7993 AS ra, 
        1.00331 AS dec, 
        0.005556 AS search_radius -- 20 arcsec in degrees
),
filtered_objects AS (
    -- Filter ZTF objects that lie within the specified search radii of the input objects
    SELECT 
        io.identifier AS input_identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius,
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date
    FROM 
        input_objects io
    INNER JOIN 
        object o
    ON 
        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius) -- Use q3c_radial_query for spatial matching
)
-- Select the required columns and sort by the last detection date in descending order
SELECT 
    input_identifier AS identifier,
    input_ra AS ra,
    input_dec AS dec,
    search_radius,
    ztf_identifier AS oid,
    number_of_detections AS ndet,
    mean_ra AS meanra,
    mean_dec AS meandec,
    first_detection_date AS firstmjd,
    last_detection_date AS lastmjd
FROM 
    filtered_objects
ORDER BY 
    last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",138.28193759918213,2025-07-28T16:39:03,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,5,"-- Define the input objects and their search parametersWITH input_objects AS (    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 0.008333 AS search_radius    UNION ALL    SELECT 'id_2', 20.7993, 1.00331, 0.005556),-- Perform spatial filtering for each input objectspatial_query AS (    SELECT         io.identifier AS input_identifier,        io.ra AS input_ra,        io.dec AS input_dec,        io.search_radius,        o.oid AS ztf_identifier,        o.ndet AS number_of_detections,        o.meanra AS mean_ra,        o.meandec AS mean_dec,        o.firstmjd AS first_detection_date,        o.lastmjd AS last_detection_date    FROM input_objects io    JOIN object o    ON (        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)    ))-- Final query to retrieve and sort the resultsSELECT     input_identifier AS identifier,    input_ra AS ra,    input_dec AS dec,    search_radius,    ztf_identifier,    number_of_detections,    mean_ra,    mean_dec,    first_detection_date,    last_detection_dateFROM spatial_queryORDER BY last_detection_date DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,31.15353798866272,2025-07-23T18:44:14,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Define the input objects and their search parameters
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 0.008333 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 0.005556
),
-- Perform spatial filtering for each input object
spatial_query AS (
    SELECT 
        io.identifier AS input_identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius,
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date
    FROM input_objects io
    JOIN object o
    ON q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)
)
-- Final query to retrieve and sort the results
SELECT 
    input_identifier AS identifier,
    input_ra AS ra,
    input_dec AS dec,
    search_radius,
    ztf_identifier,
    number_of_detections,
    mean_ra,
    mean_dec,
    first_detection_date,
    last_detection_date
FROM spatial_query
ORDER BY last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.13194489479065,2025-07-28T16:41:19,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,6,"-- Final Query to retrieve ZTF objects within specified search radii of input objectsWITH catalog AS (    -- Define the input objects and their search parameters    SELECT         'id_1' AS identifier,         354.67 AS ra,         15.954 AS dec,         0.008333 AS search_radius -- 30 arcsec in degrees    UNION ALL    SELECT         'id_2' AS identifier,         20.7993 AS ra,         1.00331 AS dec,         0.005556 AS search_radius -- 20 arcsec in degrees),matched_objects AS (    -- Perform spatial queries to find ZTF objects within the specified search radii    SELECT         c.identifier,         c.ra AS input_ra,         c.dec AS input_dec,         c.search_radius,         o.oid,         o.ndet,         o.meanra,         o.meandec,         o.firstmjd,         o.lastmjd    FROM         catalog c    INNER JOIN         object o    ON         q3c_radial_query(o.meanra, o.meandec, c.ra, c.dec, c.search_radius))-- Final result with sorting by last detection date in descending orderSELECT     identifier,     input_ra AS ra,     input_dec AS dec,     search_radius,     oid,     ndet,     meanra,     meandec,     firstmjd,     lastmjdFROM     matched_objectsORDER BY     lastmjd DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.701988220214844,2025-07-23T18:44:36,"[  identifier        ra       dec  search_radius           oid  ndet  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx     2   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb     1   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc    96   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm    89   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix    46   

       meanra    meandec      firstmjd       lastmjd  
0  354.671235  15.954552  58431.216979  60065.491678  
1  354.663704  15.955837  59935.163229  59935.163229  
2  354.670313  15.954038  59098.360544  59233.132199  
3   20.799247   1.003320  59073.419086  59136.331620  
4   20.799251   1.003313  59073.419086  59095.397998  ]",,125.57612872123718,2025-07-28T16:43:29,1.0,1.0,0.5555555555555556,0.5,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,7,"-- Final Query to retrieve ZTF objects within specified radii of input objectsWITH input_objects AS (    -- Define the input objects and their search parameters    SELECT         'id_1' AS identifier,         354.67 AS ra,         15.954 AS dec,         0.008333 AS search_radius -- 30 arcsec in degrees    UNION ALL    SELECT         'id_2' AS identifier,         20.7993 AS ra,         1.00331 AS dec,         0.005556 AS search_radius -- 20 arcsec in degrees),filtered_objects AS (    -- Perform spatial filtering using q3c_radial_query for each input object    SELECT         io.identifier AS input_identifier,        io.ra AS input_ra,        io.dec AS input_dec,        io.search_radius,        o.oid AS ztf_oid,        o.ndet,        o.meanra,        o.meandec,        o.firstmjd,        o.lastmjd    FROM         input_objects io    INNER JOIN         object o    ON         q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius))-- Combine input and output information, and sort by last detection date in descending orderSELECT     input_identifier AS identifier,    input_ra AS ra,    input_dec AS dec,    search_radius,    ztf_oid AS oid,    ndet,    meanra,    meandec,    firstmjd,    lastmjdFROM     filtered_objectsORDER BY     lastmjd DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,26.208205461502075,2025-07-23T18:45:03,"[  identifier        ra       dec  search_radius           oid  ndet  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx     2   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb     1   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc    96   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm    89   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix    46   

       meanra    meandec      firstmjd       lastmjd  
0  354.671235  15.954552  58431.216979  60065.491678  
1  354.663704  15.955837  59935.163229  59935.163229  
2  354.670313  15.954038  59098.360544  59233.132199  
3   20.799247   1.003320  59073.419086  59136.331620  
4   20.799251   1.003313  59073.419086  59095.397998  ]",,128.9251697063446,2025-07-28T16:45:41,1.0,1.0,0.5555555555555556,0.5,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,8,"-- Define the input objects and their search parametersWITH input_objects AS (    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 0.008333 AS search_radius    UNION ALL    SELECT 'id_2', 20.7993, 1.00331, 0.005556),-- Filter ZTF objects based on spatial proximityfiltered_objects AS (    SELECT         io.identifier AS input_identifier,        io.ra AS input_ra,        io.dec AS input_dec,        io.search_radius,        o.oid AS ztf_identifier,        o.ndet AS number_of_detections,        o.meanra AS mean_ra,        o.meandec AS mean_dec,        o.firstmjd AS first_detection_date,        o.lastmjd AS last_detection_date    FROM input_objects io    INNER JOIN object o    ON (        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)    ))-- Final query to retrieve and sort the resultsSELECT     input_identifier AS identifier,    input_ra AS ra,    input_dec AS dec,    search_radius,    ztf_identifier,    number_of_detections,    mean_ra,    mean_dec,    first_detection_dateFROM filtered_objectsORDER BY last_detection_date DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,28.11832880973816,2025-07-23T18:45:31,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  \
0                     2  354.671235  15.954552          58431.216979   
1                     1  354.663704  15.955837          59935.163229   
2                    96  354.670313  15.954038          59098.360544   
3                    89   20.799247   1.003320          59073.419086   
4                    46   20.799251   1.003313          59073.419086   

   last_detection_date  
0         60065.491678  
1         59935.163229  
2         59233.132199  
3         59136.331620  
4         59095.397998  ]",,132.08954310417175,2025-07-28T16:47:58,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,9,"-- Final QueryWITH input_objects AS (    SELECT         'id_1' AS identifier,         354.67 AS ra,         15.954 AS dec,         0.008333 AS search_radius    UNION ALL    SELECT         'id_2' AS identifier,         20.7993 AS ra,         1.00331 AS dec,         0.005556 AS search_radius),filtered_objects AS (    SELECT         io.identifier AS input_identifier,        io.ra AS input_ra,        io.dec AS input_dec,        io.search_radius,        o.oid AS ztf_identifier,        o.ndet AS number_of_detections,        o.meanra AS mean_ra,        o.meandec AS mean_dec,        o.firstmjd AS first_detection_date,        o.lastmjd AS last_detection_date    FROM         input_objects io    INNER JOIN         object o    ON         q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)),aggregated_detections AS (    SELECT         d.oid AS ztf_identifier,        MAX(d.mjd) AS last_detection_date    FROM         detection d    GROUP BY         d.oid)SELECT     f.input_identifier AS identifier,    f.input_ra AS input_ra,    f.input_dec AS input_dec,    f.search_radius AS search_radius,    f.ztf_identifier AS ztf_identifier,    f.number_of_detections AS number_of_detections,    f.mean_ra AS mean_ra,    f.mean_dec AS mean_dec,    f.first_detection_date AS first_detection_date,    ad.last_detection_date AS last_detection_dateFROM     filtered_objects fINNER JOIN     aggregated_detections adON     f.ztf_identifier = ad.ztf_identifierORDER BY     ad.last_detection_date DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.94319987297058,2025-07-23T18:45:56,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query
WITH input_objects AS (
    -- Define the input objects with their identifiers, coordinates, and search radii
    SELECT 
        'id_1' AS identifier, 
        354.67 AS ra, 
        15.954 AS dec, 
        0.008333 AS search_radius -- 30 arcsec in degrees
    UNION ALL
    SELECT 
        'id_2' AS identifier, 
        20.7993 AS ra, 
        1.00331 AS dec, 
        0.005556 AS search_radius -- 20 arcsec in degrees
),
filtered_objects AS (
    -- Filter objects from the 'object' table that lie within the search radius of the input objects
    SELECT 
        io.identifier AS input_identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius,
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date
    FROM 
        input_objects io
    INNER JOIN 
        object o
    ON 
        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius) -- Use q3c_radial_query for spatial filtering
),
aggregated_detections AS (
    -- Aggregate detections to find the last detection date for each object
    SELECT 
        d.oid AS ztf_identifier,
        MAX(d.mjd) AS last_detection_date
    FROM 
        detection d
    GROUP BY 
        d.oid
)
-- Final selection and ordering
SELECT 
    f.input_identifier AS identifier,
    f.input_ra AS input_ra,
    f.input_dec AS input_dec,
    f.search_radius AS search_radius,
    f.ztf_identifier AS ztf_identifier,
    f.number_of_detections AS number_of_detections,
    f.mean_ra AS mean_ra,
    f.mean_dec AS mean_dec,
    f.first_detection_date AS first_detection_date,
    ad.last_detection_date AS last_detection_date
FROM 
    filtered_objects f
INNER JOIN 
    aggregated_detections ad
ON 
    f.ztf_identifier = ad.ztf_identifier
ORDER BY 
    ad.last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",134.18077182769775,2025-07-28T16:50:17,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,57,10,"-- Final Query to retrieve ZTF objects within specified search radii of input objectsWITH input_objects AS (    -- Define the input objects and their search parameters    SELECT         'id_1' AS identifier,         354.67 AS ra,         15.954 AS dec,         0.008333 AS search_radius -- 30 arcsec in degrees    UNION ALL    SELECT         'id_2' AS identifier,         20.7993 AS ra,         1.00331 AS dec,         0.005556 AS search_radius -- 20 arcsec in degrees),spatial_matches AS (    -- Perform spatial filtering using q3c_radial_query for each input object    SELECT         io.identifier AS input_identifier,        io.ra AS input_ra,        io.dec AS input_dec,        io.search_radius,        o.oid AS ztf_oid,        o.meanra AS ztf_meanra,        o.meandec AS ztf_meandec,        o.ndet AS ztf_ndet,        o.firstmjd AS ztf_firstmjd,        o.lastmjd AS ztf_lastmjd    FROM         input_objects io    INNER JOIN         object o    ON         q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)),detection_aggregates AS (    -- Aggregate detection data for ZTF objects    SELECT         d.oid AS ztf_oid,        COUNT(d.candid) AS total_detections,        MIN(d.mjd) AS first_detection_date,        MAX(d.mjd) AS last_detection_date    FROM         detection d    GROUP BY         d.oid)-- Combine spatial matches with detection aggregates and sort by last detection dateSELECT     sm.input_identifier AS identifier,    sm.input_ra AS ra,    sm.input_dec AS dec,    sm.search_radius,    sm.ztf_oid AS oid,    sm.ztf_meanra AS meanra,    sm.ztf_meandec AS meandec,    sm.ztf_ndet AS ndet,    sm.ztf_firstmjd AS firstmjd,    sm.ztf_lastmjd AS lastmjdFROM     spatial_matches smLEFT JOIN     detection_aggregates daON     sm.ztf_oid = da.ztf_oidORDER BY     sm.ztf_lastmjd DESC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,27.159336805343628,2025-07-23T18:46:23,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query to retrieve ZTF objects within specified search radii of input objects
WITH input_objects AS (
    -- Define the input objects and their search parameters
    SELECT 
        'id_1' AS identifier, 
        354.67 AS ra, 
        15.954 AS dec, 
        0.008333 AS search_radius -- 30 arcsec in degrees
    UNION ALL
    SELECT 
        'id_2' AS identifier, 
        20.7993 AS ra, 
        1.00331 AS dec, 
        0.005556 AS search_radius -- 20 arcsec in degrees
),
spatial_matches AS (
    -- Perform spatial filtering using q3c_radial_query for each input object
    SELECT 
        io.identifier AS input_identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius,
        o.oid AS ztf_oid,
        o.meanra AS ztf_meanra,
        o.meandec AS ztf_meandec,
        o.ndet AS ztf_ndet,
        o.firstmjd AS ztf_firstmjd,
        o.lastmjd AS ztf_lastmjd
    FROM 
        input_objects io
    INNER JOIN 
        object o
    ON 
        q3c_radial_query(o.meanra, o.meandec, io.ra, io.dec, io.search_radius)
),
detection_aggregates AS (
    -- Aggregate detection data for ZTF objects
    SELECT 
        d.oid AS ztf_oid,
        COUNT(d.candid) AS total_detections,
        MIN(d.mjd) AS first_detection_date,
        MAX(d.mjd) AS last_detection_date
    FROM 
        detection d
    GROUP BY 
        d.oid
)
-- Combine spatial matches with detection aggregates and sort by last detection date
SELECT 
    sm.input_identifier AS identifier,
    sm.input_ra AS ra,
    sm.input_dec AS dec,
    sm.search_radius,
    sm.ztf_oid AS oid,
    sm.ztf_meanra AS meanra,
    sm.ztf_meandec AS meandec,
    sm.ztf_ndet AS ndet,
    sm.ztf_firstmjd AS firstmjd,
    sm.ztf_lastmjd AS lastmjd,
    da.total_detections AS total_detections,
    da.first_detection_date AS first_detection_date,
    da.last_detection_date AS last_detection_date
FROM 
    spatial_matches sm
LEFT JOIN 
    detection_aggregates da
ON 
    sm.ztf_oid = da.ztf_oid
ORDER BY 
    da.last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.84987616539,2025-07-28T16:52:34,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,75,0,"SELECT
    *
FROM
    ss_ztf
WHERE
    ssnamenr != 'null'
LIMIT 100",,,,,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
1   ZTF20acukbuk  1429422675015015003       0.0     17.6    96873
2   ZTF21aagkhgi  1489223746315015007       0.0     18.5    15038
3   ZTF20acukddo  1429434662615015000       6.0     14.6     7753
4   ZTF20acukewy  1429443641815015000       0.0     17.0     2997
..           ...                  ...       ...      ...      ...
95  ZTF20acuppuk  1431162891815015007       0.0     18.3    58575
96  ZTF20acupqut  1431162890915015007       0.0     19.9   126476
97  ZTF20acupsrj  1431172650915015006       0.0     18.6    45590
98  ZTF20acupstb  1431172656215015013       0.0     17.6    19549
99  ZTF20acupsto  1431173114015015006       0.0     18.2    35911

[100 rows x 5 columns]]",,3.7097151279449454,2025-07-28T16:52:38,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,1,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.9363696575164795,2025-07-23T18:46:26,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,10.069519281387327,2025-07-28T16:52:52,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,2,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.691504716873169,2025-07-23T18:46:29,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,8.912192583084106,2025-07-28T16:53:05,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,3,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,5.05715012550354,2025-07-23T18:46:34,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.368069171905518,2025-07-28T16:53:18,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,4,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.795912504196167,2025-07-23T18:46:38,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,8.720510959625244,2025-07-28T16:53:30,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,5,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.1639137268066406,2025-07-23T18:46:40,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.961895227432253,2025-07-28T16:53:44,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,6,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.1587629318237305,2025-07-23T18:46:42,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.372444152832031,2025-07-28T16:53:57,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,7,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,5.123332262039185,2025-07-23T18:46:47,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.0691978931427,2025-07-28T16:54:10,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,8,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.001185894012451,2025-07-23T18:46:50,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,10.319344282150269,2025-07-28T16:54:24,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,9,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.9854061603546143,2025-07-23T18:46:53,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,11.739469289779665,2025-07-28T16:54:40,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,75,10,SELECT * FROM ss_ztf WHERE ssnamenr IS NOT NULL LIMIT 100,"[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.613499402999878,2025-07-23T18:46:56,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF21aagkgxn  1489208332615010013    -999.0   -999.0     null
1   ZTF20acujzae  1429338664915015020       0.0     15.7     8532
2   ZTF19acidawx  1489205962415015012    -999.0   -999.0     null
3   ZTF20acvrrax  1489205963615015018    -999.0   -999.0     null
4   ZTF18acmgnng  1489229544115010227    -999.0   -999.0     null
..           ...                  ...       ...      ...      ...
95  ZTF18acwgegu  1489205962315015037    -999.0   -999.0     null
96  ZTF19aceqoke  1489224686015010181    -999.0   -999.0     null
97  ZTF19abbphsy  1489225154615010084    -999.0   -999.0     null
98  ZTF18acwgdgt  1489205962715015006    -999.0   -999.0     null
99  ZTF20aakjhsk  1489205964315015013    -999.0   -999.0     null

[100 rows x 5 columns]]",,9.449856281280518,2025-07-28T16:54:54,0.32,0.32,1.0,1.0,0.0,1.0
0.20.2,,,43,0,"SELECT
    oid, candid, xpos, ypos, scorr
FROM
    dataquality
WHERE
    oid IN ('ZTF20acwrybw','ZTF22abugigx')
    AND fid = 2",,,,,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,3.4730677604675293,2025-07-28T16:54:58,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,1,"-- Query to retrieve r-band epochs for specified ZTF identifiersSELECT     oid,         -- ZTF object identifier    candid,      -- Candidate identifier    xpos,        -- X-image position    ypos,        -- Y-image position    scorr        -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specified ZTF identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,20.88077473640442,2025-07-23T18:47:17,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.67696499824524,2025-07-28T16:55:11,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,2,"-- Query to retrieve r-band epochs for specific ZTF object identifiersSELECT     oid,          -- ZTF object identifier    candid,       -- Candidate identifier    xpos,         -- X-image position    ypos,         -- Y-image position    scorr         -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specific ZTF object identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,25.671644926071167,2025-07-23T18:47:43,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,11.925616025924684,2025-07-28T16:55:27,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,3,"-- Query to retrieve r-band epochs for specific ZTF object identifiersSELECT     oid,          -- ZTF object identifier    candid,       -- Candidate identifier    xpos,         -- X-image position    ypos,         -- Y-image position    scorr         -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specific ZTF object identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,23.135615587234497,2025-07-23T18:48:06,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.746364831924438,2025-07-28T16:55:41,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,4,"-- Query to retrieve r-band epochs for specified ZTF identifiersSELECT     oid,          -- ZTF object identifier    candid,       -- Candidate identifier    xpos,         -- X-image position    ypos,         -- Y-image position    scorr         -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specified ZTF identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,21.97835183143616,2025-07-23T18:48:28,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,8.954590320587158,2025-07-28T16:55:54,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,5,"-- Query to retrieve r-band epochs for specific ZTF object identifiersSELECT     oid,          -- ZTF object identifier    candid,       -- Candidate identifier    xpos,         -- X-image position    ypos,         -- Y-image position    scorr         -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specific ZTF object identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,18.56669855117798,2025-07-23T18:48:47,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.727746486663818,2025-07-28T16:56:08,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,6,"-- Query to retrieve r-band epochs for specific ZTF object identifiersSELECT     oid,          -- ZTF object identifier    candid,       -- Candidate identifier    xpos,         -- X-image position    ypos,         -- Y-image position    scorr         -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specific ZTF object identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,19.390215635299683,2025-07-23T18:49:06,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.03825044631958,2025-07-28T16:56:21,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,7,"-- Query to retrieve r-band epochs for specific ZTF objects from the dataquality tableSELECT     oid,         -- ZTF object identifier    candid,      -- Candidate identifier    xpos,        -- X-image position    ypos,        -- Y-image position    scorr        -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specific ZTF object identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,18.97723412513733,2025-07-23T18:49:25,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,8.905958890914917,2025-07-28T16:56:34,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,8,"-- Query to retrieve r-band epochs for specified ZTF identifiers from the dataquality tableSELECT     oid,        -- ZTF identifier    candid,     -- Candidate identifier    xpos,       -- X-image position    ypos,       -- Y-image position    scorr       -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx') -- Filter for the specified ZTF identifiers    AND fid = 2                            -- Filter for r-band data (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,19.32241487503052,2025-07-23T18:49:44,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.586752891540527,2025-07-28T16:56:48,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,9,"-- Query to retrieve r-band epochs for specific ZTF object identifiersSELECT     oid,          -- ZTF object identifier    candid,       -- Candidate identifier    xpos,         -- X-image position    ypos,         -- Y-image position    scorr         -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specific ZTF object identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,16.562102556228638,2025-07-23T18:50:01,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,9.622462511062622,2025-07-28T16:57:01,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,43,10,"-- Query to retrieve all r-band epochs for specific ZTF objects-- Returns ZTF and candidate identifiers, x- and y-image positions, and peak-pixel S/NSELECT     oid,          -- ZTF object identifier    candid,       -- Candidate identifier    xpos,         -- X-image position    ypos,         -- Y-image position    scorr         -- Peak-pixel signal-to-noise ratioFROM     dataqualityWHERE     oid IN ('ZTF20acwrybw', 'ZTF22abugigx')  -- Filter for specific ZTF object identifiers    AND fid = 2                             -- Filter for r-band (fid = 2)","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,16.46616554260254,2025-07-23T18:50:18,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,19.3054723739624,2025-07-28T16:57:24,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,89,0,"SELECT
    *
FROM
    dataquality
WHERE
    oid in
(
SELECT
    oid
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'SN'
    AND probability > 0.7
LIMIT 50
)",,,,,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF21aamfbcg  1511370245015015009    2  2974.2660  2333.0870  0.853915   
1    ZTF21aamfbcg  1511400215015015013    1  2962.4915  2338.0810  2.333080   
2    ZTF21aamfbcg  1513375285015015000    1  2957.4136  2318.9985  0.855764   
3    ZTF21aamfbcg  1515365185015015005    2  2962.8547  2324.2570  1.213921   
4    ZTF21aamfbcg  1515430775015015008    1  2952.7730  2336.0078  1.167017   
..            ...                  ...  ...        ...        ...       ...   
651  ZTF21aamelxr  1511312603515015006    2  2965.3710  1016.3635  1.324734   
652  ZTF21aamelxr  1513330793515015002    2  2958.4756  1011.8967  0.883379   
653  ZTF21aamelxr  1513358723515015002    1  2962.4233  1024.0796  1.401563   
654  ZTF21aamelxr  1515439563515015002    1  2995.2913  1025.5391  1.666932   
655  ZTF21aamelxr  1517301953515015002    2  2967.8713  1048.4604  1.239147   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   -0.065562  2.460000     0.979     98.2338  ...     0.000018     0.045040   
1   -0.429602  2.710000     0.902    110.0085  ...     0.000046     0.052810   
2   -0.066002  3.710000     0.899    115.0865  ...     0.000021     0.031447   
3    2.562140  1.840000     0.979    109.6452  ...     0.000019     0.046351   
4    0.810167  1.820000     0.981    119.7271  ...     0.000033     0.039084   
..        ...       ...       ...         ...  ...          ...          ...   
651 -0.310877  3.430000     0.978    107.1289  ...     0.000009     0.044094   
652 -0.444360  3.740000     0.986    114.0245  ...     0.000011     0.044912   
653  0.522727  4.410000     0.959    110.0766  ...     0.000026     0.041515   
654  0.862274  2.410000     0.982     77.2088  ...     0.000019     0.038484   
655  1.171546  1.439273     0.717    104.6287  ...     0.000019     0.050195   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0       249.0  0.104065  0.000027 -0.000020  26.3840   0.698  0.340419   
1       250.0 -0.080725  0.000069 -0.000051  26.3565   0.682  0.343304   
2       224.0 -0.034728  0.000035 -0.000024  26.3810   0.594  0.330539   
3       255.0  0.107570  0.000028 -0.000021  26.3360   0.698  0.339248   
4       230.0 -0.032955  0.000053 -0.000038  26.3690   0.605  0.337885   
..        ...       ...       ...       ...      ...     ...       ...   
651     482.0  0.114334  0.000016 -0.000011  26.3620   0.576  0.306805   
652     480.0  0.108909  0.000020 -0.000014  26.3760   0.572  0.305709   
653     393.0 -0.011356  0.000056 -0.000034  26.2920   0.521  0.279402   
654     433.0 -0.035695  0.000038 -0.000024  26.2680   0.530  0.287320   
655     478.0  0.102450  0.000033 -0.000022  26.3540   0.579  0.310461   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3       30.0  
4       30.0  
..       ...  
651     30.0  
652     30.0  
653     30.0  
654     30.0  
655     30.0  

[656 rows x 32 columns]]",,4.236083507537842,2025-07-28T16:57:29,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,1,-- Retrieve at most 50 ZTF objects classified as supernovae (SN) with a probability > 0.7-- in the stamp_classifier and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN probability p    ON dq.oid = p.oidWHERE p.class_name = 'SN' -- Filter for supernovae classification  AND p.classifier_name = 'stamp_classifier' -- Use the stamp classifier  AND p.ranking = 1 -- Only consider the most likely classification  AND p.probability > 0.7 -- Probability thresholdLIMIT 50 -- Limit the results to at most 50 rows,"['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,27.96042251586914,2025-07-23T18:50:46,"[             oid               candid  fid       xpos       ypos     chipsf  \
0   ZTF21aamgvef  1558395022715015000    2   697.3330  1323.4493   1.682183   
1   ZTF21aamgvef  1541482552715015005    2   683.2990  1368.4633   1.364179   
2   ZTF21aamgvef  1538464512715015007    2   678.8859  1338.4966   1.828280   
3   ZTF21aamgvef  1528524352715015003    1   682.8005  1370.9578   1.649855   
4   ZTF21aamgvef  1515521512715015003    2   518.9425  1291.4052   1.318881   
5   ZTF21aamgvef  1511524712715015005    2   522.0225  1301.6967   1.887226   
6   ZTF21aamgtfw  1537463694215015007    2   701.4586   988.6033   1.469065   
7   ZTF21aamgtfw  1515514094215015007    2   562.3775   914.2441   2.389277   
8   ZTF21aamgtfw  1515488694215015008    1   560.0329   907.4728   1.262747   
9   ZTF21aamgtfw  1513529814215015008    1   555.2970   930.9897   1.309252   
10  ZTF21aamgtfw  1513428704215015001    2   535.9164   883.3460   0.818371   
11  ZTF21aamgtfw  1511527564215015003    2   565.5891   924.0793   1.217800   
12  ZTF21aamgtfw  1511516424215015008    1   565.0405   920.3992   1.268598   
13  ZTF21aagtooe  1494490374115015006    1  2794.9734  2113.8123   0.671752   
14  ZTF21aagtooe  1494533764115015007    2  2796.3506  2135.3710   1.602194   
15  ZTF21aagtooe  1496494914115015004    1  2796.3270  2124.5813   1.281103   
16  ZTF21aagtooe  1496537434115015002    2  2795.5820  2144.6123   1.949703   
17  ZTF21aagtooe  1498538254115015010    1  2804.5503  2142.2960   2.448609   
18  ZTF21aagtooe  1498545634115015007    2  2805.5625  2145.6309   2.898560   
19  ZTF21aagtooe  1501535184115015020    1  2789.4778  2153.9560   1.053242   
20  ZTF21aagtooe  1511529494115015005    2  2731.1110  2106.3618   1.048953   
21  ZTF21aamgvry  1511530454015015007    2  1152.3033  1848.9672   1.205081   
22  ZTF21aakiddw  1511538435515015008    2  2683.2278  2256.7942   1.360034   
23  ZTF21aakiyra  1502516351815015006    1  1346.0659  2203.4000   0.724225   
24  ZTF21aakiyra  1511531891815015008    2  1304.4190  2171.1384   1.152834   
25  ZTF21aadatfg  1476536305715015006    2   875.5515  1073.3230   7.204136   
26  ZTF21aadatfg  1470516375715015002    2   833.8214  1097.9400   0.935834   
27  ZTF21aadatfg  1476488365715015002    1   867.8775  1069.0835   2.066258   
28  ZTF21aadatfg  1478515935715015005    2   877.9384  1080.7957   4.946762   
29  ZTF21aadatfg  1478546725715015004    1   863.4615  1095.0796  14.531136   
30  ZTF21aadatfg  1473493955715015003    1   848.7300  1084.3500   2.235680   
31  ZTF21aadatfg  1473552555715015005    2   858.6050  1105.9600   2.368600   
32  ZTF21aadatfg  1470547605715015001    1   849.1176  1109.5080   1.146883   
33  ZTF21aadatfg  1495519685715015001    2   864.9109  1118.0265   1.233842   
34  ZTF21aadatfg  1495542455715015004    1   860.0844  1118.6900   1.322208   
35  ZTF21aadatfg  1499510405715015009    2   870.9871  1103.9208   1.274695   
36  ZTF21aadatfg  1499530185715015005    1   869.0572  1109.2579   0.833398   
37  ZTF21aadatfg  1501430695715015003    2   852.4881  1094.5775   3.898864   
38  ZTF21aadatfg  1504487285715015003    2   859.1603  1095.8656   1.004196   
39  ZTF21aadatfg  1504519595715015005    1   859.1724  1102.9648   1.063267   
40  ZTF21aadatfg  1511537475715015002    2   728.7941  1053.5513   2.031946   
41  ZTF21aadatfg  1513427265715015002    2   720.5568  1042.0910   1.398716   
42  ZTF21aadatfg  1515514615715015001    2   736.7192  1065.4508   1.146149   
43  ZTF18abdocdr  2971553414615015003    2  2114.2898   124.7071   9.951098   
44  ZTF18abdocdr  2971545594615015001    2  2115.6377   122.7937   5.527333   
45  ZTF18abdocdr  2971548954615015004    2  2112.7314   123.2022   4.494639   
46  ZTF18abdocdr  2956570034615015003    2  2117.5215    93.1217   1.735964   
47  ZTF18abdocdr  2956558763515015000    2   311.9682    10.6567   1.701186   
48  ZTF18abdocdr  2954566793515015000    2   303.2620    38.2586   1.619657   
49  ZTF18abdocdr  2954562843515015000    2   302.0992    36.3582   1.924006   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.770370  1.630000     0.767    697.3330  ...     0.000001     0.022231   
1   0.367833  2.220000     0.962    683.2990  ...     0.000001     0.021447   
2   0.608383  2.220000     0.972    678.8859  ...     0.000001     0.021732   
3  -0.019556  2.310000     0.901    682.8005  ...     0.000002     0.025137   
4   1.024034  1.910000     0.974    518.9425  ...     0.000001     0.022628   
5   0.491265  1.900000     0.965    522.0225  ...     0.000001     0.020787   
6  -0.170213  2.540000     0.769    701.4586  ...     0.000002     0.029360   
7   0.383288  1.670000     0.981    562.3775  ...     0.000001     0.028016   
8   0.774068  1.990000     0.977    560.0329  ...     0.000003     0.030170   
9  -0.031355  3.380000     0.958    555.2970  ...     0.000002     0.029388   
10  0.149956  3.790000     0.975    535.9164  ...     0.000005     0.045246   
11 -0.090526  2.850000     0.974    565.5891  ...     0.000001     0.030508   
12  0.027267  4.020000     0.971    565.0405  ...     0.000002     0.024276   
13  0.110989  2.690000     0.971    277.5265  ...     0.000007     0.035501   
14 -0.317998  2.050000     0.982    276.1493  ...     0.000004     0.038730   
15  0.250426  3.460000     0.963    276.1730  ...     0.000010     0.041869   
16 -0.027248  2.670000     0.975    276.9180  ...     0.000003     0.038787   
17  0.572540  2.030000     0.977    267.9498  ...     0.000004     0.034732   
18  0.533997  2.430000     1.000    266.9374  ...     0.000003     0.036271   
19  0.451535  2.350000     0.948    283.0221  ...     0.000005     0.042217   
20 -0.150674  1.800000     0.900    341.3889  ...     0.000003     0.037886   
21  0.295674  2.100000     0.745   1152.3033  ...     0.000002     0.034982   
22  0.286500  2.230000     0.844    389.2722  ...     0.000002     0.035855   
23 -0.123453  1.980000     0.797    877.1002  ...     0.000008     0.046680   
24 -0.199947  3.380000     0.936    909.3616  ...     0.000004     0.039789   
25  0.111080  2.300000     0.995    875.5515  ...     0.000005     0.038966   
26 -0.113825  2.390000     0.969    833.8214  ...     0.000007     0.042333   
27 -0.074539  2.650000     0.983    867.8775  ...     0.000011     0.037733   
28 -0.065232  2.080000     0.983    877.9384  ...     0.000006     0.039762   
29 -0.059452  2.090000     0.983    863.4615  ...     0.000009     0.037851   
30 -0.234802  2.670000     0.983    848.7300  ...     0.000013     0.034996   
31 -0.296287  3.380000     0.982    858.6050  ...     0.000007     0.025024   
32  0.041118  5.510000     0.889    849.1176  ...     0.000013     0.037438   
33 -0.012620  3.110000     0.981    864.9109  ...     0.000006     0.040412   
34  0.065318  2.230000     0.987    860.0844  ...     0.000009     0.034304   
35 -0.083060  2.080000     0.981    870.9871  ...     0.000005     0.037726   
36 -0.314616  2.650000     0.951    869.0572  ...     0.000008     0.035107   
37 -0.178246  2.760000     0.988    852.4881  ...     0.000005     0.040122   
38 -0.970222  3.880000     0.837    859.1603  ...     0.000010     0.044387   
39  0.304709  2.480000     0.924    859.1724  ...     0.000009     0.038294   
40  0.129673  3.670000     0.962    728.7941  ...     0.000005     0.038768   
41 -0.168966  1.570000     0.991    720.5568  ...     0.000006     0.040520   
42  0.235796  1.169325     0.939    736.7192  ...     0.000007     0.039743   
43  1.437307  2.250000     0.992    124.7071  ...     0.000013     0.043308   
44  1.880290  2.620000     0.984    122.7937  ...     0.000018     0.045465   
45  1.500566  2.440000     0.983    123.2022  ...     0.000016     0.044822   
46 -1.786603  2.300000     0.980     93.1217  ...     0.000019     0.047344   
47 -1.812171  3.660000     0.982     10.6567  ...     0.000063     0.053992   
48  0.364694  2.620000     0.989     38.2586  ...     0.000027     0.039834   
49  0.534109  2.760000     0.983     36.3582  ...     0.000024     0.038426   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0     2084.0  0.082383  0.000004 -0.000002  26.3360   0.484  0.181068     30.0  
1     2074.0  0.080624  0.000004 -0.000002  26.2890   0.484  0.180668     30.0  
2     2084.0  0.086112  0.000003 -0.000002  26.2950   0.484  0.181435     30.0  
3     2067.0 -0.079407  0.000006 -0.000003  26.2620   0.483  0.181508     30.0  
4     2063.0  0.083617  0.000004 -0.000002  26.3590   0.484  0.181936     30.0  
5     2054.0  0.079583  0.000003 -0.000002  26.3730   0.484  0.180118     30.0  
6     1967.0  0.091704  0.000004 -0.000002  26.3350   0.486  0.226168     30.0  
7     1962.0  0.094811  0.000003 -0.000002  26.4760   0.487  0.227823     30.0  
8     1958.0 -0.049475  0.000008 -0.000004  26.3380   0.486  0.229632     30.0  
9     1953.0 -0.059264  0.000007 -0.000004  26.3780   0.487  0.228489     30.0  
10    1957.0  0.100749  0.000015 -0.000008  26.4220   0.487  0.228724     30.0  
11    1967.0  0.102700  0.000004 -0.000002  26.4880   0.487  0.227917     30.0  
12    1957.0 -0.045154  0.000005 -0.000003  26.3590   0.486  0.230829     30.0  
13     948.0 -0.050296  0.000015 -0.000010  26.2830   0.568  0.275037     30.0  
14    1037.0  0.103202  0.000006 -0.000004  26.3750   0.605  0.295211     30.0  
15     978.0 -0.063487  0.000019 -0.000012  26.2920   0.574  0.281183     30.0  
16    1042.0  0.105566  0.000006 -0.000004  26.4670   0.607  0.294626     30.0  
17    1038.0 -0.077194  0.000008 -0.000005  26.3150   0.604  0.294220     30.0  
18    1038.0  0.100781  0.000005 -0.000003  26.4580   0.607  0.294794     30.0  
19    1038.0 -0.103021  0.000009 -0.000007  26.3100   0.607  0.295827     30.0  
20    1057.0  0.107668  0.000004 -0.000003  26.4840   0.614  0.296622     30.0  
21    1338.0  0.101646  0.000004 -0.000003  26.4860   0.579  0.277981     30.0  
22    1104.0  0.095262  0.000005 -0.000003  26.3685   0.533  0.298387     30.0  
23     852.0 -0.115767  0.000014 -0.000010  26.2160   0.627  0.291819     30.0  
24     866.0  0.110557  0.000007 -0.000005  26.3810   0.626  0.291845     30.0  
25     541.0  0.100885  0.000009 -0.000006  26.2760   0.593  0.317425     30.0  
26     546.0  0.107421  0.000011 -0.000008  26.2095   0.597  0.317523     30.0  
27     530.0 -0.059950  0.000021 -0.000014  26.2300   0.576  0.313009     30.0  
28     542.0  0.101331  0.000010 -0.000007  26.2590   0.599  0.318314     30.0  
29     544.0 -0.074840  0.000016 -0.000011  26.2860   0.594  0.319053     30.0  
30       NaN -0.041605  0.000025       NaN      NaN     NaN       NaN      NaN  
31       NaN  0.111454  0.000011       NaN      NaN     NaN       NaN      NaN  
32     530.0 -0.049396  0.000023 -0.000015  26.2735   0.581  0.311430     30.0  
33     543.0  0.102555  0.000010 -0.000007  26.2900   0.596  0.317664     30.0  
34     536.0 -0.055021  0.000016 -0.000011  26.3290   0.584  0.316849     30.0  
35     545.0  0.098139  0.000008 -0.000006  26.2700   0.596  0.318554     30.0  
36     544.0 -0.070824  0.000013 -0.000009  26.3100   0.595  0.318022     30.0  
37     549.0  0.103939  0.000009 -0.000006  26.2290   0.596  0.318221     30.0  
38     545.0  0.099445  0.000018 -0.000012  25.8890   0.596  0.318237     30.0  
39     543.0 -0.077483  0.000016 -0.000011  26.2780   0.596  0.318257     30.0  
40     537.0  0.101738  0.000008 -0.000006  26.3140   0.581  0.318602     30.0  
41     536.0  0.103157  0.000011 -0.000007  26.2850   0.582  0.316503     30.0  
42     540.0  0.097133  0.000012 -0.000008  26.3050   0.584  0.316759     30.0  
43    1029.0  0.113817  0.000010 -0.000011  26.3850   1.055  0.284526     30.0  
44    1029.0  0.110412  0.000013 -0.000015  26.3730   1.055  0.284461     30.0  
45    1027.0  0.112354  0.000012 -0.000013  26.3720   1.054  0.284659     30.0  
46    1029.0  0.117398  0.000014 -0.000016  26.3450   1.053  0.282863     30.0  
47    1404.0  0.073304  0.000049 -0.000055  26.3590   1.092  0.197989     30.0  
48    1403.0  0.105050  0.000021 -0.000023  26.3390   1.093  0.199505     30.0  
49    1405.0  0.109142  0.000018 -0.000021  26.3040   1.093  0.197740     30.0  

[50 rows x 32 columns]]",,10.20073652267456,2025-07-28T16:57:44,0.0051063829787234,0.12,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,2,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the stamp_classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN'      AND classifier_name = 'stamp_classifier'      AND probability > 0.7      AND ranking = 1) p ON dq.oid = p.oidLIMIT 50","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.85085701942444,2025-07-23T18:51:09,"[             oid               candid  fid       xpos       ypos       chipsf  \
0   ZTF21aamkmkb  1512384184715015001    2   786.4876   381.0763    43.094950   
1   ZTF21aamesud  1512384183715015003    2  2944.3635  1222.1791     6.749656   
2   ZTF21aamesud  1512484973715015005    1  2952.0652  1238.8410     9.604321   
3   ZTF21aamesud  1514482703715015004    1  2958.3667  1213.8477    31.549746   
4   ZTF21aamesud  1516369143715015007    2  2950.1077  1208.1796     2.687898   
5   ZTF21aamesud  1516423513715015001    1  2952.5752  1199.0133    10.764467   
6   ZTF21aamesud  1518426123715015001    1  2948.4695  1230.6044     7.227183   
7   ZTF21aamesud  1518454143715015003    2  2951.0134  1227.7784     3.722861   
8   ZTF21aamesud  1520400553715015002    2  2941.4062  1240.3573     2.296008   
9   ZTF21aamesud  1520445933715015000    1  2949.8066  1231.9788     1.829108   
10  ZTF21aamkmkx  1512384185615015004    2  1271.9668  2421.3994     1.335167   
11  ZTF21aamkmnq  1512385125215015009    2    47.1488  1805.5953     1.862478   
12  ZTF21aamkmev  1512382773815015011    2  2982.5225  1465.3688     6.971146   
13  ZTF21aamkmna  1512385125715015000    2  1152.5193   146.5084     5.689874   
14  ZTF21aaekeqv  1496426994715015001    2  3055.2850   234.5527     2.429552   
15  ZTF21aaekeqv  1510483354715015000    1  3062.0066   278.6204     4.118035   
16  ZTF21aaekeqv  1512387024715015000    2  2891.2970   180.3772     1.792804   
17  ZTF21aaekeqv  1514503464715015000    1  2914.0173   210.1251     1.375700   
18  ZTF21aaekeqv  1516439804715015001    1  2911.3125   219.5036     1.310871   
19  ZTF21aaekeqv  1516499674715015001    2  2917.5347   224.8958     1.746500   
20  ZTF21aaekeqv  1518487174715015002    2  2913.0170   196.7695     0.964156   
21  ZTF21aaekeqv  1536393474715015004    2  3048.9607   259.5235     4.574506   
22  ZTF21aaekeqv  1536423404715015001    1  3056.3962   266.5042     3.621517   
23  ZTF21aaekeqv  1541387544715015001    2  3054.7646   254.1535     1.200737   
24  ZTF17aabwqjg  2846515621015010003    1  2824.4640  2982.5906    66.708800   
25  ZTF17aabwqjg  2680284401015010003    1  2825.0288  3058.9868   898.585140   
26  ZTF17aabwqjg  2506467601015010005    1  2840.1500  3045.4817   181.193660   
27  ZTF17aabwqjg  2499466711015010008    1  2857.4746  3022.3440   747.363200   
28  ZTF17aabwqjg  2499466711015010007    1  2857.7632  3022.1600   413.042400   
29  ZTF17aabwqjg  2347198961015015004    1  2865.2832  3057.9126    94.711105   
30  ZTF17aabwqjg  2334286201015010005    1  2867.0725  3030.8616   182.974030   
31  ZTF17aabwqjg  2332303211015010005    1  2870.1472  3024.0237   373.207670   
32  ZTF17aabwqjg  2326264101015010006    1  2867.2983  3046.1992   283.631740   
33  ZTF17aabwqjg  2311320461015015003    1  2870.6064  3043.9397   153.108000   
34  ZTF17aabwqjg  2303217691015010004    1  2858.8900  3063.2185   995.182860   
35  ZTF17aabwqjg  2151414071015010009    1  2828.7166  3030.3313    37.720190   
36  ZTF17aabwqjg  2139427301015010003    1  2809.8318  3017.0671    26.626308   
37  ZTF17aabwqjg  1986261751015010003    1  2855.3352  2999.8455   454.963130   
38  ZTF17aabwqjg  1984201721015010003    1  2885.2776  3032.5608   201.249280   
39  ZTF17aabwqjg  1982239781015010003    1  2863.0847  3036.1091   107.160774   
40  ZTF17aabwqjg  1977220321015010006    1  2865.9614  3055.7097   459.744630   
41  ZTF17aabwqjg  1970219891015010001    1  2883.7090  3044.5117  1688.739700   
42  ZTF17aabwqjg  1959204711015010003    1  2863.4878  3060.7915   967.613200   
43  ZTF17aabwqjg  1940364611015010004    1  2833.0030  3036.3623    87.754036   
44  ZTF17aabwqjg  1936283321015010007    1  2830.2660  3064.1448   350.930050   
45  ZTF17aabwqjg  1934281051015010006    1  2845.7330  3050.5900   201.676670   
46  ZTF17aabwqjg  1924304801015010003    1  2855.9290  3035.3792   787.564800   
47  ZTF17aabwqjg  1607247081015015001    1  2815.1665  3036.4653   502.059050   
48  ZTF17aabwqjg  1609221061015015009    1  2828.5925  3041.5793   559.737550   
49  ZTF17aabwqjg  1619266581015015008    1  2826.1826  3009.9648    95.609726   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.156867  3.060000     0.983    381.0763  ...     0.000015     0.049192   
1  -0.508221  2.880000     0.990    128.1365  ...     0.000013     0.046800   
2  -0.214512  4.420000     0.981    120.4347  ...     0.000029     0.040568   
3   0.049467  2.030000     0.987    114.1333  ...     0.000013     0.030716   
4  -0.204324  2.470000     0.984    122.3923  ...     0.000023     0.053095   
5   0.287936  2.210000     0.983    119.9247  ...     0.000028     0.039668   
6   0.035483  2.610000     0.983    124.0306  ...     0.000033     0.034461   
7   1.593943  2.180000     0.984    121.4866  ...     0.000026     0.053310   
8  -0.979859  4.760000     0.984    131.0937  ...     0.000048     0.059420   
9   0.715249  4.250000     0.984    122.6933  ...     0.000057     0.043107   
10 -0.202397  3.030000     0.973    659.1005  ...     0.000014     0.045921   
11  0.432571  2.850000     0.980     47.1488  ...     0.000013     0.043463   
12 -3.543676  3.230000     0.983     89.9776  ...     0.000018     0.047400   
13  0.367220  3.090000     0.979    146.5084  ...     0.000011     0.040695   
14 -0.057933  3.970000     0.979     17.2150  ...     0.000011     0.051329   
15 -0.094319  2.140000     0.980     10.4935  ...     0.000005     0.031936   
16 -0.405316  3.520000     0.980    180.3772  ...     0.000011     0.050865   
17  0.063669  2.290000     0.977    158.4827  ...     0.000006     0.033315   
18 -0.474341  3.120000     0.979    161.1876  ...     0.000019     0.044574   
19  0.661968  4.390000     0.971    154.9654  ...     0.000011     0.051915   
20  1.724869  2.000000     0.983    159.4829  ...     0.000008     0.047897   
21 -0.398803  2.050000     0.981     23.5392  ...     0.000005     0.043367   
22 -0.186654  2.640000     0.998     16.1038  ...     0.000004     0.031780   
23  0.023349  3.010000     0.943     17.7354  ...     0.000010     0.049812   
24 -7.734028  2.095071     0.997     97.9095  ...     0.000148     0.050191   
25  0.106689  2.033111     0.998     21.5132  ...     0.000076     0.072991   
26 -0.304715  2.340000     1.000     35.0182  ...     0.000036     0.053865   
27 -0.145962  1.308251     0.765     58.1561  ...     0.000040     0.043972   
28 -0.309287  1.308251     1.000     58.3402  ...     0.000040     0.043972   
29  0.484649  3.050000     1.000     22.5875  ...     0.000032     0.045854   
30  0.379750  2.350000     1.000     49.6384  ...     0.000035     0.050917   
31  0.445599  1.361477     0.998     56.4763  ...     0.000031     0.051117   
32 -0.082409  1.590000     1.000     34.3009  ...     0.000036     0.056422   
33  7.065239  1.529680     0.997     36.5603  ...     0.000048     0.046526   
34 -0.254914  1.376471     0.998     17.2814  ...     0.000027     0.058469   
35  4.442382  2.340000     0.998     50.1686  ...     0.000863     0.119009   
36 -1.407699  2.410000     0.999     63.4328  ...     0.000068     0.042835   
37 -2.482304  1.383336     1.000     80.6546  ...     0.000049     0.049420   
38 -0.762889  1.740206     0.998     47.9393  ...     0.000042     0.048321   
39  0.376675  2.490000     1.000     44.3908  ...     0.000037     0.050665   
40  0.074984  2.580000     1.000     24.7904  ...     0.000044     0.060601   
41 -0.104959  1.444748     0.998     35.9882  ...     0.000034     0.061055   
42 -3.335300  1.412700     0.998     19.7084  ...     0.000060     0.054392   
43  0.713090  1.483569     0.997     44.1376  ...     0.000037     0.045668   
44 -0.225482  1.437078     0.997     16.3553  ...     0.000028     0.053935   
45 -0.532288  1.678316     0.997     29.9100  ...     0.000049     0.050563   
46  0.153387  2.240000     1.000     45.1209  ...     0.000034     0.052541   
47  2.164103  1.256540     0.998     44.0346  ...     0.000047     0.047482   
48  0.000154  1.302202     0.997     38.9206  ...     0.000022     0.047547   
49  0.198794  2.320000     0.845     70.5351  ...     0.000033     0.041463   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        315  0.119966  0.000023 -0.000017  26.418000   0.617  0.333283   
1        327  0.120047  0.000021 -0.000015  26.360000   0.654  0.320253   
2        294 -0.047308  0.000053 -0.000036  26.279000   0.580  0.304346   
3        323 -0.051063  0.000020 -0.000015  26.292000   0.648  0.319819   
4        326  0.125295  0.000036 -0.000026  26.350000   0.653  0.319676   
5        288 -0.046740  0.000052 -0.000035  26.256000   0.576  0.302796   
6        201 -0.040135  0.000075 -0.000046  26.280000   0.526  0.267312   
7        326  0.120488  0.000041 -0.000030  26.385000   0.658  0.319424   
8        277  0.120721  0.000076 -0.000055  26.373000   0.663  0.315027   
9        190 -0.047180  0.000126 -0.000078  26.295000   0.531  0.266103   
10       347  0.116029  0.000022 -0.000016  26.329000   0.687  0.316219   
11       326  0.103741  0.000018 -0.000014  26.326000   0.727  0.336218   
12       297  0.115687  0.000028 -0.000021  26.402000   0.622  0.320745   
13       333  0.099710  0.000016 -0.000012  26.310000   0.694  0.328355   
14       602  0.122185  0.000020 -0.000013  26.377000   0.570  0.314162   
15       602 -0.072113  0.000008 -0.000006  26.362000   0.572  0.316892   
16       613  0.116720  0.000019 -0.000013  26.369000   0.572  0.318478   
17       607 -0.066321  0.000011 -0.000007  26.365000   0.568  0.317555   
18       520 -0.046357  0.000042 -0.000026  26.321000   0.519  0.288134   
19       609  0.120765  0.000020 -0.000014  26.417000   0.572  0.316947   
20       608  0.118957  0.000014 -0.000010  26.408000   0.571  0.316686   
21       605  0.114688  0.000009 -0.000006  26.400000   0.572  0.316838   
22       601 -0.072795  0.000008 -0.000005  26.330000   0.570  0.317198   
23       600  0.119312  0.000018 -0.000012  26.344000   0.571  0.315097   
24        87 -0.117545  0.000348 -0.000211  26.246000   0.565  0.239126   
25       140 -0.176249  0.000111 -0.000084  26.272000   0.704  0.338104   
26       248 -0.114436  0.000052 -0.000039  26.261000   0.720  0.334777   
27       240 -0.061274  0.000058 -0.000044  26.244000   0.722  0.331270   
28       240 -0.061274  0.000058 -0.000044  26.244000   0.722  0.331270   
29       239 -0.089548  0.000047 -0.000035  26.228000   0.700  0.330121   
30       255 -0.104335  0.000047 -0.000037  26.212000   0.759  0.336045   
31       251 -0.112455  0.000042 -0.000033  26.135000   0.754  0.335645   
32       261 -0.122179  0.000049 -0.000039  26.250000   0.759  0.338842   
33       193 -0.079738  0.000087 -0.000059  26.227000   0.599  0.305582   
34       262 -0.141969  0.000037 -0.000029  26.311500   0.757  0.338274   
35       109 -0.111144  0.001915 -0.001190  24.772000   0.571  0.253120   
36       138 -0.069693  0.000143 -0.000091  26.177000   0.572  0.273284   
37       204 -0.091257  0.000085 -0.000059  26.188000   0.605  0.308014   
38       195 -0.098857  0.000073 -0.000050  26.252000   0.605  0.312114   
39       224 -0.108302  0.000058 -0.000043  26.278500   0.679  0.321765   
40       246 -0.131774  0.000063 -0.000048  26.262000   0.722  0.334557   
41       257 -0.145437  0.000048 -0.000037  26.238000   0.744  0.334014   
42       204 -0.096879  0.000103 -0.000072  26.263000   0.620  0.311737   
43       236 -0.078439  0.000056 -0.000042  26.066500   0.697  0.328376   
44       268 -0.123712  0.000038 -0.000030  26.271000   0.749  0.338705   
45       200 -0.096101  0.000088 -0.000060  26.289501   0.599  0.308789   
46       253 -0.113880  0.000047 -0.000036  26.256000   0.739  0.333631   
47       216 -0.077275  0.000078 -0.000055  26.297500   0.620  0.313991   
48       267 -0.108873  0.000030 -0.000024  26.293000   0.759  0.337296   
49       253 -0.061501  0.000046 -0.000036  26.212000   0.736  0.333216   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,10.24189519882202,2025-07-28T16:58:00,0.005050505050505,0.02,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,3,"-- Retrieve at most 50 ZTF objects classified as supernovae (SN) by the stamp_classifier-- with a probability greater than 0.7, returning all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN'      AND classifier_name = 'stamp_classifier'      AND probability > 0.7      AND ranking = 1) filtered_probabilitiesON dq.oid = filtered_probabilities.oidLIMIT 50","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.29758334159851,2025-07-23T18:51:31,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21aamscpt  1514226010615015011    1  1724.7672  1895.7062  1.943288   
1   ZTF21aamslof  1514252152715015008    2   168.0806  2015.3156  1.082162   
2   ZTF21aaiqcew  1499356804215015015    1   864.4748  3036.4050  1.254615   
3   ZTF21aaiqcew  1501356924215015020    1   859.1497  3045.2178  1.320116   
4   ZTF21aaiqcew  1503400084215015007    2   876.4753  3028.4570  0.760294   
5   ZTF21aaiqcew  1508314434215015010    1   863.5475  3051.6810  1.744893   
6   ZTF21aaiqcew  1514289644215015008    1   693.9251  2960.6465  1.183699   
7   ZTF21aaiqcew  1514335604215015007    2   697.9364  2969.3318  0.989931   
8   ZTF20acwqiva  1960170863215015017    2  1823.1277  1220.3463  1.192586   
9   ZTF20acwqiva  1956172953215015002    1  1841.4946  1233.2871  0.900188   
10  ZTF20acwqiva  1954190553215015001    2  1835.5765  1216.8794  0.831645   
11  ZTF20acwqiva  1949164873215015004    2  1815.2789  1200.1906  1.094566   
12  ZTF20acwqiva  1947169144515015005    1  3052.6587  1230.1305  1.319466   
13  ZTF20acwqiva  1945192973215015004    1  1846.4143  1224.3150  1.123763   
14  ZTF20acwqiva  1945168154515015005    2  3027.9180  1237.6136  1.552787   
15  ZTF20acwqiva  1943190983215015003    1  1846.1665  1223.0416  0.735541   
16  ZTF20acwqiva  1943168783215015001    2  1816.4525  1227.3368  1.538194   
17  ZTF20acwqiva  1941217293215015001    2  1828.0698  1220.6339  1.469829   
18  ZTF20acwqiva  1939216073215015002    1  1831.3307  1236.9406  0.972364   
19  ZTF20acwqiva  1939190163215015003    2  1825.5979  1241.7852  1.529670   
20  ZTF20acwqiva  1933156713215015001    2  1805.7927  1232.7382  1.626536   
21  ZTF20acwqiva  1933156234515015003    2  3021.9192  1234.1030  1.394341   
22  ZTF20acwqiva  1931168933215015001    1  1819.1210  1235.6934  0.434434   
23  ZTF20acwqiva  1924211083215015002    2  1823.7736  1210.7094  1.726468   
24  ZTF20acwqiva  1924171643215015001    1  1829.2100  1212.7394  1.449501   
25  ZTF20acwqiva  1922228934515015003    1  3052.8870  1220.9307  1.140070   
26  ZTF20acwqiva  1920297123215015003    2  1812.4199  1219.3112  1.264970   
27  ZTF20acwqiva  1920186744515015000    1  3050.7751  1227.4691  1.371551   
28  ZTF20acwqiva  1920185783215015002    1  1831.1561  1223.4453  1.198086   
29  ZTF20acwqiva  1917335124515015006    2  3019.9540  1200.0924  1.355883   
30  ZTF20acwqiva  1917315263215015001    2  1826.2264  1203.0420  1.396646   
31  ZTF20acwqiva  1917277834515015002    1  3029.5535  1216.7694  1.569795   
32  ZTF20acwqiva  1886335753215015004    1  1868.7391  1226.1279  0.925963   
33  ZTF20acwqiva  1882250054515015004    1  3052.6694  1217.4083  1.230300   
34  ZTF20acwqiva  1594210773215015003    1  1817.1609  1196.4764  0.866527   
35  ZTF20acwqiva  1770543813215015007    1  1840.5352  1208.0180  1.163179   
36  ZTF20acwqiva  1774522033215015007    1  1837.9467  1189.3591  0.888036   
37  ZTF20acwqiva  1777481674515015004    1  3030.5378  1193.3260  1.387228   
38  ZTF20acwqiva  1796502874515015005    2  3058.9695  1220.8090  1.353668   
39  ZTF20acwqiva  1868357453215015004    2  1870.8605  1227.0664  1.061237   
40  ZTF20acwqiva  1425523264515015003    2  3009.7700  1199.5300  1.183310   
41  ZTF20acwqiva  1468403104515015003    1  3038.8528  1209.8427  0.697825   
42  ZTF20acwqiva  1476398584515015004    1  3058.0999  1203.6430  1.265557   
43  ZTF20acwqiva  1414499823215015004    1  1826.8400  1194.2300  1.227630   
44  ZTF20acwqiva  1472379733215015001    1  1817.3816  1258.6870  1.406593   
45  ZTF20acwqiva  1478419204515015007    1  3052.4182  1205.9598  1.216665   
46  ZTF20acwqiva  1444521113215015004    1  1818.0400  1204.2300  0.955349   
47  ZTF20acwqiva  1416478923215015002    1  1835.7200  1161.3400  1.275890   
48  ZTF20acwqiva  1446439393215015003    1  1820.3300  1219.9900  0.881661   
49  ZTF20acwqiva  1430500543215015018    2  1820.5600  1211.3200  1.163760   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.393749  2.580000     0.981   1184.7938  ...     0.000017     0.038501   
1  -0.265913  2.210000     0.981    168.0806  ...     0.000004     0.041521   
2  -0.004919  3.220000     0.935     44.0950  ...     0.000011     0.036080   
3   0.342151  3.370000     0.969     35.2823  ...     0.000012     0.040279   
4  -1.605473  2.410000     0.497     52.0429  ...     0.000016     0.049085   
5   1.103332  4.390000     0.685     28.8192  ...     0.000013     0.036346   
6   0.841924  3.060000     0.974    119.8536  ...     0.000014     0.034883   
7  -0.427450  1.499448     0.734    111.1682  ...     0.000010     0.049824   
8  -0.220404  1.910000     0.953   1220.3463  ...     0.000011     0.045321   
9  -0.018932  3.010000     0.981   1231.0054  ...     0.000022     0.040992   
10  0.192445  2.620000     0.919   1216.8794  ...     0.000009     0.046219   
11 -0.187686  3.720000     0.962   1200.1906  ...     0.000010     0.044830   
12  0.264814  3.490000     0.970     19.8412  ...     0.000009     0.035309   
13  0.105845  2.670000     0.975   1224.3150  ...     0.000012     0.037509   
14  1.296197  3.140000     0.968     44.5821  ...     0.000007     0.043783   
15  0.097200  3.380000     0.868   1223.0416  ...     0.000016     0.043073   
16 -0.127065  3.000000     0.970   1227.3368  ...     0.000006     0.039900   
17 -0.356516  2.710000     0.978   1220.6339  ...     0.000006     0.040535   
18 -0.146319  3.250000     0.950   1236.9406  ...     0.000020     0.043253   
19 -0.219742  3.360000     0.947   1241.7852  ...     0.000012     0.048365   
20 -0.225405  2.120000     0.972   1232.7382  ...     0.000005     0.039469   
21 -0.028751  2.250000     0.965     50.5808  ...     0.000015     0.054679   
22 -0.450419  2.170000     0.986   1235.6934  ...     0.000025     0.039092   
23 -0.300539  2.520000     0.981   1210.7094  ...     0.000005     0.039328   
24  0.146777  2.010000     0.957   1212.7394  ...     0.000014     0.037464   
25 -0.218169  4.570000     0.929     19.6130  ...     0.000018     0.041028   
26  0.560372  3.200000     0.972   1219.3112  ...     0.000006     0.040254   
27  0.007615  3.010000     0.959     21.7248  ...     0.000010     0.036465   
28  0.283604  3.140000     0.846   1223.4453  ...     0.000013     0.040471   
29  0.161290  2.190000     0.972     52.5460  ...     0.000011     0.046961   
30 -0.247641  3.020000     0.971   1203.0420  ...     0.000007     0.040286   
31 -4.311616  2.930000     0.953     42.9465  ...     0.000015     0.043546   
32  0.341261  6.540000     0.898   1203.7609  ...     0.000013     0.040299   
33 -0.801247  2.880000     0.950     19.8305  ...     0.000012     0.038476   
34 -0.096282  2.430000     0.962   1196.4764  ...     0.000012     0.036306   
35 -0.070144  2.240000     0.974   1208.0180  ...     0.000010     0.034043   
36 -0.095226  4.320000     0.821   1189.3591  ...     0.000016     0.042971   
37 -0.855613  2.170000     0.922     41.9622  ...     0.000011     0.034103   
38  0.366375  3.520000     0.964     13.5304  ...     0.000005     0.040953   
39 -0.533390  3.750000     0.935   1201.6395  ...     0.000008     0.043081   
40 -0.567148  5.520000     0.848     62.7300  ...     0.000006     0.025826   
41 -0.472752  3.360000     0.815     33.6473  ...     0.000008     0.032561   
42  0.405940  4.310000     0.584     14.4001  ...     0.000009     0.036503   
43  0.244492  5.660000     0.839   1194.2300  ...     0.000015     0.039148   
44 -0.341821  4.740000     0.823   1255.1184  ...     0.000018     0.045701   
45 -0.029647  2.590000     0.956     20.0817  ...     0.000007     0.033564   
46 -0.242055  4.740000     0.640   1204.2300  ...     0.000013     0.036343   
47 -0.229979  3.610000     0.806   1161.3400  ...     0.000011     0.033554   
48  0.201067  1.444750     0.592   1219.9900  ...     0.000021     0.042133   
49 -0.021310  1.403730     0.800   1211.3200  ...     0.000008     0.030041   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0      438.0 -0.059205  0.000028 -0.000020  26.3090   0.625  0.307004     30.0  
1      957.0  0.113475  0.000007 -0.000005  26.3940   0.634  0.296285     30.0  
2      583.0 -0.063436  0.000018 -0.000013  26.2850   0.618  0.299634     30.0  
3      585.0 -0.082075  0.000019 -0.000014  26.2650   0.621  0.302721     30.0  
4      578.0  0.109626  0.000025 -0.000018  26.3380   0.627  0.300737     30.0  
5      576.0 -0.050147  0.000022 -0.000015  26.2680   0.612  0.297017     30.0  
6      523.0 -0.044165  0.000029 -0.000019  26.3100   0.565  0.267398     30.0  
7      606.0  0.131091  0.000017 -0.000012  26.4890   0.619  0.302045     30.0  
8      757.0  0.101431  0.000017 -0.000012  26.2380   0.659  0.297955     30.0  
9      535.0 -0.039662  0.000048 -0.000030  26.1240   0.556  0.248321     30.0  
10     764.0  0.115702  0.000014 -0.000010  26.2680   0.661  0.297798     30.0  
11     763.0  0.102029  0.000016 -0.000012  26.1740   0.656  0.297111     30.0  
12     769.0 -0.061524  0.000014 -0.000010  26.1700   0.661  0.291429     30.0  
13     721.0 -0.046587  0.000021 -0.000015  26.0320   0.622  0.284103     30.0  
14     786.0  0.117871  0.000010 -0.000008  26.2360   0.669  0.295113     30.0  
15     710.0 -0.058283  0.000029 -0.000020  26.0355   0.618  0.279059     30.0  
16     767.0  0.105554  0.000009 -0.000007  26.1800   0.662  0.297051     30.0  
17     765.0  0.107355  0.000009 -0.000007  26.1560   0.659  0.297214     30.0  
18     649.0 -0.035981  0.000039 -0.000026  26.0430   0.579  0.265271     30.0  
19     762.0  0.109483  0.000019 -0.000014  26.2220   0.658  0.296995     30.0  
20     767.0  0.104763  0.000009 -0.000006  26.2170   0.658  0.297595     30.0  
21     776.0  0.125267  0.000024 -0.000018  26.4200   0.673  0.294290     30.0  
22     474.0 -0.031361  0.000056 -0.000035  26.1530   0.550  0.235044     30.0  
23     763.0  0.104699  0.000008 -0.000006  26.2100   0.659  0.297767     30.0  
24     700.0 -0.030893  0.000025 -0.000017  26.0860   0.609  0.276746     30.0  
25     649.0 -0.043604  0.000036 -0.000024  26.1820   0.583  0.256653     30.0  
26     765.0  0.104832  0.000010 -0.000007  26.2310   0.661  0.296654     30.0  
27     760.0 -0.056060  0.000017 -0.000012  26.2170   0.658  0.289912     30.0  
28     736.0 -0.058284  0.000022 -0.000016  26.1275   0.627  0.289220     30.0  
29     792.0  0.109362  0.000017 -0.000013  26.2630   0.673  0.294040     30.0  
30     761.0  0.100159  0.000011 -0.000008  26.2420   0.661  0.295858     30.0  
31     778.0 -0.060658  0.000024 -0.000017  26.2090   0.660  0.293048     30.0  
32     683.0 -0.069944  0.000024 -0.000017  26.1800   0.605  0.274213     30.0  
33     760.0 -0.054251  0.000020 -0.000014  26.1870   0.651  0.285953     30.0  
34     724.0 -0.043547  0.000020 -0.000014  25.9880   0.620  0.282471     30.0  
35     737.0 -0.045451  0.000016 -0.000012  26.1490   0.625  0.287015     30.0  
36     733.0 -0.053824  0.000027 -0.000019  26.1230   0.625  0.285920     30.0  
37     768.0 -0.025956  0.000017 -0.000013  26.1340   0.654  0.287584     30.0  
38     781.0  0.112597  0.000009 -0.000006  26.3540   0.672  0.294446     30.0  
39     761.0  0.105138  0.000013 -0.000010  26.3190   0.659  0.296553     30.0  
40       NaN  0.110030  0.000010       NaN      NaN     NaN       NaN      NaN  
41     780.0 -0.053602  0.000012 -0.000009  26.2470   0.663  0.291495     30.0  
42     768.0 -0.064773  0.000015 -0.000011  26.2760   0.660  0.290209     30.0  
43       NaN -0.041908  0.000026       NaN      NaN     NaN       NaN      NaN  
44     708.0 -0.058560  0.000033 -0.000023  26.1435   0.618  0.279726     30.0  
45     783.0 -0.062334  0.000012 -0.000009  26.2610   0.668  0.294262     30.0  
46       NaN -0.074360  0.000023       NaN      NaN     NaN       NaN      NaN  
47       NaN -0.052044  0.000018       NaN      NaN     NaN       NaN      NaN  
48       NaN -0.036723  0.000042       NaN      NaN     NaN       NaN      NaN  
49       NaN  0.102048  0.000013       NaN      NaN     NaN       NaN      NaN  

[50 rows x 32 columns]]",,10.023174285888672,2025-07-28T16:58:15,0.0018761726078799,0.02,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,4,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the stamp_classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN'      AND classifier_name = 'stamp_classifier'      AND probability > 0.7      AND ranking = 1) p ON dq.oid = p.oidLIMIT 50","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,21.27705931663513,2025-07-23T18:51:53,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21aamxduf  1543398781715015008    2  2113.0488  2585.8855  1.772358   
1   ZTF21aamxduf  1541400351715015009    2  2113.2437  2583.3674  1.669824   
2   ZTF21aamxduf  1537377281715015023    2  2103.9580  2577.7090  2.149123   
3   ZTF21aamxduf  1537299691715015018    1  2098.9160  2559.8477  1.259990   
4   ZTF21aamxduf  1526422371715015017    2  2110.5420  2541.3752  1.570372   
5   ZTF21aamxduf  1522440001715015009    1  2091.1265  2541.4463  0.883168   
6   ZTF21aamxduf  1522382781715015003    2  2107.0322  2551.8403  0.888405   
7   ZTF21aamxduf  1518454621715015005    2  1948.5463  2506.5984  1.161461   
8   ZTF21aamxduf  1518400971715015008    1  1946.3340  2497.2036  0.918117   
9   ZTF21aamxduf  1516500191715015008    2  1965.2140  2538.4087  1.410225   
10  ZTF21aamxduf  1516439301715015004    1  1955.2365  2540.7583  1.616236   
11  ZTF21aamxduf  1514482231715015006    1  1956.1433  2499.0212  1.107722   
12  ZTF21aamxdxi  1514483184615015002    1  2953.2627   503.4679  2.141902   
13  ZTF21aamxdxi  1514485563515015001    1  1536.1835   513.4626  1.516045   
14  ZTF21aamxdzd  1514483185315015007    1  2352.0413  1401.7725  0.950819   
15  ZTF21aamwzfi  1514465214815015001    2  1986.1970  1024.5320  1.927482   
16  ZTF21aamwzfi  1514531384815015006    1  1975.4349  1034.0054  1.786408   
17  ZTF21aamwzfi  1515490596015015005    1  2939.7449  1230.2477  1.417566   
18  ZTF21aamwzfi  1517429076015015006    1  2934.6602  1243.5278  1.125170   
19  ZTF21aamwzfi  1518476714815015002    2  1969.2744  1043.8670  1.242607   
20  ZTF21aamwzfi  1521449534815015004    1  1945.8687  1045.4990  1.325777   
21  ZTF21aamwzfi  1524496066015015019    2  3009.0590  1279.9020  1.438144   
22  ZTF21aamwzfi  1524498954815015002    2  2039.8221  1102.2313  1.766768   
23  ZTF21aamwzfi  1524521284815015012    1  2050.1445  1095.4788  1.563365   
24  ZTF21aamwzfi  1524527956015015007    1  3009.5400  1274.9609  2.776963   
25  ZTF21aamwzfi  1528512034815015005    2  2053.7395  1124.8088  2.748049   
26  ZTF21aamwzfi  1528514006015015010    2  3008.1540  1300.9040  1.650860   
27  ZTF21aamwzfi  1538456066015015019    1  3018.4248  1279.0199  2.353582   
28  ZTF21aamwzfi  1538458404815015007    1  2062.0857  1097.7415  1.548773   
29  ZTF21aamwzfi  1538473144815015003    2  2054.7776  1101.0868  1.821040   
30  ZTF21aamwzfi  1538474106015015017    2  3009.8510  1276.8108  2.212996   
31  ZTF21aamwzfi  1541489724815015003    2  2050.9246  1131.7552  1.465367   
32  ZTF21aamwzfi  1541490196015015005    2  3009.0140  1307.4307  2.162896   
33  ZTF21aamwzfi  1543394724815015001    2  2047.1261  1119.8097  1.082613   
34  ZTF21aamwzfi  1543429866015015004    2  3004.0435  1302.9471  0.688353   
35  ZTF21aamwzfi  1552481286015015008    2  3010.1658  1280.5240  1.894939   
36  ZTF21aamwzfi  1553445654815015006    2  2078.3867  1099.2726  1.258000   
37  ZTF21aamwzfi  1554493726015015016    2  3025.8880  1278.6927  1.084584   
38  ZTF21aamwzfi  1555408284815015004    2  2061.9940  1089.9673  0.830979   
39  ZTF21aamwzfi  1556457926015015004    2  3029.3054  1265.7420  1.803813   
40  ZTF21aamwzfi  1563430914815015007    2  2063.5898  1099.1188  1.168448   
41  ZTF21aamwzfi  1558406136015015004    2  3037.4392  1267.6112  1.798962   
42  ZTF21aamxdmn  1514481755015015008    1  2974.0408  2220.6711  1.265877   
43  ZTF21aamssts  1536347316015015006    2  3028.1790  2767.0193  1.268527   
44  ZTF21aamssts  1536345404915015011    2  1086.5641  2915.0664  0.851103   
45  ZTF21aamssts  1536320946015015022    1  3035.3333  2766.3784  0.937689   
46  ZTF21aamssts  1526366036015015020    1  3044.4990  2718.0425  1.735829   
47  ZTF21aamssts  1526277414915015016    2  1108.3859  2862.9185  1.749649   
48  ZTF21aamssts  1526274546015015013    2  3053.5290  2709.9663  2.017363   
49  ZTF21aamssts  1526243284915015025    1  1117.8040  2860.9678  1.048551   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.083140  1.317870     0.542    494.6144  ...     0.000008     0.046505   
1   0.247122  1.254025     0.714    497.1326  ...     0.000006     0.042163   
2   0.333040  2.350000     0.952    502.7909  ...     0.000007     0.043922   
3   0.097415  2.340000     0.846    520.6523  ...     0.000013     0.038405   
4  -0.013194  2.330000     0.660    539.1248  ...     0.000008     0.043313   
5  -0.175669  2.030000     0.978    539.0538  ...     0.000018     0.040362   
6  -0.472465  2.340000     0.953    528.6596  ...     0.000011     0.046450   
7  -0.426307  1.431574     0.843    573.9015  ...     0.000013     0.049340   
8  -0.006869  1.570000     0.923    583.2965  ...     0.000035     0.042601   
9  -0.365459  1.432676     0.872    542.0914  ...     0.000011     0.047839   
10  0.387381  1.376471     0.871    539.7416  ...     0.000018     0.037795   
11  0.463527  1.980000     0.953    581.4787  ...     0.000009     0.035028   
12 -0.724382  2.490000     0.997    119.2373  ...     0.000022     0.038955   
13  0.067187  2.470000     0.980    513.4626  ...     0.000020     0.038196   
14  0.119676  2.430000     0.974    720.4587  ...     0.000016     0.037224   
15 -0.087428  2.380000     0.961   1024.5320  ...     0.000006     0.038912   
16  0.059526  2.220000     0.974   1034.0054  ...     0.000013     0.047412   
17 -0.306064  2.480000     0.981    132.7551  ...     0.000009     0.036162   
18 -0.905536  4.100000     0.979    137.8399  ...     0.000026     0.043877   
19 -0.307391  2.230000     0.997   1043.8670  ...     0.000009     0.043449   
20 -0.083575  3.200000     0.978   1045.4990  ...     0.000016     0.039225   
21 -0.677277  2.420000     0.983     63.4409  ...     0.000005     0.038152   
22  0.137591  2.370000     0.981   1032.6779  ...     0.000006     0.038989   
23 -0.475095  3.690000     0.980   1022.3554  ...     0.000013     0.041589   
24 -0.182883  3.600000     0.908     62.9599  ...     0.000010     0.035945   
25 -0.277093  2.110000     0.985   1018.7606  ...     0.000007     0.038940   
26 -0.657259  2.020000     0.982     64.3459  ...     0.000004     0.036107   
27  0.242711  2.490000     0.978     54.0751  ...     0.000007     0.034353   
28 -0.011995  3.100000     0.979   1010.4143  ...     0.000014     0.046722   
29 -0.314763  2.330000     0.979   1017.7225  ...     0.000007     0.038630   
30 -0.178931  2.020000     0.999     62.6490  ...     0.000005     0.035979   
31 -0.092535  2.640000     0.973   1021.5755  ...     0.000006     0.037560   
32  0.081647  2.310000     0.978     63.4861  ...     0.000004     0.034995   
33  0.098430  2.880000     0.894   1025.3739  ...     0.000008     0.041958   
34  0.152429  3.230000     0.956     68.4566  ...     0.000008     0.043087   
35  0.286298  1.860000     0.980     62.3342  ...     0.000006     0.038075   
36 -0.317105  2.550000     0.958    994.1132  ...     0.000005     0.037323   
37  0.324250  1.970000     0.955     46.6120  ...     0.000005     0.035526   
38 -0.156946  3.210000     0.762   1010.5061  ...     0.000008     0.039823   
39 -0.062193  2.900000     0.887     43.1945  ...     0.000004     0.036889   
40  0.151228  2.910000     0.695   1008.9102  ...     0.000010     0.042357   
41 -0.113903  1.350000     0.858     35.0609  ...     0.000004     0.036528   
42  0.034599  2.650000     0.952     98.4593  ...     0.000009     0.033660   
43  0.373605  2.240000     0.923     44.3211  ...     0.000007     0.040815   
44 -0.061031  2.190000     0.948    165.4335  ...     0.000011     0.040800   
45 -0.186230  2.380000     0.933     37.1668  ...     0.000012     0.036872   
46 -0.364599  3.870000     0.909     28.0010  ...     0.000014     0.039226   
47  0.358130  2.790000     0.975    217.5816  ...     0.000013     0.041382   
48 -0.417791  2.830000     0.966     18.9709  ...     0.000007     0.038786   
49  0.104018  3.780000     0.908    219.5323  ...     0.000034     0.061416   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        520  0.122532  0.000013 -0.000010  26.311000   0.650  0.313485   
1        521  0.112793  0.000010 -0.000007  26.293000   0.650  0.313453   
2        521  0.117500  0.000011 -0.000008  26.330000   0.653  0.315991   
3        508 -0.061305  0.000022 -0.000016  26.147500   0.644  0.312134   
4        520  0.111997  0.000012 -0.000009  26.239000   0.653  0.313986   
5        445 -0.063488  0.000033 -0.000022  26.252000   0.579  0.294679   
6        521  0.110706  0.000018 -0.000013  26.335000   0.653  0.315044   
7        514  0.117034  0.000022 -0.000016  26.360000   0.661  0.312328   
8        302 -0.038208  0.000077 -0.000047  26.242500   0.532  0.270376   
9        515  0.119671  0.000018 -0.000013  26.363000   0.677  0.312842   
10       439 -0.037184  0.000035 -0.000023  26.248000   0.579  0.292183   
11       513 -0.069226  0.000015 -0.000011  26.278000   0.653  0.312036   
12       283 -0.055417  0.000035 -0.000025  26.358000   0.654  0.342070   
13       281 -0.059117  0.000032 -0.000023  26.331000   0.641  0.342777   
14       360 -0.053193  0.000026 -0.000019  26.357000   0.645  0.338313   
15       734  0.095599  0.000009 -0.000007  26.165500   0.625  0.306657   
16       727 -0.087873  0.000022 -0.000016  26.162000   0.624  0.305843   
17       677 -0.063899  0.000017 -0.000011  26.233000   0.603  0.292326   
18       465 -0.052605  0.000060 -0.000036  26.200000   0.532  0.251206   
19       734  0.098230  0.000014 -0.000010  26.140000   0.628  0.306566   
20       595 -0.028639  0.000034 -0.000022  26.165000   0.554  0.270085   
21       696  0.102193  0.000008 -0.000006  26.226000   0.627  0.300914   
22       720  0.097173  0.000009 -0.000007  26.169000   0.624  0.305615   
23       680 -0.058023  0.000024 -0.000016  26.175499   0.602  0.297044   
24       672 -0.059780  0.000017 -0.000012  26.248000   0.610  0.292345   
25       720  0.090157  0.000011 -0.000008  26.153000   0.625  0.306229   
26       704  0.097387  0.000007 -0.000005  26.216000   0.625  0.301386   
27       692 -0.067497  0.000012 -0.000009  26.166000   0.627  0.301123   
28       704 -0.084118  0.000024 -0.000017  26.074000   0.618  0.302854   
29       716  0.087004  0.000012 -0.000008  26.103000   0.625  0.305521   
30       694  0.094440  0.000008 -0.000005  26.175000   0.628  0.301082   
31       719  0.086101  0.000011 -0.000008  26.090000   0.624  0.305385   
32       700  0.092172  0.000007 -0.000005  26.157000   0.627  0.302469   
33       719  0.094266  0.000014 -0.000010  26.108000   0.624  0.304765   
34       705  0.104785  0.000014 -0.000010  26.187000   0.621  0.300683   
35       697  0.092396  0.000011 -0.000008  26.195000   0.628  0.302241   
36       708  0.095626  0.000008 -0.000006  26.147500   0.624  0.305129   
37       692  0.092010  0.000008 -0.000006  26.170000   0.628  0.301486   
38       714  0.084509  0.000014 -0.000010  26.127000   0.624  0.305690   
39       689  0.099027  0.000007 -0.000005  26.152000   0.629  0.302143   
40       716  0.086622  0.000016 -0.000012  26.114000   0.625  0.304842   
41       691  0.098097  0.000007 -0.000005  26.215000   0.627  0.302089   
42       587 -0.040842  0.000017 -0.000011  26.382000   0.578  0.310769   
43       533  0.108935  0.000011 -0.000008  26.207000   0.708  0.306923   
44       489  0.100443  0.000016 -0.000012  26.249000   0.706  0.304964   
45       533 -0.068361  0.000018 -0.000014  26.176000   0.696  0.306925   
46       523 -0.072427  0.000021 -0.000016  26.163000   0.696  0.306366   
47       494  0.094240  0.000019 -0.000015  26.248000   0.707  0.304900   
48       526  0.101348  0.000011 -0.000008  26.207000   0.711  0.307853   
49       490 -0.124817  0.000051 -0.000039  26.173000   0.699  0.304618   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,10.439950942993164,2025-07-28T16:58:29,0.0429799426934097,0.3,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,5,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the 'stamp_classifier' -- with a probability greater than 0.7, and return all columns from the 'dataquality' table.SELECT dq.*FROM dataquality dqINNER JOIN probability p    ON dq.oid = p.oidWHERE p.classifier_name = 'stamp_classifier' -- Use the stamp classifier  AND p.class_name = 'SN'                   -- Classify as supernova ('SN')  AND p.ranking = 1                         -- Only the most likely classification  AND p.probability > 0.7                   -- Probability greater than 0.7LIMIT 50                                   -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.14957046508789,2025-07-23T18:52:15,"[             oid               candid  fid       xpos       ypos     chipsf  \
0   ZTF21aangstx  1516278004815015002    1  2093.9358  1022.0841   1.180754   
1   ZTF21aangsxq  1516278473915015000    1    74.0300   428.9334   1.012839   
2   ZTF21aangsyx  1516278942415015003    1  1449.3138   851.7587   1.757463   
3   ZTF21aangtgx  1516278471515015007    1  1573.6830  1180.6888   1.240443   
4   ZTF21aangvva  1516293432115015007    2  1741.4104  1491.7974   1.813867   
5   ZTF21aanhave  1516311003115015002    2  2276.5470   496.2262   1.520525   
6   ZTF21aanhapx  1516311004715015012    2  2922.1057  2436.9690   1.325877   
7   ZTF21aanhbwt  1516309593015015004    2  1271.4017   645.0965   0.960050   
8   ZTF21aanhawa  1516311000515015007    2   866.6450  1071.6306   1.159657   
9   ZTF21aanhbqm  1516311002515015020    2  2212.0183  1905.3693   0.957892   
10  ZTF21aanheed  1516321426115015010    2  2959.4019  1641.1356   1.838704   
11  ZTF21aanhenv  1516321903115015002    2  2643.8623  1601.5153   1.804603   
12  ZTF21aanheuw  1516322874315015004    2  2104.3164   418.5373   1.232387   
13  ZTF21aanhfaq  1516322381115015015    2  2704.7417  2295.5115   1.388951   
14  ZTF21aanhgej  1516321904115015008    2   712.6222  2308.7402   0.954736   
15  ZTF21aanhgju  1516323802915015004    2  1283.6716   783.8607   0.976507   
16  ZTF21aanhirs  1516337784415015000    2  1832.3922    97.8175   1.702551   
17  ZTF21aanhjdm  1516336804015015007    2   397.9332  1108.2295   0.606038   
18  ZTF21aanhjqk  1516336806215015006    2  1288.3287  1281.0951   1.253827   
19  ZTF21aanhjtv  1516338260815015008    2  2414.9282  1586.3615   1.250152   
20  ZTF21aanhjtm  1516338264115015009    2  1891.7081  2057.9966   1.055787   
21  ZTF21aanhled  1516341553315015002    2  1533.7950   999.3583   1.435499   
22  ZTF21aanhmbi  1516353650415015000    2  1536.7452   401.5095   1.366636   
23  ZTF21aanhnco  1516355921715015007    2  1608.8835  1540.8958   1.067298   
24  ZTF21aanhnat  1516356400415015002    2  2981.8830   137.3747   1.181977   
25  ZTF21aanhrzs  1516369145315015009    2  1730.0570  1974.9056   3.943983   
26  ZTF21aanhsdp  1516371493315015007    2  2025.7029  1252.1718   1.350097   
27  ZTF21aanhtsd  1516373396215015037    2   595.2807  2306.9978   1.024537   
28  ZTF21aanhvxv  1516384383615015000    1  1062.0568   251.2029   1.277903   
29  ZTF21aanhwde  1516387255215015000    2  1717.3948    42.9599   1.689481   
30  ZTF21aanhwie  1516386793615015003    2   527.0311  1652.1910   0.674167   
31  ZTF21aanhwju  1516387251015015012    2  1522.2140  1650.7491   0.709573   
32  ZTF21aanhwyw  1516388191815015005    2  2741.0190  2914.5527   1.466186   
33  ZTF21aanhxfi  1516387734615015011    2   686.2590  2421.3872   0.837643   
34  ZTF21aanhxeb  1516388702215015012    2  2558.4055  2527.3467   1.358824   
35  ZTF21aanhynp  1516387736215015015    2  1814.1576  2854.9214   1.325195   
36  ZTF21aaniatn  1516401794415015010    1  1588.3116  2718.3574   1.804864   
37  ZTF21aanifuz  1516481684715015007    2   774.4594  2401.7456   1.725120   
38  ZTF21aanigrs  1516482161215015011    2  1145.6410  2155.3480   1.781637   
39  ZTF18aawfofp  1555410183315015010    2   920.5580  2657.1910   2.408221   
40  ZTF18aawfofp  1516486093315015021    2   796.7332  2645.5230   8.732484   
41  ZTF18ablwums  2231507543115015008    1  3052.9211  2946.5210   8.001466   
42  ZTF18ablwums  1766225683115015008    2  3057.5078  2889.4922  12.124171   
43  ZTF18ablwums  1544430353115015008    1  3054.9102  2918.3196  27.689320   
44  ZTF18ablwums  1516529623115015011    1  2933.7500  2891.9326  12.692691   
45  ZTF18ablwums  1516492503115015001    2  2937.9832  2877.7798  11.149524   
46  ZTF18ablwums   944316893115010041    1  3039.6965  2825.0667  57.098255   
47  ZTF18ablwums   821514063115015035    1  2991.1838  2896.0415   8.570893   
48  ZTF18ablwums  1423120813115015005    1  3048.7878  2905.2417   7.470389   
49  ZTF18ablwums  1134516533115015002    2  3026.2222  2823.3477   4.090123   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -3.353884  3.960000     0.983    978.5643  ...     0.000051     0.043256   
1  -2.777706  2.740000     0.987     74.0300  ...     0.000030     0.036401   
2   0.089144  2.720000     0.995    851.7587  ...     0.000034     0.038340   
3  -2.022586  2.390000     0.983   1180.6888  ...     0.000048     0.045713   
4  -0.103780  2.730000     0.986   1331.0896  ...     0.000003     0.036985   
5   0.338942  2.000000     0.981    496.2262  ...     0.000022     0.050249   
6   2.974333  3.070000     0.982    150.3942  ...     0.000019     0.053010   
7  -0.744974  1.750000     0.993    645.0965  ...     0.000015     0.049616   
8  -1.852543  2.650000     0.993    866.6450  ...     0.000020     0.045157   
9  -0.490882  1.960000     0.980    860.4818  ...     0.000019     0.054770   
10  1.597806  2.730000     0.983    113.0981  ...     0.000035     0.048193   
11 -0.853337  2.180000     0.981    428.6378  ...     0.000022     0.055960   
12  0.115615  2.560000     0.999    418.5373  ...     0.000018     0.049578   
13  0.274810  2.690000     0.980    367.7582  ...     0.000020     0.045072   
14 -0.453083  3.110000     1.000    712.6222  ...     0.000029     0.053334   
15  0.347523  3.230000     0.973    783.8607  ...     0.000016     0.052450   
16  2.037936  3.150000     0.982     97.8175  ...     0.000028     0.057040   
17 -0.349948  2.990000     0.978    397.9332  ...     0.000022     0.053849   
18 -0.161258  3.430000     0.982   1281.0951  ...     0.000021     0.048716   
19  1.068764  2.610000     0.981    657.5717  ...     0.000016     0.043367   
20 -0.077134  2.210000     0.977   1022.5034  ...     0.000019     0.051940   
21  0.399083  3.380000     0.898    999.3583  ...     0.000020     0.053751   
22 -0.557343  3.420000     0.983    401.5095  ...     0.000032     0.051568   
23 -0.858810  4.390000     0.981   1463.6165  ...     0.000021     0.051363   
24  1.978517  4.740000     0.979     90.6170  ...     0.000018     0.053327   
25 -0.349009  2.670000     0.984   1105.5944  ...     0.000024     0.046126   
26  0.028580  2.810000     0.980   1046.7971  ...     0.000017     0.049060   
27 -0.710075  2.880000     0.980    595.2807  ...     0.000015     0.048421   
28  0.553062  2.580000     0.984    251.2029  ...     0.000026     0.040287   
29 -3.408553  2.940000     0.983     42.9599  ...     0.000016     0.052150   
30  0.119800  3.630000     0.981    527.0311  ...     0.000020     0.060443   
31  0.209014  2.610000     0.962   1429.7509  ...     0.000013     0.046151   
32  0.610365  4.620000     0.974    165.9473  ...     0.000008     0.047229   
33 -1.357227  2.880000     0.987    659.1129  ...     0.000012     0.044514   
34 -0.314454  4.420000     0.999    514.0944  ...     0.000033     0.057392   
35  0.641994  5.090000     0.996    225.5787  ...     0.000012     0.046658   
36 -0.491748  2.640000     0.983    362.1427  ...     0.000020     0.040313   
37  0.526932  4.590000     0.967    678.7543  ...     0.000006     0.041702   
38  0.349820  3.090000     0.982    925.1522  ...     0.000004     0.038426   
39 -0.217993  1.228585     0.942    423.3090  ...     0.000005     0.037591   
40  0.573119  2.770000     1.000    434.9770  ...     0.000006     0.039341   
41 -0.858185  1.818296     0.983     19.5789  ...     0.000005     0.029054   
42  1.002745  2.350000     0.653     14.9921  ...     0.000003     0.024331   
43 -1.018328  1.377617     0.995     17.5899  ...     0.000003     0.021448   
44 -0.114364  1.672662     0.994    138.7500  ...     0.000005     0.028536   
45 -2.937552  1.552221     0.995    134.5169  ...     0.000002     0.023014   
46 -3.103923  6.020000     0.940     32.8035  ...     0.000453     0.196341   
47  1.595042  2.860000     0.958     81.3161  ...     0.000024     0.061183   
48  0.934564  1.717374     0.988     23.7122  ...     0.000004     0.024577   
49 -4.511748  2.599550     0.845     46.2779  ...     0.000013     0.043904   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        211 -0.048392  0.000111 -0.000069  26.156000   0.556  0.270043   
1        251 -0.023417  0.000066 -0.000041  26.313000   0.543  0.279110   
2        212 -0.058788  0.000068 -0.000044  26.314999   0.539  0.286572   
3        256 -0.046632  0.000087 -0.000060  26.279500   0.613  0.292335   
4       2127  0.097454  0.000009 -0.000005  26.361000   0.479  0.217437   
5        374  0.113169  0.000028 -0.000023  26.398000   0.813  0.329697   
6        419  0.122961  0.000026 -0.000021  26.433000   0.710  0.327712   
7        387  0.118374  0.000022 -0.000017  26.372000   0.702  0.330469   
8        350  0.091240  0.000030 -0.000023  26.400000   0.676  0.329785   
9        385  0.126313  0.000026 -0.000020  26.444000   0.734  0.338741   
10       193  0.103870  0.000051 -0.000039  26.174000   0.733  0.335016   
11       306  0.131928  0.000031 -0.000024  26.374500   0.702  0.341441   
12       391  0.107168  0.000027 -0.000020  26.489000   0.666  0.332741   
13       348  0.093099  0.000029 -0.000022  26.362000   0.732  0.330544   
14       298  0.118468  0.000039 -0.000031  26.511000   0.875  0.333766   
15       499  0.118674  0.000027 -0.000019  26.376000   0.616  0.316829   
16       281  0.129808  0.000037 -0.000030  26.450000   0.803  0.344961   
17       411  0.121472  0.000034 -0.000025  26.477000   0.635  0.316962   
18       386  0.106283  0.000030 -0.000023  26.220000   0.697  0.321017   
19       337  0.100343  0.000023 -0.000017  26.387000   0.728  0.324965   
20       348  0.120630  0.000026 -0.000020  26.503000   0.749  0.338660   
21       320  0.129571  0.000028 -0.000022  26.391500   0.712  0.334140   
22       255  0.107328  0.000043 -0.000034  26.401000   0.769  0.343525   
23       426  0.113004  0.000037 -0.000025  26.311500   0.572  0.304310   
24       551  0.109065  0.000027 -0.000020  26.358000   0.643  0.325184   
25       312  0.096893  0.000038 -0.000028  26.323000   0.670  0.317555   
26       302  0.118337  0.000028 -0.000020  26.399000   0.631  0.328239   
27       362  0.117768  0.000022 -0.000017  26.245000   0.693  0.328050   
28       390 -0.043949  0.000070 -0.000039  26.210000   0.478  0.235206   
29       418  0.119712  0.000026 -0.000019  26.309000   0.623  0.327584   
30       560  0.130794  0.000038 -0.000025  26.358000   0.548  0.308068   
31       433  0.102306  0.000023 -0.000016  26.283000   0.569  0.324107   
32       675  0.117147  0.000014 -0.000010  26.345000   0.548  0.308422   
33       480  0.100397  0.000020 -0.000014  26.361000   0.618  0.316467   
34       372  0.119013  0.000048 -0.000036  26.562000   0.678  0.320377   
35       495  0.101721  0.000020 -0.000014  26.223000   0.610  0.329350   
36       385 -0.048127  0.000043 -0.000026  26.329000   0.508  0.294550   
37      2018  0.100299  0.000013 -0.000008  26.324000   0.545  0.216689   
38      1616  0.081755  0.000009 -0.000005  26.266000   0.510  0.265926   
39       581  0.102514  0.000008 -0.000006  26.369000   0.572  0.303863   
40       575  0.102351  0.000012 -0.000008  26.394000   0.572  0.300850   
41      2009 -0.050376  0.000017 -0.000009  26.125000   0.503  0.150906   
42      2027  0.093760  0.000008 -0.000005  26.268000   0.505  0.152170   
43      2008 -0.057970  0.000008 -0.000005  26.095000   0.504  0.150711   
44      2010 -0.050044  0.000016 -0.000009  26.227000   0.500  0.151299   
45      2016  0.088092  0.000008 -0.000004  26.288000   0.500  0.151565   
46      1290 -0.010100  0.001466 -0.000788  23.466500   0.500  0.142793   
47      2002 -0.078938  0.000076 -0.000041  24.625000   0.502  0.154176   
48      2012 -0.044749  0.000012 -0.000006  26.120000   0.503  0.154010   
49      1752  0.084947  0.000039 -0.000022  26.242000   0.510  0.159687   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.586565494537354,2025-07-28T16:58:44,0.0046511627906976,0.04,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,6,"-- Retrieve at most 50 ZTF objects classified as supernovae (SN) by the stamp_classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE classifier_name = 'stamp_classifier' -- Use the stamp classifier      AND class_name = 'SN' -- Classify as supernovae      AND probability > 0.7 -- Probability greater than 0.7      AND ranking = 1 -- Only the most likely classification) p ON dq.oid = p.oidLIMIT 50 -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.459919214248657,2025-07-23T18:52:38,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21aanrpcg  1520379903315015000    2  1958.8029   119.8147  0.856458   
1   ZTF21aanrpfy  1520382383715015004    2  1830.4347   795.8670  2.179222   
2   ZTF21aanrpil  1520382380115015000    2  1104.4668    58.5558  2.642199   
3   ZTF21aanrrzr  1520415033715015002    2  1429.3313  1305.0273  6.482396   
4   ZTF21aanrsde  1520415502715015004    2   208.5326   510.2064  2.179070   
5   ZTF21aanrxmt  1520503573615015002    2  1045.8180  2306.4167  0.930640   
6   ZTF21aantkuf  1521157994215015007    1  1790.4502  2244.9712  1.011954   
7   ZTF21aantkuf  1524159384215015029    2  1806.1241  2287.4430  0.762531   
8   ZTF21aantkuf  1539185654215015001    2  1805.4097  2250.5847  1.959310   
9   ZTF21aanrhag  1562186495615015003    2  2734.4778   897.9595  1.357225   
10  ZTF21aanrhag  1562186030615015013    2   809.0440  3007.8586  0.748192   
11  ZTF21aanrhag  1558268685615015006    2  2715.2014   892.7451  1.233735   
12  ZTF21aanrhag  1556202010615015002    2   811.5421  3013.0688  1.457328   
13  ZTF21aanrhag  1554218220615015009    2   815.2047  3010.8284  1.137520   
14  ZTF21aanrhag  1554215405615015005    2  2747.2890   898.9185  0.860120   
15  ZTF21aanrhag  1552240900615015013    2   805.5782  3010.8340  1.387325   
16  ZTF21aanrhag  1552239005615015005    2  2731.8933   902.1597  1.366498   
17  ZTF21aanrhag  1548223355615015004    2  2735.2007   879.7736  1.184178   
18  ZTF21aanrhag  1550177405615015004    2  2763.0500   903.0575  1.263556   
19  ZTF21aanrhag  1542237595615015004    2  2726.5957   927.0174  1.003833   
20  ZTF21aanrhag  1539281570615015005    1   809.3690  3023.0767  1.379125   
21  ZTF21aanrhag  1539280625615015005    1  2738.6006   916.3840  1.092830   
22  ZTF21aanrhag  1539222145615015002    2  2745.8638   914.0799  1.284781   
23  ZTF21aanrhag  1537250265615015008    2  2724.5774   929.2411  2.208958   
24  ZTF21aanrhag  1537213610615015009    2   789.8619  3038.3484  1.151269   
25  ZTF21aanrhag  1527329350615015011    1   796.4342  3020.6213  1.254068   
26  ZTF21aanrhag  1527327005615015010    1  2730.4724   910.3438  1.612965   
27  ZTF21aanrhag  1527235345615015006    2  2742.5430   907.1642  1.454222   
28  ZTF21aanrhag  1527233870615015004    2   807.2754  3017.2540  1.003860   
29  ZTF21aanrhag  1524244840615015003    1   806.1261  3055.3005  0.929416   
30  ZTF21aanrhag  1524243435615015007    1  2739.3152   949.0127  1.155943   
31  ZTF21aanrhag  1524182175615015002    2  2725.8174   904.3983  1.549901   
32  ZTF21aanrhag  1524179820615015002    2   792.0950  3012.1975  1.614569   
33  ZTF21aanrhag  1521270545615015003    2  2591.5520   888.4954  2.485630   
34  ZTF21aanrhag  1521270080615015006    2   660.7632  2993.8901  1.547557   
35  ZTF21aanrhag  1521166145615015004    1  2609.7642   855.7472  2.617055   
36  ZTF21aanrhag  1521166620615015005    1   677.7290  2959.0950  1.373086   
37  ZTF21aantnug  1521171632015015002    1  2560.7920   264.0744  1.619330   
38  ZTF21aanttzc  1521187594315015014    1  2343.7432  2134.4236  0.929157   
39  ZTF21aantvkz  1521191494315015011    1  1341.4988  1607.9093  0.940969   
40  ZTF21aantxzr  1521206151715015000    1   642.9015   281.1556  1.217025   
41  ZTF21aantyvm  1521207092615015021    1  1849.9397  1980.0016  0.993733   
42  ZTF21aanubsj  1521212482015015013    1  2031.1733  1929.0700  1.026738   
43  ZTF21aanucac  1521212481115015014    1   507.3099  2964.8286  1.249266   
44  ZTF21aantsla  2332221651015010004    1  2661.0615  2356.2420  0.818012   
45  ZTF21aantsla  1521216361015015001    1  2468.3716  2277.5852  1.896061   
46  ZTF21aantsla  1521222025315015000    1    89.7679   221.8327  1.746259   
47  ZTF21aantsla  1521335945315015000    2    98.1226   238.8266  1.725945   
48  ZTF21aantsla  1524300135315015000    1   242.0411   325.1364  1.591765   
49  ZTF21aantsla  1524312531015015044    1  2615.3720  2335.2942  5.041827   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -1.483478  3.090000     0.981    119.8147  ...     0.000053     0.052888   
1   0.326428  4.240000     0.951    795.8670  ...     0.000050     0.056781   
2  -0.484641  4.220000     0.981     58.5558  ...     0.000048     0.055938   
3   0.325445  4.960000     0.975   1305.0273  ...     0.000036     0.055405   
4  -0.840794  5.900000     0.977    208.5326  ...     0.000031     0.052007   
5  -0.950685  4.210000     0.977    774.0832  ...     0.000010     0.036818   
6   0.112234  3.990000     0.941    835.5287  ...     0.000011     0.039350   
7  -0.623396  4.010000     0.972    793.0570  ...     0.000005     0.039664   
8  -0.062135  2.420000     0.999    829.9153  ...     0.000003     0.035768   
9  -0.011614  2.350000     0.970    338.0223  ...     0.000013     0.042668   
10 -2.120998  1.206540     0.886     72.6413  ...     0.000015     0.042549   
11 -0.115164  1.519323     0.616    357.2987  ...     0.000013     0.039832   
12 -2.861204  2.350000     0.850     67.4312  ...     0.000016     0.046329   
13 -1.894716  2.900000     0.971     69.6717  ...     0.000013     0.042850   
14  0.452831  2.670000     0.884    325.2110  ...     0.000011     0.040234   
15 -2.415169  1.214367     0.717     69.6659  ...     0.000014     0.043565   
16  0.327931  1.243911     0.909    340.6067  ...     0.000014     0.041144   
17 -0.363475  1.206540     0.930    337.2994  ...     0.000016     0.041894   
18 -0.324651  2.590000     0.953    309.4499  ...     0.000013     0.042856   
19 -0.249950  2.940000     0.912    345.9042  ...     0.000023     0.048142   
20 -0.918888  1.870000     0.887     57.4233  ...     0.000022     0.048522   
21 -0.038463  2.920000     0.714    333.8995  ...     0.000024     0.042800   
22 -0.057142  2.480000     0.976    326.6363  ...     0.000011     0.040287   
23  0.590156  2.620000     0.978    347.9227  ...     0.000012     0.040239   
24 -2.714554  2.150000     0.973     42.1516  ...     0.000011     0.038993   
25 -1.116448  3.310000     0.837     59.8786  ...     0.000022     0.040263   
26 -0.234230  4.130000     0.891    342.0276  ...     0.000024     0.039212   
27  0.035702  3.520000     0.963    329.9571  ...     0.000013     0.041687   
28 -2.025330  2.470000     0.934     63.2461  ...     0.000023     0.050808   
29 -1.289654  3.730000     0.969     25.1995  ...     0.000023     0.038628   
30 -0.179402  4.530000     0.948    333.1847  ...     0.000023     0.037600   
31  0.129995  3.270000     0.981    346.6826  ...     0.000014     0.042149   
32 -1.664251  2.560000     0.981     68.3024  ...     0.000013     0.041314   
33 -0.575344  2.750000     0.983    480.9480  ...     0.000017     0.044532   
34 -1.972946  3.710000     0.981     86.6099  ...     0.000020     0.053112   
35 -0.136458  2.800000     0.982    462.7358  ...     0.000019     0.036925   
36 -0.282271  4.680000     0.968    121.4050  ...     0.000025     0.039895   
37  0.309494  3.350000     0.903    264.0744  ...     0.000010     0.057506   
38 -0.241478  4.560000     0.933    728.7568  ...     0.000011     0.041066   
39  0.207565  4.730000     0.930   1341.4988  ...     0.000019     0.037344   
40 -0.479730  3.000000     0.983    281.1556  ...     0.000026     0.036312   
41 -0.303547  3.460000     0.979   1100.4984  ...     0.000019     0.041944   
42  0.677946  4.050000     0.982   1041.3267  ...     0.000034     0.041081   
43  0.070930  3.640000     0.979    115.6714  ...     0.000036     0.047217   
44  0.256745  1.910000     0.861    411.4384  ...     0.000019     0.046212   
45 -0.285232  2.950000     0.998    604.1285  ...     0.000034     0.041138   
46  1.257417  3.750000     0.977     89.7679  ...     0.000072     0.042675   
47  1.811058  3.580000     0.979     98.1226  ...     0.000029     0.047490   
48 -0.089496  2.910000     0.986    242.0411  ...     0.000037     0.041321   
49  0.419071  2.490000     0.999    457.1280  ...     0.000028     0.044417   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        203  0.107366  0.000085 -0.000061  26.406000   0.598  0.311905   
1        251  0.138226  0.000060 -0.000051  26.393000   0.886  0.307221   
2        215  0.114449  0.000070 -0.000053  26.319000   0.700  0.332899   
3        344  0.119076  0.000053 -0.000040  26.347000   0.720  0.308316   
4        371  0.105299  0.000050 -0.000036  26.337000   0.672  0.302371   
5       1968  0.081967  0.000019 -0.000013  26.360000   0.645  0.177108   
6       1263 -0.071132  0.000021 -0.000014  26.260000   0.616  0.219608   
7       1444  0.098840  0.000009 -0.000006  26.439000   0.653  0.266154   
8       1443  0.103228  0.000005 -0.000004  26.430000   0.653  0.265024   
9        340  0.100997  0.000019 -0.000015  26.264000   0.758  0.330659   
10       372  0.101241  0.000019 -0.000015  26.302000   0.861  0.324636   
11       336  0.093186  0.000018 -0.000014  26.318000   0.766  0.329103   
12       375  0.112941  0.000021 -0.000017  26.317000   0.863  0.323345   
13       374  0.106174  0.000017 -0.000014  26.343000   0.861  0.323589   
14       339  0.097347  0.000016 -0.000012  26.326000   0.758  0.330759   
15       375  0.105359  0.000018 -0.000015  26.299000   0.863  0.324571   
16       339  0.094319  0.000020 -0.000015  26.284000   0.765  0.330326   
17       339  0.093028  0.000022 -0.000017  26.314000   0.765  0.330647   
18       341  0.102845  0.000018 -0.000014  26.279000   0.768  0.330210   
19       338  0.101166  0.000032 -0.000025  26.305000   0.762  0.332428   
20       374 -0.108822  0.000028 -0.000023  26.329000   0.867  0.323713   
21       334 -0.073806  0.000034 -0.000026  26.352000   0.749  0.330756   
22       337  0.097358  0.000016 -0.000012  26.340000   0.756  0.329857   
23       339  0.093113  0.000017 -0.000013  26.301000   0.758  0.334103   
24       373  0.095866  0.000015 -0.000012  26.293000   0.859  0.322521   
25       369 -0.068700  0.000029 -0.000024  26.333000   0.855  0.323692   
26       331 -0.050127  0.000036 -0.000027  26.344000   0.725  0.327882   
27       336  0.098577  0.000018 -0.000014  26.340000   0.762  0.330977   
28       374  0.116478  0.000030 -0.000025  26.161000   0.873  0.322971   
29       356 -0.057381  0.000031 -0.000025  26.315000   0.831  0.321108   
30       321 -0.042415  0.000036 -0.000027  26.328000   0.658  0.325152   
31       338  0.098748  0.000019 -0.000015  26.338501   0.762  0.330739   
32       373  0.100764  0.000017 -0.000014  26.347000   0.863  0.323241   
33       337  0.102084  0.000024 -0.000019  26.328000   0.756  0.326566   
34       376  0.131183  0.000025 -0.000021  26.353000   0.851  0.324654   
35       336 -0.055173  0.000028 -0.000021  26.326000   0.745  0.330802   
36       354 -0.058215  0.000034 -0.000027  26.315500   0.761  0.320288   
37      1357 -0.121808  0.000019 -0.000013  26.266000   0.577  0.284525   
38      1180 -0.031706  0.000027 -0.000017  26.244000   0.532  0.225098   
39       363 -0.055488  0.000028 -0.000021  26.316000   0.732  0.325535   
40       238 -0.052682  0.000043 -0.000030  26.225500   0.618  0.318560   
41       365 -0.076795  0.000032 -0.000023  26.296000   0.631  0.317674   
42       241 -0.056097  0.000060 -0.000041  26.281000   0.579  0.309614   
43       289 -0.071925  0.000059 -0.000042  26.321000   0.635  0.316700   
44       249 -0.105864  0.000028 -0.000021  26.256000   0.730  0.343178   
45       191 -0.068539  0.000065 -0.000043  26.261000   0.531  0.313727   
46       152 -0.033228  0.000128 -0.000088  26.271000   0.618  0.297652   
47       215  0.114241  0.000040 -0.000032  26.344000   0.802  0.321985   
48       220 -0.066082  0.000052 -0.000041  26.329000   0.760  0.328049   
49       251 -0.082738  0.000040 -0.000030  26.347000   0.723  0.342618   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.558968305587769,2025-07-28T16:58:59,0.0059880239520958,0.02,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,7,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier-- with a probability greater than 0.7, and return all columns from the 'dataquality' table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN' -- Filter for supernovae classification      AND classifier_name = 'stamp_classifier' -- Use the stamp classifier      AND probability > 0.7 -- Probability threshold      AND ranking = 1 -- Only the most likely classification) p ON dq.oid = p.oidLIMIT 50 -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.43987345695496,2025-07-23T18:53:02,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21aantxfv  1538282655415015001    1   278.4218   441.9074  1.138057   
1   ZTF21aantxfv  1536310025415015003    1   271.0484   453.3009  0.987020   
2   ZTF21aantxfv  1526276465415015004    2   292.6564   405.1389  1.336415   
3   ZTF21aantxfv  1526250355415015000    1   299.6122   404.4748  3.038820   
4   ZTF21aantxfv  1522240275415015000    1   290.5447   404.2780  1.592026   
5   ZTF21aanyfam  1538305591015015000    1   732.4972   194.7302  1.162824   
6   ZTF21aanyfam  1536321411015015000    1   701.2032   212.8794  0.836271   
7   ZTF21aanyfam  1526366491015015000    1   711.1462   166.4220  1.328620   
8   ZTF21aanyfam  1526275021015015000    2   713.9888   157.8876  1.093830   
9   ZTF21aanyfam  1522349271015015000    2   708.1470   174.0435  0.775789   
10  ZTF21aanyfam  1522242171015015002    1   714.0602   143.3313  0.831673   
11  ZTF21aanvtng  1522248533215015016    1  2411.4976  2826.3160  1.552768   
12  ZTF21aanvtng  1522369403215015023    2  2422.0903  2823.1455  1.264523   
13  ZTF21aanvtng  1526286963215015025    2  2419.2834  2809.0566  1.558059   
14  ZTF21aanvtng  1526358423215015019    1  2426.9446  2824.1870  1.186491   
15  ZTF21aanvtng  1536255243215015019    2  2413.1975  2864.0913  1.193224   
16  ZTF21aanvtng  1536295173215015014    1  2415.1284  2870.0340  1.135204   
17  ZTF21aanyzhg  1522255132415015012    1  2058.3790  2502.3223  3.555323   
18  ZTF21aanyzhk  1522255132415015003    1  2962.2620   601.3735  1.201045   
19  ZTF21aanzalc  1522255602315015013    1  1097.9517  2701.9058  1.030134   
20  ZTF21aanzasy  1522256072915015007    1  2465.0444  1052.1554  1.289222   
21  ZTF21aanzcdp  1522257961215015000    1  2864.3320    44.0015  1.234282   
22  ZTF21aanywbt  1563197364715015010    2   935.1461  2273.9330  1.329830   
23  ZTF21aanywbt  1559215994715015014    2   916.8591  2277.2832  1.752952   
24  ZTF21aanywbt  1553233804715015005    2   933.1176  2278.0322  1.005068   
25  ZTF21aanywbt  1543269174715015007    2   901.1154  2308.9282  0.764022   
26  ZTF21aanywbt  1538339754715015008    2   914.1273  2301.3360  1.673520   
27  ZTF21aanywbt  1538316434715015008    1   918.4317  2301.7378  2.629618   
28  ZTF21aanywbt  1536316584715015013    1   905.0403  2316.9980  1.164559   
29  ZTF21aanywbt  1536257604715015010    2   898.9506  2315.3840  2.885003   
30  ZTF21aanywbt  1526360784715015007    1   917.5130  2271.4120  2.283444   
31  ZTF21aanywbt  1526282174715015003    2   902.1619  2264.6230  2.333254   
32  ZTF21aanywbt  1522342394715015009    2   912.4725  2270.7780  1.355251   
33  ZTF21aanywbt  1522260314715015006    1   905.2324  2282.9370  1.229669   
34  ZTF21aanzcyu  1522269970015015005    1  2381.1418  2796.8538  0.773097   
35  ZTF21aanzezj  1522274684415015003    2  2106.3823   756.5696  1.578284   
36  ZTF21aanzhfq  1522275175715015022    2  2508.2285  2073.9084  1.235224   
37  ZTF21aanzhiu  1522276114115015019    2   381.1934  3019.0002  0.952164   
38  ZTF21aanzilq  1522276571715015002    2   513.6189   134.1988  2.938125   
39  ZTF21aanzxpu  1522335653415015003    2  1412.7649  1140.9548  1.157232   
40  ZTF21aanzxtp  1522337081915015018    2  1926.0051  2844.2417  0.892124   
41  ZTF21aanzyfw  1522337551815015004    2  1007.8355   881.0524  1.442301   
42  ZTF21aanzyvz  1522337555415015008    2   319.5496  3003.4292  2.532537   
43  ZTF21aanzzfr  1522337551415015022    2   777.2079  1895.4447  2.737217   
44  ZTF21aanzzpm  1522337085815015009    2  1892.0938  2658.8953  1.615614   
45  ZTF21aanzzwz  1522337082215015029    2  2965.3513  2633.8486  0.906006   
46  ZTF21aaoaats  1522340386315015003    2  2964.9575  1610.8549  0.689992   
47  ZTF21aaoabrs  1538336360515015020    2  2053.1035  1792.6964  0.927279   
48  ZTF21aaoabrs  1536336270515015015    2  2046.4384  1807.6981  0.859180   
49  ZTF21aaoabrs  1526295560515015018    2  2053.6082  1762.7900  1.561304   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.023426  2.540000     0.923    278.4218  ...     0.000012     0.035023   
1  -0.272994  1.950000     0.940    271.0484  ...     0.000013     0.038098   
2  -0.200538  1.960000     0.954    292.6564  ...     0.000008     0.038713   
3   0.110817  2.100000     0.981    299.6122  ...     0.000013     0.039499   
4  -0.321778  3.030000     0.966    290.5447  ...     0.000013     0.036792   
5  -0.132779  1.570000     0.697    194.7302  ...     0.000021     0.049130   
6   0.158373  3.680000     0.895    212.8794  ...     0.000028     0.053745   
7  -0.098311  3.100000     0.959    166.4220  ...     0.000021     0.051795   
8   0.220755  2.350000     0.701    157.8876  ...     0.000010     0.039167   
9   0.211396  2.350000     0.990    174.0435  ...     0.000015     0.041561   
10  0.050578  3.230000     0.959    143.3313  ...     0.000024     0.047044   
11  0.108564  3.160000     0.978    254.1842  ...     0.000024     0.039433   
12  0.046779  1.343969     0.846    257.3546  ...     0.000011     0.042833   
13  0.265969  1.730000     0.973    271.4434  ...     0.000011     0.045985   
14  0.000732  3.990000     0.979    256.3131  ...     0.000024     0.043898   
15  0.407213  2.350000     0.917    216.4088  ...     0.000010     0.045878   
16 -0.174690  2.850000     0.893    210.4661  ...     0.000020     0.041555   
17 -0.194441  2.710000     0.982    578.1778  ...     0.000018     0.038356   
18 -0.348930  3.510000     0.957    110.2381  ...     0.000018     0.038356   
19 -0.313014  2.230000     0.981    378.5943  ...     0.000022     0.040206   
20 -0.003672  2.770000     0.972    607.4555  ...     0.000022     0.041100   
21 -0.286519  3.080000     0.976     44.0015  ...     0.000037     0.042690   
22  0.383660  2.140000     0.949    806.5669  ...     0.000040     0.059847   
23  0.150556  1.650000     0.953    803.2168  ...     0.000033     0.055307   
24  0.175599  2.210000     0.976    802.4677  ...     0.000038     0.055477   
25  0.562089  2.940000     0.834    771.5718  ...     0.000047     0.059945   
26  0.031288  1.760000     0.981    779.1641  ...     0.000061     0.066847   
27 -0.151956  2.760000     0.981    778.7623  ...     0.000027     0.034519   
28  0.086299  2.210000     0.976    763.5019  ...     0.000031     0.039745   
29  0.107652  1.710000     0.982    765.1160  ...     0.000040     0.056292   
30  0.063636  2.860000     0.953    809.0878  ...     0.000029     0.037494   
31 -0.110380  2.540000     0.981    815.8769  ...     0.000140     0.080679   
32  0.080230  2.710000     0.985    809.7219  ...     0.000037     0.058425   
33 -0.492678  3.000000     0.953    797.5629  ...     0.000043     0.039299   
34  0.015983  3.100000     0.974    283.6463  ...     0.000038     0.043872   
35 -0.335522  2.570000     0.936    756.5696  ...     0.000010     0.045211   
36  0.436837  2.370000     0.984    564.2714  ...     0.000007     0.037510   
37  0.647962  2.610000     0.980     61.4997  ...     0.000003     0.039408   
38  0.302674  2.280000     0.983    134.1988  ...     0.000006     0.041154   
39 -0.245094  2.780000     0.961   1140.9548  ...     0.000010     0.046975   
40  0.085101  3.670000     0.972    236.2583  ...     0.000023     0.053320   
41  0.269137  3.620000     0.981    881.0524  ...     0.000015     0.041498   
42  0.471672  3.340000     0.979     77.0707  ...     0.000016     0.047973   
43  0.048274  3.240000     0.987    777.2079  ...     0.000011     0.040869   
44  0.303140  4.340000     0.934    421.6048  ...     0.000023     0.050012   
45  0.002887  3.660000     0.975    107.1486  ...     0.000017     0.053977   
46 -1.134707  3.540000     0.980    107.5425  ...     0.000009     0.046030   
47  0.108862  3.040000     0.964   1019.3966  ...     0.000004     0.031872   
48 -0.026526  2.910000     0.993   1026.0616  ...     0.000004     0.031380   
49  0.100210  2.510000     0.997   1018.8918  ...     0.000004     0.033747   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        440 -0.063169  0.000018 -0.000014  26.232000   0.701  0.318445   
1        442 -0.075133  0.000019 -0.000015  26.287000   0.706  0.320284   
2        449  0.096966  0.000011 -0.000009  26.341000   0.717  0.321035   
3        450 -0.083281  0.000018 -0.000014  26.285000   0.715  0.321467   
4        443 -0.070051  0.000019 -0.000014  26.293000   0.705  0.319036   
5        308 -0.120250  0.000029 -0.000023  26.263500   0.727  0.321063   
6        305 -0.126865  0.000040 -0.000031  26.322000   0.725  0.319847   
7        307 -0.129584  0.000029 -0.000023  26.307000   0.725  0.322349   
8        310  0.101949  0.000015 -0.000011  26.314499   0.725  0.320534   
9        309  0.100021  0.000022 -0.000017  26.320000   0.726  0.321101   
10       308 -0.105504  0.000033 -0.000026  26.284000   0.729  0.321401   
11       337 -0.047468  0.000044 -0.000029  26.205000   0.562  0.301919   
12       363  0.106038  0.000018 -0.000013  26.327000   0.604  0.319635   
13       363  0.118730  0.000018 -0.000013  26.329000   0.608  0.318794   
14       357 -0.068773  0.000041 -0.000029  26.211000   0.592  0.314635   
15       366  0.122105  0.000017 -0.000012  26.315000   0.605  0.316730   
16       367 -0.067745  0.000034 -0.000024  26.217000   0.592  0.317374   
17       402 -0.058498  0.000026 -0.000020  26.275500   0.693  0.324240   
18       402 -0.058498  0.000026 -0.000020  26.275500   0.693  0.324240   
19       358 -0.062258  0.000033 -0.000025  26.316000   0.673  0.319909   
20       380 -0.059114  0.000032 -0.000024  26.282000   0.699  0.327521   
21       211 -0.068035  0.000060 -0.000043  26.301000   0.619  0.325443   
22       172  0.141679  0.000052 -0.000042  26.459000   0.805  0.351201   
23       169  0.133069  0.000044 -0.000035  26.456000   0.808  0.349021   
24       172  0.128049  0.000050 -0.000040  26.488500   0.805  0.351387   
25       171  0.135051  0.000063 -0.000050  26.378000   0.800  0.351584   
26       173  0.150454  0.000081 -0.000064  26.439000   0.802  0.349284   
27       173 -0.058258  0.000036 -0.000029  26.308000   0.808  0.351838   
28       172 -0.076621  0.000041 -0.000032  26.338000   0.805  0.350374   
29       174  0.127086  0.000054 -0.000043  26.482500   0.799  0.351733   
30       168 -0.069906  0.000039 -0.000031  26.336500   0.801  0.350497   
31       166  0.150755  0.000185 -0.000148  26.660000   0.805  0.348780   
32       170  0.139106  0.000049 -0.000039  26.452500   0.801  0.350630   
33       159 -0.056413  0.000060 -0.000046  26.335000   0.707  0.348600   
34       213 -0.056478  0.000071 -0.000046  26.199000   0.533  0.323483   
35       447  0.119912  0.000013 -0.000010  26.448000   0.793  0.318320   
36       554  0.097916  0.000010 -0.000008  26.284000   0.652  0.303197   
37       944  0.110213  0.000005 -0.000004  26.476000   0.627  0.300460   
38       593  0.108938  0.000008 -0.000006  26.350000   0.717  0.318429   
39       740  0.107935  0.000017 -0.000012  26.395000   0.612  0.301459   
40       319  0.127500  0.000032 -0.000025  26.357000   0.757  0.327360   
41       250  0.099824  0.000022 -0.000017  26.402000   0.683  0.332459   
42       305  0.118827  0.000023 -0.000017  26.363000   0.724  0.330421   
43       375  0.094357  0.000016 -0.000012  26.159000   0.682  0.333860   
44       317  0.113576  0.000031 -0.000024  26.385000   0.819  0.331748   
45       346  0.126902  0.000025 -0.000019  26.455000   0.660  0.343268   
46       599  0.111793  0.000014 -0.000010  26.252000   0.649  0.320627   
47       485  0.089263  0.000007 -0.000005  26.297000   0.583  0.296539   
48       484  0.087627  0.000007 -0.000005  26.363000   0.579  0.296804   
49       491  0.096644  0.000007 -0.000005  26.366000   0.575  0.296137   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.060406684875488,2025-07-28T16:59:13,0.0142450142450142,0.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,8,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the 'stamp_classifier'-- with a probability greater than 0.7 and ranking equal to 1, returning all columns from the 'dataquality' table.SELECT dq.*FROM dataquality dqINNER JOIN probability p    ON dq.oid = p.oidWHERE p.classifier_name = 'stamp_classifier' -- Use the stamp classifier  AND p.class_name = 'SN'                   -- Classify as supernovae  AND p.ranking = 1                         -- Only the most likely classification  AND p.probability > 0.7                   -- Probability greater than 0.7LIMIT 50                                   -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,19.49210286140442,2025-07-23T18:53:21,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21aaoebyi  1524283813615015019    2  1531.8951  1732.7950  1.346242   
1   ZTF21aaoecng  1524284755415015015    2  2906.6430  2345.0208  1.656202   
2   ZTF21aaoecuo  1524284751115015011    2   891.1978  1488.6425  1.268305   
3   ZTF21aaoectd  1524284292215015010    2  1184.8157  1242.7031  4.427886   
4   ZTF21aaoebid  1524283811715015007    2  2675.6780   666.1815  0.727067   
5   ZTF21aaoedkk  1524283815615015013    2  1953.5927  1607.8947  1.777334   
6   ZTF21aaoejdu  1524291933115015009    2   276.8536  1149.5293  0.914245   
7   ZTF21aaoejim  1524291931115015010    2   262.8076   914.8297  1.089289   
8   ZTF21aanuyrn  1524310551115015000    1  2502.5620   875.0348  1.413127   
9   ZTF21aanuyrn  1537309141115015004    1  2517.4407   909.9952  1.150736   
10  ZTF21aanuyrn  1537367391115015003    2  2512.3890   922.6113  1.818552   
11  ZTF21aanuyrn  1539261921115015002    2  2535.8394   883.5157  1.934186   
12  ZTF21aanuyrn  1554433151115015005    2  2534.9377   903.8438  1.061066   
13  ZTF21aaoepti  1524311111215015004    1  1463.2428  1190.3322  1.460277   
14  ZTF21aanzcuj  1524312535815015006    1  1658.6257  1515.9779  2.476141   
15  ZTF21aanzcuj  1524430855815015016    2  1646.9930  1527.5424  2.486088   
16  ZTF21aanzcuj  1536325385815015011    1  1650.2777  1549.2594  3.336260   
17  ZTF21aanzcuj  1536350165815015005    2  1641.7437  1554.3494  7.160142   
18  ZTF21aanzcuj  1538304165815015011    1  1672.6711  1536.7148  5.499927   
19  ZTF21aanzcuj  1538362435815015009    2  1663.9572  1542.5255  7.854186   
20  ZTF21aanzcuj  1541286555815015007    1  1663.5822  1541.5359  2.023824   
21  ZTF21aanzcuj  1543268195815015008    2  1657.6404  1540.5563  2.769733   
22  ZTF21aanzcuj  1546332395815015006    1  1642.4587  1536.0942  1.109107   
23  ZTF21aanzcuj  1550228475815015004    1  1672.9920  1506.4259  1.505602   
24  ZTF21aanzcuj  1550297255815015007    2  1661.2297  1524.1978  1.131615   
25  ZTF21aanzcuj  1553235215815015007    2  1690.3344  1507.3064  9.864778   
26  ZTF21aanzcuj  1553307345815015012    1  1675.0406  1516.0212  1.068772   
27  ZTF21aanzcuj  1555197935815015005    1  1698.3832  1494.1556  4.694424   
28  ZTF21aanzcuj  1555238245815015005    2  1688.4037  1506.1304  3.976399   
29  ZTF21aanzcuj  1557225795815015005    1  1678.7677  1509.8292  1.636357   
30  ZTF21aanzcuj  1557306465815015005    2  1671.2500  1521.2452  8.358280   
31  ZTF21aanzcuj  1559218805815015006    2  1676.8177  1507.6417  6.992635   
32  ZTF21aanzcuj  1559243185815015003    1  1680.1637  1509.8701  2.613661   
33  ZTF21aanzcuj  1561261995815015031    2  1690.0460  1512.8217  1.155284   
34  ZTF21aanzcuj  1563198775815015010    2  1694.1603  1504.5876  6.263910   
35  ZTF21aanzcuj  1563241365815015008    1  1690.8780  1514.5183  6.533310   
36  ZTF21aanzcuj  1567261755815015010    1  1663.9749  1529.2263  1.655962   
37  ZTF21aanzcuj  1567301415815015005    2  1671.5612  1528.9362  9.691377   
38  ZTF21aanzcuj  1569282195815015015    1  1681.8734  1525.4373  1.897764   
39  ZTF21aanzcuj  1569322225815015005    2  1669.8262  1521.5935  5.511229   
40  ZTF21aanzcuj  1571260745815015008    2  1672.7535  1524.4233  3.676354   
41  ZTF21aanzcuj  1571347515815015004    1  1657.7972  1510.0830  1.072667   
42  ZTF21aanzcuj  1575247175815015006    2  1660.8160  1526.7784  1.364099   
43  ZTF21aanzcuj  1581258645815015004    1  1676.0414  1508.5966  3.165634   
44  ZTF21aanzcuj  1581309165815015007    2  1676.0156  1498.9417  0.867909   
45  ZTF21aanzcuj  1584261895815015002    2  1678.2206  1519.9872  3.072807   
46  ZTF21aanzcuj  1584306865815015010    1  1661.1057  1512.2473  1.699314   
47  ZTF21aanzcuj  1586221095815015009    1  1682.2379  1510.2888  2.937377   
48  ZTF21aanzcuj  1586301505815015006    2  1671.7051  1499.2457  6.289765   
49  ZTF21aanzcuj  1588279785815015006    2  1661.2408  1508.0550  2.242893   

         sky  fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.270973  2.88     0.968   1347.7050  ...     0.000009     0.045844   
1  -0.495954  2.88     0.982    165.8570  ...     0.000010     0.039877   
2   0.191567  3.16     0.930    891.1978  ...     0.000010     0.041302   
3  -0.074768  3.03     0.983   1184.8157  ...     0.000013     0.042683   
4  -0.212844  2.77     0.974    396.8220  ...     0.000011     0.046291   
5   0.063206  3.78     0.964   1118.9073  ...     0.000012     0.043384   
6   0.183554  2.28     0.836    276.8536  ...     0.000011     0.047089   
7  -0.229440  2.68     0.980    262.8076  ...     0.000008     0.039716   
8  -0.458039  3.86     0.968    569.9381  ...     0.000017     0.046510   
9   0.046394  3.14     0.952    555.0593  ...     0.000013     0.050191   
10 -0.511872  2.26     0.998    560.1110  ...     0.000007     0.037908   
11 -0.281771  2.78     0.965    536.6606  ...     0.000008     0.039529   
12 -0.399370  1.59     0.914    537.5623  ...     0.000007     0.037631   
13  0.329943  3.05     0.924   1190.3322  ...     0.000015     0.034468   
14  0.172727  2.69     0.981   1413.8743  ...     0.000028     0.039058   
15  0.197510  3.13     0.982   1425.5070  ...     0.000017     0.046925   
16 -0.170443  2.32     0.983   1422.2223  ...     0.000020     0.033247   
17 -0.309569  1.97     0.983   1430.7563  ...     0.000018     0.046191   
18  0.361490  2.51     0.999   1399.8289  ...     0.000018     0.031960   
19  0.278106  1.81     0.983   1408.5428  ...     0.000018     0.045217   
20 -0.202760  4.09     0.980   1408.9178  ...     0.000049     0.042215   
21 -0.693995  2.50     0.999   1414.8596  ...     0.000032     0.051961   
22 -0.232768  3.57     0.979   1430.0413  ...     0.000054     0.037006   
23  0.372294  2.88     0.983   1399.5080  ...     0.000030     0.034197   
24 -0.088691  3.19     0.983   1411.2703  ...     0.000028     0.053022   
25  0.448027  2.06     0.992   1382.1656  ...     0.000016     0.043838   
26  0.178009  1.98     0.982   1397.4594  ...     0.000014     0.028385   
27  0.526957  1.92     0.983   1374.1168  ...     0.000021     0.035785   
28  0.449018  1.66     0.983   1384.0963  ...     0.000027     0.048820   
29  0.183343  2.37     0.983   1393.7323  ...     0.000021     0.033956   
30  0.174357  1.93     0.983   1401.2500  ...     0.000023     0.047174   
31  0.139455  2.18     0.983   1395.6823  ...     0.000024     0.050360   
32  0.145377  3.21     0.983   1392.3363  ...     0.000021     0.032253   
33 -0.141020  1.71     0.982   1382.4540  ...     0.000036     0.052871   
34  0.044550  2.27     0.985   1378.3397  ...     0.000019     0.045818   
35  0.402574  2.23     0.983   1381.6220  ...     0.000027     0.041617   
36  0.290170  1.92     0.983   1408.5251  ...     0.000015     0.029561   
37  0.290862  1.98     0.983   1400.9388  ...     0.000015     0.043067   
38  0.006812  3.19     0.982   1390.6266  ...     0.000025     0.037429   
39 -0.240179  2.09     0.982   1402.6738  ...     0.000018     0.047640   
40  0.043278  1.94     0.988   1399.7465  ...     0.000018     0.046711   
41 -0.090300  4.16     0.921   1414.7028  ...     0.000026     0.035306   
42 -0.134140  1.96     0.983   1411.6840  ...     0.000025     0.051512   
43  0.285692  2.09     0.981   1396.4586  ...     0.000022     0.033476   
44  0.056104  2.33     0.983   1396.4844  ...     0.000027     0.049624   
45 -0.055471  2.07     0.983   1394.2794  ...     0.000016     0.046507   
46  0.343837  2.25     0.982   1411.3943  ...     0.000020     0.033902   
47  0.396246  2.27     0.982   1390.2621  ...     0.000019     0.032159   
48 -0.012122  1.92     0.983   1400.7949  ...     0.000018     0.044641   
49  0.143203  2.62     0.983   1411.2592  ...     0.000020     0.048730   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        399  0.119434  0.000013 -0.000010  26.383000   0.664  0.328833   
1        310  0.098088  0.000015 -0.000011  26.358000   0.735  0.334976   
2        331  0.104077  0.000015 -0.000012  26.342000   0.750  0.328819   
3        392  0.102931  0.000018 -0.000014  26.460499   0.704  0.320361   
4        380  0.119328  0.000015 -0.000012  26.362500   0.704  0.328295   
5        333  0.106235  0.000017 -0.000013  26.343000   0.707  0.333309   
6        355  0.120570  0.000016 -0.000012  26.374000   0.695  0.331518   
7        356  0.100498  0.000011 -0.000009  26.345000   0.737  0.333705   
8        392 -0.096407  0.000026 -0.000019  26.288000   0.637  0.333253   
9        405 -0.120271  0.000020 -0.000015  26.301000   0.661  0.333665   
10       404  0.092233  0.000011 -0.000008  26.125000   0.663  0.333665   
11       409  0.095956  0.000012 -0.000009  26.288000   0.654  0.332948   
12       407  0.092610  0.000010 -0.000007  26.345000   0.659  0.333792   
13       334 -0.063806  0.000021 -0.000016  26.326500   0.762  0.329205   
14       258 -0.056186  0.000041 -0.000031  26.382000   0.710  0.333566   
15       253  0.116557  0.000025 -0.000019  26.381000   0.716  0.332663   
16       256 -0.052137  0.000028 -0.000022  26.369000   0.715  0.332823   
17       256  0.112444  0.000026 -0.000020  26.408000   0.716  0.332292   
18       254 -0.048414  0.000027 -0.000020  26.338000   0.710  0.334099   
19       257  0.109283  0.000027 -0.000020  26.380000   0.716  0.330124   
20       204 -0.028399  0.000092 -0.000061  26.326000   0.576  0.302084   
21       256  0.112346  0.000046 -0.000035  26.313000   0.716  0.331941   
22       156 -0.008791  0.000110 -0.000070  26.361000   0.559  0.281925   
23       211 -0.026414  0.000052 -0.000036  26.339000   0.596  0.316281   
24       257  0.123397  0.000041 -0.000031  26.324000   0.713  0.330521   
25       256  0.107675  0.000023 -0.000017  26.405000   0.693  0.331784   
26       255 -0.045115  0.000020 -0.000015  26.382000   0.707  0.333511   
27       258 -0.058635  0.000031 -0.000024  26.374500   0.706  0.334701   
28       255  0.106739  0.000040 -0.000030  25.800000   0.682  0.332379   
29       254 -0.049541  0.000031 -0.000023  26.294000   0.706  0.334652   
30       254  0.108397  0.000033 -0.000025  26.371000   0.715  0.332528   
31       255  0.118923  0.000035 -0.000026  26.356000   0.707  0.332029   
32       256 -0.039505  0.000030 -0.000023  26.344000   0.710  0.334016   
33       254  0.108401  0.000053 -0.000040  25.242500   0.710  0.333555   
34       256  0.109244  0.000027 -0.000021  26.390000   0.710  0.333033   
35       259 -0.072782  0.000039 -0.000030  26.385000   0.707  0.335840   
36       254 -0.047232  0.000022 -0.000017  26.315000   0.715  0.332262   
37       254  0.106929  0.000021 -0.000016  26.377000   0.710  0.331566   
38       256 -0.053950  0.000038 -0.000028  26.354500   0.682  0.334016   
39       254  0.118523  0.000026 -0.000020  26.363000   0.716  0.331446   
40       255  0.114357  0.000026 -0.000020  26.374000   0.707  0.331808   
41       221 -0.053603  0.000044 -0.000031  26.350000   0.614  0.314354   
42       260  0.121015  0.000036 -0.000027  26.346000   0.715  0.332955   
43       252 -0.044081  0.000033 -0.000025  26.183500   0.682  0.330751   
44       252  0.111939  0.000040 -0.000030  25.972500   0.710  0.330416   
45       257  0.116613  0.000023 -0.000018  26.339000   0.707  0.331932   
46       254 -0.056734  0.000028 -0.000022  26.319000   0.710  0.332022   
47       256 -0.047111  0.000027 -0.000021  26.338000   0.693  0.335202   
48       251  0.108361  0.000026 -0.000020  26.339000   0.713  0.330437   
49       254  0.120116  0.000029 -0.000022  26.326500   0.715  0.330461   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,9.716991662979126,2025-07-28T16:59:28,0.001466275659824,0.02,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,9,"-- Retrieve at most 50 ZTF objects classified as supernovae ('SN') by the stamp classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN' -- Filter for supernovae      AND classifier_name = 'stamp_classifier' -- Use the stamp classifier      AND probability > 0.7 -- Probability threshold      AND ranking = 1 -- Only the most likely classification) p ON dq.oid = p.oidLIMIT 50 -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,18.65030217170716,2025-07-23T18:53:40,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21aanwmug  1541489720615015012    2   537.6577  2598.8640  1.313433   
1   ZTF21aanwmug  1538470774915015002    2   845.0796   244.0168  1.266293   
2   ZTF21aanwmug  1538473140615015010    2   538.4456  2568.7239  1.745542   
3   ZTF21aanwmug  1538458400615015013    1   543.7429  2565.1667  1.171827   
4   ZTF21aanwmug  1528512030615015011    2   538.4238  2592.3374  1.638078   
5   ZTF21aanwmug  1528511564915015002    2   844.7690   266.8969  2.821622   
6   ZTF21aanwmug  1528511096115015000    2  2746.9119   106.2960  1.306745   
7   ZTF21aanwmug  1524521280615015015    1   533.6705  2561.9026  1.734156   
8   ZTF21aanwmug  1524498950615015010    2   522.5800  2570.0140  1.011880   
9   ZTF21aanwmug  1524493726115015000    2  2746.4746    80.9571  1.733135   
10  ZTF21aanwmue  1524493722315015005    2  1998.8119  1786.2861  1.134041   
11  ZTF21aanwmue  1528511092315015021    2  1999.7173  1812.0940  1.152465   
12  ZTF21aanwmue  1538470312315015013    2  2002.9591  1786.9226  1.105380   
13  ZTF21aaobnrr  1524516442315015003    1  2757.9240   825.0666  0.807421   
14  ZTF21aaobnrr  1524494662315015000    2  2759.5906   825.8806  0.889043   
15  ZTF21aamwyxf  1524496065415015005    2  1398.6305  1420.5074  2.674295   
16  ZTF21aamwyxf  1528514005415015008    2  1397.4610  1443.1145  1.987979   
17  ZTF21aaogltd  1524497495615015001    2   661.4529   185.1124  1.772460   
18  ZTF21aaogltd  1524521281515015011    1   346.7973  2124.7340  1.498235   
19  ZTF21aaogltd  1528511565615015002    2   667.0226   207.2029  0.848178   
20  ZTF21aaogltd  1528512031515015015    2   351.3826  2154.7588  1.674831   
21  ZTF21aaogltd  1538458401515015036    1   356.0684  2128.1885  0.919073   
22  ZTF21aaogigx  1528507711315015007    2  2654.0900  2033.3600  1.478685   
23  ZTF21aaogigx  1524510771315015008    1  2649.1648  2003.9948  1.203487   
24  ZTF21aaogigx  1524509810015015010    1  1136.0107  1979.7654  0.777839   
25  ZTF21aaognjk  1524516440915015003    1  2270.7112  1517.0765  0.794193   
26  ZTF21aaognjk  1528513540915015002    2  2272.5144  1542.2026  1.283381   
27  ZTF21aaognjk  1538455590915015014    1  2281.3586  1519.6165  1.168624   
28  ZTF21aaognjk  1538473630915015005    2  2274.1487  1518.0688  0.897614   
29  ZTF21aaoghyd  1524520814115015009    1   153.6488  1926.1066  0.925603   
30  ZTF21aaoghyd  1536384404115015003    2   134.0205  1940.5696  2.231015   
31  ZTF21aaoghyd  1536431074115015012    1   136.6718  1963.5569  2.857493   
32  ZTF21aaoghyd  1540322514115015005    2   157.6939  1879.3590  0.932181   
33  ZTF21aaoghyd  1543429384115015005    2   147.0432  1961.0110  1.197936   
34  ZTF21aaoghyd  1558390594115015007    2   161.3978  1919.5045  1.680081   
35  ZTF21aaoghyd  1560452834115015011    2   157.7637  1928.2764  0.993994   
36  ZTF21aaognpg  1541481145715015016    2   211.0691  1834.6389  1.643051   
37  ZTF21aaognpg  1537485525715015019    1   209.0086  1828.3125  1.185749   
38  ZTF21aaognpg  1528505375715015011    2   215.0013  1831.2175  1.702562   
39  ZTF21aaognpg  1524522975715015008    1   208.0241  1792.1111  0.743334   
40  ZTF21aaogqkz  2889175206015015034    2  1771.1302   806.6274  3.231380   
41  ZTF21aaogqkz  1524538006015015038    2  1812.7043   767.8906  1.784835   
42  ZTF21aaogzwp  1525142662515015006    2  2661.5933  1693.7133  3.648070   
43  ZTF21aaohozd  1526140841115015003    2  2153.6220   319.4951  2.093138   
44  ZTF21aaohqpo  1538222193115015009    2  2086.8882  1927.6177  1.560081   
45  ZTF21aaohqpo  1538178623115015013    1  2093.5845  1938.1248  1.861728   
46  ZTF21aaohqpo  1536270473115015011    2  2085.5596  1919.1827  1.972815   
47  ZTF21aaohqpo  1536219533115015011    1  2080.6865  1947.2788  1.373203   
48  ZTF21aaohqpo  1526199523115015020    1  2087.9424  1904.8853  0.713978   
49  ZTF21aaohqpo  1526144783115015027    2  2089.5002  1901.7705  1.691760   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   -0.136147  2.220000     0.967    481.6360  ...     0.000004     0.034917   
1    1.091069  2.400000     0.823    244.0168  ...     0.000006     0.037953   
2    0.423727  2.740000     0.958    511.7761  ...     0.000004     0.034977   
3    0.085003  2.710000     0.936    515.3332  ...     0.000007     0.039858   
4    0.012706  2.260000     0.998    488.1625  ...     0.000004     0.033473   
5    0.560349  3.240000     0.963    266.8969  ...     0.000006     0.039015   
6   -0.596978  2.370000     0.965    106.2960  ...     0.000004     0.036162   
7   -0.409200  4.410000     0.933    518.5975  ...     0.000009     0.038247   
8   -0.040722  1.970000     0.980    510.4861  ...     0.000004     0.035862   
9   -0.005250  2.860000     0.953     80.9571  ...     0.000005     0.038618   
10   0.077538  3.100000     0.966   1073.6881  ...     0.000004     0.039337   
11   0.487389  2.420000     0.991   1072.7827  ...     0.000007     0.041107   
12   0.247357  2.640000     0.969   1069.5409  ...     0.000008     0.043385   
13   0.038197  2.720000     0.952    314.5759  ...     0.000010     0.047718   
14  -0.152468  2.820000     0.956    312.9095  ...     0.000004     0.037130   
15  -0.097918  2.230000     0.982   1398.6305  ...     0.000003     0.036133   
16   0.004614  1.680000     0.977   1397.4610  ...     0.000003     0.035616   
17   0.403933  2.100000     0.979    185.1124  ...     0.000005     0.036715   
18  -0.101410  3.170000     0.944    346.7973  ...     0.000011     0.038698   
19   0.099138  2.460000     0.959    207.2029  ...     0.000005     0.035928   
20   0.160538  2.800000     0.968    351.3826  ...     0.000005     0.033751   
21  -0.072700  3.810000     0.738    356.0684  ...     0.000009     0.047593   
22   0.052930  1.133675     0.743    418.4098  ...     0.000004     0.036447   
23  -0.175007  2.850000     0.966    423.3351  ...     0.000008     0.038881   
24   0.384718  2.840000     0.887   1100.7346  ...     0.000008     0.033354   
25  -0.123228  3.360000     0.964    801.7888  ...     0.000008     0.043066   
26   0.093778  1.810000     0.976    799.9857  ...     0.000003     0.034827   
27   0.192790  2.320000     0.815    791.1413  ...     0.000005     0.038692   
28   0.271764  1.139232     0.944    798.3513  ...     0.000003     0.036244   
29  -0.048009  3.370000     0.869    153.6488  ...     0.000015     0.036516   
30   0.199856  1.910000     0.976    134.0205  ...     0.000008     0.043495   
31   0.195478  2.410000     0.999    136.6718  ...     0.000011     0.035134   
32   0.781347  2.230000     0.976    157.6939  ...     0.000009     0.043750   
33  -0.322770  2.120000     0.974    147.0432  ...     0.000011     0.045638   
34   0.499763  1.231153     0.836    161.3978  ...     0.000008     0.042354   
35   0.177572  1.137845     0.557    157.7637  ...     0.000006     0.041608   
36   0.126878  3.400000     0.805    211.0691  ...     0.000001     0.030872   
37   0.209407  2.220000     0.982    209.0086  ...     0.000003     0.033229   
38   0.868403  3.260000     0.973    215.0013  ...     0.000001     0.028885   
39   0.496597  2.930000     0.974    208.0241  ...     0.000005     0.037029   
40 -10.852330  1.879777     0.912    806.6274  ...     0.000023     0.049903   
41  -5.629688  1.740206     0.851    767.8906  ...     0.000005     0.027908   
42  -0.289246  3.050000     0.983    410.9067  ...     0.000008     0.038598   
43  -0.626002  2.530000     0.999    319.4951  ...     0.000006     0.038725   
44  -0.070348  2.280000     0.980    985.6117  ...     0.000003     0.033027   
45   0.547987  1.920000     0.971    978.9156  ...     0.000005     0.032011   
46   0.210825  2.730000     0.973    986.9404  ...     0.000004     0.034320   
47   0.056084  2.430000     0.980    991.8135  ...     0.000005     0.031389   
48   0.171953  2.270000     0.968    984.5577  ...     0.000004     0.033912   
49   0.081422  2.340000     0.967    982.9998  ...     0.000005     0.034365   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        687  0.091898  0.000006 -0.000005  26.277000   0.649  0.308454   
1        719  0.087748  0.000011 -0.000008  26.237000   0.587  0.303622   
2        689  0.094425  0.000006 -0.000004  26.295000   0.649  0.307871   
3        694 -0.091661  0.000012 -0.000009  26.280000   0.643  0.307853   
4        687  0.088137  0.000006 -0.000004  26.337000   0.644  0.307449   
5        717  0.090589  0.000012 -0.000008  26.269000   0.582  0.304062   
6        739  0.090352  0.000007 -0.000005  26.145000   0.660  0.316409   
7        678 -0.075785  0.000015 -0.000010  26.340000   0.630  0.306064   
8        688  0.094974  0.000006 -0.000005  26.350000   0.649  0.309367   
9        739  0.096954  0.000007 -0.000005  26.154000   0.661  0.316394   
10       946  0.101726  0.000007 -0.000005  26.442000   0.605  0.304008   
11       944  0.088017  0.000011 -0.000008  26.439499   0.604  0.302061   
12       941  0.089044  0.000013 -0.000009  26.394000   0.605  0.302553   
13       973 -0.093841  0.000017 -0.000012  26.324000   0.593  0.299966   
14       996  0.094592  0.000006 -0.000004  26.434000   0.602  0.304169   
15       961  0.096621  0.000006 -0.000004  26.349000   0.616  0.296393   
16       962  0.096656  0.000005 -0.000004  26.338000   0.604  0.295171   
17       601  0.094353  0.000009 -0.000006  26.343000   0.608  0.308291   
18       584 -0.079145  0.000019 -0.000013  26.300000   0.630  0.295708   
19       603  0.090583  0.000009 -0.000006  26.331000   0.608  0.307819   
20       593  0.087311  0.000009 -0.000006  26.278000   0.655  0.299605   
21       594 -0.127078  0.000016 -0.000011  26.237000   0.653  0.298124   
22       684  0.096966  0.000008 -0.000005  26.275000   0.578  0.302207   
23       673 -0.082489  0.000015 -0.000010  26.307000   0.567  0.298229   
24       673 -0.041604  0.000016 -0.000010  26.252000   0.544  0.299581   
25       793 -0.096356  0.000014 -0.000010  26.339000   0.601  0.302839   
26       819  0.095548  0.000005 -0.000003  26.332000   0.612  0.307638   
27       814 -0.096049  0.000008 -0.000006  26.264000   0.617  0.309303   
28       813  0.095446  0.000006 -0.000004  26.278000   0.612  0.308579   
29       468 -0.049756  0.000025 -0.000018  26.368000   0.627  0.306196   
30       486  0.117892  0.000012 -0.000009  26.456000   0.669  0.308545   
31       486 -0.067842  0.000017 -0.000012  26.322000   0.669  0.310737   
32       482  0.114868  0.000013 -0.000010  26.335000   0.673  0.312028   
33       489  0.117168  0.000017 -0.000012  26.445000   0.669  0.308450   
34       484  0.114479  0.000012 -0.000009  26.474000   0.671  0.308429   
35       485  0.114644  0.000010 -0.000008  26.456000   0.668  0.308854   
36      1675  0.087917  0.000003 -0.000002  26.216000   0.537  0.273693   
37      1671 -0.076033  0.000005 -0.000003  26.289000   0.536  0.274757   
38      1673  0.083528  0.000002 -0.000002  26.271000   0.537  0.273785   
39      1573 -0.055617  0.000012 -0.000007  26.326000   0.518  0.252901   
40      1738  0.097359  0.000034 -0.000027  25.964000   0.730  0.191235   
41      1762  0.085251  0.000008 -0.000006  26.253000   0.729  0.190985   
42       594  0.099744  0.000012 -0.000009  26.376000   0.684  0.295439   
43       554  0.105308  0.000009 -0.000007  26.282000   0.739  0.308014   
44      1076  0.095308  0.000006 -0.000004  26.293000   0.607  0.262335   
45      1066 -0.071972  0.000009 -0.000006  26.207000   0.604  0.261955   
46      1077  0.098645  0.000007 -0.000005  26.319000   0.610  0.262248   
47      1071 -0.070647  0.000009 -0.000006  26.220000   0.606  0.261350   
48      1080 -0.089504  0.000008 -0.000005  26.248000   0.607  0.263631   
49      1075  0.088489  0.000009 -0.000006  26.360000   0.610  0.262777   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,11.542226791381836,2025-07-28T16:59:47,0.0473537604456824,0.34,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,89,10,"-- Retrieve at most 50 ZTF objects classified as supernovae (SN) by the stamp_classifier-- with a probability greater than 0.7, and return all columns from the dataquality table.SELECT dq.*FROM dataquality dqINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'SN' -- Filter for supernovae classification      AND classifier_name = 'stamp_classifier' -- Use the stamp classifier      AND probability > 0.7 -- Probability threshold      AND ranking = 1 -- Most likely classification) p ON dq.oid = p.oidLIMIT 50 -- Limit the results to at most 50 rows","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,22.56733012199402,2025-07-23T18:54:03,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21aaopbjg  1526360301515015000    1  1192.6430   461.8207  1.059338   
1   ZTF21aaopcdd  1526359821515015004    1  1238.1729   603.9910  1.053805   
2   ZTF21aaopcng  1526365061115015002    1  1566.9747   437.1310  0.839594   
3   ZTF21aaolbhn  1526366030215015000    1   445.5138   412.0240  0.896520   
4   ZTF21aaolbhn  1536347310215015000    2   429.4133   462.2331  1.486566   
5   ZTF21aaolbhn  1538306060215015000    1   464.1478   439.0348  0.872312   
6   ZTF21aaolbhn  1538348310215015001    2   445.3707   445.2995  1.319760   
7   ZTF21aaopcwt  1526369361015015006    1  2224.8828  2163.9540  1.145258   
8   ZTF21aaopcwt  1536381991015015006    2  2218.9429  2218.1377  1.298652   
9   ZTF21aaopcwt  1537309645215015000    1   913.2250    60.9317  1.110624   
10  ZTF21aaopcwt  1538366731015015015    2  2233.6382  2201.5696  1.880682   
11  ZTF21aaoeowf  1538299961415015012    1   319.9697  1976.1093  0.915476   
12  ZTF21aaoeowf  1536352531415015011    2   300.2078  1994.0865  2.349323   
13  ZTF21aaoeowf  1536325911415015012    1   299.1015  1990.1936  0.708886   
14  ZTF21aaoeowf  1526372611415015012    1   323.1839  1950.0499  1.045109   
15  ZTF21aaoexjt  1571301994715015000    2  1405.6846    59.2113  1.521145   
16  ZTF21aaoexjt  1569337834715015000    2  1412.3761    62.4057  1.006271   
17  ZTF21aaoexjt  1563405624715015000    2  1414.2607    56.8317  1.639733   
18  ZTF21aaoexjt  1559354244715015000    2  1410.8915    57.7385  1.429381   
19  ZTF21aaoexjt  1557328694715015000    2  1407.7238    59.2183  2.154044   
20  ZTF21aaoexjt  1557279234715015000    1  1399.4081    51.0655  1.205675   
21  ZTF21aaoexjt  1555391224715015000    2  1408.6011    54.3625  2.251333   
22  ZTF21aaoexjt  1555305844715015001    1  1410.2638    48.2521  1.013999   
23  ZTF21aaoexjt  1553448344715015000    2  1403.0411    53.0852  1.911813   
24  ZTF21aaoexjt  1553322624715015000    1  1407.9543    51.0171  1.021125   
25  ZTF21aaoexjt  1548339454715015000    1  1407.0860    35.7598  1.629146   
26  ZTF21aaoexjt  1546400964715015000    2  1394.6070    68.0104  0.737659   
27  ZTF21aaoexjt  1543330174715015001    1  1385.8848    84.2423  1.457407   
28  ZTF21aaoexjt  1543285324715015000    2  1378.3943    74.5364  1.802145   
29  ZTF21aaoexjt  1540266884715015000    1  1381.5363    54.9281  1.551343   
30  ZTF21aaoexjt  1537373404715015000    2  1387.6217    83.6917  6.051327   
31  ZTF21aaoexjt  1537304384715015000    1  1382.2788    72.0900  2.176806   
32  ZTF21aaoexjt  1526425194715015000    2  1396.7540    49.5674  1.437160   
33  ZTF21aaoexjt  1526394984715015000    1  1394.0061    45.9437  1.243868   
34  ZTF21aaopkly  1526400625515015013    1  2928.1520  2267.5398  1.416079   
35  ZTF21aaopktk  1526401094615015001    1   324.7340  1091.6707  1.851623   
36  ZTF21aaopndk  1526402513515015006    1  1929.0840  2844.1396  0.591803   
37  ZTF21aaopndk  1537499813515015008    1  1942.7727  2887.1514  1.239799   
38  ZTF21aaopndk  1541331263515015006    1  1929.6722  2856.5713  0.926306   
39  ZTF21aaopqqk  1594433022915015017    2   808.4851  2414.1110  1.793765   
40  ZTF21aaopqqk  1591468562915015011    2   796.4589  2407.2493  1.085750   
41  ZTF21aaopqqk  1589344712915015009    2   784.9335  2387.0251  1.155549   
42  ZTF21aaopqqk  1587452932915015015    2   789.5308  2387.6740  1.184143   
43  ZTF21aaopqqk  1585447712915015015    2   797.2577  2410.2256  1.540299   
44  ZTF21aaopqqk  1583451682915015015    2   770.2334  2420.2278  1.418869   
45  ZTF21aaopqqk  1575431042915015012    2   762.5365  2415.8147  2.149047   
46  ZTF21aaopqqk  1575430101615015006    2   889.7146  2166.5690  1.450950   
47  ZTF21aaopqqk  1570346582915015009    2   780.7191  2381.1301  1.482041   
48  ZTF21aaopqqk  1568475312915015009    2   783.7770  2425.0380  1.104420   
49  ZTF21aaopqqk  1568282961615015005    2   910.0163  2098.7630  1.210007   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.093169  3.050000     0.951    461.8207  ...     0.000018     0.041952   
1  -0.081904  3.440000     0.906    603.9910  ...     0.000015     0.043276   
2  -0.215486  3.490000     0.928    437.1310  ...     0.000026     0.045148   
3  -0.406548  2.790000     0.792    412.0240  ...     0.000017     0.040256   
4  -0.265751  1.186749     0.915    429.4133  ...     0.000012     0.040978   
5   0.120544  1.314271     0.797    439.0348  ...     0.000015     0.041878   
6  -0.354595  1.186749     0.903    445.2995  ...     0.000010     0.038581   
7  -0.374599  5.140000     0.825    847.6171  ...     0.000018     0.045283   
8   0.466786  2.570000     0.951    853.5571  ...     0.000007     0.034232   
9   1.043293  3.690000     0.388     60.9317  ...     0.000019     0.041675   
10  0.187410  1.240000     0.991    838.8618  ...     0.000007     0.035836   
11  0.051140  1.880000     0.875    319.9697  ...     0.000022     0.042011   
12  0.206408  1.114006     0.824    300.2078  ...     0.000025     0.046143   
13  0.308836  1.880000     0.939    299.1015  ...     0.000020     0.038340   
14  0.074458  2.870000     0.823    323.1839  ...     0.000025     0.042538   
15  0.281609  1.640000     0.968     59.2113  ...     0.000010     0.049915   
16 -0.602916  3.420000     0.924     62.4057  ...     0.000009     0.048207   
17 -0.110335  2.110000     0.967     56.8317  ...     0.000011     0.049815   
18  0.223279  2.020000     0.977     57.7385  ...     0.000009     0.047796   
19  0.147891  1.870000     0.981     59.2183  ...     0.000011     0.047833   
20  0.218836  2.430000     0.896     51.0655  ...     0.000011     0.029152   
21  0.275101  3.890000     0.960     54.3625  ...     0.000011     0.050265   
22  0.059745  3.280000     0.906     48.2521  ...     0.000014     0.034647   
23  0.620411  1.680000     0.992     53.0852  ...     0.000010     0.046140   
24  0.064245  1.900000     0.979     51.0171  ...     0.000010     0.032241   
25 -5.918785  1.259051     0.966     35.7598  ...     0.000036     0.043010   
26  0.251190  3.560000     0.955     68.0104  ...     0.000029     0.058523   
27 -0.695507  3.270000     0.981     84.2423  ...     0.000024     0.041983   
28 -0.248052  3.610000     0.977     74.5364  ...     0.000017     0.052695   
29 -0.025152  4.210000     0.821     54.9281  ...     0.000030     0.042721   
30  0.040441  2.330000     1.000     83.6917  ...     0.000014     0.050788   
31  0.446764  2.100000     0.983     72.0900  ...     0.000010     0.031818   
32 -0.640210  2.660000     0.940     49.5674  ...     0.000012     0.049895   
33  0.103859  3.980000     0.978     45.9437  ...     0.000014     0.034088   
34 -0.161825  3.900000     0.936    144.3480  ...     0.000007     0.037740   
35  0.399461  4.710000     0.864    324.7340  ...     0.000012     0.043895   
36 -0.340844  4.450000     0.673    236.3604  ...     0.000016     0.043224   
37 -0.321656  2.870000     0.969    193.3486  ...     0.000018     0.053971   
38  0.283208  3.090000     0.855    223.9286  ...     0.000020     0.043819   
39  0.438949  1.111168     0.758    666.3888  ...     0.000002     0.034956   
40  0.112139  1.185418     0.771    673.2507  ...     0.000002     0.036527   
41  0.077116  1.148893     0.928    693.4749  ...     0.000002     0.036533   
42 -0.196222  2.680000     0.699    692.8259  ...     0.000002     0.036006   
43  0.186675  2.920000     0.990    670.2744  ...     0.000002     0.034852   
44  0.172001  2.460000     0.862    660.2721  ...     0.000002     0.037021   
45  0.486712  2.300000     0.963    664.6852  ...     0.000003     0.039154   
46 -0.630557  2.510000     0.799    889.7146  ...     0.000002     0.035518   
47 -0.089027  2.980000     0.972    699.3699  ...     0.000002     0.039048   
48  0.230595  2.580000     0.980    655.4618  ...     0.000002     0.037912   
49 -1.230117  1.960000     0.987    910.0163  ...     0.000004     0.042464   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        324 -0.084854  0.000028 -0.000020  26.275000   0.663  0.330389   
1        389 -0.091424  0.000023 -0.000017  26.264000   0.625  0.328474   
2        290 -0.102907  0.000035 -0.000028  26.343000   0.795  0.314020   
3        422 -0.084117  0.000023 -0.000019  26.191500   0.783  0.308839   
4        419  0.104885  0.000016 -0.000013  26.234000   0.814  0.307110   
5        422 -0.097484  0.000021 -0.000017  26.149500   0.800  0.309307   
6        420  0.101210  0.000013 -0.000010  26.190000   0.808  0.308197   
7        422 -0.094864  0.000028 -0.000021  26.244000   0.667  0.313688   
8        424  0.085838  0.000011 -0.000008  26.306000   0.673  0.314222   
9        423 -0.071872  0.000026 -0.000020  26.245000   0.739  0.326243   
10       427  0.092544  0.000011 -0.000008  26.261000   0.669  0.313429   
11       241 -0.088210  0.000030 -0.000023  26.110000   0.769  0.342672   
12       246  0.097544  0.000035 -0.000027  26.219500   0.760  0.342511   
13       244 -0.076472  0.000028 -0.000021  26.163000   0.742  0.341666   
14       238 -0.084382  0.000035 -0.000027  26.125500   0.760  0.342830   
15       323  0.129058  0.000017 -0.000012  26.419000   0.598  0.336598   
16       326  0.125414  0.000015 -0.000011  26.399000   0.614  0.335870   
17       323  0.128236  0.000018 -0.000013  26.431000   0.613  0.334512   
18       321  0.125759  0.000014 -0.000010  26.353000   0.598  0.335636   
19       324  0.120428  0.000018 -0.000013  26.404500   0.596  0.336202   
20       317 -0.041610  0.000018 -0.000013  26.248000   0.594  0.335951   
21       321  0.128928  0.000018 -0.000013  26.401000   0.594  0.336724   
22       316 -0.060811  0.000023 -0.000016  26.320000   0.586  0.332865   
23       319  0.118580  0.000015 -0.000011  26.418000   0.613  0.334889   
24       314 -0.065681  0.000016 -0.000011  26.329000   0.596  0.334970   
25       226 -0.049573  0.000081 -0.000048  26.350000   0.489  0.299119   
26       295  0.127174  0.000048 -0.000034  26.389000   0.585  0.336636   
27       294 -0.064062  0.000042 -0.000028  26.303000   0.559  0.326776   
28       321  0.126479  0.000027 -0.000019  26.352000   0.615  0.336446   
29       285 -0.038972  0.000056 -0.000037  26.184000   0.554  0.323946   
30       320  0.123954  0.000023 -0.000017  26.458000   0.614  0.336155   
31       318 -0.059760  0.000017 -0.000012  26.293000   0.596  0.336692   
32       314  0.126634  0.000020 -0.000014  26.320000   0.596  0.334924   
33       316 -0.054180  0.000023 -0.000016  26.296501   0.586  0.336126   
34      1814 -0.011602  0.000016 -0.000010  25.998000   0.572  0.220341   
35      1932 -0.033712  0.000026 -0.000017  25.907000   0.604  0.193727   
36       712 -0.033371  0.000041 -0.000024  25.929500   0.495  0.247049   
37       804 -0.086765  0.000039 -0.000024  25.885000   0.526  0.272755   
38       637 -0.039738  0.000057 -0.000031  26.013000   0.484  0.224963   
39      1634  0.094769  0.000004 -0.000003  26.316000   0.582  0.277986   
40      1634  0.105556  0.000004 -0.000003  26.313000   0.582  0.276686   
41      1633  0.102803  0.000004 -0.000003  26.244000   0.581  0.277919   
42      1622  0.098740  0.000004 -0.000003  26.334000   0.580  0.277019   
43      1636  0.095672  0.000004 -0.000003  26.322000   0.582  0.276871   
44      1641  0.104447  0.000004 -0.000003  26.307000   0.582  0.276294   
45      1641  0.110036  0.000005 -0.000003  26.343000   0.579  0.276330   
46      1651  0.096817  0.000004 -0.000003  26.314000   0.579  0.278605   
47      1627  0.112563  0.000004 -0.000003  26.308000   0.582  0.277068   
48      1635  0.110313  0.000004 -0.000003  26.355000   0.581  0.277341   
49      1632  0.105635  0.000007 -0.000005  26.155000   0.579  0.279129   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,11.82921862602234,2025-07-28T17:00:04,0.0048076923076923,0.02,1.0,1.0,0.0,1.0
0.20.2,,,72,0,"SELECT
    *
FROM
    reference
WHERE
    oid = 'ZTF20actnuls'
    AND rfid = '712120223'",,,,,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,3.840999126434326,2025-07-28T17:00:09,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,1,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.483412027359009,2025-07-23T18:54:07,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.350595951080322,2025-07-28T17:00:25,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,2,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.7140703201293945,2025-07-23T18:54:11,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.444234371185305,2025-07-28T17:00:39,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,3,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.96899962425232,2025-07-23T18:54:14,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.651461124420166,2025-07-28T17:00:51,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,4,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.755898714065552,2025-07-23T18:54:16,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.365379571914673,2025-07-28T17:01:05,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,5,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.046919107437134,2025-07-23T18:54:20,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,9.604355573654177,2025-07-28T17:01:20,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,6,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls'   AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.280837059020996,2025-07-23T18:54:22,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.816922187805176,2025-07-28T17:01:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,7,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,5.216446876525879,2025-07-23T18:54:27,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.660383701324463,2025-07-28T17:01:46,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,8,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.1630802154541016,2025-07-23T18:54:31,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.865426778793335,2025-07-28T17:02:00,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,9,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.116030693054199,2025-07-23T18:54:34,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.19899296760559,2025-07-28T17:02:14,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,72,10,SELECT * FROM referenceWHERE oid = 'ZTF20actnuls' AND rfid = 712120223,"['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.6944284439086914,2025-07-23T18:54:37,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.689826488494873,2025-07-28T17:02:27,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,103,0,"SELECT
    *
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ps1_ztf
    ON object.oid = ps1_ztf.oid
WHERE
    classifier_name = 'lc_classifier'
    AND class_name NOT IN ('SNIa','SNII','SNIbc','SLSN')
    AND probability > 0.7
    AND distpsnr1 > 5
ORDER BY distpsnr1
LIMIT 200
",,,,,,"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: SELECT
    *
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ps1_ztf
    ON object.oid = ps1_ztf.oid
WHERE
    classifier_name = 'lc_classifier'
    AND class_name NOT IN ('SNIa','SNII','SNIbc','SLSN')
    AND probability > 0.7
    AND distpsnr1 > 5
ORDER BY distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",247.79214906692505,2025-07-28T17:06:35,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,1,,,,,,,,247.74079990386963,2025-07-28T17:10:45,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,2,"-- [FINAL QUERY HERE]SELECT     object.*,     probability.*,     ps1_ztf.*FROM     objectINNER JOIN     probability ON object.oid = probability.oidINNER JOIN     ps1_ztf ON object.oid = ps1_ztf.oidWHERE     ps1_ztf.distpsnr1 > 5 -- Distance to nearest PS1 source greater than 5 arcseconds    AND probability.classifier_name = 'lc_classifier' -- Use the light curve classifier    AND probability.ranking = 1 -- Only the most likely classification    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Exclude supernova classes    AND probability.probability > 0.7 -- Probability greater than 0.7ORDER BY     ps1_ztf.distpsnr1 ASC -- Order by nearest PS1 source distanceLIMIT 200 -- Limit to at most 200 objects","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.68711519241333,2025-07-23T18:55:44,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
SELECT 
    object.*, 
    probability.*, 
    ps1_ztf.*
FROM 
    object
INNER JOIN 
    probability 
    ON object.oid = probability.oid
INNER JOIN 
    ps1_ztf 
    ON object.oid = ps1_ztf.oid
WHERE 
    ps1_ztf.distpsnr1 > 5 -- Distance to nearest PS1 source greater than 5 arcseconds
    AND probability.classifier_name = 'lc_classifier' -- Use the light curve classifier
    AND probability.ranking = 1 -- Only the most likely classification
    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Exclude supernova classes
    AND probability.probability > 0.7 -- Probability greater than 0.7
ORDER BY 
    ps1_ztf.distpsnr1 ASC -- Order by nearest PS1 source distance
LIMIT 200 -- Limit to at most 200 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.8254473209381,2025-07-28T17:13:34,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,3,"-- [FINAL QUERY HERE]SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidINNER JOIN ps1_ztf ON object.oid = ps1_ztf.oidWHERE ps1_ztf.distpsnr1 > 5  AND probability.classifier_name = 'lc_classifier'  AND probability.ranking = 1  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  AND probability.probability > 0.7ORDER BY ps1_ztf.distpsnr1 ASCLIMIT 200","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,19.412251234054565,2025-07-23T18:56:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5  -- Condition for distance to nearest PS1 source
  AND probability.classifier_name = 'lc_classifier'  -- Default condition for classifier
  AND probability.ranking = 1  -- Default condition for ranking
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Exclude supernova classes
  AND probability.probability > 0.7  -- Probability threshold
ORDER BY ps1_ztf.distpsnr1 ASC  -- Corrected ordering syntax
LIMIT 200  -- Limit the results to 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",129.62923955917358,2025-07-28T17:16:16,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,4,"-- [FINAL QUERY HERE]SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidINNER JOIN ps1_ztf ON object.oid = ps1_ztf.oidWHERE ps1_ztf.distpsnr1 > 5  AND probability.ranking = 1  AND probability.classifier_name = 'lc_classifier'  AND probability.probability > 0.7  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')ORDER BY ps1_ztf.distpsnr1 ASCLIMIT 200","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,48.20567417144776,2025-07-23T18:56:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5  -- Condition for distance to nearest PS1 source
  AND probability.ranking = 1  -- Default condition for ranking
  AND probability.classifier_name = 'lc_classifier'  -- Default condition for classifier
  AND probability.probability > 0.7  -- Condition for probability threshold
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Exclude supernova classes
ORDER BY ps1_ztf.distpsnr1 ASC  -- Corrected syntax for ascending order
LIMIT 200  -- Limit the results to 200 rows
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.82783389091492,2025-07-28T17:21:26,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,5,"-- [FINAL QUERY HERE]SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidINNER JOIN ps1_ztf ON object.oid = ps1_ztf.oidWHERE ps1_ztf.distpsnr1 > 5  AND probability.classifier_name = 'lc_classifier'  AND probability.ranking = 1  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  AND probability.probability > 0.7ORDER BY ps1_ztf.distpsnr1 ASCLIMIT 200","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,22.023472785949707,2025-07-23T18:57:14,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5  -- Condition for distance to the nearest PS1 source
  AND probability.classifier_name = 'lc_classifier'  -- Default condition for the light curve classifier
  AND probability.ranking = 1  -- Default condition to only consider the most likely probabilities
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Exclude supernova classes
  AND probability.probability > 0.7  -- Condition for probability greater than 0.7
ORDER BY ps1_ztf.distpsnr1 ASC  -- Corrected syntax for ordering in ascending order
LIMIT 200  -- Limit the results to at most 200 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.8736493587494,2025-07-28T17:26:48,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,6,"-- [FINAL QUERY HERE]SELECT *FROM objectINNER JOIN probability ON object.oid = probability.oidINNER JOIN ps1_ztf ON object.oid = ps1_ztf.oidWHERE ps1_ztf.distpsnr1 > 5  AND probability.classifier_name = 'lc_classifier'  AND probability.ranking = 1  AND probability.probability > 0.7  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')ORDER BY ps1_ztf.distpsnr1 ASCLIMIT 200","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.927040338516235,2025-07-23T18:57:35,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5  -- Condition for distance to nearest PS1 source
  AND probability.classifier_name = 'lc_classifier'  -- Default condition for classifier
  AND probability.ranking = 1  -- Default condition for ranking
  AND probability.probability > 0.7  -- Condition for probability threshold
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')  -- Exclude supernova classes
ORDER BY ps1_ztf.distpsnr1 ASC  -- Corrected ordering syntax
LIMIT 200  -- Limit the results to 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.10432124137878,2025-07-28T17:30:52,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,7,,,,,,,,247.82084274291992,2025-07-28T17:35:01,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,8,"-- [FINAL QUERY HERE]SELECT     object.*,     probability.*,     ps1_ztf.*FROM     objectINNER JOIN     (SELECT oid, class_name, classifier_name, classifier_version, probability, ranking     FROM probability     WHERE ranking = 1       AND classifier_name = 'lc_classifier'       AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')       AND probability > 0.7) AS filtered_probabilityON     object.oid = filtered_probability.oidINNER JOIN     (SELECT *     FROM ps1_ztf     WHERE distpsnr1 > 5) AS filtered_ps1_ztfON     object.oid = filtered_ps1_ztf.oidORDER BY     filtered_ps1_ztf.distpsnr1 ASCLIMIT 200","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,24.29500699043274,2025-07-23T18:58:29,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
SELECT 
    object.*, 
    filtered_probability.*, 
    filtered_ps1_ztf.*
FROM 
    object
INNER JOIN 
    (SELECT 
         oid, 
         class_name, 
         classifier_name, 
         classifier_version, 
         probability, 
         ranking
     FROM 
         probability
     WHERE 
         ranking = 1 -- Default condition for ranking
         AND classifier_name = 'lc_classifier' -- Default condition for classifier
         AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Exclude supernova classes
         AND probability > 0.7 -- Probability condition
    ) AS filtered_probability
ON 
    object.oid = filtered_probability.oid
INNER JOIN 
    (SELECT 
         * 
     FROM 
         ps1_ztf
     WHERE 
         distpsnr1 > 5 -- Condition for distance to nearest PS1 source
    ) AS filtered_ps1_ztf
ON 
    object.oid = filtered_ps1_ztf.oid
ORDER BY 
    filtered_ps1_ztf.distpsnr1 ASC -- Corrected ASC syntax for ordering
LIMIT 200 -- Limit the results to 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.77613472938538,2025-07-28T17:37:46,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,9,"-- [FINAL QUERY HERE]SELECT     object.*,     probability.*,     ps1_ztf.*FROM     objectINNER JOIN     probability     ON object.oid = probability.oidINNER JOIN     ps1_ztf     ON object.oid = ps1_ztf.oidWHERE     ps1_ztf.distpsnr1 > 5 -- Distance to nearest PS1 source greater than 5 arcseconds    AND probability.classifier_name = 'lc_classifier' -- Use the light curve classifier    AND probability.ranking = 1 -- Only the most likely classification    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Exclude supernova classes    AND probability.probability > 0.7 -- Probability greater than 0.7ORDER BY     ps1_ztf.distpsnr1 ASC -- Order by nearest PS1 source distanceLIMIT 200 -- Limit to at most 200 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,21.243720531463623,2025-07-23T18:58:50,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
SELECT 
    object.*, 
    probability.*, 
    ps1_ztf.*
FROM 
    object
INNER JOIN 
    probability 
    ON object.oid = probability.oid
INNER JOIN 
    ps1_ztf 
    ON object.oid = ps1_ztf.oid
WHERE 
    ps1_ztf.distpsnr1 > 5 -- Distance to nearest PS1 source greater than 5 arcseconds
    AND probability.classifier_name = 'lc_classifier' -- Use the light curve classifier
    AND probability.ranking = 1 -- Only the most likely classification
    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Exclude supernova classes
    AND probability.probability > 0.7 -- Probability greater than 0.7
ORDER BY 
    ps1_ztf.distpsnr1 ASC -- Order by nearest PS1 source distance
LIMIT 200 -- Limit to at most 200 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",129.7062418460846,2025-07-28T17:41:49,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,103,10,"-- [FINAL QUERY HERE]SELECT     object.*,     probability.*,     ps1_ztf.*FROM     objectINNER JOIN     probability     ON object.oid = probability.oidINNER JOIN     ps1_ztf     ON object.oid = ps1_ztf.oidWHERE     ps1_ztf.distpsnr1 > 5 -- Distance to nearest PS1 source greater than 5 arcseconds    AND probability.ranking = 1 -- Only the most likely classification    AND probability.classifier_name = 'lc_classifier' -- Use the light curve classifier    AND probability.probability > 0.7 -- Probability greater than 0.7    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Exclude supernova classesORDER BY     ps1_ztf.distpsnr1 ASC -- Order by nearest PS1 source distanceLIMIT     200 -- Limit to at most 200 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.11852550506592,2025-07-23T18:59:13,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
SELECT 
    object.*, 
    probability.*, 
    ps1_ztf.*
FROM 
    object
INNER JOIN 
    probability 
    ON object.oid = probability.oid
INNER JOIN 
    ps1_ztf 
    ON object.oid = ps1_ztf.oid
WHERE 
    ps1_ztf.distpsnr1 > 5 -- Distance to nearest PS1 source greater than 5 arcseconds
    AND probability.ranking = 1 -- Only the most likely classification
    AND probability.classifier_name = 'lc_classifier' -- Use the light curve classifier
    AND probability.probability > 0.7 -- Probability greater than 0.7
    AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN') -- Exclude supernova classes
ORDER BY 
    ps1_ztf.distpsnr1 ASC -- Order by nearest PS1 source distance
LIMIT 
    200 -- Limit to at most 200 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.4562258720398,2025-07-28T17:48:03,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,54,0,"SELECT
    *
FROM
    non_detection
WHERE
    oid IN ('ZTF23abtcveg','ZTF23abudlls')
    AND diffmaglim > 19.5",,,,,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,3.368917226791382,2025-07-28T17:48:08,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,1,"-- Query to find all epochs in the 'non_detection' table for specified ZTF identifiers-- where the 5-sigma magnitude limit is fainter than 19.5SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.4255034923553467,2025-07-23T18:59:17,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.804433822631836,2025-07-28T17:48:23,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,2,"-- Query to find all epochs in the 'non_detection' table with a 5-sigma magnitude limit fainter than 19.5-- for objects with ZTF identifiers 'ZTF23abtcveg' and 'ZTF23abudlls'SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.033903121948242,2025-07-23T18:59:20,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.30762004852295,2025-07-28T17:48:37,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,3,"-- Query to find all epochs in the 'non_detection' table with a 5-sigma magnitude limit fainter than 19.5-- for objects with ZTF identifiers 'ZTF23abtcveg' and 'ZTF23abudlls'SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.5301308631896973,2025-07-23T18:59:24,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.577115058898926,2025-07-28T17:48:51,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,4,"-- Query to find all epochs in the 'non_detection' table with a 5-sigma magnitude limit fainter than 19.5-- for objects with ZTF identifiers 'ZTF23abtcveg' and 'ZTF23abudlls'SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.906831979751587,2025-07-23T18:59:27,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.221834897994995,2025-07-28T17:49:04,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,5,"-- Query to find all epochs in the 'non_detection' table with a 5-sigma magnitude limit fainter than 19.5-- for objects with ZTF identifiers 'ZTF23abtcveg' and 'ZTF23abudlls'SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.5017521381378174,2025-07-23T18:59:30,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,9.19278073310852,2025-07-28T17:49:18,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,6,"-- Query to find all epochs in the 'non_detection' table with a 5-sigma magnitude limit fainter than 19.5-- for objects with ZTF identifiers 'ZTF23abtcveg' and 'ZTF23abudlls'SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.7030181884765625,2025-07-23T18:59:33,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.780642032623291,2025-07-28T17:49:32,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,7,"-- Query to find all epochs in the 'non_detection' table with a 5-sigma magnitude limit fainter than 19.5-- for objects with ZTF identifiers 'ZTF23abtcveg' and 'ZTF23abudlls'SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,4.210073947906494,2025-07-23T18:59:38,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.389119386672974,2025-07-28T17:49:44,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,8,"-- Query to find all epochs in the 'non_detection' table with a 5-sigma magnitude limit fainter than 19.5-- for objects with ZTF identifiers 'ZTF23abtcveg' and 'ZTF23abudlls'SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.5401864051818848,2025-07-23T18:59:42,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,10.061604261398315,2025-07-28T17:49:59,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,9,"-- Query to find all epochs in the 'non_detection' table for specified ZTF identifiers-- where the 5-sigma magnitude limit is fainter than 19.5SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.7103075981140137,2025-07-23T18:59:46,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.734848499298096,2025-07-28T17:50:12,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,54,10,"-- Query to find all epochs in the 'non_detection' table with a 5-sigma magnitude limit fainter than 19.5-- for objects with ZTF identifiers 'ZTF23abtcveg' and 'ZTF23abudlls'SELECT *FROM non_detectionWHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')  AND diffmaglim > 19.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,3.2041146755218506,2025-07-23T18:59:49,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,10.126327514648438,2025-07-28T17:50:28,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,99,0,"SELECT
    *
FROM
    forced_photometry
WHERE
    oid in
(
SELECT
    object.oid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    firstmjd > 60310
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability = 1
ORDER BY firstmjd
LIMIT 10
)
",,,,,"[              pid           oid           mjd  fid          ra        dec  \
0   2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
1   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
2   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
3   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
4   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None   24.769798    7.675689  ...   20.420700          1   
1   None  None  100.000000  100.000000  ...   20.528500          1   
2   None  None   21.659468    0.900523  ...   19.729099          1   
3   None  None   24.218550    5.723178  ...   20.183001          1   
4   None  None  100.000000  100.000000  ...   20.335699          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,3.603440046310425,2025-07-28T17:50:32,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,1,-- Query to retrieve at most 10 ZTF objects with specific conditions and return all columns from the 'forced_photometry' tableSELECT fp.*FROM forced_photometry fpINNER JOIN object o ON fp.oid = o.oidINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd > 60310 -- Filter for objects with first detection date later than MJD=60310  AND p.class_name = 'asteroid' -- Filter for objects classified as 'asteroid'  AND p.probability = 1 -- Ensure the probability of being an asteroid is 1  AND p.classifier_name = 'stamp_classifier' -- Use the stamp classifier  AND p.ranking = 1 -- Only consider the most likely classificationORDER BY o.firstmjd ASC -- Order by first detection date in ascending orderLIMIT 10 -- Limit the results to at most 10 rows,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,40.17616558074951,2025-07-23T19:00:30,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,10.205811023712158,2025-07-28T17:50:49,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,2,"-- Retrieve at most 10 ZTF objects with first detection date > 60310,-- classified as 'asteroid' with probability = 1 in the 'stamp_classifier',-- and return all columns from the 'forced_photometry' table.SELECT fp.*FROM forced_photometry fpINNER JOIN object o ON fp.oid = o.oidINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd > 60310  AND p.class_name = 'asteroid'  AND p.probability = 1  AND p.classifier_name = 'stamp_classifier'  AND p.ranking = 1ORDER BY o.firstmjd ASCLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,49.44163990020752,2025-07-23T19:01:19,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,10.134581565856934,2025-07-28T17:51:04,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,3,"-- Retrieve at most 10 ZTF objects with first detection date > 60310,-- classified as 'asteroid' with probability = 1 in the 'stamp_classifier',-- and return all columns from the 'forced_photometry' table.SELECT fp.*FROM forced_photometry fpINNER JOIN object o ON fp.oid = o.oidINNER JOIN (    SELECT oid    FROM probability    WHERE class_name = 'asteroid'      AND probability = 1      AND classifier_name = 'stamp_classifier'      AND ranking = 1) p ON o.oid = p.oidWHERE o.firstmjd > 60310ORDER BY o.firstmjd ASCLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,47.01105713844299,2025-07-23T19:02:06,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,8.821109056472778,2025-07-28T17:51:18,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,4,"-- Query to retrieve at most 10 ZTF objects with first detection date > 60310,-- classified as 'asteroid' with probability = 1 in the stamp classifier,-- and return all columns from the 'forced_photometry' table.SELECT fp.*FROM object oINNER JOIN probability p    ON o.oid = p.oidINNER JOIN forced_photometry fp    ON o.oid = fp.oidWHERE o.firstmjd > 60310  AND p.class_name = 'asteroid'  AND p.probability = 1  AND p.ranking = 1  AND p.classifier_name = 'stamp_classifier'ORDER BY o.firstmjdLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,48.90394186973572,2025-07-23T19:02:55,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,10.353522539138794,2025-07-28T17:51:33,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,5,"-- Retrieve at most 10 ZTF objects with first detection date > 60310,-- classified as 'asteroid' with probability = 1 in the 'stamp_classifier',-- and return all columns from the 'forced_photometry' table.SELECT fp.*FROM object oINNER JOIN probability p    ON o.oid = p.oidINNER JOIN forced_photometry fp    ON o.oid = fp.oidWHERE o.firstmjd > 60310  AND p.class_name = 'asteroid'  AND p.probability = 1  AND p.classifier_name = 'stamp_classifier'  AND p.ranking = 1ORDER BY o.firstmjdLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,36.85013628005981,2025-07-23T19:03:32,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,9.329804182052612,2025-07-28T17:51:48,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,6,"-- Retrieve at most 10 ZTF objects with a first detection date later than MJD=60310,-- classified as an asteroid with a probability of 1 in the stamp classifier,-- and return all columns from the forced_photometry table for such objects.SELECT fp.*FROM object oINNER JOIN probability p ON o.oid = p.oidINNER JOIN forced_photometry fp ON o.oid = fp.oidWHERE o.firstmjd > 60310  AND p.class_name = 'asteroid'  AND p.probability = 1  AND p.classifier_name = 'stamp_classifier'  AND p.ranking = 1ORDER BY o.firstmjd ASCLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,15.483111381530762,2025-07-23T19:03:48,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,10.580359935760498,2025-07-28T17:52:04,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,7,"-- Query to retrieve at most 10 ZTF objects with first detection date > 60310,-- classified as 'asteroid' with 100% probability in the 'stamp_classifier',-- and return all columns from the 'forced_photometry' table.SELECT fp.*FROM object oINNER JOIN probability p ON o.oid = p.oidINNER JOIN forced_photometry fp ON o.oid = fp.oidWHERE o.firstmjd > 60310  AND p.class_name = 'asteroid'  AND p.classifier_name = 'stamp_classifier'  AND p.probability = 1  AND p.ranking = 1ORDER BY o.firstmjd ASCLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,17.976346731185913,2025-07-23T19:04:06,[None],sqlalchemy.cyextension.immutabledict.immutabledict is not a sequence,9.10304355621338,2025-07-28T17:52:18,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,99,8,"-- Retrieve at most 10 ZTF objects with a first detection date later than MJD=60310,-- classified as 'asteroid' with a probability of 1 in the 'stamp_classifier',-- and return all columns from the 'forced_photometry' table for such objects.SELECT fp.*FROM object oINNER JOIN probability p    ON o.oid = p.oidINNER JOIN forced_photometry fp    ON o.oid = fp.oidWHERE o.firstmjd > 60310  AND p.class_name = 'asteroid'  AND p.probability = 1  AND p.classifier_name = 'stamp_classifier'  AND p.ranking = 1ORDER BY o.firstmjd ASCLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,15.798409700393677,2025-07-23T19:04:22,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,9.904044151306152,2025-07-28T17:52:33,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,9,"-- Retrieve at most 10 ZTF objects with first detection date > 60310, classified as 'asteroid' with probability 1,-- and return all columns from the 'forced_photometry' table, ordered by first detection date.SELECT fp.*FROM forced_photometry fpINNER JOIN object o ON fp.oid = o.oidINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd > 60310  AND p.class_name = 'asteroid'  AND p.probability = 1  AND p.classifier_name = 'stamp_classifier'  AND p.ranking = 1ORDER BY o.firstmjd ASCLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,16.994078397750854,2025-07-23T19:04:39,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,9.98185396194458,2025-07-28T17:52:48,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,99,10,"-- Query to retrieve at most 10 ZTF objects with first detection date > 60310,-- classified as 'asteroid' with probability 1 in the 'stamp_classifier',-- and return all columns from the 'forced_photometry' table.SELECT fp.*FROM forced_photometry fpINNER JOIN object o ON fp.oid = o.oidINNER JOIN probability p ON o.oid = p.oidWHERE o.firstmjd > 60310  AND p.class_name = 'asteroid'  AND p.probability = 1  AND p.classifier_name = 'stamp_classifier'  AND p.ranking = 1ORDER BY o.firstmjd ASCLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,19.97710633277893,2025-07-23T19:04:59,"[             pid           oid           mjd  fid          ra        dec  \
0  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
1  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
4  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
5  2536220341615  ZTF24aaaajnz  60290.220347    1  356.638975  47.487980   
6  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
7  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
8  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
9  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   23.913935    5.575612  ...   19.935200          1           0   
1  None  None   22.524460    1.329010  ...   20.095900          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   21.872555    0.786584  ...   19.916599          1           0   
4  None  None   21.412384    0.511367  ...   19.907400          1           0   
5  None  None   24.769798    7.675689  ...   20.420700          1          56   
6  None  None  100.000000  100.000000  ...   20.528500          1          61   
7  None  None   21.659468    0.900523  ...   19.729099          1          56   
8  None  None   24.218550    5.723178  ...   20.183001          1           0   
9  None  None  100.000000  100.000000  ...   20.335699          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
1 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
4 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0     -0.297  
1 -99999.000  
2     -0.297  
3     -0.297  
4 -99999.000  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,10.635336875915527,2025-07-28T17:53:04,0.144927536231884,1.1,1.0,1.0,0.0,1.0
0.20.2,,,40,0,"SELECT
    oid_catalog, ra, dec, w1mpro, w2mpro,
    w1sigmpro, w2sigmpro, j_m_2mass, j_msig_2mass
FROM
    allwise
WHERE
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778)",,,,,"[           oid_catalog         ra        dec  w1mpro  w2mpro  w1sigmpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842  13.735       0.03   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,22.7698233127594,2025-07-28T17:53:29,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,40,1,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog AS allwise_identifier,     a.ra,     a.dec,     a.w1mpro AS w1_magnitude,     a.w1sigmpro AS w1_uncertainty,     a.w2mpro AS w2_magnitude,     a.w2sigmpro AS w2_uncertainty,     a.j_m_2mass AS j_magnitude,     a.j_msig_2mass AS j_uncertaintyFROM     allwise aINNER JOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.447317600250244,2025-07-23T19:05:03,"[    allwise_identifier         ra        dec  w1_magnitude  w1_uncertainty  \
0  J013435.71+304352.7  23.648805  30.731309        13.842            0.03   

   w2_magnitude  w2_uncertainty  j_magnitude  j_uncertainty  
0        13.735           0.038       15.552          0.051  ]",,15.307382822036743,2025-07-28T17:53:53,0.0,0.0,0.2222222222222222,0.2222222222222222,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,40,2,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog,     a.ra,     a.dec,     a.w1mpro,     a.w1sigmpro,     a.w2mpro,     a.w2sigmpro,     a.j_m_2mass,     a.j_msig_2massFROM     allwise aINNER JOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.766996383666992,2025-07-23T19:05:07,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,14.556473970413208,2025-07-28T17:54:15,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,40,3,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog,     a.ra,     a.dec,     a.w1mpro,     a.w1sigmpro,     a.w2mpro,     a.w2sigmpro,     a.j_m_2mass,     a.j_msig_2massFROM     allwise aJOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.386090993881226,2025-07-23T19:05:11,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.17652940750122,2025-07-28T17:54:38,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,40,4,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog,     a.ra,     a.dec,     a.w1mpro,     a.w1sigmpro,     a.w2mpro,     a.w2sigmpro,     a.j_m_2mass,     a.j_msig_2massFROM     allwise aJOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,7.106404781341553,2025-07-23T19:05:19,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,13.83872365951538,2025-07-28T17:55:00,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,40,5,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog,     a.ra,     a.dec,     a.w1mpro,     a.w1sigmpro,     a.w2mpro,     a.w2sigmpro,     a.j_m_2mass,     a.j_msig_2massFROM     allwise aJOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.919676780700684,2025-07-23T19:05:23,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.242355585098268,2025-07-28T17:55:23,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,40,6,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog AS allwise_identifier,     a.ra,     a.dec,     a.w1mpro AS w1_magnitude,     a.w1sigmpro AS w1_uncertainty,     a.w2mpro AS w2_magnitude,     a.w2sigmpro AS w2_uncertainty,     a.j_m_2mass AS j_magnitude,     a.j_msig_2mass AS j_uncertaintyFROM     allwise aINNER JOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,5.32002854347229,2025-07-23T19:05:28,"[    allwise_identifier         ra        dec  w1_magnitude  w1_uncertainty  \
0  J013435.71+304352.7  23.648805  30.731309        13.842            0.03   

   w2_magnitude  w2_uncertainty  j_magnitude  j_uncertainty  
0        13.735           0.038       15.552          0.051  ]",,14.320363998413086,2025-07-28T17:55:46,1.0,1.0,0.2222222222222222,0.2222222222222222,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,40,7,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog AS allwise_identifier,     a.ra,     a.dec,     a.w1mpro AS w1_magnitude,     a.w1sigmpro AS w1_uncertainty,     a.w2mpro AS w2_magnitude,     a.w2sigmpro AS w2_uncertainty,     a.j_m_2mass AS j_magnitude,     a.j_msig_2mass AS j_uncertaintyFROM     allwise aJOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,7.888059854507446,2025-07-23T19:05:36,"[    allwise_identifier         ra        dec  w1_magnitude  w1_uncertainty  \
0  J013435.71+304352.7  23.648805  30.731309        13.842            0.03   

   w2_magnitude  w2_uncertainty  j_magnitude  j_uncertainty  
0        13.735           0.038       15.552          0.051  ]",,14.332364082336426,2025-07-28T17:56:08,1.0,1.0,0.2222222222222222,0.2222222222222222,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,40,8,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog,     a.ra,     a.dec,     a.w1mpro,     a.w1sigmpro,     a.w2mpro,     a.w2sigmpro,     a.j_m_2mass,     a.j_msig_2massFROM     allwise aINNER JOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.182799100875855,2025-07-23T19:05:40,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,14.597450733184814,2025-07-28T17:56:31,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,40,9,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog,     a.ra,     a.dec,     a.w1mpro,     a.w1sigmpro,     a.w2mpro,     a.w2sigmpro,     a.j_m_2mass,     a.j_msig_2massFROM     allwise aINNER JOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,5.154914379119873,2025-07-23T19:05:46,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,14.652921438217165,2025-07-28T17:56:54,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,40,10,"-- Query to retrieve ALLWISE objects within 1 arcsec from specified coordinatesWITH catalog (source_id, ra, dec) AS (    VALUES ('search_center', 23.6488, 30.7314))SELECT     a.oid_catalog,     a.ra,     a.dec,     a.w1mpro,     a.w1sigmpro,     a.w2mpro,     a.w2sigmpro,     a.j_m_2mass,     a.j_msig_2massFROM     allwise aINNER JOIN     catalog cON     q3c_radial_query(a.ra, a.dec, c.ra, c.dec, 1.0 / 3600.0) -- 1 arcsec converted to degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.54558801651001,2025-07-23T19:05:50,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,17.835490226745605,2025-07-28T17:57:20,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,80,0,"SELECT
    *
FROM
    xmatch
WHERE
    oid IN ('ZTF22abcmmkz','ZTF18abbufof')
    AND dist < 0.5",,,,,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,3.5518999099731445,2025-07-28T17:57:25,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,1,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.0404040813446045,2025-07-23T19:05:53,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,11.2572283744812,2025-07-28T17:57:43,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,2,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.3939456939697266,2025-07-23T19:05:57,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,10.573883295059204,2025-07-28T17:57:58,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,3,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.34602689743042,2025-07-23T19:06:00,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,9.681411981582642,2025-07-28T17:58:13,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,4,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.4486703872680664,2025-07-23T19:06:04,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,10.212861061096191,2025-07-28T17:58:28,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,5,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.9359676837921143,2025-07-23T19:06:07,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,10.217935562133787,2025-07-28T17:58:43,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,6,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.732797861099243,2025-07-23T19:06:10,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,9.641377925872805,2025-07-28T17:58:57,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,7,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.5442099571228027,2025-07-23T19:06:12,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,10.607404947280884,2025-07-28T17:59:12,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,8,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,9.24356484413147,2025-07-23T19:06:22,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,10.33911395072937,2025-07-28T17:59:28,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,9,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,6.3282623291015625,2025-07-23T19:06:28,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,9.2839195728302,2025-07-28T17:59:43,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,80,10,"WITH catalog (oid) AS (    VALUES         ('ZTF22abcmmkz'),        ('ZTF18abbufof'))SELECT *FROM xmatchWHERE oid IN (SELECT oid FROM catalog)  AND dist < 0.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.4681925773620605,2025-07-23T19:06:31,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,10.056349992752075,2025-07-28T17:59:58,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,45,0,"SELECT
    COUNT(chipsf)
FROM
    dataquality
WHERE
    oid IN ('ZTF23abjikaf','ZTF20achlced')
    AND chipsf >= 5",,,,,"[   count
0     81]",,3.42036247253418,2025-07-28T18:00:02,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,45,1,"-- Query to count rows in the 'dataquality' table with a minimum reduced chi-square value of 5-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'SELECT COUNT(*) AS row_countFROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified object identifiers  AND chipsf = 5 -- Filter for rows with a reduced chi-square value of 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,17.36132001876831,2025-07-23T19:06:48,"[   row_count
0         81]",,9.437551021575928,2025-07-28T18:00:18,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,45,2,"-- Count the number of rows in the 'dataquality' table where the 'oid' matches the specified ZTF identifiers-- and the 'chipsf' (reduced chi-square value) is equal to 5.SELECT COUNT(*)FROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')  AND chipsf = 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,15.934313297271729,2025-07-23T19:07:04,"[   count
0     81]",,9.081198453903198,2025-07-28T18:00:32,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,45,3,"-- Query to count rows in the 'dataquality' table where 'chipsf' = 5 -- for objects with 'oid' values 'ZTF23abjikaf' and 'ZTF20achlced'SELECT COUNT(*) AS row_countFROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified object identifiers  AND chipsf = 5 -- Filter for rows with a minimum reduced chi-square value of 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,15.113534927368164,2025-07-23T19:07:19,"[   row_count
0         81]",,10.49176573753357,2025-07-28T18:00:48,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,45,4,"-- Query to count rows in the 'dataquality' table with a minimum reduced chi-square value of 5-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'SELECT COUNT(*)FROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified ZTF object identifiers  AND chipsf >= 5 -- Filter for rows with a minimum reduced chi-square value of 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,16.44861388206482,2025-07-23T19:07:36,"[   count
0     81]",,10.240337610244753,2025-07-28T18:01:03,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,45,5,"-- Count the number of rows in the 'dataquality' table where the 'oid' matches the specified ZTF identifiers-- and the 'chipsf' (reduced chi-square value) is greater than or equal to 5.SELECT COUNT(*)FROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified object identifiers  AND chipsf >= 5 -- Filter for minimum reduced chi-square value of 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.793336868286133,2025-07-23T19:07:48,"[   count
0     81]",,9.635489702224731,2025-07-28T18:01:18,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,45,6,"-- Count the number of rows in the 'dataquality' table where 'chipsf' = 5-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'SELECT COUNT(*)FROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified ZTF identifiers  AND chipsf = 5 -- Filter for rows with a minimum reduced chi-square value of 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.028989791870115,2025-07-23T19:08:00,"[   count
0     81]",,9.05830216407776,2025-07-28T18:01:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,45,7,"-- Query to count rows in the 'dataquality' table with a minimum reduced chi-square value (chipsf) of 5-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'SELECT COUNT(*) AS row_countFROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified object identifiers  AND chipsf = 5 -- Filter for rows with chipsf equal to 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,16.166043519973755,2025-07-23T19:08:16,"[   row_count
0         81]",,9.826706647872925,2025-07-28T18:01:48,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,45,8,"-- Query to count rows in the 'dataquality' table with a minimum reduced chi-square value (chipsf) of 5-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'SELECT COUNT(*)FROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified object identifiers  AND chipsf = 5 -- Filter for rows where the reduced chi-square value is 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,16.337603330612183,2025-07-23T19:08:33,"[   count
0     81]",,10.7465717792511,2025-07-28T18:02:03,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,45,9,"-- Query to count rows in the 'dataquality' table with a minimum reduced chi-square value of 5-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'SELECT COUNT(*)FROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified object identifiers  AND chipsf >= 5 -- Filter for reduced chi-square values greater than or equal to 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.101154088974,2025-07-23T19:08:44,"[   count
0     81]",,10.78336215019226,2025-07-28T18:02:18,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,45,10,"-- Count the number of rows in the 'dataquality' table where the reduced chi-square value (chipsf) is 5-- and the object identifier (oid) matches either 'ZTF23abjikaf' or 'ZTF20achlced'SELECT COUNT(*)FROM dataqualityWHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') -- Filter for the specified object identifiers  AND chipsf = 5 -- Filter for rows with a reduced chi-square value of 5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,21.60567045211792,2025-07-23T19:09:05,"[   count
0     81]",,9.516581296920776,2025-07-28T18:02:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,63,0,"SELECT
    *
FROM
    probability
WHERE
    oid IN ('ZTF21aaobkmg','ZTF21aaomuka')
    AND classifier_name = 'lc_classifier'
    AND ranking <= 2
ORDER BY ranking",,,,,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,3.4501657485961914,2025-07-28T18:02:38,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,1,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,7.874923706054687,2025-07-23T19:09:13,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.936675548553467,2025-07-28T18:02:53,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,2,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,6.506305932998657,2025-07-23T19:09:20,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.979624509811401,2025-07-28T18:03:07,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,3,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.414422988891602,2025-07-23T19:09:24,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.800880193710327,2025-07-28T18:03:22,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,4,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,6.3352370262146,2025-07-23T19:09:31,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.187825679779053,2025-07-28T18:03:34,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,5,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,10.067726373672484,2025-07-23T19:09:41,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.924163579940796,2025-07-28T18:03:48,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,6,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.193794250488281,2025-07-23T19:09:45,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.685158252716064,2025-07-28T18:04:01,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,7,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.626595497131348,2025-07-23T19:09:49,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.619201421737671,2025-07-28T18:04:15,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,8,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.01028299331665,2025-07-23T19:09:53,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.401947736740112,2025-07-28T18:04:29,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,9,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.338388442993164,2025-07-23T19:09:56,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,9.326796054840088,2025-07-28T18:04:44,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,63,10,"-- Query to find all rows in the 'probability' table for specified ZTF identifiers-- with ranking 1 or 2 and classifier_name as 'lc_classifier', sorted by ranking.SELECT *FROM probabilityWHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')  AND classifier_name = 'lc_classifier'  AND ranking IN (1, 2)ORDER BY ranking","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.8999855518341064,2025-07-23T19:09:59,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,8.719724416732788,2025-07-28T18:04:58,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,73,0,"SELECT
    oid, ssnamenr, ssmagnr
FROM
    ss_ztf
WHERE
    oid = 'ZTF21acitntz'
",,,,,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,3.4037070274353027,2025-07-28T18:05:03,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,73,1,"-- Query to retrieve the ZTF object identifier, MPC name, and MPC magnitude of the nearest known Solar System objectSELECT     o.oid,                -- ZTF object identifier    s.ssnamenr,           -- MPC name of the nearest known Solar System object    s.ssmagnr             -- MPC magnitude of the nearest known Solar System objectFROM     object oINNER JOIN     ss_ztf sON     o.oid = s.oidWHERE     o.oid = 'ZTF21acitntz' -- Filter for the specific ZTF object","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,20.174733638763428,2025-07-23T19:10:20,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,9.39594340324402,2025-07-28T18:05:17,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,73,2,"-- Query to retrieve the ZTF object identifier, MPC name, and MPC magnitude of the nearest known Solar System objectSELECT     object.oid,     ss_ztf.ssnamenr,     ss_ztf.ssmagnrFROM     objectINNER JOIN     ss_ztf ON     object.oid = ss_ztf.oidWHERE     object.oid = 'ZTF21acitntz'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,21.39244055747986,2025-07-23T19:10:41,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,8.224852561950684,2025-07-28T18:05:30,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,73,3,"SELECT     ss_ztf.oid AS ztf_object_id,     ss_ztf.ssnamenr AS mpc_name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHERE     ss_ztf.oid = 'ZTF21acitntz'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.894503831863404,2025-07-23T19:10:44,"[  ztf_object_id mpc_name  mpc_magnitude
0  ZTF21acitntz    17427           18.6]",,7.892415761947632,2025-07-28T18:05:44,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,73,4,"SELECT     ss_ztf.oid AS ztf_object_identifier,     ss_ztf.ssnamenr AS mpc_name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHERE     ss_ztf.oid = 'ZTF21acitntz'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.674062490463257,2025-07-23T19:10:47,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,8.293864011764526,2025-07-28T18:05:57,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,73,5,"SELECT     ss_ztf.oid AS ztf_object_identifier,     ss_ztf.ssnamenr AS mpc_name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHERE     ss_ztf.oid = 'ZTF21acitntz'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.8279216289520255,2025-07-23T19:10:51,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,7.749195575714111,2025-07-28T18:06:10,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,73,6,"-- Query to retrieve the ZTF object identifier, MPC name, and MPC magnitude of the nearest known Solar System object-- for the ZTF object 'ZTF21acitntz'SELECT     object.oid,          -- ZTF object identifier    ss_ztf.ssnamenr,     -- MPC name of the nearest known Solar System object    ss_ztf.ssmagnr       -- MPC magnitude of the nearest known Solar System objectFROM     objectINNER JOIN     ss_ztf ON object.oid = ss_ztf.oid  -- Join on the object identifierWHERE     object.oid = 'ZTF21acitntz'       -- Filter for the specific ZTF object","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,15.838666439056396,2025-07-23T19:11:06,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,9.348493337631226,2025-07-28T18:06:24,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,73,7,"SELECT     ss_ztf.oid AS ztf_object_identifier,     ss_ztf.ssnamenr AS mpc_name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHERE     ss_ztf.oid = 'ZTF21acitntz'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,4.193819522857666,2025-07-23T19:11:11,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,8.166532278060913,2025-07-28T18:06:37,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,73,8,"SELECT     ss_ztf.oid AS ztf_object_identifier,     ss_ztf.ssnamenr AS mpc_name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHERE     ss_ztf.oid = 'ZTF21acitntz'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,5.604791164398193,2025-07-23T19:11:16,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,8.178368330001831,2025-07-28T18:06:49,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,73,9,"-- Query to retrieve the ZTF object identifier, the MPC name, and the MPC magnitude of the nearest known Solar System objectSELECT     o.oid,     s.ssnamenr AS mpc_name,     s.ssmagnr AS mpc_magnitudeFROM     object oINNER JOIN     ss_ztf sON     o.oid = s.oidWHERE     o.oid = 'ZTF21acitntz'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,15.258827686309814,2025-07-23T19:11:32,"[            oid mpc_name  mpc_magnitude
0  ZTF21acitntz    17427           18.6]",,9.14078140258789,2025-07-28T18:07:03,1.0,1.0,0.3333333333333333,0.3333333333333333,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,73,10,"SELECT     ss_ztf.oid AS ztf_object_identifier,     ss_ztf.ssnamenr AS mpc_name,     ss_ztf.ssmagnr AS mpc_magnitudeFROM     ss_ztfWHERE     ss_ztf.oid = 'ZTF21acitntz'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.7857139110565186,2025-07-23T19:11:35,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,8.762537240982056,2025-07-28T18:07:16,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,,,92,0,"SELECT
    oid, classifier_version, class_name, probability
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking = 1
    AND oid in
(
SELECT
    oid
FROM
    magstat
WHERE
    fid = 1
    AND ndet >= 10
    AND ndubious = 0
ORDER BY oid
LIMIT 500
)
",,,,,"[              oid     classifier_version      class_name  probability
0    ZTF17aaaaaxb  hierarchical_rf_1.1.0  Periodic-Other     0.402136
1    ZTF17aaaaaxb   lc_classifier_1.1.13  Periodic-Other     0.349860
2    ZTF17aaaadiz  hierarchical_rf_1.1.0               E     0.282672
3    ZTF17aaaadiz   lc_classifier_1.1.13  Periodic-Other     0.258560
4    ZTF17aaaadyg  hierarchical_rf_1.1.0  Periodic-Other     0.553136
..            ...                    ...             ...          ...
942  ZTF17aaaaaas   lc_classifier_1.1.13  Periodic-Other     0.254528
943  ZTF17aaaaegw  hierarchical_rf_1.1.0             YSO     0.717024
944  ZTF17aaaaegw   lc_classifier_1.1.13             YSO     0.604632
945  ZTF17aaaabel  hierarchical_rf_1.1.0               E     0.371840
946  ZTF17aaaabel   lc_classifier_1.1.13  Periodic-Other     0.439200

[947 rows x 4 columns]]",,4.29850959777832,2025-07-28T18:07:23,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,92,1,"-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1-- for the light curve classifier.SELECT     p.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     probability p-- Join with a subquery to filter objects with at least 10 detections in the g band and no dubious correctionsINNER JOIN (    SELECT         d.oid    FROM         detection d    WHERE         d.fid = 1 -- g band        AND d.dubious = FALSE -- no dubious corrections    GROUP BY         d.oid    HAVING         COUNT(d.oid) >= 10 -- at least 10 detections) filtered_objects ON p.oid = filtered_objects.oidWHERE     p.ranking = 1 -- only the most likely classification    AND p.classifier_name = 'lc_classifier' -- light curve classifierORDER BY     p.oid ASC -- order by ZTF identifierLIMIT 500 -- limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,23.453742027282715,2025-07-23T19:11:58,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,
-- no dubious corrections in that filter, and classification probabilities with ranking 1
-- for the light curve classifier.

SELECT 
    p.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    probability p
-- Join with a subquery to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- no dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(d.oid) >= 10 -- at least 10 detections
) filtered_objects 
ON 
    p.oid = filtered_objects.oid
WHERE 
    p.ranking = 1 -- only the most likely classification
    AND p.classifier_name = 'lc_classifier' -- light curve classifier
ORDER BY 
    p.oid ASC -- order by ZTF identifier
LIMIT 500 -- limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.8792543411255,2025-07-28T18:09:42,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,2,"-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.SELECT     o.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     object o-- Join with a subquery to filter detections in the g band with no dubious correctionsINNER JOIN (    SELECT         d.oid    FROM         detection d    WHERE         d.fid = 1 -- g band        AND d.dubious = FALSE    GROUP BY         d.oid    HAVING         COUNT(d.oid) >= 10 -- At least 10 detections) d_filtered ON o.oid = d_filtered.oid-- Join with the probability table to filter by ranking and classifierINNER JOIN probability p ON o.oid = p.oidWHERE     p.ranking = 1 -- Only the most likely class    AND p.classifier_name = 'lc_classifier' -- Light curve classifierORDER BY     o.oid ASC -- Order by ZTF identifierLIMIT 500 -- Limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,27.30911874771118,2025-07-23T19:12:25,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,
-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.

SELECT 
    o.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with a subquery to filter detections in the g band with no dubious corrections
INNER JOIN (
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- No dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(d.oid) >= 10 -- At least 10 detections
) d_filtered ON o.oid = d_filtered.oid
-- Join with the probability table to filter by ranking and classifier
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only the most likely class
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid ASC -- Order by ZTF identifier
LIMIT 500 -- Limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.6467640399933,2025-07-28T18:11:58,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,3,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.WITH filtered_detections AS (    -- Subquery to filter objects with at least 10 detections in the g band and no dubious corrections    SELECT        oid    FROM        detection    WHERE        fid = 1 -- g band        AND dubious = FALSE    GROUP BY        oid    HAVING        COUNT(*) >= 10),filtered_probabilities AS (    -- Subquery to filter classification probabilities with ranking 1 for the light curve classifier    SELECT        oid,        classifier_version,        class_name,        probability    FROM        probability    WHERE        ranking = 1        AND classifier_name = 'lc_classifier')-- Combine the filtered detections and probabilities, and limit the results to 500 rowsSELECT    p.oid,    p.classifier_version,    p.class_name,    p.probabilityFROM    filtered_detections dINNER JOIN    filtered_probabilities pON    d.oid = p.oidORDER BY    p.oid ASCLIMIT 500","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,21.42437148094177,2025-07-23T19:12:47,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,
-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.

WITH filtered_detections AS (
    -- Subquery to filter objects with at least 10 detections in the g band and no dubious corrections
    SELECT
        oid
    FROM
        detection
    WHERE
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY
        oid
    HAVING
        COUNT(*) >= 10
),
filtered_probabilities AS (
    -- Subquery to filter classification probabilities with ranking 1 for the light curve classifier
    SELECT
        oid,
        classifier_version,
        class_name,
        probability
    FROM
        probability
    WHERE
        ranking = 1
        AND classifier_name = 'lc_classifier'
)
-- Combine the filtered detections and probabilities, and limit the results to 500 rows
SELECT
    p.oid,
    p.classifier_version,
    p.class_name,
    p.probability
FROM
    filtered_detections d
INNER JOIN
    filtered_probabilities p
ON
    d.oid = p.oid
ORDER BY
    p.oid ASC
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",129.70821022987366,2025-07-28T18:14:13,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,4,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.WITH filtered_objects AS (    -- Step 1: Filter objects with at least 10 detections in the g band and no dubious corrections    SELECT        d.oid    FROM        detection d    WHERE        d.fid = 1 -- g band        AND d.dubious = FALSE -- no dubious corrections    GROUP BY        d.oid    HAVING        COUNT(*) >= 10 -- at least 10 detections),classified_objects AS (    -- Step 2: Retrieve classification information for objects with ranking 1 and lc_classifier    SELECT        p.oid,        p.class_name,        p.classifier_version,        p.probability    FROM        probability p    WHERE        p.ranking = 1 -- most likely classification        AND p.classifier_name = 'lc_classifier' -- light curve classifier)-- Step 3: Join filtered objects with classification information and limit resultsSELECT    fo.oid AS ztf_identifier,    co.classifier_version,    co.class_name,    co.probabilityFROM    filtered_objects foINNER JOIN    classified_objects coON    fo.oid = co.oidORDER BY    fo.oid ASC -- order by oidLIMIT 500 -- limit to 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,21.43982100486756,2025-07-23T19:13:08,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,
-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.

-- Step 1: Filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_objects AS (
    SELECT
        d.oid
    FROM
        detection d
    WHERE
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- no dubious corrections
    GROUP BY
        d.oid
    HAVING
        COUNT(*) >= 10 -- at least 10 detections
),
-- Step 2: Retrieve classification information for objects with ranking 1 and lc_classifier
classified_objects AS (
    SELECT
        p.oid,
        p.class_name,
        p.classifier_version,
        p.probability
    FROM
        probability p
    WHERE
        p.ranking = 1 -- most likely classification
        AND p.classifier_name = 'lc_classifier' -- light curve classifier
)
-- Step 3: Join filtered objects with classification information and limit results
SELECT
    fo.oid AS ztf_identifier,
    co.classifier_version,
    co.class_name,
    co.probability
FROM
    filtered_objects fo
INNER JOIN
    classified_objects co
ON
    fo.oid = co.oid
ORDER BY
    fo.oid ASC -- order by oid
LIMIT 500 -- limit to 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.70392370224,2025-07-28T18:16:30,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,5,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.SELECT     p.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     probability p-- Join with a subquery to filter objects with at least 10 detections in the g band and no dubious correctionsINNER JOIN (    SELECT         d.oid    FROM         detection d    WHERE         d.fid = 1 -- g band        AND d.dubious = FALSE -- no dubious corrections    GROUP BY         d.oid    HAVING         COUNT(*) >= 10 -- at least 10 detections) AS filtered_objectsON     p.oid = filtered_objects.oidWHERE     p.ranking = 1 -- only include probabilities with ranking 1    AND p.classifier_name = 'lc_classifier' -- light curve classifierORDER BY     p.oid ASC -- order by oidLIMIT 500 -- limit to 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,22.400028944015503,2025-07-23T19:13:31,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,
-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.

SELECT 
    p.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    probability p
-- Join with a subquery to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- no dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(*) >= 10 -- at least 10 detections
) AS filtered_objects
ON 
    p.oid = filtered_objects.oid
WHERE 
    p.ranking = 1 -- only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- light curve classifier
ORDER BY 
    p.oid ASC -- order by oid
LIMIT 500 -- limit to 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.1093785762787,2025-07-28T18:18:47,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,6,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.WITH filtered_detections AS (    SELECT        oid    FROM        detection    WHERE        fid = 1 -- g band        AND dubious = FALSE -- no dubious corrections    GROUP BY        oid    HAVING        COUNT(*) >= 10 -- at least 10 detections),filtered_objects AS (    SELECT        o.oid    FROM        object o    INNER JOIN        filtered_detections fd ON o.oid = fd.oid),final_results AS (    SELECT        po.oid,        po.classifier_version,        po.class_name,        po.probability    FROM        probability po    INNER JOIN        filtered_objects fo ON po.oid = fo.oid    WHERE        po.ranking = 1 -- only the most likely classification        AND po.classifier_name = 'lc_classifier' -- light curve classifier)SELECT    oid,    classifier_version,    class_name,    probabilityFROM    final_resultsORDER BY    oid ASCLIMIT 500","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,32.38863587379456,2025-07-23T19:14:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,
-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.

WITH filtered_detections AS (
    SELECT
        oid
    FROM
        detection
    WHERE
        fid = 1 -- g band
        AND dubious = FALSE -- no dubious corrections
    GROUP BY
        oid
    HAVING
        COUNT(*) >= 10 -- at least 10 detections
),
filtered_objects AS (
    SELECT
        o.oid
    FROM
        object o
    INNER JOIN
        filtered_detections fd ON o.oid = fd.oid
),
final_results AS (
    SELECT
        po.oid,
        po.classifier_version,
        po.class_name,
        po.probability
    FROM
        probability po
    INNER JOIN
        filtered_objects fo ON po.oid = fo.oid
    WHERE
        po.ranking = 1 -- only the most likely classification
        AND po.classifier_name = 'lc_classifier' -- light curve classifier
)
SELECT
    oid,
    classifier_version,
    class_name,
    probability
FROM
    final_results
ORDER BY
    oid ASC -- Corrected syntax for ordering
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.2500717639923,2025-07-28T18:21:03,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,7,"-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.SELECT     o.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     object o-- Join with detection table to filter objects with at least 10 detections in g band and no dubious correctionsINNER JOIN (    SELECT DISTINCT oid    FROM detection    WHERE fid = 1 -- g band      AND dubious = FALSE -- no dubious corrections) d ON o.oid = d.oid-- Join with probability table to filter probabilities with ranking 1 for the light curve classifierINNER JOIN probability p ON o.oid = p.oidWHERE     o.ndet >= 10 -- at least 10 detections    AND p.ranking = 1 -- only the most likely class    AND p.classifier_name = 'lc_classifier' -- light curve classifierORDER BY     o.oid ASC -- order by ZTF identifierLIMIT 500 -- limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,19.0737042427063,2025-07-23T19:14:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,
-- no dubious corrections in that filter, and probabilities with ranking 1 for the light curve classifier.

SELECT 
    o.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with detection table to filter objects with at least 10 detections in g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE -- no dubious corrections
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10 -- at least 10 detections in g band
) d ON o.oid = d.oid
-- Join with probability table to filter probabilities with ranking 1 for the light curve classifier
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- only the most likely class
    AND p.classifier_name = 'lc_classifier' -- light curve classifier
ORDER BY 
    o.oid ASC -- order by ZTF identifier
LIMIT 500 -- limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",135.4562304019928,2025-07-28T18:23:24,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,8,"-- Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1-- for the light curve classifier.SELECT     o.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     object o-- Join with the detection table to filter detections in the g band and exclude dubious onesINNER JOIN (    SELECT DISTINCT oid    FROM detection    WHERE fid = 1 -- g band      AND dubious = FALSE) d ON o.oid = d.oid-- Join with the probability table to get classification informationINNER JOIN probability p ON o.oid = p.oidWHERE     o.ndet >= 10 -- At least 10 detections    AND p.ranking = 1 -- Only the most likely classification    AND p.classifier_name = 'lc_classifier' -- Light curve classifierORDER BY     o.oid ASC -- Order by ZTF identifierLIMIT 500 -- Limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,23.353625059127808,2025-07-23T19:14:46,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve at most 500 ZTF objects with at least 10 detections in the g band,
-- no dubious corrections in that filter, and classification probabilities with ranking 1
-- for the light curve classifier.

SELECT 
    o.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter detections in the g band and exclude dubious ones
INNER JOIN (
    SELECT 
        oid 
    FROM 
        detection 
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
) d ON o.oid = d.oid
-- Join with the probability table to get classification information
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 10 -- At least 10 detections
    AND p.ranking = 1 -- Only the most likely classification
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid ASC -- Order by ZTF identifier
LIMIT 500 -- Limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.16857075691223,2025-07-28T18:25:43,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,9,"-- Retrieve at most 500 ZTF objects ordered by their oids, with at least 10 detections in the g band,-- no dubious corrections in that filter, and classification probabilities with ranking 1 for the light curve classifier.WITH filtered_detections AS (    -- Subquery 1: Filter detections in the g band (fid = 1) with no dubious corrections and count detections per object    SELECT        oid    FROM        detection    WHERE        fid = 1 -- g band        AND dubious = FALSE    GROUP BY        oid    HAVING        COUNT(*) >= 10 -- At least 10 detections),filtered_probabilities AS (    -- Subquery 2: Filter probabilities with ranking = 1 and classifier_name = 'lc_classifier'    SELECT        oid,        classifier_version,        class_name,        probability    FROM        probability    WHERE        ranking = 1        AND classifier_name = 'lc_classifier')-- Final query: Join filtered detections, probabilities, and objects, and apply sorting and limitingSELECT    o.oid AS ztf_identifier,    p.classifier_version,    p.class_name,    p.probabilityFROM    object oINNER JOIN    filtered_detections d ON o.oid = d.oidINNER JOIN    filtered_probabilities p ON o.oid = p.oidORDER BY    o.oid ASCLIMIT 500","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,24.88426351547241,2025-07-23T19:15:11,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
WITH filtered_detections AS (
    -- Subquery 1: Filter detections in the g band (fid = 1) with no dubious corrections and count detections per object
    SELECT
        oid
    FROM
        detection
    WHERE
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY
        oid
    HAVING
        COUNT(*) >= 10 -- At least 10 detections
),
filtered_probabilities AS (
    -- Subquery 2: Filter probabilities with ranking = 1 and classifier_name = 'lc_classifier'
    SELECT
        oid,
        classifier_version,
        class_name,
        probability
    FROM
        probability
    WHERE
        ranking = 1
        AND classifier_name = 'lc_classifier'
)
-- Final query: Join filtered detections, probabilities, and objects, and apply sorting and limiting
SELECT
    o.oid AS ztf_identifier,
    p.classifier_version,
    p.class_name,
    p.probability
FROM
    object o
INNER JOIN
    filtered_detections d ON o.oid = d.oid
INNER JOIN
    filtered_probabilities p ON o.oid = p.oid
ORDER BY
    o.oid ASC
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",129.42919969558716,2025-07-28T18:27:58,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,92,10,"-- Retrieve at most 500 ZTF objects with at least 10 detections in the g band (fid = 1),-- no dubious corrections, and classification probabilities with ranking = 1 for the light curve classifier.SELECT     o.oid AS ztf_identifier,     p.classifier_version,     p.class_name,     p.probabilityFROM     object o-- Join with a subquery that filters detections in the g band (fid = 1) with no dubious corrections-- and counts the number of such detections per object.INNER JOIN (    SELECT         d.oid    FROM         detection d    WHERE         d.fid = 1 -- g band        AND d.dubious = FALSE -- no dubious corrections    GROUP BY         d.oid    HAVING         COUNT(*) >= 10 -- at least 10 detections) d_filtered ON o.oid = d_filtered.oid-- Join with the probability table to get classification informationINNER JOIN probability p ON o.oid = p.oidWHERE     p.ranking = 1 -- only the most likely classification    AND p.classifier_name = 'lc_classifier' -- light curve classifierORDER BY     o.oid ASC -- order by ZTF identifierLIMIT 500 -- limit to at most 500 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,25.414546251297,2025-07-23T19:15:36,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
-- Retrieve at most 500 ZTF objects with at least 10 detections in the g band (fid = 1),
-- no dubious corrections, and classification probabilities with ranking = 1 for the light curve classifier.

SELECT 
    o.oid AS ztf_identifier, 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with a subquery that filters detections in the g band (fid = 1) with no dubious corrections
-- and counts the number of such detections per object.
INNER JOIN (
    SELECT 
        d.oid
    FROM 
        detection d
    WHERE 
        d.fid = 1 -- g band
        AND d.dubious = FALSE -- no dubious corrections
    GROUP BY 
        d.oid
    HAVING 
        COUNT(*) >= 10 -- at least 10 detections
) d_filtered ON o.oid = d_filtered.oid
-- Join with the probability table to get classification information
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- only the most likely classification
    AND p.classifier_name = 'lc_classifier' -- light curve classifier
ORDER BY 
    o.oid ASC -- order by ZTF identifier
LIMIT 500 -- limit to at most 500 results
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.6143708229065,2025-07-28T18:30:14,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,102,0,"SELECT
    *
FROM
    magstat
WHERE
    oid IN
(
SELECT
    probability.oid
FROM
    probability INNER JOIN
    xmatch
    ON probability.oid = xmatch.oid
    INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    w1mpro > 12
    AND w1mpro < 13
    AND classifier_name = 'lc_classifier'
    AND class_name = 'AGN'
    AND probability > 0.6
LIMIT 50
)",,,,,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF18admzvfs    1    False       True   111         0         NaN   
1   ZTF18admzvfs    2    False       True    67         0         NaN   
2   ZTF18acbwaow    1    False       True   428         0         NaN   
3   ZTF18acbwaow    2    False       True   399         1         NaN   
4   ZTF18adaryet    1    False       True   111         0         NaN   
..           ...  ...      ...        ...   ...       ...         ...   
95  ZTF22abxzvrs    1    False       True   148         0         NaN   
96  ZTF22abxzvrs    2    False       True   142         0         NaN   
97  ZTF22abxzvrs    3    False       True     5         0         NaN   
98  ZTF20actrcji    1    False       True    42         0   -0.528726   
99  ZTF20actrcji    2    False       True    46         0         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.262014    18.417845   
1        NaN            NaN       NaN  ...       17.761003    17.839651   
2        NaN            NaN       NaN  ...       18.081297    19.777365   
3        NaN            NaN       NaN  ...       17.882048    24.629429   
4        NaN            NaN       NaN  ...       17.690979    18.122430   
..       ...            ...       ...  ...             ...          ...   
95       NaN            NaN       NaN  ...       18.574380    18.922522   
96       NaN            NaN       NaN  ...       17.907152    18.283686   
97       NaN            NaN       NaN  ...       17.415329    17.496540   
98 -1.189105     -18.985958  2.021586  ...       17.466900    17.625141   
99       NaN            NaN       NaN  ...       16.896624    17.093203   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     18.222050       0.075151     18.417845            NaN  58360.168   
1     17.729683       0.040485     17.824680            NaN  58369.145   
2     17.343874       0.326064     18.014069      18.397856  58423.484   
3     17.224304       0.386415     17.695300      17.893929  58423.543   
4     17.491518       0.163959     17.683527      18.071615  58480.266   
..          ...            ...           ...            ...        ...   
95    17.943922       0.197880     18.602077      18.189098  59887.273   
96    17.525473       0.109590     17.889904      17.699236  59895.312   
97    17.385704       0.037042     17.385704      17.433744  60575.473   
98    17.108603       0.110517     17.614399      17.108603  59182.523   
99    16.770851       0.072555     17.093203      16.836765  59178.547   

      lastmjd  step_id_corr  saturation_rate  
0   60404.430    ALeRCE ZTF              0.0  
1   60408.445    ALeRCE ZTF              0.0  
2   60699.414        27.3.0              0.0  
3   60688.383        27.3.0              0.0  
4   60706.250        27.4.0              0.0  
..        ...           ...              ...  
95  60734.150        27.4.0              0.0  
96  60730.184        27.4.0              0.0  
97  60577.520        27.4.0              0.0  
98  59969.375         1.1.6              0.0  
99  59972.336         1.1.6              0.0  

[100 rows x 28 columns]]",,7.880961418151855,2025-07-28T18:30:23,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,102,1,-- [FINAL QUERY HERE]SELECT *FROM magstatWHERE oid IN (    -- Subquery to filter objects based on classification probability and WISE W1 magnitude    SELECT p.oid    FROM probability p    INNER JOIN allwise a ON p.oid = a.oid_catalog    WHERE p.class_name = 'AGN'      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.probability > 0.6      AND a.w1mpro BETWEEN 12 AND 13)LIMIT 50,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",advanced,37.279759883880615,2025-07-23T19:16:14,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,12.294854164123535,2025-07-28T18:30:42,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,102,2,-- [FINAL QUERY HERE]SELECT *FROM magstatWHERE oid IN (    SELECT p.oid    FROM probability p    INNER JOIN allwise a ON p.oid = a.oid_catalog    WHERE p.class_name = 'AGN'      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.probability > 0.6      AND a.w1mpro BETWEEN 12 AND 13)LIMIT 50,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",advanced,23.05440926551819,2025-07-23T19:16:37,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,11.608663320541382,2025-07-28T18:31:01,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,102,3,-- [FINAL QUERY HERE]SELECT *FROM magstatWHERE oid IN (    -- Subquery to filter objects based on probability conditions    SELECT p.oid    FROM probability p    INNER JOIN allwise a ON p.oid = a.oid_catalog    WHERE p.class_name = 'AGN'      AND p.classifier_name = 'lc_classifier'      AND p.ranking = 1      AND p.probability > 0.6      AND a.w1mpro BETWEEN 12 AND 13)LIMIT 50,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",advanced,19.86609053611756,2025-07-23T19:16:57,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.03152346611023,2025-07-28T18:31:15,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,102,4,-- [FINAL QUERY HERE]SELECT *FROM magstatWHERE oid IN (    -- Subquery 3: Cross-match objects between probability and allwise    SELECT p.oid    FROM (        -- Subquery 1: Filter objects based on classification probability        SELECT oid        FROM probability        WHERE class_name = 'AGN'          AND classifier_name = 'lc_classifier'          AND ranking = 1          AND probability > 0.6    ) p    INNER JOIN (        -- Subquery 2: Filter objects based on WISE W1 magnitude        SELECT oid_catalog AS oid        FROM allwise        WHERE w1mpro BETWEEN 12 AND 13    ) a    ON p.oid = a.oid)LIMIT 50,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",advanced,21.30132484436035,2025-07-23T19:17:18,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,10.18412160873413,2025-07-28T18:31:31,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,102,5,-- [FINAL QUERY HERE]SELECT *FROM magstatWHERE oid IN (    SELECT p.oid    FROM probability p    INNER JOIN allwise a ON p.oid = a.oid_catalog    WHERE p.class_name = 'AGN'      AND p.classifier_name = 'lc_classifier'      AND p.probability > 0.6      AND p.ranking = 1      AND a.w1mpro BETWEEN 12 AND 13)LIMIT 50,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",advanced,23.090798139572144,2025-07-23T19:17:41,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,12.53628158569336,2025-07-28T18:31:49,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,102,6,"-- Retrieve at most 50 ZTF objects that satisfy the specified conditions-- Return all columns from the 'magstat' table for such objectsSELECT magstat.*FROM magstatINNER JOIN object ON magstat.oid = object.oidINNER JOIN probability ON object.oid = probability.oidINNER JOIN allwise ON q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 0.00027778) -- Spatial cross-match within 1 arcsecondWHERE probability.class_name = 'AGN'  AND probability.classifier_name = 'lc_classifier'  AND probability.ranking = 1  AND probability.probability > 0.6  AND allwise.w1mpro BETWEEN 12 AND 13LIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,42.185208797454834,2025-07-23T19:18:23,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
SELECT 
    magstat.*
FROM 
    magstat
INNER JOIN 
    object ON magstat.oid = object.oid
INNER JOIN 
    probability ON object.oid = probability.oid
INNER JOIN 
    allwise ON q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 0.00027778) -- Spatial cross-match within 1 arcsecond
WHERE 
    probability.class_name = 'AGN'  -- Ensure the class is AGN
    AND probability.classifier_name = 'lc_classifier'  -- Use the light curve classifier
    AND probability.ranking = 1  -- Only consider the most likely classification
    AND probability.probability > 0.6  -- Probability must be greater than 0.6
    AND allwise.w1mpro BETWEEN 12 AND 13  -- WISE W1 magnitude must be between 12 and 13
LIMIT 50 -- Limit the result to at most 50 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.24718236923218,2025-07-28T18:34:08,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,102,7,-- Query to retrieve at most 50 ZTF objects that satisfy the specified conditions-- and return all columns from the 'magstat' table for such objects.SELECT magstat.*FROM magstatINNER JOIN object ON magstat.oid = object.oidINNER JOIN probability ON object.oid = probability.oidINNER JOIN allwise ON object.oid = allwise.oid_catalogWHERE probability.class_name = 'AGN' -- Filter for AGN class  AND probability.classifier_name = 'lc_classifier' -- Use the light curve classifier  AND probability.ranking = 1 -- Only consider the most likely classification  AND probability.probability > 0.6 -- Probability greater than 0.6  AND allwise.w1mpro BETWEEN 12 AND 13 -- WISE W1 magnitude between 12 and 13LIMIT 50 -- Limit the results to at most 50 objects,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,21.62737226486206,2025-07-23T19:18:45,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,30.94933652877808,2025-07-28T18:34:44,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,102,8,"-- Retrieve at most 50 ZTF objects that satisfy the specified conditions-- Return all columns from the magstat table for such objectsSELECT magstat.*FROM magstatINNER JOIN object ON magstat.oid = object.oidINNER JOIN probability ON object.oid = probability.oidINNER JOIN allwise ON q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 0.000277778) -- 1 arcsecond toleranceWHERE probability.class_name = 'AGN'  AND probability.classifier_name = 'lc_classifier'  AND probability.ranking = 1  AND probability.probability > 0.6  AND allwise.w1mpro BETWEEN 12 AND 13LIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,22.45337581634521,2025-07-23T19:19:08,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected SQL Query
-- Retrieve at most 50 ZTF objects that satisfy the specified conditions
-- Return all columns from the magstat table for such objects
SELECT 
    magstat.*
FROM 
    magstat
INNER JOIN 
    object ON magstat.oid = object.oid
INNER JOIN 
    probability ON object.oid = probability.oid
INNER JOIN 
    allwise ON q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 0.000277778) -- 1 arcsecond tolerance
WHERE 
    probability.class_name = 'AGN'  -- Ensure the class is AGN
    AND probability.classifier_name = 'lc_classifier'  -- Use the light curve classifier
    AND probability.ranking = 1  -- Only consider the most likely classification
    AND probability.probability > 0.6  -- Probability must be greater than 0.6
    AND allwise.w1mpro BETWEEN 12 AND 13  -- WISE W1 magnitude must be between 12 and 13
LIMIT 50 -- Limit the results to at most 50 rows
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.78943991661072,2025-07-28T18:37:00,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,102,9,-- [FINAL QUERY HERE]SELECT     magstat.*FROM     magstatINNER JOIN (    -- Subquery to filter objects based on probability conditions    SELECT         probability.oid    FROM         probability    WHERE         probability.class_name = 'AGN'        AND probability.classifier_name = 'lc_classifier'        AND probability.probability > 0.6        AND probability.ranking = 1) AS filtered_probabilitiesON     magstat.oid = filtered_probabilities.oidINNER JOIN (    -- Subquery to filter objects based on WISE W1 magnitude    SELECT         oid_catalog AS oid    FROM         allwise    WHERE         w1mpro BETWEEN 12 AND 13) AS filtered_allwiseON     magstat.oid = filtered_allwise.oidLIMIT 50,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",advanced,23.40838122367859,2025-07-23T19:19:31,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,10.391483068466188,2025-07-28T18:37:15,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,102,10,-- Query to retrieve at most 50 ZTF objects that satisfy the specified conditions-- and return all columns from the 'magstat' table.SELECT magstat.*FROM magstatINNER JOIN probability    ON magstat.oid = probability.oidINNER JOIN allwise    ON magstat.oid = allwise.oid_catalogWHERE probability.class_name = 'AGN' -- Filter for AGN class  AND probability.classifier_name = 'lc_classifier' -- Use light curve classifier  AND probability.ranking = 1 -- Only consider the most likely classification  AND probability.probability > 0.6 -- Probability greater than 0.6  AND allwise.w1mpro BETWEEN 12 AND 13 -- WISE W1 magnitude between 12 and 13LIMIT 50 -- Limit the results to at most 50 objects,"['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,27.74723792076111,2025-07-23T19:19:59,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,11.074466228485107,2025-07-28T18:37:32,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,81,0,"SELECT
    oid, dist
FROM
    xmatch
WHERE
    oid_catalog = 'J163603.54-065228.7'",,,,,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,3.4328389167785645,2025-07-28T18:37:37,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,1,"-- Query to retrieve ZTF object identifier and distance for the specified ALLWISE objectSELECT     oid,  -- ZTF object identifier    dist  -- Distance to the counterpart in arcsecondsFROM     xmatchWHERE     catid = 'ALLWISE'  -- Filter for the ALLWISE catalog    AND oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE object identifier","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,33.43243861198425,2025-07-23T19:20:32,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,8.993033170700073,2025-07-28T18:37:53,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,2,"-- Retrieve ZTF object identifier and distance for the specified ALLWISE objectSELECT     xmatch.oid,  -- ZTF object identifier    xmatch.dist  -- Distance to the closest ZTF object [arcsec]FROM     xmatchINNER JOIN     allwise ON xmatch.oid_catalog = allwise.oid_catalog  -- Join on catalog object identifierWHERE     allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE object","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.224146842956543,2025-07-23T19:20:50,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,9.266509771347046,2025-07-28T18:38:07,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,3,"-- Retrieve ZTF object identifier and distance for the ALLWISE object with identifier 'J163603.54-065228.7'SELECT     xmatch.oid,  -- ZTF object identifier    xmatch.dist  -- Distance to the closest ZTF object [arcsec]FROM     xmatchINNER JOIN     allwise ON xmatch.oid_catalog = allwise.oid_catalog  -- Join on the catalog object identifierWHERE     allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE object","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.441943407058716,2025-07-23T19:21:05,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,8.877193689346313,2025-07-28T18:38:21,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,4,"-- Retrieve ZTF object identifier and distance for the specified ALLWISE objectSELECT     xmatch.oid, -- ZTF object identifier    xmatch.dist -- Distance to the closest ZTF object [arcsec]FROM     xmatchINNER JOIN     allwise ON xmatch.oid_catalog = allwise.oid_catalog -- Join on catalog object identifierWHERE     allwise.oid_catalog = 'J163603.54-065228.7' -- Filter for the specific ALLWISE object","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,31.840330839157104,2025-07-23T19:21:37,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,9.454156398773192,2025-07-28T18:38:36,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,5,"-- Query to retrieve ZTF object identifier and distance for the ALLWISE object with identifier 'J163603.54-065228.7'SELECT     xmatch.oid, -- ZTF object identifier    xmatch.dist -- Distance to the closest ZTF object [arcsec]FROM     xmatchINNER JOIN     allwise ON xmatch.oid_catalog = allwise.oid_catalog -- Join on the catalog object identifierWHERE     allwise.oid_catalog = 'J163603.54-065228.7' -- Filter for the specific ALLWISE object","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.117833852767944,2025-07-23T19:21:52,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,9.014688730239868,2025-07-28T18:38:50,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,6,"SELECT     xmatch.oid,  -- ZTF object identifier    xmatch.dist  -- Distance to the closest ZTF object [arcsec]FROM     xmatchWHERE     xmatch.catid = 'ALLWISE'  -- Filter for the ALLWISE catalog    AND xmatch.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific object in ALLWISE","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,16.37302255630493,2025-07-23T19:22:09,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,9.053350687026978,2025-07-28T18:39:04,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,7,"-- Query to retrieve ZTF object identifier and distance for the ALLWISE object with identifier 'J163603.54-065228.7'SELECT     xmatch.oid,  -- ZTF object identifier    xmatch.dist  -- Distance to the closest ZTF object [arcsec]FROM     xmatchINNER JOIN     allwise ON xmatch.oid_catalog = allwise.oid_catalog  -- Join on the catalog object identifierWHERE     allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE object","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,18.80836606025696,2025-07-23T19:22:28,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,9.876380920410156,2025-07-28T18:39:19,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,8,"-- Query to retrieve ZTF object identifier and distance for the ALLWISE object with identifier 'J163603.54-065228.7'SELECT     xmatch.oid, -- ZTF object identifier    xmatch.dist -- Distance to the closest ZTF object [arcsec]FROM     xmatchINNER JOIN     allwise ON     xmatch.oid_catalog = allwise.oid_catalog -- Join condition on catalog object identifierWHERE     allwise.oid_catalog = 'J163603.54-065228.7' -- Filter for the specific ALLWISE object","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,18.47267317771912,2025-07-23T19:22:46,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,9.040791988372805,2025-07-28T18:39:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,9,"-- Retrieve the ZTF object identifier and distance for the ALLWISE object with identifier 'J163603.54-065228.7'SELECT     xmatch.oid,  -- ZTF object identifier    xmatch.dist  -- Distance to the closest ZTF object [arcsec]FROM     xmatchINNER JOIN     allwise ON xmatch.oid_catalog = allwise.oid_catalog  -- Join on the catalog object identifierWHERE     allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE object","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,16.8337082862854,2025-07-23T19:23:03,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,9.488850593566896,2025-07-28T18:39:48,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,81,10,"-- Retrieve the ZTF object identifier and the distance to the closest ZTF object-- for the ALLWISE object with identifier 'J163603.54-065228.7'SELECT     xmatch.oid,  -- ZTF object identifier    xmatch.dist  -- Distance to the closest ZTF object [arcsec]FROM     xmatchINNER JOIN     allwise ON xmatch.oid_catalog = allwise.oid_catalog  -- Join on the catalog object identifierWHERE     allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE object","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.605318307876589,2025-07-23T19:23:19,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,9.402403116226196,2025-07-28T18:40:03,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,69,0,"SELECT
    *
FROM
    ps1_ztf
WHERE
    oid IN ('ZTF21abstkhj','ZTF22aacqjeb','ZTF21aamwpdf')
    AND sgscore1 < 0.2",,,,,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,3.435452938079834,2025-07-28T18:40:08,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,1,"-- Query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztf pINNER JOIN catalog c ON p.oid = c.oidWHERE p.sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,4.521542072296143,2025-07-23T19:23:23,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,13.79526972770691,2025-07-28T18:40:30,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,2,"-- Query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.1582376956939697,2025-07-23T19:23:26,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,10.111232995986938,2025-07-28T18:40:45,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,3,"-- Query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.7276885509490967,2025-07-23T19:23:30,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,10.454476594924929,2025-07-28T18:41:01,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,4,"-- Query to find all rows in the 'ps1_ztf' table for specified ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.299851655960083,2025-07-23T19:23:34,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,9.574999809265137,2025-07-28T18:41:16,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,5,"-- Query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.0232248306274414,2025-07-23T19:23:37,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,10.610739946365356,2025-07-28T18:41:31,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,6,"-- Query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,4.170575380325317,2025-07-23T19:23:41,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,10.785282611846924,2025-07-28T18:41:47,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,7,"-- Query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.567036867141724,2025-07-23T19:23:45,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,10.568752527236938,2025-07-28T18:42:03,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,8,"-- Query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,4.005024671554565,2025-07-23T19:23:49,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,10.422138214111328,2025-07-28T18:42:19,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,9,"-- Query to find rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,4.037959098815918,2025-07-23T19:23:53,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,10.21243405342102,2025-07-28T18:42:34,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,69,10,"-- Query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers-- where the star/galaxy score of the nearest source is lower than 0.2WITH catalog (oid) AS (    VALUES         ('ZTF21abstkhj'),        ('ZTF22aacqjeb'),        ('ZTF21aamwpdf'))SELECT *FROM ps1_ztfWHERE oid IN (SELECT oid FROM catalog)  AND sgscore1 < 0.2","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,3.73406982421875,2025-07-23T19:23:57,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""AS""
LINE 11: ) AS c(oid) -- Alias the column name as 'oid' to match the '...
           ^

[SQL: 
-- Corrected query to find all rows in the 'ps1_ztf' table for specific ZTF identifiers
-- where the star/galaxy score of the nearest source is lower than 0.2

WITH catalog AS (
    -- Create a temporary table with the specified ZTF identifiers
    VALUES 
        ('ZTF21abstkhj'),
        ('ZTF22aacqjeb'),
        ('ZTF21aamwpdf')
) AS c(oid) -- Alias the column name as 'oid' to match the 'ps1_ztf' table
SELECT *
FROM ps1_ztf
WHERE oid IN (SELECT oid FROM catalog) -- Match the 'oid' column with the catalog
  AND sgscore1 < 0.2 -- Filter rows where the star/galaxy score of the nearest source is less than 0.2
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.963444948196411,2025-07-28T18:42:52,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,61,0,"SELECT
    *
FROM
    magstat
WHERE
    ndet >= 10
    AND magmedian > 19
    AND maglast < 17
ORDER BY oid
LIMIT 30
",,,,,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,12.33012342453003,2025-07-28T18:43:06,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,1,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,5.093992233276367,2025-07-23T19:24:02,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,11.131935358047484,2025-07-28T18:43:26,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,2,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.4793519973754883,2025-07-23T19:24:04,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,10.120545625686646,2025-07-28T18:43:43,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,3,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.1885151863098145,2025-07-23T19:24:06,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,9.864484310150146,2025-07-28T18:44:00,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,4,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,128.53543496131897,2025-07-23T19:26:15,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,10.68730401992798,2025-07-28T18:44:18,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,5,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,4.449378490447998,2025-07-23T19:26:20,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,9.92980980873108,2025-07-28T18:44:35,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,6,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.59629487991333,2025-07-23T19:26:22,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,9.935508966445925,2025-07-28T18:44:52,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,7,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.055353164672852,2025-07-23T19:26:24,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,10.453711986541748,2025-07-28T18:45:09,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,8,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.1933865547180176,2025-07-23T19:26:28,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,14.24993109703064,2025-07-28T18:45:30,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,9,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.6488170623779297,2025-07-23T19:26:30,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,9.422749280929564,2025-07-28T18:45:47,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,61,10,SELECT * FROM magstatWHERE ndet >= 10  AND magmedian > 19  AND maglast < 17ORDER BY oidLIMIT 30,"['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.9094552993774414,2025-07-23T19:26:33,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaafaj    1    False       True   543         0         NaN   
1   ZTF17aaaajin    1    False       True    27         1         NaN   
2   ZTF17aaaazob    1    False       True   595         0         NaN   
3   ZTF17aaadaqj    1    False       True   109         2         NaN   
4   ZTF17aaagzbe    1    False       True    44         0         NaN   
5   ZTF17aaahyqe    1    False       True   142         0         NaN   
6   ZTF17aaaihhg    1    False       True    12         0         NaN   
7   ZTF17aaakimh    2    False       True    31         0         NaN   
8   ZTF17aaakkku    1    False       True    12         0         NaN   
9   ZTF17aaaskut    1    False       True    32         0         NaN   
10  ZTF17aaastit    1    False       True   113         0         NaN   
11  ZTF17aaaswvx    1    False       True   626         2         NaN   
12  ZTF17aaatnbo    1    False       True    48         1         NaN   
13  ZTF17aaawcom    1    False       True   167         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabukrm    1    False       True   346         0         NaN   
18  ZTF17aabxonw    2    False       True    24         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacldol    2    False       True   340         0         NaN   
23  ZTF17aacomhx    2    False       True    24         1         NaN   
24  ZTF17aadfmzp    1    False       True    11         0         NaN   
25  ZTF18aaaaofg    1    False       True   126         1         NaN   
26  ZTF18aaadqso    2    False       True   108         0         NaN   
27  ZTF18aaajdrc    1    False       True    41         1         NaN   
28  ZTF18aaakpie    2    False       True    23         1         NaN   
29  ZTF18aaamgxp    2    False       True    15         0   -0.205313   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       20.352161   100.000000   
1        NaN            NaN       NaN  ...       16.318940    19.395094   
2        NaN            NaN       NaN  ...       18.349495    19.250978   
3        NaN            NaN       NaN  ...       16.816305    17.090448   
4        NaN            NaN       NaN  ...       17.365470    17.422337   
5        NaN            NaN       NaN  ...       20.069712    22.804115   
6        NaN            NaN       NaN  ...       17.421630    17.455881   
7        NaN            NaN       NaN  ...             NaN          NaN   
8        NaN            NaN       NaN  ...       16.144281    16.324556   
9        NaN            NaN       NaN  ...       17.704395    17.758635   
10       NaN            NaN       NaN  ...       16.442953    18.112616   
11       NaN            NaN       NaN  ...       18.349104    19.250978   
12       NaN            NaN       NaN  ...       17.135637    17.261750   
13       NaN            NaN       NaN  ...       19.099104    19.469353   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       20.262785   100.000000   
18       NaN            NaN       NaN  ...       17.251135    17.346697   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...       18.782711    20.460472   
23       NaN            NaN       NaN  ...             NaN          NaN   
24       NaN            NaN       NaN  ...       16.035013    16.058973   
25       NaN            NaN       NaN  ...       16.540580   100.000000   
26       NaN            NaN       NaN  ...       19.940691   100.000000   
27       NaN            NaN       NaN  ...       16.955814    17.002485   
28       NaN            NaN       NaN  ...             NaN          NaN   
29 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     15.406956      16.402906     16.106325      21.224947  58287.406   
1     16.245401       0.591529     19.395094      16.304100  58287.406   
2     14.514420       0.655273     14.871971      17.780094  58349.434   
3     16.205900       0.345946     16.205900            NaN  58382.460   
4     15.648982       0.269482     15.648982      17.358065  58437.430   
5     16.589040       1.203840     16.789545      18.917585  58371.516   
6     15.928150       0.414757     15.928150      17.446985  58441.460   
7           NaN            NaN           NaN            NaN  58422.350   
8     14.078731       0.589342     14.078731      16.132055  58431.227   
9     16.271450       0.350806     16.348988      17.441607  58352.426   
10    16.405207       0.495029     18.062143      16.432556  58374.473   
11    14.450059       0.715195     16.425968      17.780094  58349.434   
12    16.205920       0.224303     16.205920      16.905798  58382.460   
13    15.268386       1.541127     16.175684      19.311296  58693.320   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    15.798060       4.799358     15.805555      20.535583  58273.460   
18    16.228182       0.214038     16.228182      16.976244  58676.200   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22    15.087682       0.691946     16.486593      18.723999  58245.188   
23          NaN            NaN           NaN            NaN  58455.293   
24    15.296916       0.213511     15.296916      16.035013  59843.470   
25    16.453445       7.449521     21.514559      16.530027  58382.477   
26    14.369963       8.062789     15.070667      14.531776  58434.200   
27    15.961990       0.163007     15.961990      16.664300  58440.473   
28          NaN            NaN           NaN            NaN  58510.223   
29    16.190092       0.218214     17.169376      16.326408  58851.445   

      lastmjd  step_id_corr  saturation_rate  
0   60882.363        27.5.6              0.0  
1   60819.430        27.5.6              0.0  
2   60735.145        27.5.6              0.0  
3   60608.457        24.5.1              0.0  
4   60695.180        27.0.0              0.0  
5   60795.176        27.5.6              0.0  
6   59509.418        27.4.0              0.0  
7   60530.445        24.5.1              0.0  
8   60616.367        27.5.6              0.0  
9   59860.350        27.5.6              0.0  
10  60693.203        27.5.6              0.0  
11  60743.176        27.5.6              0.0  
12  60608.457        27.4.0              0.0  
13  60788.484        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60863.254        27.5.6              0.0  
18  60819.285        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.5.6              0.0  
21  60619.414        24.5.1              0.0  
22  60821.220        27.5.6              0.0  
23  60530.450        24.5.1              0.0  
24  60760.242        27.5.2              0.0  
25  60732.176        27.5.0              0.0  
26  60872.426        27.5.6              0.0  
27  60689.402        26.2.0              0.0  
28  60321.188        24.5.1              0.0  
29  59858.504           dev              0.0  

[30 rows x 28 columns]]",,10.221442461013794,2025-07-28T18:46:04,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,104,0,"SELECT
    sq1.oid,
    ss_ztf.candid, ss_ztf.ssdistnr, ss_ztf.ssmagnr,
    ss_ztf.ssnamenr, dataquality.fid,
    dataquality.fwhm, dataquality.nmatches,
    dataquality.exptime
FROM
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.9
    AND classifier_version = 'stamp_classifier_1.0.4'
LIMIT 30
) as sq1
INNER JOIN
ss_ztf
ON sq1.oid = ss_ztf.oid
INNER JOIN
dataquality
ON ss_ztf.oid = dataquality.oid
AND ss_ztf.candid = dataquality.candid",,,,,"[             oid               candid  ssdistnr  ssmagnr  ssnamenr  fid  \
0   ZTF21abiqudc  1642188423115015017       0.0     19.9     78682    2   
1   ZTF21abiqude  1642188426315015013       0.0     19.3    101529    2   
2   ZTF21abiqudk  1642188900815015015       0.0     18.8     62108    2   
3   ZTF21abiqudp  1642188900815015013       0.0     19.8      8037    2   
4   ZTF21abiqtwm  1642188425915015013       0.0     17.9     30094    2   
5   ZTF21abiqtky  1642187332915015006       0.0     19.7     53356    2   
6   ZTF21abiquav  1642187333615015001       0.0     19.6     27451    2   
7   ZTF21abiquar  1642187333615015002       0.0     18.9    119987    2   
8   ZTF21abiqufk  1642189363715015002       0.0     19.6     45417    2   
9   ZTF21abiqtfy  1642187330115015003       0.0     19.8     54305    2   
10  ZTF21abiqtia  1642187330015015005       0.0     18.7     28256    2   
11  ZTF21abiqufc  1642189360715015002       0.0     19.7     29678    2   
12  ZTF21abiqtyu  1642187811115015017       0.0     19.2     77500    2   
13  ZTF21abiqtmy  1642187810915015024       0.0     20.5    201878    2   
14  ZTF21abiqtyz  1642187810715015009       0.0     18.7     28510    2   
15  ZTF21abiqtzu  1642187812315015011       0.0     19.2     31206    2   
16  ZTF21abiqtue  1642187811715015005       0.0     20.8    129450    2   
17  ZTF21abiqtod  1642187331015015009       0.0     18.6      6109    2   
18  ZTF21abiqucs  1642188423915015013       0.0     18.5     53879    2   
19  ZTF21abiqtsb  1642188425315015017       0.0     18.7      8137    2   
20  ZTF21abiquij  1642189360415015020       0.0     19.3     34527    2   
21  ZTF21aaqosfm  1543178183915015000       0.0     18.9     72883    1   
22  ZTF21aaqosfj  1543178185615015005       1.0     17.6     37678    1   
23  ZTF21aaqosgd  1543179591715015010       0.0     16.5     18017    1   
24  ZTF21aaqosfo  1543178181215015005       1.0     18.6  1999VX15    1   
25  ZTF21aaqoshn  1543179590715015007       1.0     17.7    283889    1   
26  ZTF21aaqosgk  1543179123615015003       0.0     17.1     33997    1   
27  ZTF21aaqosgr  1543179122615015001       0.0     18.5     83619    1   
28  ZTF21aaqosgy  1543179121715015012       0.0     17.5     66176    1   
29  ZTF21aaqoshw  1543179596015015002       0.0     18.3    152057    1   

        fwhm  nmatches  exptime  
0   2.190000      1616     30.0  
1   2.110000      1476     30.0  
2   1.940000      1259     30.0  
3   1.820000      1259     30.0  
4   1.930000      1527     30.0  
5   2.130000       398     30.0  
6   2.020000       369     30.0  
7   1.420000       369     30.0  
8   1.850000       909     30.0  
9   1.760000       484     30.0  
10  1.720000       472     30.0  
11  1.970000      1082     30.0  
12  1.980000       393     30.0  
13  1.580000       405     30.0  
14  1.890000       408     30.0  
15  1.990000       349     30.0  
16  1.096867       343     30.0  
17  1.770000       427     30.0  
18  1.820000      1712     30.0  
19  1.920000      1381     30.0  
20  1.740000       933     30.0  
21  3.570000       165     30.0  
22  4.280000       398     30.0  
23  3.650000       246     30.0  
24  4.210000       665     30.0  
25  5.610000       346     30.0  
26  4.840000       334     30.0  
27  3.830000       348     30.0  
28  5.040000       252     30.0  
29  4.060000       324     30.0  ]",,4.286479711532593,2025-07-28T18:46:11,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,104,1,"-- Final query to retrieve at most 30 ZTF objects classified as asteroids with probability > 0.9-- using the stamp classifier version 'stamp_classifier_1.0.4', including the specified columns.WITH filtered_probability AS (    SELECT         oid    FROM         probability    WHERE         class_name = 'asteroid'        AND classifier_name = 'stamp_classifier'        AND classifier_version = 'stamp_classifier_1.0.4'        AND probability > 0.9        AND ranking = 1),ss_ztf_data AS (    SELECT         ss.oid,        ss.candid,        ss.ssdistnr,        ss.ssmagnr,        ss.ssnamenr    FROM         ss_ztf ss    INNER JOIN         filtered_probability fp    ON         ss.oid = fp.oid),detection_data AS (    SELECT         d.oid,        d.candid,        d.fid,        d.fwhm,        d.nid AS ncalib, -- Assuming 'nid' corresponds to the number of PS1 calibrators used        d.exptime    FROM         detection d    INNER JOIN         filtered_probability fp    ON         d.oid = fp.oid)SELECT     ss.oid AS ztf_object_id,    ss.candid AS candidate_id,    ss.ssdistnr AS distance_to_nearest_sso,    ss.ssmagnr AS mpc_archive_magnitude,    ss.ssnamenr AS mpc_archive_name,    d.fid AS filter_id,    d.fwhm AS fwhm_from_sextractor,    d.ncalib AS ps1_calibrators_used,    d.exptime AS exposure_timeFROM     ss_ztf_data ssINNER JOIN     detection_data dON     ss.oid = d.oid    AND ss.candid = d.candidLIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,56.74768137931824,2025-07-23T19:27:30,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 39:         d.fwhm,
                 ^

[SQL: 
-- Corrected query to retrieve at most 30 ZTF objects classified as asteroids with probability > 0.9
-- using the stamp classifier version 'stamp_classifier_1.0.4', including the specified columns.

WITH filtered_probability AS (
    -- Filter objects classified as 'asteroid' with probability > 0.9 and ranking = 1
    SELECT 
        oid
    FROM 
        probability
    WHERE 
        class_name = 'asteroid'
        AND classifier_name = 'stamp_classifier'
        AND classifier_version = 'stamp_classifier_1.0.4'
        AND probability > 0.9
        AND ranking = 1
),
ss_ztf_data AS (
    -- Retrieve Solar System object data for filtered objects
    SELECT 
        ss.oid,
        ss.candid,
        ss.ssdistnr,
        ss.ssmagnr,
        ss.ssnamenr
    FROM 
        ss_ztf ss
    INNER JOIN 
        filtered_probability fp
    ON 
        ss.oid = fp.oid
),
detection_data AS (
    -- Retrieve detection data for filtered objects
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.fwhm,
        d.nid AS ncalib, -- 'nid' corresponds to the number of PS1 calibrators used
        d.exptime
    FROM 
        detection d
    INNER JOIN 
        filtered_probability fp
    ON 
        d.oid = fp.oid
)
-- Final SELECT to combine data from ss_ztf_data and detection_data
SELECT 
    ss.oid AS ztf_object_id,
    ss.candid AS candidate_id,
    ss.ssdistnr AS distance_to_nearest_sso,
    ss.ssmagnr AS mpc_archive_magnitude,
    ss.ssnamenr AS mpc_archive_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    ss_ztf_data ss
INNER JOIN 
    detection_data d
ON 
    ss.oid = d.oid
    AND ss.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.022918939590454,2025-07-28T18:46:30,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,2,"-- [FINAL QUERY HERE]SELECT     p.oid AS ztf_object_id,    s.candid AS candidate_id,    s.ssdistnr AS distance_to_nearest_solar_system_object,    s.ssmagnr AS mpc_archive_magnitude,    s.ssnamenr AS solar_system_object_name,    d.fid AS filter_identifier,    d.fwhm AS fwhm_from_sextractor,    d.ncalib AS number_of_ps1_calibrators,    d.exptime AS exposure_timeFROM     probability pINNER JOIN     ss_ztf s ON p.oid = s.oidINNER JOIN     detection d ON p.oid = d.oidWHERE     p.class_name = 'asteroid'    AND p.classifier_name = 'stamp_classifier'    AND p.classifier_version = 'stamp_classifier_1.0.4'    AND p.probability > 0.9    AND p.ranking = 1LIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,28.81893801689148,2025-07-23T19:27:59,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 10:     d.fwhm AS fwhm_from_sextractor, 
             ^

[SQL: 
-- [FINAL QUERY HERE]
SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_to_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS solar_system_object_name, 
    d.fid AS filter_identifier, 
    d.fwhm AS fwhm_from_sextractor, 
    d.nid AS number_of_ps1_calibrators, 
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.378953218460085,2025-07-28T18:46:45,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,3,"-- Final Query to retrieve at most 30 ZTF objects with a probability > 0.9 of being an asteroid-- in the stamp classifier version 'stamp_classifier_1.0.4', including the specified columns.SELECT     o.oid AS ztf_object_id,     s.candid AS candidate_id,     s.ssdistnr AS distance_to_nearest_solar_system_object,     s.ssmagnr AS mpc_archive_magnitude,     s.ssnamenr AS mpc_archive_name,     d.fid AS filter_identifier,     d.distnr AS fwhm_from_sextractor,     d.rb AS number_of_ps1_calibrators_used,     d.exposure_time AS exposure_timeFROM     probability pINNER JOIN     object o ON p.oid = o.oidINNER JOIN     ss_ztf s ON o.oid = s.oidINNER JOIN     detection d ON o.oid = d.oidWHERE     p.class_name = 'asteroid'     AND p.classifier_name = 'stamp_classifier'     AND p.classifier_version = 'stamp_classifier_1.0.4'     AND p.probability > 0.9     AND p.ranking = 1LIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,47.37856936454773,2025-07-23T19:28:46,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 12:     d.fwhm AS fwhm_from_sextractor, -- Corrected column name...
             ^

[SQL: 
-- Corrected Final Query to retrieve at most 30 ZTF objects with a probability > 0.9 of being an asteroid
-- in the stamp classifier version 'stamp_classifier_1.0.4', including the specified columns.

SELECT 
    o.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_to_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS mpc_archive_name, 
    d.fid AS filter_identifier, 
    d.fwhm AS fwhm_from_sextractor, -- Corrected column name for FWHM
    d.ncalib AS number_of_ps1_calibrators_used, -- Corrected column name for PS1 calibrators
    d.exptime AS exposure_time -- Corrected column name for exposure time
FROM 
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid -- Corrected join condition to use candid for detection
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.415269374847412,2025-07-28T18:47:03,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,4,"-- Final query to retrieve at most 30 ZTF objects classified as 'asteroid' with a probability > 0.9-- in the stamp classifier version 'stamp_classifier_1.0.4', including the specified columns.SELECT     p.oid AS ztf_object_id,     s.candid AS candidate_id,     s.ssdistnr AS distance_to_nearest_solar_system_object,     s.ssmagnr AS mpc_archive_magnitude,     s.ssnamenr AS mpc_archive_name,     d.fid AS filter_identifier,     d.fwhm AS fwhm_from_sextractor,     d.nid AS number_of_ps1_calibrators_used,     d.exptime AS exposure_timeFROM     probability pINNER JOIN     ss_ztf s ON p.oid = s.oidINNER JOIN     detection d ON p.oid = d.oidWHERE     p.class_name = 'asteroid'     AND p.classifier_name = 'stamp_classifier'     AND p.classifier_version = 'stamp_classifier_1.0.4'     AND p.probability > 0.9     AND p.ranking = 1LIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.017574787139893,2025-07-23T19:29:10,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 14:     d.exptime AS exposure_time
             ^

[SQL: 
-- Corrected query to retrieve at most 30 ZTF objects classified as 'asteroid' with a probability > 0.9
-- in the stamp classifier version 'stamp_classifier_1.0.4', including the specified columns.

SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_to_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS mpc_archive_name, 
    d.fid AS filter_identifier, 
    d.distnr AS fwhm_from_sextractor, -- Corrected column name for FWHM
    d.nid AS number_of_ps1_calibrators_used, 
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid -- Corrected join condition to use candid for detection
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.164018869400024,2025-07-28T18:47:19,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,5,"-- Final query to retrieve at most 30 ZTF objects classified as 'asteroid' with a probability > 0.9-- using the classifier version 'stamp_classifier_1.0.4', including the specified columns.SELECT     p.oid AS ztf_object_id,     s.candid AS candidate_id,     s.ssdistnr AS distance_to_nearest_solar_system_object,     s.ssmagnr AS mpc_archive_magnitude,     s.ssnamenr AS mpc_archive_name,     d.fid AS filter_identifier,     d.fwhm AS fwhm_from_sextractor,     d.nid AS number_of_ps1_calibrators_used,     d.exptime AS exposure_timeFROM     probability pINNER JOIN     ss_ztf s ON p.oid = s.oidINNER JOIN     detection d ON p.oid = d.oidWHERE     p.class_name = 'asteroid'     AND p.classifier_name = 'stamp_classifier'     AND p.classifier_version = 'stamp_classifier_1.0.4'     AND p.probability > 0.9     AND p.ranking = 1LIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,25.286662578582764,2025-07-23T19:29:35,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 14:     d.exptime AS exposure_time -- Corrected column name for ...
             ^

[SQL: 
-- Corrected query to retrieve at most 30 ZTF objects classified as 'asteroid' with a probability > 0.9
-- using the classifier version 'stamp_classifier_1.0.4', including the specified columns.

SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_to_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS mpc_archive_name, 
    d.fid AS filter_identifier, 
    d.distnr AS fwhm_from_sextractor, -- Corrected column name for FWHM
    d.nid AS number_of_ps1_calibrators_used, 
    d.exptime AS exposure_time -- Corrected column name for exposure time
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid -- Corrected join condition to use candid for detection
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",17.363254070281982,2025-07-28T18:47:42,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,6,"-- [FINAL QUERY HERE]SELECT     obj.oid AS ztf_object_id,    ss.candid AS candidate_id,    ss.ssdistnr AS distance_to_nearest_solar_system_object,    ss.ssmagnr AS mpc_archive_magnitude,    ss.ssnamenr AS mpc_archive_name,    det.fid AS filter_identifier,    det.distnr AS fwhm_from_sextractor,    det.rb AS number_of_ps1_calibrators_used,    det.exposure_time AS exposure_timeFROM     (SELECT oid      FROM probability      WHERE          class_name = 'asteroid'          AND classifier_name = 'stamp_classifier'          AND classifier_version = 'stamp_classifier_1.0.4'          AND probability > 0.9          AND ranking = 1    ) AS probINNER JOIN object obj ON prob.oid = obj.oidINNER JOIN ss_ztf ss ON obj.oid = ss.oidINNER JOIN detection det ON obj.oid = det.oidLIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,26.053998708724976,2025-07-23T19:30:01,[None],"(psycopg2.errors.UndefinedColumn) column det.fwhm does not exist
LINE 10:     det.fwhm AS fwhm_from_sextractor, 
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    obj.oid AS ztf_object_id, 
    ss.candid AS candidate_id, 
    ss.ssdistnr AS distance_to_nearest_solar_system_object, 
    ss.ssmagnr AS mpc_archive_magnitude, 
    ss.ssnamenr AS mpc_archive_name, 
    det.fid AS filter_identifier, 
    det.fwhm AS fwhm_from_sextractor, 
    det.rb AS number_of_ps1_calibrators_used, 
    det.exptime AS exposure_time
FROM 
    (SELECT oid 
     FROM probability 
     WHERE 
         class_name = 'asteroid' 
         AND classifier_name = 'stamp_classifier' 
         AND classifier_version = 'stamp_classifier_1.0.4' 
         AND probability > 0.9 
         AND ranking = 1
    ) AS prob
INNER JOIN object obj ON prob.oid = obj.oid
INNER JOIN ss_ztf ss ON obj.oid = ss.oid
INNER JOIN detection det ON obj.oid = det.oid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.218186140060425,2025-07-28T18:48:02,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,7,"-- [FINAL QUERY HERE]SELECT     p.oid AS ztf_object_id,    s.candid AS candidate_id,    s.ssdistnr AS distance_to_nearest_solar_system_object,    s.ssmagnr AS mpc_archive_magnitude,    s.ssnamenr AS mpc_archive_name,    d.fid AS filter_id,    d.fwhm AS fwhm_from_sextractor,    d.ncalib AS number_of_ps1_calibrators,    d.exptime AS exposure_timeFROM     probability pINNER JOIN     ss_ztf s ON p.oid = s.oidINNER JOIN     detection d ON p.oid = d.oidWHERE     p.class_name = 'asteroid'    AND p.classifier_name = 'stamp_classifier'    AND p.classifier_version = 'stamp_classifier_1.0.4'    AND p.probability > 0.9    AND p.ranking = 1LIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,41.97374629974365,2025-07-23T19:30:43,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 12:     d.exptime AS exposure_time
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_to_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS mpc_archive_name, 
    d.fid AS filter_id, 
    d.magpsf_corr AS fwhm_from_sextractor, -- Corrected column name for FWHM
    d.nid AS number_of_ps1_calibrators, -- Corrected column name for PS1 calibrators
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON p.oid = d.oid
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.611283302307127,2025-07-28T18:48:18,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,8,"-- [FINAL QUERY HERE]SELECT     p.oid AS ztf_object_id,    s.candid AS candidate_id,    s.ssdistnr AS distance_to_nearest_solar_system_object,    s.ssmagnr AS mpc_archive_magnitude,    s.ssnamenr AS mpc_archive_name,    d.fid AS filter_id,    d.fwhm AS fwhm_from_sextractor,    d.num_ps1_calib AS num_ps1_calibrators_used,    d.exptime AS exposure_timeFROM     probability pINNER JOIN     object o ON p.oid = o.oidINNER JOIN     ss_ztf s ON o.oid = s.oidINNER JOIN     detection d ON o.oid = d.oidWHERE     p.class_name = 'asteroid'    AND p.classifier_name = 'stamp_classifier'    AND p.classifier_version = 'stamp_classifier_1.0.4'    AND p.probability > 0.9    AND p.ranking = 1LIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,31.71809458732605,2025-07-23T19:31:15,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 10:     d.fwhm AS fwhm_from_sextractor, 
             ^

[SQL: 
-- Corrected Query
SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_to_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS mpc_archive_name, 
    d.fid AS filter_id, 
    d.fwhm AS fwhm_from_sextractor, 
    d.rb AS num_ps1_calibrators_used, -- Corrected column name for PS1 calibrators
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.024979591369627,2025-07-28T18:48:34,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,9,"-- [FINAL QUERY HERE]SELECT     p.oid AS ztf_object_id,    s.candid AS candidate_id,    s.ssdistnr AS distance_to_nearest_solar_system_object,    s.ssmagnr AS mpc_archive_magnitude,    s.ssnamenr AS mpc_archive_name,    d.fid AS filter_identifier,    d.magpsf AS fwhm_from_sextractor,    d.nid AS number_of_ps1_calibrators_used,    d.exposure_time AS exposure_timeFROM     probability pINNER JOIN     ss_ztf s ON p.oid = s.oidINNER JOIN     detection d ON p.oid = d.oidWHERE     p.class_name = 'asteroid'    AND p.classifier_name = 'stamp_classifier'    AND p.classifier_version = 'stamp_classifier_1.0.4'    AND p.probability > 0.9    AND p.ranking = 1LIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,24.77300715446472,2025-07-23T19:31:40,[None],"(psycopg2.errors.UndefinedColumn) column d.fwhm does not exist
LINE 10:     d.fwhm AS fwhm_from_sextractor, 
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_to_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS mpc_archive_name, 
    d.fid AS filter_identifier, 
    d.fwhm AS fwhm_from_sextractor, 
    d.ncalib AS number_of_ps1_calibrators_used, 
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",16.929420232772827,2025-07-28T18:48:57,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,104,10,"-- Final Query to retrieve at most 30 ZTF objects classified as 'asteroid' with probability > 0.9-- in the stamp classifier version 'stamp_classifier_1.0.4', including the specified columns.SELECT     p.oid AS ztf_object_id,  -- ZTF object identifier    s.candid AS candidate_id,  -- Candidate identifier    s.ssdistnr AS distance_to_nearest_ss_object,  -- Distance to nearest Solar System object    s.ssmagnr AS mpc_archive_magnitude,  -- Magnitude of nearest Solar System object    s.ssnamenr AS mpc_archive_name,  -- Name of nearest Solar System object    d.fid AS filter_id,  -- Filter identifier    d.fwhm AS fwhm_sextractor,  -- FWHM from SExtractor    d.nid AS ps1_calibrators_used,  -- Number of PS1 calibrators used    d.exptime AS exposure_time  -- Exposure timeFROM     probability pINNER JOIN     ss_ztf s ON p.oid = s.oid  -- Join with ss_ztf table to get Solar System object informationINNER JOIN     detection d ON p.oid = d.oid  -- Join with detection table to get detection-related informationWHERE     p.class_name = 'asteroid'  -- Filter for objects classified as 'asteroid'    AND p.classifier_name = 'stamp_classifier'  -- Use the stamp classifier    AND p.classifier_version = 'stamp_classifier_1.0.4'  -- Specific classifier version    AND p.probability > 0.9  -- Probability greater than 0.9    AND p.ranking = 1  -- Only the most likely classificationLIMIT 30  -- Limit the results to at most 30 objects","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,34.43267822265625,2025-07-23T19:32:14,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 14:     d.exptime AS exposure_time  -- Exposure time
             ^

[SQL: 
-- Corrected Final Query to retrieve at most 30 ZTF objects classified as 'asteroid' with probability > 0.9
-- in the stamp classifier version 'stamp_classifier_1.0.4', including the specified columns.

SELECT 
    p.oid AS ztf_object_id,  -- ZTF object identifier
    s.candid AS candidate_id,  -- Candidate identifier
    s.ssdistnr AS distance_to_nearest_ss_object,  -- Distance to nearest Solar System object
    s.ssmagnr AS mpc_archive_magnitude,  -- Magnitude of nearest Solar System object
    s.ssnamenr AS mpc_archive_name,  -- Name of nearest Solar System object
    d.fid AS filter_id,  -- Filter identifier
    d.distnr AS fwhm_sextractor,  -- FWHM from SExtractor (corrected column name)
    d.nid AS ps1_calibrators_used,  -- Number of PS1 calibrators used
    d.exptime AS exposure_time  -- Exposure time
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid  -- Join with ss_ztf table to get Solar System object information
INNER JOIN 
    detection d ON s.candid = d.candid  -- Join with detection table using candid (corrected join condition)
WHERE 
    p.class_name = 'asteroid'  -- Filter for objects classified as 'asteroid'
    AND p.classifier_name = 'stamp_classifier'  -- Use the stamp classifier
    AND p.classifier_version = 'stamp_classifier_1.0.4'  -- Specific classifier version
    AND p.probability > 0.9  -- Probability greater than 0.9
    AND p.ranking = 1  -- Only the most likely classification
LIMIT 30  -- Limit the results to at most 30 objects
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.490683794021606,2025-07-28T18:49:16,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,71,0,"SELECT
    rfid, oid, candid, magnr, sigmagnr
FROM
    reference
WHERE
    oid IN ('ZTF20aczxeud','ZTF21aappfdu','ZTF22aacqjeb')
    AND fid = 1
ORDER BY oid",,,,,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,3.322115898132324,2025-07-28T18:49:22,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,71,1,"-- Query to retrieve information from the 'reference' table for specific ZTF identifiers in the g bandSELECT     rfid,       -- Reference identifier    oid,        -- ZTF identifier    candid,     -- Candidate identifier    magnr,      -- Magnitude of the nearest reference object    sigmagnr    -- Uncertainty in the magnitude of the nearest reference objectFROM     referenceWHERE     oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') -- Filter by specific ZTF identifiers    AND fid = 1                                             -- Filter for g band (fid = 1)ORDER BY     oid                                                    -- Sort results by ZTF identifier","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,22.62612676620484,2025-07-23T19:32:37,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,8.599831581115723,2025-07-28T18:49:39,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,71,2,"-- Query to retrieve rows from the 'reference' table for specific ZTF identifiers in the g bandSELECT     rfid,       -- Reference identifier    oid,        -- ZTF identifier    candid,     -- Candidate identifier    magnr,      -- Magnitude of the nearest reference object    sigmagnr    -- Uncertainty in the magnitude of the nearest reference objectFROM     referenceWHERE     oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') -- Filter by specific ZTF identifiers    AND fid = 1                                             -- Filter for g band (fid = 1)ORDER BY     oid -- Sort results by ZTF identifier","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,20.808937549591064,2025-07-23T19:32:58,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,8.57595443725586,2025-07-28T18:49:53,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,71,3,"-- Query to retrieve rows from the 'reference' table for specific ZTF identifiers and g bandSELECT     rfid,       -- Identifier of the reference    oid,        -- ZTF identifier    candid,     -- Candidate identifier    magnr,      -- Magnitude of the nearest reference object    sigmagnr    -- Uncertainty in the magnitude of the nearest reference objectFROM     referenceWHERE     oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') -- Filter for specific ZTF identifiers    AND fid = 1                                             -- Filter for g band (fid = 1)ORDER BY     oid -- Sort results by ZTF identifier","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,20.31647062301636,2025-07-23T19:33:18,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,8.340252876281738,2025-07-28T18:50:07,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,71,4,"-- Query to retrieve information from the 'reference' table for specific ZTF identifiers in the g bandSELECT     rfid,       -- Reference identifier    oid,        -- ZTF identifier    candid,     -- Candidate identifier    magnr,      -- Magnitude of the nearest reference object    sigmagnr    -- Uncertainty in the magnitude of the nearest reference objectFROM     referenceWHERE     oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') -- Filter by specific ZTF identifiers    AND fid = 1                                             -- Filter for g band (fid = 1)ORDER BY     oid -- Sort results by ZTF identifier","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,18.478044748306274,2025-07-23T19:33:37,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,10.913318634033203,2025-07-28T18:50:24,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,71,5,"-- Query to retrieve information from the 'reference' table for specific ZTF identifiers in the g bandSELECT     rfid,       -- Reference identifier    oid,        -- ZTF identifier    candid,     -- Candidate identifier    magnr,      -- Magnitude of the nearest reference object    sigmagnr    -- Uncertainty in the magnitude of the nearest reference objectFROM     referenceWHERE     oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') -- Filter for specific ZTF identifiers    AND fid = 1                                             -- Filter for g band (fid = 1)ORDER BY     oid -- Sort results by ZTF identifier","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,20.17418146133423,2025-07-23T19:33:57,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,10.039897918701172,2025-07-28T18:57:49,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,71,6,"WITH catalog (oid) AS (    VALUES         ('ZTF20aczxeud'),        ('ZTF21aappfdu'),        ('ZTF22aacqjeb'))SELECT     r.rfid AS reference_id,     r.oid AS ztf_id,     r.candid AS candidate_id,     r.magnr AS magnitude_nearest,     r.sigmagnr AS magnitude_uncertaintyFROM     reference rINNER JOIN     catalog cON     r.oid = c.oidWHERE     r.fid = 1 -- g band filterORDER BY     r.oid","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.2313294410705566,2025-07-23T19:34:00,"[   reference_id        ztf_id         candidate_id  magnitude_nearest  \
0     371120103  ZTF20aczxeud  1601274780315015114             16.132   
1     313120115  ZTF21aappfdu  1539274811515015018             18.253   
2     313120115  ZTF22aacqjeb  1886297531515015012             18.253   

   magnitude_uncertainty  
0                  0.048  
1                  0.065  
2                  0.065  ]",,8.508809566497803,2025-07-28T18:58:04,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,71,7,"WITH catalog (oid) AS (    VALUES         ('ZTF20aczxeud'),        ('ZTF21aappfdu'),        ('ZTF22aacqjeb'))SELECT     r.rfid AS reference_id,     r.oid AS ztf_id,     r.candid AS candidate_id,     r.magnr AS magnitude_nearest,     r.sigmagnr AS magnitude_uncertaintyFROM     reference rINNER JOIN     catalog cON     r.oid = c.oidWHERE     r.fid = 1 -- g band filterORDER BY     r.oid","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.942505121231079,2025-07-23T19:34:04,"[   reference_id        ztf_id         candidate_id  magnitude_nearest  \
0     371120103  ZTF20aczxeud  1601274780315015114             16.132   
1     313120115  ZTF21aappfdu  1539274811515015018             18.253   
2     313120115  ZTF22aacqjeb  1886297531515015012             18.253   

   magnitude_uncertainty  
0                  0.048  
1                  0.065  
2                  0.065  ]",,9.73349380493164,2025-07-28T18:58:20,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,71,8,"WITH catalog (oid) AS (    VALUES         ('ZTF20aczxeud'),        ('ZTF21aappfdu'),        ('ZTF22aacqjeb'))SELECT     r.rfid AS reference_id,     r.oid AS ztf_id,     r.candid AS candidate_id,     r.magnr AS magnitude_nearest_reference,     r.sigmagnr AS magnitude_uncertaintyFROM     reference rINNER JOIN     catalog cON     r.oid = c.oidWHERE     r.fid = 1 -- g band filterORDER BY     r.oid","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.768743276596069,2025-07-23T19:34:08,"[   reference_id        ztf_id         candidate_id  \
0     371120103  ZTF20aczxeud  1601274780315015114   
1     313120115  ZTF21aappfdu  1539274811515015018   
2     313120115  ZTF22aacqjeb  1886297531515015012   

   magnitude_nearest_reference  magnitude_uncertainty  
0                       16.132                  0.048  
1                       18.253                  0.065  
2                       18.253                  0.065  ]",,9.95309352874756,2025-07-28T18:58:36,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,71,9,"-- Query to find all rows in the 'reference' table for specific ZTF identifiers in the g bandWITH catalog (oid) AS (    VALUES         ('ZTF20aczxeud'),        ('ZTF21aappfdu'),        ('ZTF22aacqjeb'))SELECT     r.rfid AS reference_id,     r.oid AS ztf_id,     r.candid AS candidate_id,     r.magnr AS magnitude_nearest,     r.sigmagnr AS magnitude_uncertaintyFROM     reference rINNER JOIN     catalog c ON r.oid = c.oidWHERE     r.fid = 1 -- g band filterORDER BY     r.oid","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.871248245239258,2025-07-23T19:34:12,"[   reference_id        ztf_id         candidate_id  magnitude_nearest  \
0     371120103  ZTF20aczxeud  1601274780315015114             16.132   
1     313120115  ZTF21aappfdu  1539274811515015018             18.253   
2     313120115  ZTF22aacqjeb  1886297531515015012             18.253   

   magnitude_uncertainty  
0                  0.048  
1                  0.065  
2                  0.065  ]",,9.849612951278688,2025-07-28T18:58:52,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,71,10,"-- Query to retrieve information from the 'reference' table for specific ZTF identifiers in the g-bandSELECT     rfid,       -- Identifier of the reference    oid,        -- ZTF identifier    candid,     -- Candidate identifier    magnr,      -- Magnitude of the nearest reference object    sigmagnr    -- Uncertainty in the magnitude of the nearest reference objectFROM     referenceWHERE     oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') -- Filter for specific ZTF identifiers    AND fid = 1                                             -- Filter for g-band (fid = 1)ORDER BY     oid -- Sort results by ZTF identifier","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,27.141483068466187,2025-07-23T19:34:39,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,12.770888090133669,2025-07-28T18:59:11,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,42,0,"SELECT
    oid, candid, fid, chipsf, fwhm, classtar,
    nbad, magzpsci, magzpsciunc, exptime
FROM
    dataquality
WHERE
    oid = 'ZTF21aapnixl'
ORDER BY chipsf
",,,,,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,4.408031702041626,2025-07-28T18:59:18,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,42,1,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_of_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,5.735076904296875,2025-07-23T19:34:45,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_of_bad_pixels  zp_magnitude  \
0         1.248978              0.876                     0     26.197325   
1         2.540000              0.992                     0     26.321283   
2         1.435979              0.931                     0     26.299805   
3         2.340000              0.993                     0     26.338717   
4         2.530000              0.763                     0     26.294783   
5         2.540000              0.979                     0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,11.127018928527832,2025-07-28T18:59:38,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,2,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_of_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.412503957748413,2025-07-23T19:34:49,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_of_bad_pixels  zp_magnitude  \
0         1.248978              0.876                     0     26.197325   
1         2.540000              0.992                     0     26.321283   
2         1.435979              0.931                     0     26.299805   
3         2.340000              0.993                     0     26.338717   
4         2.530000              0.763                     0     26.294783   
5         2.540000              0.979                     0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,11.219112396240234,2025-07-28T18:59:55,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,3,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.6600570678710938,2025-07-23T19:34:52,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_bad_pixels  zp_magnitude  \
0         1.248978              0.876                  0     26.197325   
1         2.540000              0.992                  0     26.321283   
2         1.435979              0.931                  0     26.299805   
3         2.340000              0.993                  0     26.338717   
4         2.530000              0.763                  0     26.294783   
5         2.540000              0.979                  0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,10.346961498260498,2025-07-28T19:00:11,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,4,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_of_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.347741842269897,2025-07-23T19:34:56,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_of_bad_pixels  zp_magnitude  \
0         1.248978              0.876                     0     26.197325   
1         2.540000              0.992                     0     26.321283   
2         1.435979              0.931                     0     26.299805   
3         2.340000              0.993                     0     26.338717   
4         2.530000              0.763                     0     26.294783   
5         2.540000              0.979                     0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,9.079097986221312,2025-07-28T19:00:26,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,5,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_of_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,5.239951133728027,2025-07-23T19:35:01,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_of_bad_pixels  zp_magnitude  \
0         1.248978              0.876                     0     26.197325   
1         2.540000              0.992                     0     26.321283   
2         1.435979              0.931                     0     26.299805   
3         2.340000              0.993                     0     26.338717   
4         2.530000              0.763                     0     26.294783   
5         2.540000              0.979                     0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,10.723875761032104,2025-07-28T19:00:43,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,6,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_of_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.251261234283448,2025-07-23T19:35:04,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_of_bad_pixels  zp_magnitude  \
0         1.248978              0.876                     0     26.197325   
1         2.540000              0.992                     0     26.321283   
2         1.435979              0.931                     0     26.299805   
3         2.340000              0.993                     0     26.338717   
4         2.530000              0.763                     0     26.294783   
5         2.540000              0.979                     0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,10.15740728378296,2025-07-28T19:00:59,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,7,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.107594728469849,2025-07-23T19:35:09,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_bad_pixels  zp_magnitude  \
0         1.248978              0.876                  0     26.197325   
1         2.540000              0.992                  0     26.321283   
2         1.435979              0.931                  0     26.299805   
3         2.340000              0.993                  0     26.338717   
4         2.530000              0.763                  0     26.294783   
5         2.540000              0.979                  0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,12.16068434715271,2025-07-28T19:01:17,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,8,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,10.061144351959229,2025-07-23T19:35:19,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_bad_pixels  zp_magnitude  \
0         1.248978              0.876                  0     26.197325   
1         2.540000              0.992                  0     26.321283   
2         1.435979              0.931                  0     26.299805   
3         2.340000              0.993                  0     26.338717   
4         2.530000              0.763                  0     26.294783   
5         2.540000              0.979                  0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,11.416098833084106,2025-07-28T19:01:36,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,9,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.849003076553345,2025-07-23T19:35:24,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_bad_pixels  zp_magnitude  \
0         1.248978              0.876                  0     26.197325   
1         2.540000              0.992                  0     26.321283   
2         1.435979              0.931                  0     26.299805   
3         2.340000              0.993                  0     26.338717   
4         2.530000              0.763                  0     26.294783   
5         2.540000              0.979                  0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,13.069524049758911,2025-07-28T19:01:54,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,42,10,"SELECT     dq.oid AS object_id,     dq.candid AS candidate_id,     dq.fid AS filter_id,     dq.chipsf AS reduced_chi_square,     dq.fwhm AS fwhm_sextractor,     dq.classtar AS star_galaxy_score,     dq.nbad AS number_bad_pixels,     dq.magzpsci AS zp_magnitude,     dq.magzpsciunc AS zp_magnitude_uncertainty,     dq.exptime AS exposure_timeFROM     dataquality dqWHERE     dq.oid = 'ZTF21aapnixl'ORDER BY     dq.chipsf ASC","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.488207101821899,2025-07-23T19:35:28,"[      object_id         candidate_id  filter_id  reduced_chi_square  \
0  ZTF21aapnixl  1538534064015015007          2            0.993519   
1  ZTF21aapnixl  1536538794015015004          2            1.009326   
2  ZTF21aapnixl  1537537024015015004          2            1.243430   
3  ZTF21aapnixl  1536541194015015010          2            1.246692   
4  ZTF21aapnixl  1537534614015015007          2            1.422183   
5  ZTF21aapnixl  1543529474015015016          2            1.682237   

   fwhm_sextractor  star_galaxy_score  number_bad_pixels  zp_magnitude  \
0         1.248978              0.876                  0     26.197325   
1         2.540000              0.992                  0     26.321283   
2         1.435979              0.931                  0     26.299805   
3         2.340000              0.993                  0     26.338717   
4         2.530000              0.763                  0     26.294783   
5         2.540000              0.979                  0     26.292053   

   zp_magnitude_uncertainty  exposure_time  
0                  0.000002           30.0  
1                  0.000002           30.0  
2                  0.000003           30.0  
3                  0.000003           30.0  
4                  0.000003           30.0  
5                  0.000003           30.0  ]",,13.89905309677124,2025-07-28T19:02:14,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,107,0,"SELECT
    object.oid, ndet, firstmjd, lastmjd,
    probability, ss_ztf.candid, ssdistnr,
    ssnamenr, mjd, fid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ss_ztf
    ON object.oid = ss_ztf.oid
    INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ndet > 500
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.5
    AND classifier_version = 'stamp_classifier_1.0.4'
    AND ssdistnr < 2
ORDER BY firstmjd
LIMIT 10
",,,,,"[            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   789  58279.169583  60855.216528          1.0   
1  ZTF18abbxrwg  1078  58287.335428  60884.270926          1.0   
2  ZTF18abbxkax   509  58287.335428  60884.268090          1.0   
3  ZTF18abctcjx  1067  58301.355914  60884.392199          1.0   
4  ZTF18abegdjb   828  58304.357766  60884.218125          1.0   
5  ZTF18abkobur   510  58331.294919  60884.255313          1.0   
6  ZTF18abjxzue   780  58332.271759  60875.255359          1.0   
7  ZTF18abnjuiy   513  58347.196447  60870.256794          1.0   
8  ZTF18abnowwc   649  58348.212234  60881.254711          1.0   
9  ZTF18abnugpf   608  58348.353021  60884.298646          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  1497422265615015015    -999.0     null  59251.422269    1  
1  1499564341415015015    -999.0     null  59253.564340    2  
2  1500560724915015025    -999.0     null  59254.560729    2  
3  1508557300615015050    -999.0     null  59262.557303    2  
4  1508557301515015029    -999.0     null  59262.557303    2  
5  1494552690515010061    -999.0     null  59248.552697    2  
6  1494508860715015005    -999.0     null  59248.508866    1  
7  1499540791315015006    -999.0     null  59253.540799    1  
8  1508557771615015008    -999.0     null  59262.557778    2  
9  1515558154415015007    -999.0     null  59269.558160    2  ]",,79.037522315979,2025-07-28T19:03:35,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,107,1,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,         o.ndet,         o.firstmjd,         o.lastmjd    FROM         object o    WHERE         o.ndet > 500),filtered_probabilities AS (    SELECT         p.oid,         p.probability    FROM         probability p    WHERE         p.class_name = 'asteroid' AND         p.classifier_name = 'stamp_classifier' AND         p.classifier_version = 'stamp_classifier_1.0.4' AND         p.probability > 0.5 AND         p.ranking = 1),filtered_ss_ztf AS (    SELECT         s.oid,         s.ssdistnr,         s.ssnamenr    FROM         ss_ztf s    WHERE         s.ssdistnr < 2),combined_data AS (    SELECT         fo.oid,         fo.ndet,         fo.firstmjd,         fo.lastmjd,         fp.probability,         ssz.ssdistnr,         ssz.ssnamenr    FROM         filtered_objects fo    INNER JOIN         filtered_probabilities fp ON fo.oid = fp.oid    INNER JOIN         filtered_ss_ztf ssz ON fo.oid = ssz.oid),detection_data AS (    SELECT         d.oid,         d.candid,         d.mjd,         d.fid    FROM         detection d)SELECT     cd.oid AS ztf_identifier,     cd.ndet AS number_of_detections,     cd.firstmjd AS first_detection_date,     cd.lastmjd AS last_detection_date,     cd.probability,     dd.candid AS candidate_identifier,     cd.ssdistnr AS distance_to_mpc_object,     cd.ssnamenr AS mpc_name,     dd.mjd AS detection_date,     dd.fid AS filter_identifierFROM     combined_data cdINNER JOIN     detection_data dd ON cd.oid = dd.oidORDER BY     cd.firstmjd ASCLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,68.14502000808716,2025-07-23T19:36:36,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58279.169583                  2  
1                  -999.0     null    58282.190012                  2  
2                  -999.0     null    58288.234769                  2  
3                  -999.0     null    58293.234190                  2  
4                  -999.0     null    58298.252488                  2  
5                  -999.0     null    58305.178160                  2  
6                  -999.0     null    58336.174086                  1  
7                  -999.0     null    58469.524907                  1  
8                  -999.0     null    58472.485521                  1  
9                  -999.0     null    58472.486887                  1  ]",,58.36960959434509,2025-07-28T19:04:44,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,2,"-- [FINAL QUERY HERE]SELECT DISTINCT     object.oid AS ztf_identifier,    object.ndet AS number_of_detections,    object.firstmjd AS first_detection_date,    object.lastmjd AS last_detection_date,    probability.probability AS probability,    detection.candid AS candidate_identifier,    ss_ztf.ssdistnr AS distance_to_mpc_object,    ss_ztf.ssnamenr AS mpc_name,    detection.mjd AS detection_date,    detection.fid AS filter_identifierFROM     objectINNER JOIN     probability     ON object.oid = probability.oidINNER JOIN     ss_ztf     ON object.oid = ss_ztf.oidINNER JOIN     detection     ON object.oid = detection.oidWHERE     object.ndet > 500 -- More than 500 detections    AND probability.class_name = 'asteroid' -- Classified as asteroid    AND probability.classifier_name = 'stamp_classifier' -- Classifier name    AND probability.classifier_version = 'stamp_classifier_1.0.4' -- Classifier version    AND probability.probability > 0.5 -- Probability larger than 0.5    AND probability.ranking = 1 -- Most likely probability    AND ss_ztf.ssdistnr < 2 -- Distance below 2 arcsecondsORDER BY     object.firstmjd ASC -- Order by first detection dateLIMIT 10 -- Return at most 10 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,26.69975852966309,2025-07-23T19:37:03,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58279.169583                  2  
1                  -999.0     null    58282.190012                  2  
2                  -999.0     null    58288.234769                  2  
3                  -999.0     null    58293.234190                  2  
4                  -999.0     null    58298.252488                  2  
5                  -999.0     null    58305.178160                  2  
6                  -999.0     null    58336.174086                  1  
7                  -999.0     null    58469.524907                  1  
8                  -999.0     null    58472.485521                  1  
9                  -999.0     null    58472.486887                  1  ]",,119.19960308074951,2025-07-28T20:24:54,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,3,"-- [FINAL QUERY HERE]SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    p.probability AS probability,    d.candid AS candidate_identifier,    s.ssdistnr AS distance_to_mpc_object,    s.ssnamenr AS mpc_name,    d.mjd AS detection_date,    d.fid AS filter_identifierFROM     object oINNER JOIN     probability p ON o.oid = p.oidINNER JOIN     ss_ztf s ON o.oid = s.oidINNER JOIN     detection d ON o.oid = d.oidWHERE     o.ndet > 500 -- More than 500 detections    AND p.class_name = 'asteroid' -- Class name is asteroid    AND p.classifier_name = 'stamp_classifier' -- Classifier name    AND p.classifier_version = 'stamp_classifier_1.0.4' -- Classifier version    AND p.probability > 0.5 -- Probability larger than 0.5    AND p.ranking = 1 -- Most likely probability    AND s.ssdistnr < 2 -- Distance to nearest Solar System object below 2 arcsecORDER BY     o.firstmjd ASC -- Order by first detection dateLIMIT 10 -- Limit to at most 10 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,26.5134334564209,2025-07-23T19:37:30,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58279.169583                  2  
1                  -999.0     null    58282.190012                  2  
2                  -999.0     null    58288.234769                  2  
3                  -999.0     null    58293.234190                  2  
4                  -999.0     null    58298.252488                  2  
5                  -999.0     null    58305.178160                  2  
6                  -999.0     null    58336.174086                  1  
7                  -999.0     null    58469.524907                  1  
8                  -999.0     null    58472.485521                  1  
9                  -999.0     null    58472.486887                  1  ]",,11.815840721130371,2025-07-28T20:25:11,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,4,"-- [FINAL QUERY HERE]SELECT     o.oid AS ztf_identifier,    o.ndethist AS number_of_detections,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    p.probability AS probability,    d.candid AS candidate_identifier,    s.ssdistnr AS distance_to_mpc_object,    s.ssnamenr AS mpc_name,    d.mjd AS detection_date,    d.fid AS filter_identifierFROM     object oINNER JOIN     probability p ON o.oid = p.oidINNER JOIN     ss_ztf s ON o.oid = s.oidINNER JOIN     detection d ON o.oid = d.oidWHERE     o.ndethist > 500 -- More than 500 detections    AND p.class_name = 'asteroid' -- Class name is asteroid    AND p.classifier_name = 'stamp_classifier' -- Classifier name    AND p.classifier_version = 'stamp_classifier_1.0.4' -- Classifier version    AND p.probability > 0.5 -- Probability larger than 0.5    AND p.ranking = 1 -- Most likely class    AND s.ssdistnr < 2 -- Distance to nearest Solar System object below 2 arcsecORDER BY     o.firstmjd ASC -- Order by first detection dateLIMIT 10 -- Return at most 10 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,30.89608335494995,2025-07-23T19:38:01,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aayobhl                   536           58276.37544   
1  ZTF18aayobhl                   536           58276.37544   
2  ZTF18aayobhl                   536           58276.37544   
3  ZTF18aayobhl                   536           58276.37544   
4  ZTF18aayobhl                   536           58276.37544   
5  ZTF18aayobhl                   536           58276.37544   
6  ZTF18aayobhl                   536           58276.37544   
7  ZTF18aayobhl                   536           58276.37544   
8  ZTF18aayobhl                   536           58276.37544   
9  ZTF18aayobhl                   536           58276.37544   

   last_detection_date  probability  candidate_identifier  \
0         60882.264931          1.0    522375434315010014   
1         60882.264931          1.0    525357344315010018   
2         60882.264931          1.0    526412144315010010   
3         60882.264931          1.0    528377804315010014   
4         60882.264931          1.0    529401524315010013   
5         60882.264931          1.0    532403844315010028   
6         60882.264931          1.0    534377404315010022   
7         60882.264931          1.0    535378114315010013   
8         60882.264931          1.0    536400534315015021   
9         60882.264931          1.0    538414884315010013   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58276.375440                  1  
1                  -999.0     null    58279.357350                  1  
2                  -999.0     null    58280.412141                  1  
3                  -999.0     null    58282.377801                  1  
4                  -999.0     null    58283.401528                  1  
5                  -999.0     null    58286.403843                  1  
6                  -999.0     null    58288.377407                  1  
7                  -999.0     null    58289.378113                  1  
8                  -999.0     null    58290.400532                  1  
9                  -999.0     null    58292.414884                  1  ]",,13.486785650253296,2025-07-28T20:25:29,0.0,0.0,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,5,"-- [FINAL QUERY HERE]SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    p.probability AS probability,    d.candid AS candidate_identifier,    s.ssdistnr AS distance_to_mpc_object,    s.ssnamenr AS mpc_name,    d.mjd AS detection_date,    d.fid AS filter_identifierFROM     object oINNER JOIN     probability p ON o.oid = p.oidINNER JOIN     ss_ztf s ON o.oid = s.oidINNER JOIN     detection d ON o.oid = d.oidWHERE     o.ndet > 500 -- More than 500 detections    AND p.class_name = 'asteroid' -- Classified as asteroid    AND p.classifier_name = 'stamp_classifier' -- Classifier name    AND p.classifier_version = 'stamp_classifier_1.0.4' -- Classifier version    AND p.probability > 0.5 -- Probability larger than 0.5    AND p.ranking = 1 -- Most likely probability    AND s.ssdistnr < 2 -- Distance to nearest Solar System object below 2 arcsecORDER BY     o.firstmjd ASC -- Order by first detection dateLIMIT 10 -- Limit to at most 10 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,34.28209567070007,2025-07-23T19:38:35,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58279.169583                  2  
1                  -999.0     null    58282.190012                  2  
2                  -999.0     null    58288.234769                  2  
3                  -999.0     null    58293.234190                  2  
4                  -999.0     null    58298.252488                  2  
5                  -999.0     null    58305.178160                  2  
6                  -999.0     null    58336.174086                  1  
7                  -999.0     null    58469.524907                  1  
8                  -999.0     null    58472.485521                  1  
9                  -999.0     null    58472.486887                  1  ]",,12.961802005767822,2025-07-28T20:25:47,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,6,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,         o.ndet,         o.firstmjd,         o.lastmjd    FROM         object o    WHERE         o.ndet > 500),filtered_probabilities AS (    SELECT         p.oid,         p.probability    FROM         probability p    WHERE         p.class_name = 'asteroid' AND         p.classifier_name = 'stamp_classifier' AND         p.classifier_version = 'stamp_classifier_1.0.4' AND         p.probability > 0.5 AND         p.ranking = 1),filtered_ss_ztf AS (    SELECT         s.oid,         s.ssdistnr,         s.ssnamenr    FROM         ss_ztf s    WHERE         s.ssdistnr < 2),joined_data AS (    SELECT         fo.oid,         fo.ndet,         fo.firstmjd,         fo.lastmjd,         fp.probability,         ssz.ssdistnr,         ssz.ssnamenr    FROM         filtered_objects fo    INNER JOIN         filtered_probabilities fp ON fo.oid = fp.oid    INNER JOIN         filtered_ss_ztf ssz ON fo.oid = ssz.oid),final_data AS (    SELECT         jd.oid,         jd.ndet,         jd.firstmjd,         jd.lastmjd,         jd.probability,         d.candid,         jd.ssdistnr,         jd.ssnamenr,         d.mjd AS detection_date,         d.fid AS filter_id    FROM         joined_data jd    INNER JOIN         detection d ON jd.oid = d.oid)SELECT     oid AS ztf_identifier,     ndet AS number_of_detections,     firstmjd AS first_detection_date,     lastmjd AS last_detection_date,     probability,     candid AS candidate_identifier,     ssdistnr AS distance_to_mpc_object,     ssnamenr AS mpc_name,     detection_date,     filter_idFROM     final_dataORDER BY     first_detection_dateLIMIT 10","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,33.18974423408508,2025-07-23T19:39:08,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_id  
0                  -999.0     null    58279.169583          2  
1                  -999.0     null    58282.190012          2  
2                  -999.0     null    58288.234769          2  
3                  -999.0     null    58293.234190          2  
4                  -999.0     null    58298.252488          2  
5                  -999.0     null    58305.178160          2  
6                  -999.0     null    58336.174086          1  
7                  -999.0     null    58469.524907          1  
8                  -999.0     null    58472.485521          1  
9                  -999.0     null    58472.486887          1  ]",,14.864837169647217,2025-07-28T20:26:07,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,7,"-- [FINAL QUERY HERE]SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    p.probability AS probability,    d.candid AS candidate_identifier,    s.ssdistnr AS distance_to_mpc_object,    s.ssnamenr AS mpc_name,    d.mjd AS detection_date,    d.fid AS filter_identifierFROM     object oINNER JOIN     probability p ON o.oid = p.oidINNER JOIN     ss_ztf s ON o.oid = s.oidINNER JOIN     detection d ON o.oid = d.oidWHERE     o.ndet > 500 -- More than 500 detections    AND p.class_name = 'asteroid' -- Class name is asteroid    AND p.classifier_name = 'stamp_classifier' -- Classifier name    AND p.classifier_version = 'stamp_classifier_1.0.4' -- Classifier version    AND p.probability > 0.5 -- Probability larger than 0.5    AND p.ranking = 1 -- Most likely probability    AND s.ssdistnr < 2 -- Distance to nearest Solar System object below 2 arcsecORDER BY     o.firstmjd ASC -- Order by first detection dateLIMIT 10 -- Limit to at most 10 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,32.81727361679077,2025-07-23T19:39:41,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58279.169583                  2  
1                  -999.0     null    58282.190012                  2  
2                  -999.0     null    58288.234769                  2  
3                  -999.0     null    58293.234190                  2  
4                  -999.0     null    58298.252488                  2  
5                  -999.0     null    58305.178160                  2  
6                  -999.0     null    58336.174086                  1  
7                  -999.0     null    58469.524907                  1  
8                  -999.0     null    58472.485521                  1  
9                  -999.0     null    58472.486887                  1  ]",,11.501340389251709,2025-07-28T20:26:24,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,8,"-- [FINAL QUERY HERE]SELECT     object.oid AS ztf_identifier,    object.ndet AS number_of_detections,    object.firstmjd AS first_detection_date,    object.lastmjd AS last_detection_date,    probability.probability AS probability,    detection.candid AS candidate_identifier,    ss_ztf.ssdistnr AS distance_to_mpc_object,    ss_ztf.ssnamenr AS mpc_name,    detection.mjd AS detection_date,    detection.fid AS filter_identifierFROM     objectINNER JOIN     probability     ON object.oid = probability.oidINNER JOIN     ss_ztf     ON object.oid = ss_ztf.oidINNER JOIN     detection     ON object.oid = detection.oidWHERE     object.ndet > 500 -- More than 500 detections    AND probability.class_name = 'asteroid' -- Class name is 'asteroid'    AND probability.classifier_name = 'stamp_classifier' -- Classifier name    AND probability.classifier_version = 'stamp_classifier_1.0.4' -- Classifier version    AND probability.probability > 0.5 -- Probability larger than 0.5    AND probability.ranking = 1 -- Most likely probability    AND ss_ztf.ssdistnr < 2 -- Distance to nearest Solar System object below 2 arcsecORDER BY     object.firstmjd ASC -- Order by first detection dateLIMIT 10 -- Limit to at most 10 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,26.31567120552063,2025-07-23T19:40:08,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58279.169583                  2  
1                  -999.0     null    58282.190012                  2  
2                  -999.0     null    58288.234769                  2  
3                  -999.0     null    58293.234190                  2  
4                  -999.0     null    58298.252488                  2  
5                  -999.0     null    58305.178160                  2  
6                  -999.0     null    58336.174086                  1  
7                  -999.0     null    58469.524907                  1  
8                  -999.0     null    58472.485521                  1  
9                  -999.0     null    58472.486887                  1  ]",,15.2169930934906,2025-07-28T20:26:44,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,9,"-- [FINAL QUERY HERE]SELECT     object.oid AS ztf_identifier,    object.ndet AS number_of_detections,    object.firstmjd AS first_detection_date,    object.lastmjd AS last_detection_date,    probability.probability AS probability,    detection.candid AS candidate_identifier,    ss_ztf.ssdistnr AS distance_to_mpc_object,    ss_ztf.ssnamenr AS mpc_name,    detection.mjd AS detection_date,    detection.fid AS filter_identifierFROM     objectINNER JOIN     probability ON object.oid = probability.oidINNER JOIN     ss_ztf ON object.oid = ss_ztf.oidINNER JOIN     detection ON object.oid = detection.oidWHERE     object.ndet > 500 -- More than 500 detections    AND probability.class_name = 'asteroid' -- Classified as asteroid    AND probability.classifier_name = 'stamp_classifier' -- Classifier name    AND probability.classifier_version = 'stamp_classifier_1.0.4' -- Classifier version    AND probability.probability > 0.5 -- Probability larger than 0.5    AND probability.ranking = 1 -- Most likely classification    AND ss_ztf.ssdistnr < 2 -- Distance to nearest Solar System object below 2 arcsecORDER BY     object.firstmjd ASC -- Order by first detection dateLIMIT 10 -- Limit to at most 10 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,29.860870361328125,2025-07-23T19:40:38,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58279.169583                  2  
1                  -999.0     null    58282.190012                  2  
2                  -999.0     null    58288.234769                  2  
3                  -999.0     null    58293.234190                  2  
4                  -999.0     null    58298.252488                  2  
5                  -999.0     null    58305.178160                  2  
6                  -999.0     null    58336.174086                  1  
7                  -999.0     null    58469.524907                  1  
8                  -999.0     null    58472.485521                  1  
9                  -999.0     null    58472.486887                  1  ]",,14.523067712783813,2025-07-28T20:27:04,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,107,10,"-- [FINAL QUERY HERE]SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    p.probability AS probability,    d.candid AS candidate_identifier,    s.ssdistnr AS distance_to_mpc_object,    s.ssnamenr AS mpc_name,    d.mjd AS detection_date,    d.fid AS filter_identifierFROM     object oINNER JOIN     probability p ON o.oid = p.oidINNER JOIN     ss_ztf s ON o.oid = s.oidINNER JOIN     detection d ON o.oid = d.oidWHERE     o.ndet > 500 -- More than 500 detections    AND p.class_name = 'asteroid' -- Classified as asteroid    AND p.classifier_name = 'stamp_classifier' -- Classifier name    AND p.classifier_version = 'stamp_classifier_1.0.4' -- Classifier version    AND p.probability > 0.5 -- Probability larger than 0.5    AND p.ranking = 1 -- Most likely probability    AND s.ssdistnr < 2 -- Distance to nearest Solar System object below 2 arcsecORDER BY     o.firstmjd ASC -- Order by first detection dateLIMIT 10 -- Limit to at most 10 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,35.52503776550293,2025-07-23T19:41:13,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   789          58279.169583   
1  ZTF18aakqcul                   789          58279.169583   
2  ZTF18aakqcul                   789          58279.169583   
3  ZTF18aakqcul                   789          58279.169583   
4  ZTF18aakqcul                   789          58279.169583   
5  ZTF18aakqcul                   789          58279.169583   
6  ZTF18aakqcul                   789          58279.169583   
7  ZTF18aakqcul                   789          58279.169583   
8  ZTF18aakqcul                   789          58279.169583   
9  ZTF18aakqcul                   789          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60855.216528          1.0    525169581515010001   
1         60855.216528          1.0    528190011515010000   
2         60855.216528          1.0    534234765615010009   
3         60855.216528          1.0    539234185615015004   
4         60855.216528          1.0    544252481515010001   
5         60855.216528          1.0    551178155615015013   
6         60855.216528          1.0    582174085615015001   
7         60855.216528          1.0    715524901515015036   
8         60855.216528          1.0    718485525615010005   
9         60855.216528          1.0    718486881515010000   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    58279.169583                  2  
1                  -999.0     null    58282.190012                  2  
2                  -999.0     null    58288.234769                  2  
3                  -999.0     null    58293.234190                  2  
4                  -999.0     null    58298.252488                  2  
5                  -999.0     null    58305.178160                  2  
6                  -999.0     null    58336.174086                  1  
7                  -999.0     null    58469.524907                  1  
8                  -999.0     null    58472.485521                  1  
9                  -999.0     null    58472.486887                  1  ]",,11.986170530319214,2025-07-28T20:27:21,1.0,0.1,0.1,0.1,0.0,0.0
0.20.2,,,83,0,"SELECT
    *
FROM
    allwise
WHERE
    oid_catalog in
(
SELECT
    oid_catalog
FROM
    xmatch
WHERE
    oid = 'ZTF21aazqwxv'
)",,,,,"[           oid_catalog          ra       dec  w1mpro  w2mpro  w3mpro  w4mpro  \
0  J131116.64+045854.7  197.819368  4.981863  13.319  13.129   9.839   7.761   

   w1sigmpro  w2sigmpro  w3sigmpro  w4sigmpro  j_m_2mass  h_m_2mass  \
0      0.033      0.037      0.056      0.247     15.331     14.491   

   k_m_2mass  j_msig_2mass  h_msig_2mass  k_msig_2mass  
0     14.027         0.109           0.1           0.1  ]",,3.2386527061462402,2025-07-28T20:27:25,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,83,1,-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE oid_catalog = (    SELECT oid    FROM object    WHERE oid = 'ZTF21aazqwxv'),"['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.0954394340515137,2025-07-23T19:41:16,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE oid_catalog = (
    SELECT oid_catalog
    FROM object
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",148.81588673591614,2025-07-28T20:29:57,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,2,"-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 0.000277778 degrees corresponds to 1 arcsecond","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.344205379486084,2025-07-23T19:41:20,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout
CONTEXT:  SQL function ""q3c_radial_query"" statement 1

[SQL: 
-- Corrected Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_radial_query(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",135.3896563053131,2025-07-28T20:32:17,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,3,"-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 1 arcsecond radius in degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.332351922988892,2025-07-23T19:41:24,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_join(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778 -- 1 arcsecond radius in degrees
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.13239097595215,2025-07-28T20:34:33,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,4,"-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 1 arcsecond radius in degrees","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.4931681156158447,2025-07-23T19:41:28,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_join(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778 -- 1 arcsecond radius in degrees
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",129.49130487442017,2025-07-28T20:36:47,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,5,-- Retrieve all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT allwise.*FROM objectINNER JOIN allwise ON object.oid = allwise.oid_catalogWHERE object.oid = 'ZTF21aazqwxv',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,29.47672867774964,2025-07-23T19:41:57,"[Empty DataFrame
Columns: [oid_catalog, ra, dec, w1mpro, w2mpro, w3mpro, w4mpro, w1sigmpro, w2sigmpro, w3sigmpro, w4sigmpro, j_m_2mass, h_m_2mass, k_m_2mass, j_msig_2mass, h_msig_2mass, k_msig_2mass]
Index: []]",,8.524783849716187,2025-07-28T20:37:01,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,83,6,-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE oid_catalog IN (    SELECT oid    FROM object    WHERE oid = 'ZTF21aazqwxv'),"['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.88637375831604,2025-07-23T19:42:00,"[Empty DataFrame
Columns: [oid_catalog, ra, dec, w1mpro, w2mpro, w3mpro, w4mpro, w1sigmpro, w2sigmpro, w3sigmpro, w4sigmpro, j_m_2mass, h_m_2mass, k_m_2mass, j_msig_2mass, h_msig_2mass, k_msig_2mass]
Index: []]",,8.278421401977539,2025-07-28T20:37:14,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,83,7,"-- Query to get all columns in the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 0.000277778 degrees = 1 arcsecond","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.013084888458252,2025-07-23T19:42:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout
CONTEXT:  SQL function ""q3c_radial_query"" statement 1

[SQL: 
-- Corrected Query to get all columns in the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_radial_query(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778 -- 0.000277778 degrees = 1 arcsecond
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",128.89549589157104,2025-07-28T20:39:31,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,8,"-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE q3c_join(allwise.ra, allwise.dec,                (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'),                (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'),                0.000277778) -- 0.000277778 degrees = 1 arcsecond","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.083969116210937,2025-07-23T19:42:06,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout
CONTEXT:  SQL function ""q3c_join"" statement 1

[SQL: 
-- Corrected Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE q3c_join(
    allwise.ra, 
    allwise.dec, 
    (SELECT meanra FROM object WHERE oid = 'ZTF21aazqwxv'), 
    (SELECT meandec FROM object WHERE oid = 'ZTF21aazqwxv'), 
    0.000277778 -- 0.000277778 degrees = 1 arcsecond
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",129.01973390579224,2025-07-28T20:41:43,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,9,-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE oid_catalog = (    SELECT oid    FROM object    WHERE oid = 'ZTF21aazqwxv'),"['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.5708096027374268,2025-07-23T19:42:09,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'
SELECT *
FROM allwise
WHERE oid_catalog = (
    SELECT oid_catalog
    FROM object
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.4054639339447,2025-07-28T20:43:57,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,83,10,-- Query to get all columns from the 'allwise' table for the ZTF object 'ZTF21aazqwxv'SELECT *FROM allwiseWHERE oid_catalog IN (    SELECT oid    FROM object    WHERE oid = 'ZTF21aazqwxv'),"['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.003185272216797,2025-07-23T19:42:12,"[Empty DataFrame
Columns: [oid_catalog, ra, dec, w1mpro, w2mpro, w3mpro, w4mpro, w1sigmpro, w2sigmpro, w3sigmpro, w4sigmpro, j_m_2mass, h_m_2mass, k_m_2mass, j_msig_2mass, h_msig_2mass, k_msig_2mass]
Index: []]",,8.074770450592041,2025-07-28T20:44:09,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,84,0,"SELECT
    oid, xmatch.oid_catalog, dist,
    w1mpro, w2mpro, w3mpro, w4mpro
FROM
    xmatch INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    xmatch.oid = 'ZTF19aascdol'",,,,,"[            oid          oid_catalog      dist  w1mpro  w2mpro  w3mpro  w4mpro
0  ZTF19aascdol  J154334.93+152539.5  0.000043  15.286  14.354  11.747   8.611]",,3.2933902740478516,2025-07-28T20:44:12,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,84,1,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_object_id, -- ALLWISE object identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Distance between counterparts    a.w1mpro AS w1_magnitude, -- WISE W1 magnitude    a.w2mpro AS w2_magnitude, -- WISE W2 magnitude    a.w3mpro AS w3_magnitude, -- WISE W3 magnitude    a.w4mpro AS w4_magnitude -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_radial_query(o.meanra, o.meandec, a.ra, a.dec, 0.00138889) -- Match within 5 arcsecondsWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by distance to prioritize closest matches","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,28.604894876480103,2025-07-23T19:42:41,"[  ztf_object_id    allwise_object_id  angular_distance  w1_magnitude  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038        15.286   

   w2_magnitude  w3_magnitude  w4_magnitude  
0        14.354        11.747         8.611  ]",,13.397206544876099,2025-07-28T20:44:29,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,2,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     object.oid AS ztf_identifier, -- ZTF object identifier    allwise.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier    q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) AS distance, -- Angular distance between counterparts    allwise.w1mpro, -- WISE W1 magnitude    allwise.w2mpro, -- WISE W2 magnitude    allwise.w3mpro, -- WISE W3 magnitude    allwise.w4mpro  -- WISE W4 magnitudeFROM     objectINNER JOIN     allwiseON     q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 0.00138889) -- Match within 5 arcseconds (0.00138889 degrees)WHERE     object.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,19.75937795639038,2025-07-23T19:43:01,"[            oid   allwise_identifier  distance  w1mpro  w2mpro  w3mpro  w4mpro
0  ZTF19aascdol  J154334.93+152539.5  0.000038  15.286  14.354  11.747   8.611]",,12.232370615005493,2025-07-28T20:44:45,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,3,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_object_id, -- ALLWISE object identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro AS w1_magnitude, -- WISE W1 magnitude    a.w2mpro AS w2_magnitude, -- WISE W2 magnitude    a.w3mpro AS w3_magnitude, -- WISE W3 magnitude    a.w4mpro AS w4_magnitude -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_radial_query(o.meanra, o.meandec, a.ra, a.dec, 0.00139) -- Match within 5 arcseconds (0.00139 degrees)WHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,27.88888931274414,2025-07-23T19:43:29,"[  ztf_object_id    allwise_object_id  angular_distance  w1_magnitude  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038        15.286   

   w2_magnitude  w3_magnitude  w4_magnitude  
0        14.354        11.747         8.611  ]",,12.522935628890991,2025-07-28T20:45:01,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,4,"-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_identifier, -- ZTF object identifier    a.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro AS w1_magnitude, -- WISE W1 magnitude    a.w2mpro AS w2_magnitude, -- WISE W2 magnitude    a.w3mpro AS w3_magnitude, -- WISE W3 magnitude    a.w4mpro AS w4_magnitude -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_radial_query(o.meanra, o.meandec, a.ra, a.dec, 0.00027778) -- Spatial match within 1 arcsecondWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,22.05002927780152,2025-07-23T19:43:51,"[            oid   allwise_identifier  angular_distance  w1_magnitude  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038        15.286   

   w2_magnitude  w3_magnitude  w4_magnitude  
0        14.354        11.747         8.611  ]",,13.490231275558472,2025-07-28T20:45:18,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,5,"-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_identifier, -- ZTF object identifier    a.oid_catalog AS allwise_identifier, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Distance between counterparts    a.w1mpro AS w1_magnitude, -- WISE W1 magnitude    a.w2mpro AS w2_magnitude, -- WISE W2 magnitude    a.w3mpro AS w3_magnitude, -- WISE W3 magnitude    a.w4mpro AS w4_magnitude -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 1.0 / 3600.0) -- Spatial join with a 1 arcsecond radiusWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,23.00326776504517,2025-07-23T19:44:14,"[            oid   allwise_identifier  angular_distance  w1_magnitude  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038        15.286   

   w2_magnitude  w3_magnitude  w4_magnitude  
0        14.354        11.747         8.611  ]",,12.269289255142212,2025-07-28T20:45:34,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,6,"-- Query to retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)-- Includes ZTF identifier, ALLWISE catalog identifier, angular distance, and WISE magnitudes (W1 to W4)SELECT     object.oid AS ztf_oid, -- ZTF object identifier    allwise.oid_catalog AS allwise_oid, -- ALLWISE catalog identifier    q3c_dist(object.meanra, object.meandec, allwise.ra, allwise.dec) AS angular_distance, -- Angular distance between counterparts    allwise.w1mpro, -- WISE W1 magnitude    allwise.w2mpro, -- WISE W2 magnitude    allwise.w3mpro, -- WISE W3 magnitude    allwise.w4mpro  -- WISE W4 magnitudeFROM     objectINNER JOIN     allwiseON     q3c_join(object.meanra, object.meandec, allwise.ra, allwise.dec, 5.0 / 3600.0) -- Match within 5 arcsecondsWHERE     object.oid = 'ZTF19aascdol' -- Filter for the specific ZTF object","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,27.719233989715576,2025-07-23T19:44:42,"[            oid          allwise_oid  angular_distance  w1mpro  w2mpro  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038  15.286  14.354   

   w3mpro  w4mpro  
0  11.747   8.611  ]",,14.086575746536255,2025-07-28T20:45:51,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,7,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_catalog_id, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro, -- WISE W1 magnitude    a.w2mpro, -- WISE W2 magnitude    a.w3mpro, -- WISE W3 magnitude    a.w4mpro  -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.00027778) -- Match within 1 arcsecond (0.00027778 degrees)WHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,20.34419798851013,2025-07-23T19:45:02,"[  ztf_object_id   allwise_catalog_id  angular_distance  w1mpro  w2mpro  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038  15.286  14.354   

   w3mpro  w4mpro  
0  11.747   8.611  ]",,12.98475956916809,2025-07-28T20:46:08,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,8,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)-- including identifiers, angular distance, and WISE magnitudes (W1 to W4)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_catalog_id, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro, -- WISE W1 magnitude    a.w2mpro, -- WISE W2 magnitude    a.w3mpro, -- WISE W3 magnitude    a.w4mpro  -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 0.00138889) -- Match within 5 arcseconds (0.00138889 degrees)WHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,21.121541261672974,2025-07-23T19:45:23,"[  ztf_object_id   allwise_catalog_id  angular_distance  w1mpro  w2mpro  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038  15.286  14.354   

   w3mpro  w4mpro  
0  11.747   8.611  ]",,13.944092273712158,2025-07-28T20:46:25,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,9,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)-- including identifiers, angular distance, and WISE magnitudes (W1 to W4)SELECT     o.oid AS ztf_object_id, -- ZTF object identifier    a.oid_catalog AS allwise_catalog_id, -- ALLWISE catalog identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS angular_distance, -- Angular distance between counterparts    a.w1mpro, -- WISE W1 magnitude    a.w2mpro, -- WISE W2 magnitude    a.w3mpro, -- WISE W3 magnitude    a.w4mpro  -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 5.0 / 3600.0) -- Match within 5 arcsecondsWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     angular_distance ASC -- Sort by angular distance to prioritize the closest match","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,23.788135766983032,2025-07-23T19:45:47,"[  ztf_object_id   allwise_catalog_id  angular_distance  w1mpro  w2mpro  \
0  ZTF19aascdol  J154334.93+152539.5          0.000038  15.286  14.354   

   w3mpro  w4mpro  
0  11.747   8.611  ]",,12.756647825241089,2025-07-28T20:46:41,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,84,10,"-- Retrieve information about the ZTF object 'ZTF19aascdol' and its ALLWISE match(es)SELECT     o.oid AS ztf_oid, -- ZTF object identifier    a.oid_catalog AS allwise_oid, -- ALLWISE object identifier    q3c_dist(o.meanra, o.meandec, a.ra, a.dec) AS distance_arcsec, -- Angular distance in arcseconds    a.w1mpro, -- WISE W1 magnitude    a.w2mpro, -- WISE W2 magnitude    a.w3mpro, -- WISE W3 magnitude    a.w4mpro  -- WISE W4 magnitudeFROM     object oINNER JOIN     allwise aON     q3c_join(o.meanra, o.meandec, a.ra, a.dec, 5.0 / 3600.0) -- Match within 5 arcsecondsWHERE     o.oid = 'ZTF19aascdol' -- Filter for the specific ZTF objectORDER BY     distance_arcsec ASC -- Sort by distance in ascending order","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,23.76579523086548,2025-07-23T19:46:11,"[            oid          allwise_oid  distance_arcsec  w1mpro  w2mpro  w3mpro  \
0  ZTF19aascdol  J154334.93+152539.5         0.000038  15.286  14.354  11.747   

   w4mpro  
0   8.611  ]",,12.574378728866577,2025-07-28T20:46:59,1.0,1.0,0.5714285714285714,0.5714285714285714,1.0,0.0
0.20.2,,,96,0,"SELECT
    ss_ztf.*, detection.mjd, detection.fid,
    detection.isdiffpos, detection.ra, detection.dec,
    detection.magpsf, detection.sigmapsf
FROM
    ss_ztf INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ssnamenr IN ('2003FP134','2009UK56')
    AND ssdistnr < 2
ORDER BY ssnamenr, mjd",,,,,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,43.048256397247314,2025-07-28T20:47:42,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,96,1,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Define the Solar System objects and their coordinates    SELECT '2003FP134' AS ssnamenr, 123.456 AS ra, -12.345 AS dec    UNION ALL    SELECT '2009UK56', 234.567, -23.456)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd, -- Detection date    detection.fid, -- Filter identifier    detection.isdiffpos, -- Is difference positive flag    detection.ra, -- Right Ascension    detection.dec, -- Declination    detection.magpsf, -- Difference magnitude    detection.sigmapsf -- Uncertainty in difference magnitudeFROM     ss_ztfINNER JOIN     detection ON ss_ztf.candid = detection.candid -- Join ss_ztf and detection tables on candidINNER JOIN     catalog ON ss_ztf.ssnamenr = catalog.ssnamenr -- Match Solar System object namesWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objects    AND ss_ztf.ssdistnr <= 2 / 3600.0 -- Ensure distance is within 2 arcseconds    AND q3c_radial_query(detection.ra, detection.dec, catalog.ra, catalog.dec, 2 / 3600.0) -- Spatial filtering using Q3CORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Then sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,30.67071843147278,2025-07-23T19:46:42,[None],"(psycopg2.errors.UndefinedFunction) function q3c_radial_query(real, double precision, double precision, numeric) does not exist
LINE 27:     AND q3c_radial_query(ss_ztf.ssdistnr, detection.ra, dete...
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: 
-- Corrected Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH catalog AS (
    -- Define the Solar System objects and their coordinates
    SELECT '2003FP134' AS ssnamenr, 123.456 AS ra, -12.345 AS dec
    UNION ALL
    SELECT '2009UK56', 234.567, -23.456
)
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd, -- Detection date
    detection.fid, -- Filter identifier
    detection.isdiffpos, -- Is difference positive flag
    detection.ra, -- Right Ascension
    detection.dec, -- Declination
    detection.magpsf, -- Difference magnitude
    detection.sigmapsf -- Uncertainty in difference magnitude
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid -- Join ss_ztf and detection tables on candid
INNER JOIN 
    catalog ON ss_ztf.ssnamenr = catalog.ssnamenr -- Match Solar System object names
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objects
    AND ss_ztf.ssdistnr <= 2 / 3600.0 -- Ensure distance is within 2 arcseconds
    AND q3c_radial_query(ss_ztf.ssdistnr, detection.ra, detection.dec, 2 / 3600.0) -- Spatial filtering using Q3C
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Then sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.263496160507202,2025-07-28T20:48:35,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,2,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog (ssnamenr, ra, dec) AS (    VALUES         ('2003FP134', <ra_value1>, <dec_value1>), -- Replace <ra_value1> and <dec_value1> with actual RA/Dec values        ('2009UK56', <ra_value2>, <dec_value2>)  -- Replace <ra_value2> and <dec_value2> with actual RA/Dec values),filtered_detections AS (    SELECT         d.*    FROM         detection d    INNER JOIN catalog c        ON q3c_radial_query(d.ra, d.dec, c.ra, c.dec, 0.0005556) -- 2 arcseconds in degrees),filtered_ss_ztf AS (    SELECT         s.*    FROM         ss_ztf s    WHERE         s.ssnamenr IN ('2003FP134', '2009UK56'))SELECT     s.*,     d.mjd,     d.fid,     d.isdiffpos,     d.ra,     d.dec,     d.magpsf,     d.sigmapsfFROM     filtered_ss_ztf sINNER JOIN     filtered_detections d    ON s.oid = d.oidORDER BY     s.ssnamenr ASC,     d.mjd ASC","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.83741450309753,2025-07-23T19:47:07,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""<""
LINE 5:         ('2003FP134', <ra_value1>, <dec_value1>), -- Replace...
                              ^

[SQL: 
-- Corrected Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH catalog (ssnamenr, ra, dec) AS (
    VALUES 
        ('2003FP134', <ra_value1>, <dec_value1>), -- Replace <ra_value1> and <dec_value1> with actual RA/Dec values
        ('2009UK56', <ra_value2>, <dec_value2>)  -- Replace <ra_value2> and <dec_value2> with actual RA/Dec values
),
filtered_detections AS (
    SELECT 
        d.*
    FROM 
        detection d
    INNER JOIN 
        catalog c
    ON 
        q3c_radial_query(d.ra, d.dec, c.ra, c.dec, 0.0005556) -- 2 arcseconds in degrees
),
filtered_ss_ztf AS (
    SELECT 
        s.*
    FROM 
        ss_ztf s
    WHERE 
        s.ssnamenr IN ('2003FP134', '2009UK56')
)
SELECT 
    s.*, 
    d.mjd, 
    d.fid, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf
FROM 
    filtered_ss_ztf s
INNER JOIN 
    filtered_detections d
ON 
    s.candid = d.candid -- Corrected join condition to use 'candid' as the linking key
ORDER BY 
    s.ssnamenr ASC, 
    d.mjd ASC
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.24951982498169,2025-07-28T20:48:53,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,3,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Define the Solar System identifiers and their coordinates    VALUES        ('2003FP134', ra1, dec1),        ('2009UK56', ra2, dec2)    AS catalog(ssnamenr, ra, dec)),filtered_ss_ztf AS (    -- Filter objects in ss_ztf table within 2 arcseconds of the Solar System identifiers    SELECT *    FROM ss_ztf    WHERE EXISTS (        SELECT 1        FROM catalog        WHERE q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556)          AND ss_ztf.ssnamenr = catalog.ssnamenr    )),detection_data AS (    -- Join the filtered ss_ztf results with the detection table    SELECT        ss_ztf.*,        detection.mjd,        detection.fid,        detection.isdiffpos,        detection.ra,        detection.dec,        detection.magpsf,        detection.sigmapsf    FROM filtered_ss_ztf    INNER JOIN detection ON filtered_ss_ztf.oid = detection.oid)-- Final result combining and sorting the dataSELECT *FROM detection_dataORDER BY ssnamenr, mjd","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.54387331008911,2025-07-23T19:47:31,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""ss_ztf""
LINE 13:         ss_ztf.*,
                 ^

[SQL: 
-- Corrected Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH filtered_ss_ztf AS (
    -- Filter objects in ss_ztf table for the specified Solar System identifiers
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56') -- Filter by the specified Solar System identifiers
      AND ssdistnr <= 2 / 3600.0 -- Convert 2 arcseconds to degrees (2/3600)
),
detection_data AS (
    -- Join the filtered ss_ztf results with the detection table
    SELECT
        ss_ztf.*,
        detection.mjd,
        detection.fid,
        detection.isdiffpos,
        detection.ra,
        detection.dec,
        detection.magpsf,
        detection.sigmapsf
    FROM filtered_ss_ztf
    INNER JOIN detection ON filtered_ss_ztf.candid = detection.candid -- Join on candid, as it is the unique identifier
)
-- Final result combining and sorting the data
SELECT *
FROM detection_data
ORDER BY ssnamenr, mjd
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.837225675582886,2025-07-28T20:49:13,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,4,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH solar_system_objects AS (    -- Define the RA/Dec coordinates for the Solar System identifiers    SELECT DISTINCT ssnamenr, oid, candid, ssdistnr, ssmagnr    FROM ss_ztf    WHERE ssnamenr IN ('2003FP134', '2009UK56')),filtered_objects AS (    -- Perform spatial filtering using q3c_radial_query to find objects within 2 arcseconds    SELECT sso.*, d.*    FROM solar_system_objects sso    INNER JOIN detection d ON sso.candid = d.candid    WHERE q3c_radial_query(d.ra, d.dec, sso.ssdistnr, 0.0005556) -- 2 arcseconds in degrees)-- Select required columns and sort the resultsSELECT     sso.*,     d.mjd AS detection_date,     d.fid AS filter_identifier,     d.isdiffpos,     d.ra,     d.dec,     d.magpsf AS difference_magnitude,     d.sigmapsf AS magnitude_uncertaintyFROM filtered_objects ssoORDER BY sso.ssnamenr, d.mjd","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.2495596408844,2025-07-23T19:47:57,"[             oid   ssnamenr               candid  ssdistnr  ssmagnr  \
0   ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
1   ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
2   ZTF21abbsmyp  2003FP134  1595376262715015044       0.0     19.5   
3   ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
4   ZTF21abcqekm  2003FP134  1608313551615015025       0.0     19.0   
5   ZTF21abculin  2003FP134  1609376562915015021       0.0     19.0   
6   ZTF21abdihfx  2003FP134  1612381041715015014       0.0     18.9   
7   ZTF21abdulcm  2003FP134  1614399211715015002       0.0     18.8   
8   ZTF21abeywpa  2003FP134  1619365033915015076       0.0     19.1   
9   ZTF21abfkygj  2003FP134  1621376883815015021       0.0     19.2   
10  ZTF21abgavxk  2003FP134  1624308764315015004       0.0     19.3   
11  ZTF21abgxhjg  2003FP134  1628315454015015046       0.0     19.5   
12  ZTF21abhfyvv  2003FP134  1630314794115015013       0.0     19.5   
13  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
14  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
15  ZTF21abiljll  2003FP134  1640314606315015016       0.0     19.8   
16  ZTF21abjphvf  2003FP134  1646209986215015001       0.0     20.0   
17  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
18  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
19  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
20  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
21  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
22  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
23  ZTF18abngpmh  2003FP134  1554480621215015055      25.0     20.6   
24  ZTF20acawpht   2009UK56  1356469912115015034       0.0     20.7   
25  ZTF20acdqnho   2009UK56  1362353242215015020       0.0     20.5   
26  ZTF20acilssf   2009UK56  1380426825615015010       0.0     20.1   
27  ZTF20acjbakd   2009UK56  1382319845615015022       0.0     20.1   
28  ZTF20acjdjlc   2009UK56  1382380335615015023       0.0     20.1   
29  ZTF20acjxpmq   2009UK56  1384347685815015007       0.0     20.0   
30  ZTF20ackrekd   2009UK56  1386400255815015038       0.0     20.0   
31  ZTF20acmpwqx   2009UK56  1390391754415015016       0.0     19.9   
32  ZTF20acmriqf   2009UK56  1390410544415015011       0.0     19.9   
33  ZTF20acoyuab   2009UK56  1403235991815015005       0.0     19.7   
34  ZTF20acpljmx   2009UK56  1410308410715015003       0.0     19.8   
35  ZTF20acpmmxt   2009UK56  1410344090715015002       0.0     19.8   
36  ZTF20acqazko   2009UK56  1412291460615015021       0.0     19.8   
37  ZTF20acrfjpp   2009UK56  1416266955415015001       0.0     19.9   
38  ZTF20acruhoq   2009UK56  1418239475415015010       0.0     20.0   
39  ZTF20acqazko   2009UK56  1412291460615015021       0.0     19.8   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59308.480625                  2          1  255.638166 -27.069111   
1     59317.438785                  2          1  255.638119 -27.069181   
2     59349.376262                  1          1  256.824875 -25.974222   
3     59353.418819                  2          1  255.638077 -27.069166   
4     59362.313553                  2          1  254.248201 -24.971674   
5     59363.376562                  2          1  254.000931 -24.876152   
6     59366.381042                  2          1  253.289819 -24.597101   
7     59368.399213                  2          1  252.804054 -24.403010   
8     59373.365035                  2          1  251.609834 -23.908624   
9     59375.376887                  2          1  251.135458 -23.703780   
10    59378.308762                  2          1  250.466414 -23.403652   
11    59382.315451                  2          1  249.608787 -22.995193   
12    59384.314792                  2          1  249.212822 -22.794441   
13    59384.317188                  2          1  255.638093 -27.069197   
14    59392.333947                  2          1  255.638091 -27.069083   
15    59394.314606                  2          1  247.645013 -21.856142   
16    59400.209988                  2          1  247.099310 -21.379044   
17    59684.459502                  1          1  255.638028 -27.068947   
18    59697.438808                  1          1  255.638093 -27.069097   
19    59709.439167                  2          1  255.638091 -27.069062   
20    59749.334537                  2          1  255.638102 -27.069066   
21    60067.398935                  2          1  255.638036 -27.069027   
22    60111.355961                  2          1  255.638055 -27.069006   
23    60814.440255                  1          1  255.638138 -27.068973   
24    59110.469919                  2          1   39.441994  25.290333   
25    59116.353241                  2          1   39.192099  24.766625   
26    59134.426829                  2          1   37.167419  22.314968   
27    59136.319849                  2          1   36.861685  21.984306   
28    59136.380336                  1          1   36.851189  21.973495   
29    59138.347685                  2          1   36.517718  21.615395   
30    59140.400255                  1          1   36.154655  21.227094   
31    59144.391759                  1          1   35.415444  20.432652   
32    59144.410544                  2          1   35.411754  20.428770   
33    59157.235995                  2          1   32.902432  17.607816   
34    59164.308414                  2          1   31.572239  15.965531   
35    59164.344097                  1          1   31.565624  15.957268   
36    59166.291470                  2          1   31.223077  15.505689   
37    59170.266956                  2          1   30.566547  14.594135   
38    59172.239479                  1          1   30.265756  14.149791   
39    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  magnitude_uncertainty  
0              16.471214               0.108457  
1              16.409678               0.129850  
2              20.192154               0.178280  
3              16.358088               0.071829  
4              18.976067               0.170550  
5              19.098774               0.178708  
6              19.052930               0.091880  
7              18.866552               0.111349  
8              19.000805               0.124175  
9              18.983727               0.160271  
10             19.122366               0.093317  
11             19.243404               0.105018  
12             19.301159               0.215448  
13             16.225788               0.109682  
14             16.538656               0.199403  
15             19.525230               0.168116  
16             19.692917               0.152464  
17             18.120100               0.207660  
18             17.879800               0.143626  
19             15.706136               0.138835  
20             16.267649               0.146193  
21             16.579355               0.130238  
22             15.209347               0.115743  
23             17.900808               0.182491  
24             20.403624               0.171651  
25             20.593506               0.179858  
26             20.169308               0.190793  
27             20.084251               0.143195  
28             20.582052               0.217129  
29             20.017073               0.141530  
30             20.329580               0.195694  
31             20.295746               0.186697  
32             19.843100               0.108691  
33             19.573830               0.144548  
34             19.879513               0.182747  
35             20.331053               0.161874  
36             20.051088               0.208385  
37             19.858680               0.133551  
38             20.297800               0.209505  
39             18.967524               0.107702  ]",,16.71602177619934,2025-07-28T20:49:36,1.037037037037037,0.675,0.6666666666666666,0.6666666666666666,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,5,"-- Final Query to retrieve detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Temporary table containing Solar System objects of interest with their RA/Dec coordinates    VALUES        ('2003FP134', 123.456, -45.678), -- Replace with actual RA/Dec for '2003FP134'        ('2009UK56', 234.567, -12.345)  -- Replace with actual RA/Dec for '2009UK56') AS c(ssnamenr, ra, dec)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd, -- Detection date    detection.fid, -- Filter identifier    detection.isdiffpos, -- Is difference positive flag    detection.ra, -- Right Ascension    detection.dec, -- Declination    detection.magpsf, -- Difference magnitude    detection.sigmapsf -- Magnitude uncertaintyFROM ss_ztfINNER JOIN detection    ON ss_ztf.candid = detection.candid -- Join ss_ztf and detection on candidINNER JOIN catalog    ON q3c_radial_query(c.ra, c.dec, ss_ztf.ra, ss_ztf.dec, 0.0005556) -- Spatial filtering within 2 arcsecondsWHERE ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objectsORDER BY ss_ztf.ssnamenr, detection.mjd -- Sort by MPC name and detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.896572828292847,2025-07-23T19:48:20,"[Empty DataFrame
Columns: [oid, candid, ssdistnr, ssmagnr, ssnamenr, mjd, fid, isdiffpos, ra, dec, magpsf, sigmapsf]
Index: []]",,17.38760209083557,2025-07-28T20:50:00,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,96,6,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Define the Solar System objects of interest with their RA/Dec coordinates    SELECT '2003FP134' AS source_id, ra_value1 AS ra, dec_value1 AS dec    UNION ALL    SELECT '2009UK56' AS source_id, ra_value2 AS ra, dec_value2 AS dec)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd AS detection_date, -- Detection date    detection.fid AS filter_identifier, -- Filter identifier    detection.isdiffpos, -- Isdiffpos flag    detection.ra, -- RA coordinate    detection.dec, -- Dec coordinate    detection.magpsf AS difference_magnitude, -- Difference magnitude    detection.sigmapsf AS magnitude_uncertainty -- Magnitude uncertaintyFROM     ss_ztfINNER JOIN     catalog    ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcsecondsINNER JOIN     detection    ON ss_ztf.oid = detection.oid -- Join with detection table on oidWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System objectsORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.099454164505005,2025-07-23T19:48:43,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  
27             18.967524               0.107702  ]",,13.637817621231079,2025-07-28T20:50:20,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,7,"-- [FINAL QUERY HERE]SELECT     ss_ztf.*,    detection.mjd AS detection_date,    detection.fid AS filter_identifier,    detection.isdiffpos,    detection.ra,    detection.dec,    detection.magpsf AS difference_magnitude,    detection.sigmapsf AS magnitude_uncertaintyFROM     ss_ztfINNER JOIN     detection ON ss_ztf.oid = detection.oidWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')    AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra, ss_ztf.dec, 0.0005556)ORDER BY     ss_ztf.ssnamenr ASC,     detection.mjd ASC","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.67548441886902,2025-07-23T19:49:09,"[Empty DataFrame
Columns: [oid, candid, ssdistnr, ssmagnr, ssnamenr, detection_date, filter_identifier, isdiffpos, ra, dec, difference_magnitude, magnitude_uncertainty]
Index: []]",,16.063451528549194,2025-07-28T20:50:43,0.0,0.0,0.6666666666666666,0.6666666666666666,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,8,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd AS detection_date, -- Detection date    detection.fid AS filter_identifier, -- Filter identifier    detection.isdiffpos, -- Is difference positive flag    detection.ra, -- Right Ascension    detection.dec, -- Declination    detection.magpsf AS difference_magnitude, -- Difference magnitude    detection.sigmapsf AS magnitude_uncertainty -- Magnitude uncertaintyFROM     ss_ztfINNER JOIN     detectionON     ss_ztf.oid = detection.oid -- Join on object identifierWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System identifiers    AND q3c_radial_query(ss_ztf.ra, ss_ztf.dec, detection.ra, detection.dec, 2/3600.0) -- Spatial query within 2 arcsecondsORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.2930645942688,2025-07-23T19:49:34,[None],"(psycopg2.errors.UndefinedColumn) column ss_ztf.ra does not exist
LINE 20: ...AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra,...
                                                              ^

[SQL: 
-- Corrected Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd AS detection_date, -- Detection date
    detection.fid AS filter_identifier, -- Filter identifier
    detection.isdiffpos, -- Is difference positive flag
    detection.ra, -- Right Ascension
    detection.dec, -- Declination
    detection.magpsf AS difference_magnitude, -- Difference magnitude
    detection.sigmapsf AS magnitude_uncertainty -- Magnitude uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection
ON 
    ss_ztf.candid = detection.candid -- Join on candidate identifier (candid)
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter for specific Solar System identifiers
    AND q3c_radial_query(detection.ra, detection.dec, ss_ztf.ra, ss_ztf.dec, 2/3600.0) -- Spatial query within 2 arcseconds
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.448287725448608,2025-07-28T20:51:02,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,9,"-- Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'WITH catalog AS (    -- Define the Solar System identifiers and their RA/Dec coordinates    VALUES        ('2003FP134', <ra_value1>, <dec_value1>), -- Replace <ra_value1> and <dec_value1> with actual RA/Dec values for 2003FP134        ('2009UK56', <ra_value2>, <dec_value2>)  -- Replace <ra_value2> and <dec_value2> with actual RA/Dec values for 2009UK56) AS catalog(source_id, ra, dec)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd, -- Detection date    detection.fid, -- Filter identifier    detection.isdiffpos, -- Difference image flag    detection.ra, -- Right ascension    detection.dec, -- Declination    detection.magpsf, -- Difference magnitude    detection.sigmapsf -- Difference magnitude uncertaintyFROM     ss_ztfINNER JOIN     detection ON ss_ztf.oid = detection.oid -- Join ss_ztf with detection table on oidINNER JOIN     catalog ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcsecondsWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter by Solar System identifiersORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.893096208572388,2025-07-23T19:49:56,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""<""
LINE 6:         '2003FP134' AS source_id, <ra_value1> AS ra, <dec_va...
                                          ^

[SQL: 
-- Corrected Final Query to retrieve all detections for ZTF objects within 2 arcseconds of Solar System identifiers '2003FP134' and '2009UK56'
WITH catalog AS (
    -- Define the Solar System identifiers and their RA/Dec coordinates
    SELECT 
        '2003FP134' AS source_id, <ra_value1> AS ra, <dec_value1> AS dec
    UNION ALL
    SELECT 
        '2009UK56' AS source_id, <ra_value2> AS ra, <dec_value2> AS dec
)
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd, -- Detection date
    detection.fid, -- Filter identifier
    detection.isdiffpos, -- Difference image flag
    detection.ra, -- Right ascension
    detection.dec, -- Declination
    detection.magpsf, -- Difference magnitude
    detection.sigmapsf -- Difference magnitude uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid -- Join ss_ztf with detection table on candid
INNER JOIN 
    catalog ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcseconds
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter by Solar System identifiers
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.033759832382202,2025-07-28T20:51:18,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,96,10,"-- [FINAL QUERY HERE]WITH catalog AS (    -- Define the Solar System identifiers and their RA/Dec coordinates    VALUES        ('2003FP134', ra_value1, dec_value1), -- Replace ra_value1 and dec_value1 with actual coordinates        ('2009UK56', ra_value2, dec_value2)  -- Replace ra_value2 and dec_value2 with actual coordinates) AS catalog(source_id, ra, dec)SELECT     ss_ztf.*, -- All columns from the ss_ztf table    detection.mjd, -- Detection date    detection.fid, -- Filter identifier    detection.isdiffpos, -- Difference image flag    detection.ra, -- Right ascension    detection.dec, -- Declination    detection.magpsf, -- Difference magnitude    detection.sigmapsf -- Difference magnitude uncertaintyFROM     ss_ztfINNER JOIN     detection ON ss_ztf.oid = detection.oid -- Join ss_ztf and detection tables on oidINNER JOIN     catalog ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcsecondsWHERE     ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter by Solar System identifiersORDER BY     ss_ztf.ssnamenr ASC, -- Sort by Solar System object name    detection.mjd ASC -- Sort by detection date","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,30.969363927841187,2025-07-23T19:50:27,[None],"(psycopg2.errors.UndefinedColumn) column ""ra_value1"" does not exist
LINE 6:         '2003FP134' AS source_id, ra_value1 AS ra, dec_value...
                                          ^

[SQL: 
-- [FINAL QUERY HERE]
WITH catalog AS (
    -- Define the Solar System identifiers and their RA/Dec coordinates
    SELECT 
        '2003FP134' AS source_id, ra_value1 AS ra, dec_value1 AS dec -- Replace ra_value1 and dec_value1 with actual coordinates
    UNION ALL
    SELECT 
        '2009UK56' AS source_id, ra_value2 AS ra, dec_value2 AS dec -- Replace ra_value2 and dec_value2 with actual coordinates
)
SELECT 
    ss_ztf.*, -- All columns from the ss_ztf table
    detection.mjd, -- Detection date
    detection.fid, -- Filter identifier
    detection.isdiffpos, -- Difference image flag
    detection.ra, -- Right ascension
    detection.dec, -- Declination
    detection.magpsf, -- Difference magnitude
    detection.sigmapsf -- Difference magnitude uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid -- Join ss_ztf and detection tables on candid
INNER JOIN 
    catalog ON q3c_radial_query(ss_ztf.ra, ss_ztf.dec, catalog.ra, catalog.dec, 0.0005556) -- Spatial filtering within 2 arcseconds
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56') -- Filter by Solar System identifiers
ORDER BY 
    ss_ztf.ssnamenr ASC, -- Sort by Solar System object name
    detection.mjd ASC -- Sort by detection date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.790072202682495,2025-07-28T20:51:35,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,67,0,"SELECT
    *
FROM
    gaia_ztf
WHERE
    oid IN ('ZTF18acxlskz','ZTF22aanppbi','ZTF22abunrft')
    AND neargaia < 1.5",,,,,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,3.159938335418701,2025-07-28T20:51:38,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,1,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsec-- for objects with ZTF identifiers 'ZTF18acxlskz', 'ZTF22aanppbi', and 'ZTF22abunrft'SELECT *FROM gaia_ztfWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')  AND neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.843280553817749,2025-07-23T19:50:31,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.665844917297363,2025-07-28T20:51:51,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,2,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsecWITH catalog (oid) AS (    VALUES         ('ZTF18acxlskz'),        ('ZTF22aanppbi'),        ('ZTF22abunrft'))SELECT *FROM gaia_ztf gINNER JOIN catalog c ON g.oid = c.oidWHERE g.neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.493300199508667,2025-07-23T19:50:34,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,9.104126930236816,2025-07-28T20:52:04,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,3,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsec-- for objects with ZTF identifiers 'ZTF18acxlskz', 'ZTF22aanppbi', and 'ZTF22abunrft'SELECT *FROM gaia_ztfWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')  AND neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,4.331164836883545,2025-07-23T19:50:39,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.464354038238525,2025-07-28T20:52:16,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,4,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsec-- for objects with ZTF identifiers 'ZTF18acxlskz', 'ZTF22aanppbi', and 'ZTF22abunrft'SELECT *FROM gaia_ztfWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')  AND neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.4935762882232666,2025-07-23T19:50:42,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.004247665405273,2025-07-28T20:52:28,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,5,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsec-- for objects with ZTF identifiers 'ZTF18acxlskz', 'ZTF22aanppbi', and 'ZTF22abunrft'SELECT *FROM gaia_ztfWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')  AND neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.3938686847686768,2025-07-23T19:50:46,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.588249206542969,2025-07-28T20:52:39,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,6,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsec-- for objects with ZTF identifiers 'ZTF18acxlskz', 'ZTF22aanppbi', and 'ZTF22abunrft'SELECT *FROM gaia_ztfWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')  AND neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.1800084114074707,2025-07-23T19:50:49,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.339632987976074,2025-07-28T20:52:51,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,7,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsec-- for objects with ZTF identifiers 'ZTF18acxlskz', 'ZTF22aanppbi', and 'ZTF22abunrft'SELECT *FROM gaia_ztfWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')  AND neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.513537645339966,2025-07-23T19:50:53,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,19.469695568084717,2025-07-28T20:53:14,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,8,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsecWITH catalog (oid) AS (    VALUES         ('ZTF18acxlskz'),        ('ZTF22aanppbi'),        ('ZTF22abunrft'))SELECT *FROM gaia_ztf gINNER JOIN catalog c ON g.oid = c.oidWHERE g.neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.3561031818389893,2025-07-23T19:50:56,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,15.536833047866821,2025-07-28T20:53:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,9,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsec-- for objects with ZTF identifiers 'ZTF18acxlskz', 'ZTF22aanppbi', and 'ZTF22abunrft'SELECT *FROM gaia_ztfWHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')  AND neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.3154635429382324,2025-07-23T19:51:00,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.496137619018555,2025-07-28T20:53:44,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,67,10,"-- Query to find all rows in the 'gaia_ztf' table where the nearest Gaia source lies within 1.5 arcsecWITH catalog (oid) AS (    VALUES         ('ZTF18acxlskz'),        ('ZTF22aanppbi'),        ('ZTF22abunrft'))SELECT *FROM gaia_ztf gINNER JOIN catalog c ON g.oid = c.oidWHERE g.neargaia <= 1.5","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.377283096313477,2025-07-23T19:51:03,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,8.571080923080444,2025-07-28T20:53:56,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,55,0,"SELECT
    *
FROM
    object
WHERE
    oid = 'ZTF20aatxryt'",,,,,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,3.3805694580078125,2025-07-28T20:54:00,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,1,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.005568027496338,2025-07-23T19:51:05,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.33637547492981,2025-07-28T20:54:11,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,2,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.179507255554199,2025-07-23T19:51:07,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.507772922515869,2025-07-28T20:54:23,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,3,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,1.8989801406860352,2025-07-23T19:51:09,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.93914270401001,2025-07-28T20:54:36,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,4,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.1458451747894287,2025-07-23T19:51:12,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.596986293792725,2025-07-28T20:54:48,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,5,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.427107095718384,2025-07-23T19:51:14,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.21585750579834,2025-07-28T20:54:59,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,6,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.2144179344177246,2025-07-23T19:51:17,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.709903240203857,2025-07-28T20:55:11,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,7,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,1.993313789367676,2025-07-23T19:51:19,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.437097549438477,2025-07-28T20:55:22,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,8,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.0098438262939453,2025-07-23T19:51:21,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.364270210266113,2025-07-28T20:55:34,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,9,SELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.844968557357788,2025-07-23T19:51:25,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,8.90892219543457,2025-07-28T20:55:47,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,55,10,-- Query to retrieve all information from the 'object' table for the specified ZTF objectSELECT * FROM objectWHERE oid = 'ZTF20aatxryt',"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.379333019256592,2025-07-23T19:51:28,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.492093324661255,2025-07-28T20:55:58,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,47,0,"SELECT
    oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM
    detection
WHERE
    oid IN ('ZTF23aaawbsc','ZTF21abxlmuw')
    AND rb > 0.7
ORDER BY oid, mjd",,,,,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,3.398568630218506,2025-07-28T20:56:01,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,47,1,"-- Query to retrieve detections for specific ZTF objects with rb > 0.7SELECT     o.oid AS ztf_identifier,  -- ZTF identifier from the object table    d.candid AS candidate_identifier,  -- Candidate identifier from the detection table    d.fid AS filter_identifier,  -- Filter identifier    d.mjd AS detection_date,  -- Detection date    d.isdiffpos AS isdiffpos_flag,  -- Is difference positive flag    d.ra AS detection_ra,  -- Detection right ascension    d.dec AS detection_dec,  -- Detection declination    d.magpsf AS difference_magnitude,  -- Difference magnitude    d.sigmapsf AS magnitude_uncertainty,  -- Magnitude uncertainty    d.rb AS real_bogus_score  -- Real/bogus scoreFROM     detection dINNER JOIN     object o ON d.oid = o.oid  -- Join detection and object tables on oidWHERE     o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- Filter for specific ZTF identifiers    AND d.rb > 0.7  -- Filter for real/bogus score greater than 0.7ORDER BY     o.oid,  -- Sort by ZTF identifier    d.mjd  -- Then sort by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,51.40292954444885,2025-07-23T19:52:19,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos_flag  detection_ra  detection_dec  difference_magnitude  \
0                 1     21.323490      22.390380             20.659400   
1                 1     21.323480      22.390360             20.626290   
2                 1     21.323425      22.390396             20.667300   
3                 1     21.323386      22.390342             20.724100   
4                 1     21.323460      22.390334             19.865335   
..              ...           ...            ...                   ...   
157               1    265.214006      66.206344             19.306845   
158               1    265.213977      66.206306             19.475810   
159               1    265.213962      66.206365             20.027710   
160               1    265.214055      66.206338             20.245500   
161               1    265.213992      66.206356             19.808226   

     magnitude_uncertainty  real_bogus_score  
0                 0.232067          0.712857  
1                 0.211267          0.822857  
2                 0.234949          0.785714  
3                 0.274779          0.797143  
4                 0.192379          0.715714  
..                     ...               ...  
157               0.090955          0.787143  
158               0.106966          0.860000  
159               0.166629          0.808571  
160               0.207126          0.714286  
161               0.112136          0.790000  

[162 rows x 10 columns]]",,9.987798929214478,2025-07-28T20:56:15,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,47,2,"-- Query to retrieve detections for specific ZTF objects with rb > 0.7SELECT     d.oid,          -- ZTF identifier    d.candid,       -- Candidate identifier    d.fid,          -- Filter identifier    d.mjd,          -- Detection date    d.isdiffpos,    -- Is difference positive flag    d.ra,           -- Detection RA coordinate    d.dec,          -- Detection Dec coordinate    d.magpsf,       -- Difference magnitude    d.sigmapsf,     -- Difference magnitude uncertainty    d.rb            -- Real/Bogus scoreFROM     detection dINNER JOIN     object o ON d.oid = o.oid -- Join detection with object table on oidWHERE     d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') -- Filter for specific ZTF identifiers    AND d.rb > 0.7                            -- Filter for rb > 0.7ORDER BY     d.oid,                                    -- Sort by ZTF identifier    d.mjd                                    -- Then sort by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,247.1961178779602,2025-07-23T19:56:27,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.32656979560852,2025-07-28T20:56:29,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,47,3,"-- Query to retrieve detections for specific ZTF objects with rb > 0.7SELECT     oid,                -- ZTF identifier    candid,             -- Candidate identifier    fid,                -- Filter identifier    mjd,                -- Detection date    isdiffpos,          -- Difference flag    ra,                 -- Detection RA coordinate    dec,                -- Detection Dec coordinate    magpsf,             -- Difference magnitude    sigmapsf,           -- Magnitude uncertainty    rb                  -- Real/Bogus scoreFROM     detectionWHERE     oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- Filter for specific ZTF identifiers    AND rb > 0.7                             -- Filter for rb greater than 0.7ORDER BY     oid,                                     -- Sort by ZTF identifier    mjd                                     -- Then sort by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.13849139213562,2025-07-23T19:56:48,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,8.711411476135254,2025-07-28T20:56:41,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,47,4,"-- Query to retrieve detections for specific ZTF objects with rb > 0.7SELECT     oid,                -- ZTF identifier    candid,             -- Candidate identifier    fid,                -- Filter identifier    mjd,                -- Detection date    isdiffpos,          -- Is difference positive flag    ra,                 -- Right ascension    dec,                -- Declination    magpsf,             -- Difference magnitude    sigmapsf,           -- Magnitude uncertainty    rb                  -- Real/Bogus scoreFROM     detectionWHERE     oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') -- Filter for specific ZTF identifiers    AND rb > 0.7                            -- Filter for rb greater than 0.7ORDER BY     oid,                                    -- Sort by ZTF identifier    mjd                                    -- Then by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,40.031012773513794,2025-07-23T19:57:28,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.711114168167114,2025-07-28T20:56:54,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,47,5,"-- Query to retrieve detections for specific ZTF objects with rb > 0.7SELECT     o.oid AS ztf_identifier,  -- ZTF identifier from the object table    d.candid AS candidate_identifier,  -- Candidate identifier from the detection table    d.fid AS filter_identifier,  -- Filter identifier    d.mjd AS detection_date,  -- Detection date    d.isdiffpos AS isdiffpos_flag,  -- Is difference positive flag    d.ra AS detection_ra,  -- Detection right ascension    d.dec AS detection_dec,  -- Detection declination    d.magpsf AS difference_magnitude,  -- Difference magnitude    d.sigmapsf AS magnitude_uncertainty,  -- Magnitude uncertainty    d.rb AS real_bogus_score  -- Real/bogus scoreFROM     object oINNER JOIN     detection dON     o.oid = d.oid  -- Join on the object identifierWHERE     o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- Filter for specific ZTF identifiers    AND d.rb > 0.7  -- Filter for real/bogus score greater than 0.7ORDER BY     o.oid ASC,  -- Sort by ZTF identifier    d.mjd ASC  -- Then sort by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.83578848838806,2025-07-23T19:57:50,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos_flag  detection_ra  detection_dec  difference_magnitude  \
0                 1     21.323490      22.390380             20.659400   
1                 1     21.323480      22.390360             20.626290   
2                 1     21.323425      22.390396             20.667300   
3                 1     21.323386      22.390342             20.724100   
4                 1     21.323460      22.390334             19.865335   
..              ...           ...            ...                   ...   
157               1    265.214006      66.206344             19.306845   
158               1    265.213977      66.206306             19.475810   
159               1    265.213962      66.206365             20.027710   
160               1    265.214055      66.206338             20.245500   
161               1    265.213992      66.206356             19.808226   

     magnitude_uncertainty  real_bogus_score  
0                 0.232067          0.712857  
1                 0.211267          0.822857  
2                 0.234949          0.785714  
3                 0.274779          0.797143  
4                 0.192379          0.715714  
..                     ...               ...  
157               0.090955          0.787143  
158               0.106966          0.860000  
159               0.166629          0.808571  
160               0.207126          0.714286  
161               0.112136          0.790000  

[162 rows x 10 columns]]",,10.442785263061523,2025-07-28T20:57:08,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,47,6,"-- Query to retrieve detections for specific ZTF objects with rb > 0.7SELECT     o.oid AS ztf_identifier,  -- ZTF identifier from the object table    d.candid AS candidate_identifier,  -- Candidate identifier from the detection table    d.fid AS filter_identifier,  -- Filter identifier from the detection table    d.mjd AS detection_date,  -- Detection date from the detection table    d.isdiffpos,  -- Is difference positive flag    d.ra AS detection_ra,  -- Detection right ascension    d.dec AS detection_dec,  -- Detection declination    d.magpsf AS difference_magnitude,  -- Difference magnitude    d.sigmapsf AS magnitude_uncertainty,  -- Magnitude uncertainty    d.rb AS real_bogus_score  -- Real/bogus scoreFROM     object oINNER JOIN     detection d ON o.oid = d.oid  -- Join object and detection tables on oidWHERE     o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- Filter for specific ZTF identifiers    AND d.rb > 0.7  -- Filter for real/bogus score greater than 0.7ORDER BY     o.oid ASC,  -- Sort by ZTF identifier    d.mjd ASC  -- Then sort by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,22.735095024108887,2025-07-23T19:58:13,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos  detection_ra  detection_dec  difference_magnitude  \
0            1     21.323490      22.390380             20.659400   
1            1     21.323480      22.390360             20.626290   
2            1     21.323425      22.390396             20.667300   
3            1     21.323386      22.390342             20.724100   
4            1     21.323460      22.390334             19.865335   
..         ...           ...            ...                   ...   
157          1    265.214006      66.206344             19.306845   
158          1    265.213977      66.206306             19.475810   
159          1    265.213962      66.206365             20.027710   
160          1    265.214055      66.206338             20.245500   
161          1    265.213992      66.206356             19.808226   

     magnitude_uncertainty  real_bogus_score  
0                 0.232067          0.712857  
1                 0.211267          0.822857  
2                 0.234949          0.785714  
3                 0.274779          0.797143  
4                 0.192379          0.715714  
..                     ...               ...  
157               0.090955          0.787143  
158               0.106966          0.860000  
159               0.166629          0.808571  
160               0.207126          0.714286  
161               0.112136          0.790000  

[162 rows x 10 columns]]",,9.895444869995117,2025-07-28T20:57:22,1.0,1.0,0.1,0.1,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,47,7,"-- Query to retrieve detections for specific ZTF objects with rb > 0.7SELECT     d.oid,          -- ZTF identifier    d.candid,       -- Candidate identifier    d.fid,          -- Filter identifier    d.mjd,          -- Detection date    d.isdiffpos,    -- Is difference positive flag    d.ra,           -- Detection RA coordinate    d.dec,          -- Detection Dec coordinate    d.magpsf,       -- Difference magnitude    d.sigmapsf,     -- Magnitude uncertainty    d.rb            -- Real/Bogus scoreFROM     detection dINNER JOIN     object o ON d.oid = o.oid -- Join detection with object table on oidWHERE     d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') -- Filter for specific ZTF identifiers    AND d.rb > 0.7                            -- Filter for rb > 0.7ORDER BY     d.oid ASC,                                -- Sort by ZTF identifier    d.mjd ASC                                -- Then sort by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.55471181869507,2025-07-23T19:58:33,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.745595932006836,2025-07-28T20:57:35,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,47,8,"-- Query to retrieve detections for specific ZTF objects with a real/bogus score greater than 0.7SELECT     d.oid,          -- ZTF identifier    d.candid,       -- Candidate identifier    d.fid,          -- Filter identifier    d.mjd,          -- Detection date    d.isdiffpos,    -- Is difference positive flag    d.ra,           -- Detection right ascension    d.dec,          -- Detection declination    d.magpsf,       -- Difference magnitude    d.sigmapsf,     -- Difference magnitude uncertainty    d.rb            -- Real/bogus scoreFROM     detection dWHERE     d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') -- Filter for specific ZTF object identifiers    AND d.rb > 0.7                            -- Filter for real/bogus score greater than 0.7ORDER BY     d.oid,                                    -- Sort by ZTF identifier    d.mjd                                    -- Then sort by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,24.086713790893555,2025-07-23T19:58:57,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,10.12717890739441,2025-07-28T20:57:49,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,47,9,"-- Query to retrieve detections for specific ZTF objects with a real/bogus score greater than 0.7SELECT     oid,            -- ZTF identifier    candid,         -- Candidate identifier    fid,            -- Filter identifier    mjd,            -- Detection date    isdiffpos,      -- Is difference positive flag    ra,             -- Right ascension    dec,            -- Declination    magpsf,         -- Difference magnitude    sigmapsf,       -- Uncertainty in the difference magnitude    rb              -- Real/bogus scoreFROM     detectionWHERE     oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') -- Filter for specific ZTF identifiers    AND rb > 0.7                            -- Filter for real/bogus score greater than 0.7ORDER BY     oid,                                    -- Sort by ZTF identifier    mjd                                    -- Then sort by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,19.368067502975464,2025-07-23T19:59:17,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.465362071990967,2025-07-28T20:58:02,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,47,10,"-- Query to retrieve detections for specific ZTF objects with rb > 0.7SELECT     oid,                -- ZTF identifier    candid,             -- Candidate identifier    fid,                -- Filter identifier    mjd,                -- Detection date    isdiffpos,          -- Difference flag    ra,                 -- Right ascension    dec,                -- Declination    magpsf,             -- Difference magnitude    sigmapsf,           -- Magnitude uncertainty    rb                  -- Real/Bogus scoreFROM     detectionWHERE     oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- Filter for specific ZTF identifiers    AND rb > 0.7                             -- Filter for rb > 0.7ORDER BY     oid,                                     -- Sort by ZTF identifier    mjd                                     -- Then by detection date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,19.66622972488404,2025-07-23T19:59:37,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.428404808044434,2025-07-28T20:58:16,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,79,0,"SELECT
    catid, oid_catalog, dist
FROM
    xmatch
WHERE
    oid = 'ZTF20achscch'",,,,,"[     catid           oid_catalog      dist
0  allwise  3413m137_ac51-045753  0.290982]",,3.2962327003479004,2025-07-28T20:58:19,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,79,1,"SELECT     xmatch.catid AS catalog_name,     xmatch.oid_catalog AS object_identifier_in_catalog,     xmatch.dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     xmatch.oid = 'ZTF20achscch'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,4.4152679443359375,2025-07-23T19:59:41,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,7.897062540054321,2025-07-28T20:58:31,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,2,"SELECT     xmatch.catid AS catalog_name,     xmatch.oid_catalog AS object_identifier_in_catalog,     xmatch.dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     xmatch.oid = 'ZTF20achscch'","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.8222410678863525,2025-07-23T19:59:44,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,16.9474835395813,2025-07-28T20:58:52,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,3,"SELECT     catid AS catalog_name,     oid_catalog AS object_identifier_in_catalog,     dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     oid = 'ZTF20achscch'","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.0591423511505127,2025-07-23T19:59:47,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,15.548723459243774,2025-07-28T20:59:11,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,4,"SELECT     catid AS catalog_name,     oid_catalog AS object_identifier_in_catalog,     dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     oid = 'ZTF20achscch'","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.112679481506348,2025-07-23T19:59:51,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,7.483219385147095,2025-07-28T20:59:22,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,5,"SELECT     catid AS catalog_name,     oid_catalog AS object_identifier_in_catalog,     dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     oid = 'ZTF20achscch'","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.139296054840088,2025-07-23T19:59:55,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,7.7776172161102295,2025-07-28T20:59:33,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,6,"SELECT     catid AS catalog_name,     oid_catalog AS object_identifier_in_catalog,     dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     oid = 'ZTF20achscch'","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,5.208641052246094,2025-07-23T20:00:00,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,7.907463312149048,2025-07-28T20:59:45,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,7,"SELECT     catid AS catalog_name,     oid_catalog AS object_identifier_in_catalog,     dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     oid = 'ZTF20achscch'","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.724215269088745,2025-07-23T20:00:03,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,8.206051349639893,2025-07-28T20:59:56,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,8,"SELECT     catid AS catalog_name,     oid_catalog AS object_identifier_in_catalog,     dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     oid = 'ZTF20achscch'","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.940927267074585,2025-07-23T20:00:07,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,8.526800155639648,2025-07-28T21:00:08,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,9,"SELECT     catid AS catalog_name,     oid_catalog AS object_identifier_in_catalog,     dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     oid = 'ZTF20achscch'","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.053370714187622,2025-07-23T20:00:10,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,8.04258680343628,2025-07-28T21:00:20,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,79,10,"SELECT     catid AS catalog_name,     oid_catalog AS object_identifier_in_catalog,     dist AS distance_from_catalog_counterpartFROM     xmatchWHERE     oid = 'ZTF20achscch'","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.5776138305664062,2025-07-23T20:00:13,"[  catalog_name object_identifier_in_catalog  distance_from_catalog_counterpart
0      allwise         3413m137_ac51-045753                           0.290982]",,7.506229639053345,2025-07-28T21:00:31,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,94,0,"SELECT
    *
FROM
    object INNER JOIN
    reference
    ON object.oid = reference.oid
WHERE
    reference_change
LIMIT 50",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abiqmqs       663      1775  58246.438426  60884.218125       True   
1   ZTF18abiqmqs       663      1775  58246.438426  60884.218125       True   
2   ZTF18abluvzg       293      1805  58337.325949  60882.287894       True   
3   ZTF18abluvzg       293      1805  58337.325949  60882.287894       True   
4   ZTF18abhpazr       295      3820  58217.508171  60804.482488       True   
5   ZTF18abhpazr       295      3820  58217.508171  60804.482488       True   
6   ZTF18abhpazr       295      3820  58217.508171  60804.482488       True   
7   ZTF18abhpazr       295      3820  58217.508171  60804.482488       True   
8   ZTF18abcgmvw      1106      1667  58218.504826  60882.267778       True   
9   ZTF18abcgmvw      1106      1667  58218.504826  60882.267778       True   
10  ZTF18abbxrwd       848      1675  58278.395602  60884.268090       True   
11  ZTF18abbxrwd       848      1675  58278.395602  60884.268090       True   
12  ZTF18aazdjlo      1237      3185  58217.507188  60838.397477       True   
13  ZTF18aazdjlo      1237      3185  58217.507188  60838.397477       True   
14  ZTF18aazdjlo      1237      3185  58217.507188  60838.397477       True   
15  ZTF18abaiser       296      2190  58231.490266  60882.277743       True   
16  ZTF18abaiser       296      2190  58231.490266  60882.277743       True   
17  ZTF18abcqldj       223      2860  58291.354340  60882.255509       True   
18  ZTF18abcqldj       223      2860  58291.354340  60882.255509       True   
19  ZTF18abcqldj       223      2860  58291.354340  60882.255509       True   
20  ZTF18abcqldj       223      2860  58291.354340  60882.255509       True   
21  ZTF18abbxryd       957      5075  58247.456551  60884.254375       True   
22  ZTF18abbxryd       957      5075  58247.456551  60884.254375       True   
23  ZTF18abbxryd       957      5075  58247.456551  60884.254375       True   
24  ZTF18abbxryd       957      5075  58247.456551  60884.254375       True   
25  ZTF18abbxryd       957      5075  58247.456551  60884.254375       True   
26  ZTF18abbxryd       957      5075  58247.456551  60884.254375       True   
27  ZTF18aarkiwd       738      5121  58095.075336  60847.365833       True   
28  ZTF18aarkiwd       738      5121  58095.075336  60847.365833       True   
29  ZTF18aarkiwd       738      5121  58095.075336  60847.365833       True   
30  ZTF18aarkiwd       738      5121  58095.075336  60847.365833       True   
31  ZTF18abcyvid       417      2028  58294.316678  60865.252211       True   
32  ZTF18abcyvid       417      2028  58294.316678  60865.252211       True   
33  ZTF18abcyvid       417      2028  58294.316678  60865.252211       True   
34  ZTF18abirbsq       188      3075  58262.375336  60882.227384       True   
35  ZTF18abirbsq       188      3075  58262.375336  60882.227384       True   
36  ZTF18abirbsq       188      3075  58262.375336  60882.227384       True   
37  ZTF18abirbsq       188      3075  58262.375336  60882.227384       True   
38  ZTF18abdpukz        17      3643  58287.458599  60739.492685       True   
39  ZTF18abdpukz        17      3643  58287.458599  60739.492685       True   
40  ZTF18abdpukz        17      3643  58287.458599  60739.492685       True   
41  ZTF18abdpukz        17      3643  58287.458599  60739.492685       True   
42  ZTF18abjlvvy         4      3643  59082.300648  60739.492685       True   
43  ZTF18abjlvvy         4      3643  59082.300648  60739.492685       True   
44  ZTF18abjlvvy         4      3643  59082.300648  60739.492685       True   
45  ZTF18abnjwmh       553      2666  58208.507743  60884.266678       True   
46  ZTF18abnjwmh       553      2666  58208.507743  60884.266678       True   
47  ZTF18abnjwmh       553      2666  58208.507743  60884.266678       True   
48  ZTF18abecvmy        12      3642  58303.405208  60739.492685       True   
49  ZTF18abecvmy        12      3642  58303.405208  60739.492685       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False   367    None         None  ...   334  15.492000     0.009  0.501   
1     False   367    None         None  ...   334  13.454000     0.012  0.350   
2     False   173    None         None  ...   333  18.644000     0.022  0.713   
3     False   173    None         None  ...   333  15.811999     0.023  0.600   
4     False   224    None         None  ...   590  16.256000     0.015  0.594   
5     False   224    None         None  ...   589  16.255001     0.023  1.033   
6     False   224    None         None  ...   589  15.257999     0.021  0.529   
7     False   224    None         None  ...   590  15.269000     0.016  0.406   
8     False   592    None         None  ...   383  17.397000     0.021  1.263   
9     False   592    None         None  ...   383  15.953000     0.043  3.088   
10    False   500    None         None  ...   383  15.316000     0.012  0.383   
11    False   500    None         None  ...   383  14.395000     0.015  0.475   
12    False   523    None         None  ...   539  20.697000     0.075  1.228   
13    False   523    None         None  ...   539  17.905000     0.062  3.694   
14    False   523    None         None  ...  1533  16.804000     0.032  1.366   
15    False   298    None         None  ...   799  14.454000     0.018  0.769   
16    False   298    None         None  ...   799  15.223000     0.012  0.112   
17    False   158    None         None  ...   333  14.283999     0.015  0.654   
18    False   158    None         None  ...   383  15.499000     0.016  0.797   
19    False   158    None         None  ...   333  15.544000     0.011  0.155   
20    False   158    None         None  ...   383  14.308000     0.021  0.791   
21    False   558    None         None  ...   333  14.072000     0.017  0.510   
22    False   558    None         None  ...   384  16.686000     0.012  0.314   
23    False   558    None         None  ...   383  16.644001     0.018  1.151   
24    False   558    None         None  ...   333  16.750000     0.013  0.568   
25    False   558    None         None  ...   384  14.021999     0.018  0.446   
26    False   558    None         None  ...   383  13.964000     0.015  0.511   
27    False   466    None         None  ...   767  13.262000     0.018  0.520   
28    False   466    None         None  ...   767  14.013000     0.017  0.705   
29    False   466    None         None  ...   766  14.021000     0.010  0.556   
30    False   466    None         None  ...   766  13.256000     0.009  0.348   
31    False   123    None         None  ...   486  13.108999     0.021  0.796   
32    False   123    None         None  ...   486  14.632999     0.019  0.727   
33    False   123    None         None  ...  1480  13.190000     0.029  1.119   
34    False    66    None         None  ...   334  15.030000     0.010  0.407   
35    False    66    None         None  ...   335  14.377000     0.019  0.898   
36    False    66    None         None  ...   335  15.012000     0.016  0.807   
37    False    66    None         None  ...   334  14.354000     0.016  0.523   
38    False    10    None         None  ...   686  14.276000     0.023  1.034   
39    False    10    None         None  ...   686  14.091000     0.043  1.863   
40    False    10    None         None  ...   685  14.266000     0.028  1.833   
41    False    10    None         None  ...   685  14.047999     0.035  1.853   
42     True     3    None         None  ...   686  15.453000     0.014  0.364   
43     True     3    None         None  ...   685  15.458000     0.017  0.741   
44     True     3    None         None  ...   685  14.995999     0.020  0.516   
45    False   383    None         None  ...   435  13.648000     0.012  0.310   
46    False   383    None         None  ...   384  13.760000     0.011  0.395   
47    False   383    None         None  ...   435  12.400000     0.027  1.136   
48    False     9    None         None  ...   685  13.755000     0.013  0.298   
49    False     9    None         None  ...   686  13.764999     0.014  0.379   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.007  282.613855 -14.507282  58246.460394  58372.229803         16  
1     0.030  282.613862 -14.507273  58262.375336  58319.337558         40  
2    -0.018  278.943286 -15.629627  58262.401238  58364.209062         15  
3    -0.019  278.943304 -15.629619  58304.355938  58315.282257         40  
4     0.005  285.383078  20.492031  58204.508125  58247.393692         15  
5     0.067  285.383091  20.492043  58203.505521  58281.380498         15  
6    -0.020  285.383090  20.492032  58186.528900  58293.315602         15  
7     0.004  285.383077  20.492031  58186.533102  58255.442049         15  
8     0.097  276.483216 -12.769815  58205.526910  58286.404757         15  
9     0.041  276.483253 -12.769800  58218.482928  58292.312303         18  
10    0.000  276.563460 -13.128947  58205.526910  58286.404757         15  
11   -0.013  276.563465 -13.128948  58218.482928  58292.312303         18  
12   -0.112  282.647090   9.017773  58204.507674  58273.443079         15  
13   -0.160  282.647068   9.017743  58186.533692  58291.315440         20  
14   -0.296  282.647064   9.017749  58338.250000  59459.250000         16  
15   -0.044  289.272909  51.860004  58219.484155  58305.391817         15  
16    0.001  289.272908  51.860000  58204.517697  58280.406725         15  
17   -0.026  276.559192 -13.352346  58246.431273  58305.355324         15  
18   -0.046  276.559208 -13.352363  58205.526910  58286.404757         15  
19    0.004  276.559194 -13.352342  58262.401238  58347.190440         15  
20   -0.050  276.559219 -13.352357  58218.482928  58292.312303         18  
21    0.030  276.998245 -13.329665  58257.440301  58314.308438         40  
22   -0.016  276.998226 -13.329705  58246.462245  58290.398206         15  
23   -0.050  276.998275 -13.329705  58205.526910  58286.404757         15  
24    0.012  276.998246 -13.329667  58262.401238  58364.209062         15  
25   -0.023  276.998223 -13.329687  58218.468831  58316.333461         39  
26   -0.044  276.998281 -13.329683  58218.482928  58292.312303         18  
27   -0.029  298.341611  50.323620  58216.517650  58432.097662         15  
28   -0.008  298.341611  50.323609  58204.514826  58323.425509         15  
29   -0.009  298.341617  50.323608  58204.515312  58235.494664         15  
30   -0.001  298.341607  50.323619  58186.530729  58242.478241         15  
31    0.010  277.321971   4.316247  58186.534896  58291.331863         15  
32    0.035  277.321969   4.316237  58204.529514  58320.208646         15  
33    0.101  277.321960   4.316211  58593.250000  59775.250000         15  
34   -0.003  287.185013 -16.236163  58246.460394  58607.417639         15  
35   -0.044  287.185006 -16.236164  58246.457037  58365.189132         15  
36   -0.051  287.185007 -16.236165  58246.460868  58365.250845         15  
37   -0.003  287.185012 -16.236167  58292.313669  58319.341204         40  
38    0.128  294.562358  30.926876  58204.513900  58293.422199         21  
39    0.256  294.562360  30.926866  58198.529977  58338.201771         15  
40    0.080  294.562419  30.926858  58204.509549  58293.422674         16  
41    0.089  294.562408  30.926847  58186.500000  58341.250000         16  
42   -0.034  294.571946  30.781503  58204.513900  58293.422199         21  
43   -0.046  294.572021  30.781515  58204.509549  58293.422674         16  
44   -0.032  294.571991  30.781500  58186.500000  58341.250000         16  
45   -0.003  280.708395  -6.249325  58231.479722  58290.400069         15  
46    0.031  280.708357  -6.249309  58206.488125  58374.209294         21  
47    0.048  280.708379  -6.249302  58320.272847  58373.144907         18  
48   -0.011  294.526731  30.714594  58204.509549  58293.422674         16  
49   -0.014  294.526653  30.714584  58204.513900  58293.422199         21  

[50 rows x 36 columns]]",,3.3849847316741943,2025-07-28T21:00:35,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,1,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,22.20355105400085,2025-07-23T20:00:35,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18acrygzw       480       985  58450.548171  60857.228206       True   
1   ZTF18acrygzw       480       985  58450.548171  60857.228206       True   
2   ZTF19abnxdsn       446      1774  58643.323495  60872.404688       True   
3   ZTF19abnxdsn       446      1774  58643.323495  60872.404688       True   
4   ZTF18abcwemh       180      1900  58257.441215  60882.282164       True   
5   ZTF18abcwemh       180      1900  58257.441215  60882.282164       True   
6   ZTF18abijruw       965      2074  58257.441215  60884.266678       True   
7   ZTF18abijruw       965      2074  58257.441215  60884.266678       True   
8   ZTF18abplyih       384      1280  58257.441215  60853.336227       True   
9   ZTF18abplyih       384      1280  58257.441215  60853.336227       True   
10  ZTF18abplyih       384      1280  58257.441215  60853.336227       True   
11  ZTF19abjjhsj        26      1415  58693.291424  60879.255671       True   
12  ZTF19abjjhsj        26      1415  58693.291424  60879.255671       True   
13  ZTF18abmbdkv      1393      3080  58236.459641  60883.189491       True   
14  ZTF18abmbdkv      1393      3080  58236.459641  60883.189491       True   
15  ZTF18abmbdkv      1393      3080  58236.459641  60883.189491       True   
16  ZTF18abmbdkv      1393      3080  58236.459641  60883.189491       True   
17  ZTF18abcgolw       257      1996  58262.402188  60876.255590       True   
18  ZTF18abcgolw       257      1996  58262.402188  60876.255590       True   
19  ZTF18abmwzvq      1064      3133  58198.418715  60865.282199       True   
20  ZTF18abmwzvq      1064      3133  58198.418715  60865.282199       True   
21  ZTF17aaburgu       310      2183  58095.113495  60823.370382       True   
22  ZTF17aaburgu       310      2183  58095.113495  60823.370382       True   
23  ZTF19abcxcmt       345      1361  58666.292743  60883.215278       True   
24  ZTF18abztmom        29      1982  58104.449063  60780.242720       True   
25  ZTF18abztmom        29      1982  58104.449063  60780.242720       True   
26  ZTF18abztmom        29      1982  58104.449063  60780.242720       True   
27  ZTF18abztmom        29      1982  58104.449063  60780.242720       True   
28  ZTF18abnoqcs       303       987  58286.313461  60829.356655       True   
29  ZTF18abnoqcs       303       987  58286.313461  60829.356655       True   
30  ZTF18abpfjhy        48      1562  58287.292708  60879.255671       True   
31  ZTF18abpfjhg        45      1562  58287.292708  60879.255671       True   
32  ZTF18acmubbp        14      3399  58436.362685  60780.240359       True   
33  ZTF18acmubbp        14      3399  58436.362685  60780.240359       True   
34  ZTF18acmubbp        14      3399  58436.362685  60780.240359       True   
35  ZTF18acmubbp        14      3399  58436.362685  60780.240359       True   
36  ZTF19aatzzfd        23      3038  58608.418588  60879.255671       True   
37  ZTF19aatzzfd        23      3038  58608.418588  60879.255671       True   
38  ZTF19aatzzfd        23      3038  58608.418588  60879.255671       True   
39  ZTF18aahqvdd       295      1536  58173.291065  60780.237824       True   
40  ZTF18aahqvdd       295      1536  58173.291065  60780.237824       True   
41  ZTF18aahqvdd       295      1536  58173.291065  60780.237824       True   
42  ZTF18acvvzqg       252       993  58465.503299  60825.208565       True   
43  ZTF18acvvzqg       252       993  58465.503299  60825.208565       True   
44  ZTF18acvvzqg       252       993  58465.503299  60825.208565       True   
45  ZTF19abnnnvp       959      1908  58640.264317  60868.360729       True   
46  ZTF19abnnnvp       959      1908  58640.264317  60868.360729       True   
47  ZTF19abnnnvp       959      1908  58640.264317  60868.360729       True   
48  ZTF18abhdvdl       264      1946  58254.480498  60883.297280       True   
49  ZTF18abhdvdl       264      1946  58254.480498  60883.297280       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False   311    None         None  ...   372  15.502999     0.013  0.414   
1     False   311    None         None  ...   372  15.766000     0.012  0.715   
2     False   281    None         None  ...   875  14.039000     0.017  0.290   
3     False   281    None         None  ...   875  13.381000     0.020  0.572   
4     False    82    None         None  ...   435  16.744000     0.016  0.365   
5     False    82    None         None  ...   435  18.216000     0.018  0.645   
6     False   542    None         None  ...   435  15.848000     0.019  0.815   
7     False   542    None         None  ...   435  13.080999     0.016  0.338   
8     False   107    None         None  ...   435  18.126000     0.021  0.911   
9     False   107    None         None  ...   435  15.108000     0.021  0.822   
10    False   107    None         None  ...  1429  15.079000     0.027  0.893   
11    False    14    None         None  ...   333  17.960001     0.014  0.654   
12    False    14    None         None  ...   333  16.778000     0.015  0.661   
13    False   919    None         None  ...   485  14.559000     0.035  1.987   
14    False   919    None         None  ...   486  14.544000     0.017  0.485   
15    False   919    None         None  ...   485  12.606999     0.017  0.405   
16    False   919    None         None  ...   486  12.634999     0.020  0.502   
17    False   162    None         None  ...   435  15.280000     0.013  0.536   
18    False   162    None         None  ...   435  14.032000     0.017  0.400   
19    False   376    None         None  ...   585  17.639000     0.017  0.438   
20    False   376    None         None  ...   585  17.887001     0.017  0.564   
21    False   232    None         None  ...   731  15.503000     0.012  0.165   
22    False   232    None         None  ...   731  14.990999     0.019  0.540   
23    False    94    None         None  ...   333  19.716000     0.044  0.967   
24    False    17    None         None  ...  1657  14.756000     0.020  0.972   
25    False    17    None         None  ...   660  14.190000     0.014  0.711   
26    False    17    None         None  ...  1657  14.191999     0.014  0.750   
27    False    17    None         None  ...   660  14.769000     0.015  0.533   
28    False    82    None         None  ...   280  17.138000     0.013  0.719   
29    False    82    None         None  ...   280  14.570000     0.034  1.272   
30    False    15    None         None  ...   333  16.250000     0.022  0.641   
31    False    19    None         None  ...   333  15.643000     0.038  1.888   
32    False     7    None         None  ...   461  13.990000     0.015  0.662   
33    False     7    None         None  ...   462  13.940000     0.014  0.369   
34    False     7    None         None  ...   461  15.005000     0.015  0.884   
35    False     7    None         None  ...   462  14.969000     0.013  0.539   
36    False     9    None         None  ...   333  13.816000     0.011  0.453   
37    False     9    None         None  ...   383  13.802000     0.012  0.378   
38    False     9    None         None  ...   383  13.287999     0.013  0.356   
39    False   142    None         None  ...   570  14.631000     0.018  0.931   
40    False   142    None         None  ...  1616  15.099999     0.013  0.367   
41    False   142    None         None  ...   570  15.073999     0.018  0.819   
42    False   207    None         None  ...   421  14.233000     0.016  0.718   
43    False   207    None         None  ...   421  14.603000     0.011  0.516   
44    False   207    None         None  ...   421  14.573000     0.013  0.340   
45    False   589    None         None  ...   875  16.574000     0.021  0.728   
46    False   589    None         None  ...   875  16.230000     0.021  0.621   
47    False   589    None         None  ...   875  16.629000     0.015  0.478   
48    False   163    None         None  ...   386  16.173000     0.011  0.299   
49    False   163    None         None  ...   385  16.136000     0.020  0.924   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.027  194.078481 -12.365855  58219.280856  58449.557037         17  
1    -0.031  194.078483 -12.365850  58203.305139  58487.499074         15  
2    -0.007  268.777688  86.473638  58634.243924  58697.327789         15  
3    -0.027  268.777636  86.473643  58637.304711  58717.316146         15  
4     0.010  279.424509  -4.370674  58217.505266  58344.170660         15  
5     0.016  279.424499  -4.370677  58205.527373  58283.401076         15  
6    -0.040  279.488323  -4.121993  58205.527373  58283.401076         15  
7    -0.001  279.488323  -4.121981  58217.505266  58344.170660         15  
8    -0.041  279.280077  -3.640100  58205.527373  58283.401076         15  
9    -0.084  279.280074  -3.640078  58217.505266  58344.170660         15  
10   -0.055  279.280090  -3.640092  58593.500000  59821.250000         16  
11   -0.020  275.433130 -13.437401  58262.401238  58364.209062         15  
12   -0.016  275.433130 -13.437399  58246.431273  58305.355324         15  
13   -0.082  270.776254   7.404732  58204.489271  58347.194144         15  
14    0.035  270.776244   7.404732  58204.529514  58334.302222         15  
15    0.022  270.776253   7.404746  58186.535486  58331.209201         15  
16   -0.010  270.776239   7.404738  58186.534896  58337.208449         15  
17   -0.027  277.960669  -5.680880  58205.527373  58287.335880         15  
18   -0.009  277.960670  -5.680881  58218.483854  58305.356238         15  
19    0.022  251.581870  17.714711  58158.469734  58387.125069         40  
20    0.020  251.581864  17.714717  58229.464051  58343.184086         15  
21   -0.002  319.936997  41.699738  58230.492130  58338.365278         15  
22   -0.017  319.937003  41.699715  58218.490532  58449.233414         40  
23    0.018  276.421577 -15.905837  58244.479745  58365.130023         21  
24   -0.060   94.492484  32.462264  58166.168252  58495.224375         15  
25   -0.001   94.492469  32.462293  58154.172512  58367.505776         15  
26   -0.059   94.492477  32.462269  58154.250000  58750.500000         35  
27   -0.019   94.492474  32.462269  58166.178715  58423.456678         15  
28   -0.005  260.970575 -23.657599  58248.376412  58670.278646         15  
29   -0.049  260.970596 -23.657575  58257.438449  58302.280324         40  
30   -0.054  275.796895 -18.774311  58247.456551  58313.312303         25  
31    0.112  276.341337 -18.166433  58247.456551  58313.312303         25  
32   -0.009  106.931649   1.094957  58219.199317  58432.413461         16  
33   -0.028  106.931633   1.094944  58160.250000  58449.500000         19  
34    0.004  106.931671   1.094932  58368.500000  58425.500000         15  
35   -0.024  106.931641   1.094939  58204.250000  58443.250000         21  
36   -0.015  275.012136 -13.425253  58262.401238  58364.209062         15  
37   -0.013  275.012137 -13.425266  58205.526910  58287.335428         15  
38    0.001  275.012146 -13.425269  58218.500000  58291.250000         15  
39   -0.036  147.433544  21.505308  58154.275069  58186.254398         25  
40    0.021  147.433548  21.505297  58428.500000  59250.500000         16  
41   -0.061  147.433529  21.505314  58166.280937  58440.461065         21  
42   -0.028  177.773713  -0.048121  58165.388692  58448.543576         18  
43   -0.014  177.773711  -0.048121  58204.299977  58482.544653         16  
44   -0.019  177.773712  -0.048128  58204.250000  59923.500000        100  
45   -0.038  277.161041  81.243141  58652.250000  59846.250000        100  
46   -0.031  277.161057  81.243147  58637.304711  58701.282639         15  
47   -0.013  277.161013  81.243144  58634.243924  58696.308507         15  
48    0.007  291.046799  -7.371612  58246.480012  58366.228738         15  
49   -0.065  291.046809  -7.371613  58246.461319  58366.189525         15  

[50 rows x 36 columns]]",,8.965547323226929,2025-07-28T21:00:48,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,2,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where the reference image has changed, limiting the result to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,33.746368169784546,2025-07-23T20:01:09,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abmmasb       306      2896  58237.488252  60884.262870       True   
1   ZTF18abmmasb       306      2896  58237.488252  60884.262870       True   
2   ZTF18abegtuc        66      3562  58316.306979  60881.275359       True   
3   ZTF18abegtuc        66      3562  58316.306979  60881.275359       True   
4   ZTF18abegtuc        66      3562  58316.306979  60881.275359       True   
5   ZTF18abaglhh       800      1794  58218.424757  60859.340255       True   
6   ZTF18abaglhh       800      1794  58218.424757  60859.340255       True   
7   ZTF18abcysre      1382      3910  58236.459641  60884.190162       True   
8   ZTF18abcysre      1382      3910  58236.459641  60884.190162       True   
9   ZTF18abcysre      1382      3910  58236.459641  60884.190162       True   
10  ZTF18abcysre      1382      3910  58236.459641  60884.190162       True   
11  ZTF18abgqypf      1725      2304  58232.417708  60884.265729       True   
12  ZTF18abgqypf      1725      2304  58232.417708  60884.265729       True   
13  ZTF18abgqypf      1725      2304  58232.417708  60884.265729       True   
14  ZTF19abjwmju        16      2824  58694.307870  60828.343218       True   
15  ZTF19abjwmju        16      2824  58694.307870  60828.343218       True   
16  ZTF19abjwmju        16      2824  58694.307870  60828.343218       True   
17  ZTF19abjwmju        16      2824  58694.307870  60828.343218       True   
18  ZTF18abjnizf        10      4318  58317.370590  60828.343218       True   
19  ZTF18abjnizf        10      4318  58317.370590  60828.343218       True   
20  ZTF18abjnizf        10      4318  58317.370590  60828.343218       True   
21  ZTF18abjnizf        10      4318  58317.370590  60828.343218       True   
22  ZTF18aaxppip        59      3993  58271.461944  60828.339086       True   
23  ZTF18aaxppip        59      3993  58271.461944  60828.339086       True   
24  ZTF18aaxppip        59      3993  58271.461944  60828.339086       True   
25  ZTF18aaxppip        59      3993  58271.461944  60828.339086       True   
26  ZTF18aazkzyi       199      2334  58279.357350  60882.264931       True   
27  ZTF18aazkzyi       199      2334  58279.357350  60882.264931       True   
28  ZTF18aazkzyi       199      2334  58279.357350  60882.264931       True   
29  ZTF19abktmiz        12      1868  58695.277847  60828.343218       True   
30  ZTF19abktmiz        12      1868  58695.277847  60828.343218       True   
31  ZTF18abjeete      1703      2557  58246.457581  60884.190637       True   
32  ZTF18abjeete      1703      2557  58246.457581  60884.190637       True   
33  ZTF18abjeete      1703      2557  58246.457581  60884.190637       True   
34  ZTF18abloluw       910      2979  58246.438912  60884.234537       True   
35  ZTF18abloluw       910      2979  58246.438912  60884.234537       True   
36  ZTF18abloluw       910      2979  58246.438912  60884.234537       True   
37  ZTF18abloluw       910      2979  58246.438912  60884.234537       True   
38  ZTF18abclmpv       719      1151  58246.397870  60884.179526       True   
39  ZTF18abclmpv       719      1151  58246.397870  60884.179526       True   
40  ZTF18aaxpofi      1457      2394  58247.455613  60884.266204       True   
41  ZTF18aaxpofi      1457      2394  58247.455613  60884.266204       True   
42  ZTF18aaxpofi      1457      2394  58247.455613  60884.266204       True   
43  ZTF19abqnkfv       111      1410  58712.231076  60882.235868      False   
44  ZTF19abktdbu        16      2823  58695.277847  60828.343218       True   
45  ZTF19abktdbu        16      2823  58695.277847  60828.343218       True   
46  ZTF19abktdbu        16      2823  58695.277847  60828.343218       True   
47  ZTF19abjwmle        16      2819  58694.307870  60828.343218       True   
48  ZTF19abjwmle        16      2819  58694.307870  60828.343218       True   
49  ZTF19abjwmle        16      2819  58694.307870  60828.343218       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False   231       NaN           NaN  ...    727  18.773000     0.024   
1     False   231       NaN           NaN  ...    727  19.212000     0.026   
2      True    13  0.783300      0.907410  ...    384  13.954000     0.018   
3      True    13  0.783300      0.907410  ...    384  14.884000     0.013   
4      True    13  0.783300      0.907410  ...    334  14.880000     0.011   
5     False   400       NaN           NaN  ...    482  15.231999     0.023   
6     False   400       NaN           NaN  ...    482  15.329000     0.012   
7     False   880       NaN           NaN  ...    485  17.631000     0.017   
8     False   880       NaN           NaN  ...    486  17.593000     0.028   
9     False   880       NaN           NaN  ...    486  17.819000     0.015   
10    False   880       NaN           NaN  ...    485  17.799000     0.018   
11    False   918       NaN           NaN  ...    538  18.598000     0.035   
12    False   918       NaN           NaN  ...   1533  15.344999     0.030   
13    False   918       NaN           NaN  ...    538  16.612000     0.019   
14    False     6       NaN           NaN  ...    874  14.755000     0.014   
15    False     6       NaN           NaN  ...    874  13.872000     0.017   
16    False     6       NaN           NaN  ...    875  13.856999     0.019   
17    False     6       NaN           NaN  ...    875  14.773000     0.021   
18    False     8       NaN           NaN  ...    875  16.706000     0.017   
19    False     8       NaN           NaN  ...    865  17.222000     0.014   
20    False     8       NaN           NaN  ...    876  17.264000     0.016   
21    False     8       NaN           NaN  ...    875  17.229000     0.016   
22    False    24       NaN           NaN  ...    589  14.401000     0.026   
23    False    24       NaN           NaN  ...    589  12.648000     0.027   
24    False    24       NaN           NaN  ...    590  12.639000     0.015   
25    False    24       NaN           NaN  ...    590  14.392000     0.017   
26    False    97       NaN           NaN  ...    487  19.464000     0.030   
27    False    97       NaN           NaN  ...    487  17.535000     0.016   
28    False    97       NaN           NaN  ...   1480  17.542000     0.036   
29    False     5  0.485188      1.392368  ...    875  15.327000     0.013   
30    False     5  0.485188      1.392368  ...    875  14.844999     0.018   
31    False   766       NaN           NaN  ...    537  14.174999     0.016   
32    False   766       NaN           NaN  ...    537  15.818000     0.017   
33    False   766       NaN           NaN  ...   1532  13.903000     0.020   
34    False   450       NaN           NaN  ...    332  16.749000     0.018   
35    False   450       NaN           NaN  ...    332  18.097000     0.013   
36    False   450       NaN           NaN  ...    383  18.060000     0.013   
37    False   450       NaN           NaN  ...    383  16.744000     0.016   
38    False   408       NaN           NaN  ...    330  15.493999     0.015   
39    False   408       NaN           NaN  ...    330  15.852000     0.012   
40    False   724       NaN           NaN  ...    487  16.363000     0.015   
41    False   724       NaN           NaN  ...    487  13.585999     0.020   
42    False   724       NaN           NaN  ...   1533  13.370999     0.021   
43    False    39       NaN           NaN  ...    282  20.882000     0.101   
44    False     9       NaN           NaN  ...    874  14.212999     0.018   
45    False     9       NaN           NaN  ...    875  14.200999     0.021   
46    False     9       NaN           NaN  ...    875  14.606000     0.020   
47     True    10       NaN           NaN  ...    874  16.278000     0.015   
48     True    10       NaN           NaN  ...    874  15.662999     0.020   
49     True    10       NaN           NaN  ...    875  15.646000     0.029   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.694   -0.042  287.298058  37.062028  58186.530139  58423.093565   
1   1.251   -0.068  287.298065  37.062021  58204.513403  58338.181019   
2   0.664    0.003  281.096659 -13.435085  58218.468831  58292.314132   
3   0.460   -0.016  281.096660 -13.435078  58246.462245  58289.376713   
4   0.665   -0.008  281.096680 -13.435065  58246.500000  58372.250000   
5   1.477   -0.056  246.182283   4.805855  58198.439502  58256.291123   
6   0.343   -0.010  246.182288   4.805845  58203.417662  58365.211042   
7   0.444   -0.015  270.853254   5.040773  58186.535486  58291.294109   
8   1.411   -0.094  270.853243   5.040759  58186.534896  58363.212338   
9   0.438    0.012  270.853246   5.040755  58204.529514  58347.332211   
10  0.582   -0.027  270.853263   5.040762  58204.489271  58344.154988   
11  2.096   -0.056  277.306838  11.241255  58204.507211  58310.352512   
12  1.473   -0.148  277.306854  11.241245  58338.250000  59392.500000   
13  0.759   -0.023  277.306833  11.241240  58198.525590  58333.333357   
14  0.433   -0.019  242.694675  85.775928  58634.242465  58688.330081   
15  0.431    0.038  242.694674  85.775925  58634.281377  58685.335613   
16  0.501    0.039  242.694539  85.775921  58634.345069  58694.187847   
17  0.986   -0.066  242.694504  85.775925  58634.250000  58696.250000   
18  0.455    0.023  277.782007  80.254487  58634.345069  58691.379861   
19  0.404   -0.019  277.781915  80.254509  58244.443333  58318.431007   
20  0.848    0.032  277.782074  80.254478  58634.500000  58692.250000   
21  0.800   -0.045  277.781921  80.254486  58634.250000  58696.250000   
22  1.285   -0.037  285.234156  17.897753  58203.505521  58290.401910   
23  1.124    0.079  285.234152  17.897770  58186.528900  58316.271123   
24  0.292   -0.007  285.234122  17.897759  58186.533102  58293.316713   
25  0.832   -0.041  285.234123  17.897758  58204.508125  58247.393692   
26  1.027   -0.049  278.750629   3.326981  58205.509410  58273.443530   
27  0.514   -0.013  278.750630   3.326996  58217.484491  58284.337014   
28  1.598   -0.105  278.750641   3.326976  58618.250000  59798.250000   
29  0.476   -0.014  276.362015  79.663870  58634.243924  58696.308507   
30  0.470   -0.034  276.362026  79.663869  58634.345069  58691.379861   
31  0.602   -0.025  272.964987   9.393132  58186.526991  58285.352512   
32  0.775   -0.061  272.964981   9.393129  58203.503218  58336.248519   
33  0.745   -0.039  272.964996   9.393122  58285.250000  59461.250000   
34  0.916   -0.044  270.881549 -13.351817  58218.468345  58336.229363   
35  0.471   -0.005  270.881542 -13.351812  58262.400776  58365.229687   
36  0.568   -0.039  270.881538 -13.351838  58205.526910  58288.374630   
37  0.578    0.028  270.881530 -13.351832  58218.504826  58305.355776   
38  0.366    0.009  255.854835 -19.075712  58217.469028  58289.322558   
39  0.393   -0.011  255.854830 -19.075696  58205.471285  58363.147523   
40  0.610   -0.046  278.662049   6.997433  58205.509410  58263.440590   
41  0.605   -0.022  278.662052   6.997442  58217.484491  58281.375428   
42  0.700   -0.078  278.662048   6.997421  58348.250000  59424.250000   
43  0.559   -0.055  271.254683 -25.115872  58307.252465  58307.297708   
44  0.413   -0.023  242.667647  85.721337  58634.281377  58685.335613   
45  0.612   -0.003  242.667541  85.721340  58634.345069  58694.187847   
46  0.848   -0.047  242.667646  85.721335  58634.243924  58696.308507   
47  0.479    0.046  237.792702  86.291681  58634.242465  58688.330081   
48  0.550   -0.028  237.792678  86.291679  58634.281377  58685.335613   
49  1.102   -0.077  237.792616  86.291689  58634.345069  58694.187847   

   nframesref  
0          40  
1          15  
2          15  
3          15  
4          16  
5          15  
6          15  
7          15  
8          15  
9          15  
10         15  
11         15  
12         15  
13         40  
14         15  
15         15  
16         15  
17         15  
18         15  
19         16  
20         15  
21         15  
22         15  
23         15  
24         26  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         16  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         40  
39         15  
40         15  
41         15  
42         16  
43         26  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,8.78663182258606,2025-07-28T21:01:00,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,3,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limiting the result to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,23.755464792251587,2025-07-23T20:01:32,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aagcidl        11      1873  58442.250000  59901.500000       True   
1   ZTF18aagcidl        11      1873  58442.250000  59901.500000       True   
2   ZTF18aageoap        53      2064  58435.396181  60645.442002       True   
3   ZTF18aageoap        53      2064  58435.396181  60645.442002       True   
4   ZTF22aajltnx         9      1816  58508.564560  60707.565752       True   
5   ZTF22aajltnx         9      1816  58508.564560  60707.565752       True   
6   ZTF18aagdfyh         2       130  58436.371238  58602.192546       True   
7   ZTF18aagdfyh         2       130  58436.371238  58602.192546       True   
8   ZTF18aagdmxp         2        93  58078.413380  58442.437488       True   
9   ZTF18aagdmxp         2        93  58078.413380  58442.437488       True   
10  ZTF18aagccbm        30      3385  58105.371979  59687.265382       True   
11  ZTF18aagccbm        30      3385  58105.371979  59687.265382       True   
12  ZTF18aagccbm        30      3385  58105.371979  59687.265382       True   
13  ZTF18aagcpuy        14      1997  58427.500000  60198.500000       True   
14  ZTF18aagcpuy        14      1997  58427.500000  60198.500000       True   
15  ZTF18aagcipq         6      2010  58442.250000  60198.500000       True   
16  ZTF18aagcipq         6      2010  58442.250000  60198.500000       True   
17  ZTF18aagbygi         2      1331  60671.256447  60751.217211       True   
18  ZTF18aagbygi         2      1331  60671.256447  60751.217211       True   
19  ZTF18aagbksb        12      1582  58512.251956  59496.504699       True   
20  ZTF18aagbksb        12      1582  58512.251956  59496.504699       True   
21  ZTF18aagejna         4      1665  58442.343924  59496.504699       True   
22  ZTF18aagejna         4      1665  58442.343924  59496.504699       True   
23  ZTF18aagdlbu        17      2883  58436.365440  60340.385370       True   
24  ZTF18aagdlbu        17      2883  58436.365440  60340.385370       True   
25  ZTF18aagdlbu        17      2883  58436.365440  60340.385370       True   
26  ZTF18aagflrz         1       103  58442.437488  58442.437488       True   
27  ZTF18aagflrz         1       103  58442.437488  58442.437488       True   
28  ZTF18aaggvaf        18      2416  58442.324965  60734.291806       True   
29  ZTF18aaggvaf        18      2416  58442.324965  60734.291806       True   
30  ZTF18aagijqi         6       854  58182.186493  58940.155197       True   
31  ZTF18aagijqi         6       854  58182.186493  58940.155197       True   
32  ZTF18aagisxo        27      1429  58442.343924  59452.508507       True   
33  ZTF18aagisxo        27      1429  58442.343924  59452.508507       True   
34  ZTF18aagfxbm         1      1635  59475.471644  59475.471644       True   
35  ZTF18aagfxbm         1      1635  59475.471644  59475.471644       True   
36  ZTF18aagfxuq        10      2318  58436.381227  60678.213727       True   
37  ZTF18aagfxuq        10      2318  58436.381227  60678.213727       True   
38  ZTF18aaghjmt         4      1820  58436.380301  60678.212789       True   
39  ZTF18aaghjmt         4      1820  58436.380301  60678.212789       True   
40  ZTF18aagjowb         6      1135  58436.381227  58940.155648       True   
41  ZTF18aagjowb         6      1135  58436.381227  58940.155648       True   
42  ZTF18aagjppt         2      1788  58543.235741  59217.258194       True   
43  ZTF18aagjppt         2      1788  58543.235741  59217.258194       True   
44  ZTF18aagjppt         2      1788  58543.235741  59217.258194       True   
45  ZTF18aagksem         8      2743  58491.426157  59672.153437       True   
46  ZTF18aagksem         8      2743  58491.426157  59672.153437       True   
47  ZTF18aagksem         8      2743  58491.426157  59672.153437       True   
48  ZTF18aagksem         8      2743  58491.426157  59672.153437       True   
49  ZTF18aaglcdl         2       343  58436.381227  58602.185984       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3  2.505397      1.560674  ...    616  15.611999     0.016   
1     False     3  2.505397      1.560674  ...    616  16.772000     0.014   
2     False    10       NaN           NaN  ...    616  13.243999     0.016   
3     False    10       NaN           NaN  ...    616  12.803000     0.013   
4      True     2       NaN           NaN  ...    486  13.459000     0.014   
5      True     2       NaN           NaN  ...   1480  13.500000     0.024   
6      True     2  1.434454     -0.264022  ...    515  14.577000     0.025   
7      True     2  1.434454     -0.264022  ...    515  14.918000     0.010   
8      True     2  0.516741      0.538655  ...    616  15.382999     0.011   
9      True     2  0.516741      0.538655  ...    616  15.014999     0.012   
10     True     9  0.092117      0.355482  ...    616  14.587999     0.015   
11     True     9  0.092117      0.355482  ...    615  14.151999     0.019   
12     True     9  0.092117      0.355482  ...    616  14.148999     0.009   
13    False     8  2.166495      0.993774  ...    616  14.964000     0.018   
14    False     8  2.166495      0.993774  ...    616  14.658000     0.018   
15    False     6  2.118931      1.600493  ...    616  16.735000     0.020   
16    False     6  2.118931      1.600493  ...    616  17.778000     0.014   
17     True     3       NaN           NaN  ...    514  13.967999     0.013   
18     True     3       NaN           NaN  ...    514  14.764000     0.019   
19     True     5  2.240912      1.421273  ...    616  13.476000     0.021   
20     True     5  2.240912      1.421273  ...    616  13.929000     0.017   
21     True     3  1.153629      0.538907  ...    616  14.896999     0.011   
22     True     3  1.153629      0.538907  ...    616  15.253000     0.016   
23     True     5  0.813822      0.612877  ...    567  15.040000     0.012   
24     True     5  0.813822      0.612877  ...    616  15.037000     0.014   
25     True     5  0.813822      0.612877  ...    616  14.716000     0.015   
26     True     2 -0.491474      0.744900  ...    616  15.663000     0.015   
27     True     2 -0.491474      0.744900  ...    616  15.210000     0.015   
28     True     5       NaN           NaN  ...    616  15.969999     0.015   
29     True     5       NaN           NaN  ...    616  16.297000     0.013   
30     True     3 -0.176468      0.370149  ...    516  13.910000     0.012   
31     True     3 -0.176468      0.370149  ...    516  14.335999     0.010   
32     True     5  1.198795      0.600597  ...    616  16.019001     0.013   
33     True     5  1.198795      0.600597  ...    616  16.450000     0.013   
34     True     2 -0.743617      0.322390  ...    616  15.943999     0.018   
35     True     2 -0.743617      0.322390  ...    616  16.409000     0.016   
36     True     5       NaN           NaN  ...    567  13.120000     0.013   
37     True     5       NaN           NaN  ...    567  13.587000     0.015   
38     True     2       NaN           NaN  ...    516  15.453000     0.014   
39     True     2       NaN           NaN  ...    516  15.757999     0.011   
40     True     3  0.784624      0.668895  ...    567  14.492000     0.012   
41     True     3  0.784624      0.668895  ...    567  14.188999     0.014   
42     True     3  1.420925      0.944028  ...    564  14.413000     0.015   
43     True     3  1.420925      0.944028  ...    565  13.634000     0.016   
44     True     3  1.420925      0.944028  ...    564  13.632000     0.022   
45     True     8  1.981498      1.216896  ...    516  15.346000     0.013   
46     True     8  1.981498      1.216896  ...    516  15.002999     0.016   
47     True     8  1.981498      1.216896  ...    566  15.004000     0.017   
48     True     8  1.981498      1.216896  ...    566  15.368999     0.011   
49     True     2  0.205873      0.208468  ...    567  14.893000     0.014   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.795   -0.033  118.216604  23.332510  58154.202361  58183.132708   
1   0.450   -0.028  118.216599  23.332493  58166.250000  58443.250000   
2   0.392    0.013  121.022593  27.304175  58166.241898  58438.443669   
3   0.623    0.025  121.022580  27.304198  58154.202361  58190.150857   
4   0.286   -0.005  272.652898   2.979147  58186.534896  58375.159259   
5   1.051   -0.014  272.652924   2.979146  58593.250000  59775.250000   
6   1.951   -0.043  115.255927  10.856781  58154.210752  58190.166921   
7   0.258   -0.001  115.255934  10.856771  58167.206736  58438.441840   
8   0.181    0.001  118.785383  27.689304  58166.241898  58438.443669   
9   0.412   -0.013  118.785382  27.689321  58154.202361  58190.150857   
10  0.626   -0.040  117.095065  29.248715  58166.241898  58432.446053   
11  1.511   -0.030  117.095076  29.248733  58154.203843  58190.167407   
12  0.125    0.002  117.095060  29.248725  58154.202361  58190.150857   
13  0.753   -0.036  124.453005  25.791533  58166.241898  58438.443669   
14  1.132   -0.030  124.452994  25.791539  58154.215683  58223.183148   
15  1.310   -0.026  118.246396  24.059905  58154.202361  58183.132708   
16  0.349   -0.018  118.246407  24.059872  58166.250000  58443.250000   
17  0.710   -0.019  106.859981  13.259360  58154.209757  58227.144410   
18  0.797   -0.045  106.859985  13.259328  58166.250000  58437.500000   
19  1.553   -0.041  124.434459  27.536685  58154.215683  58190.150857   
20  0.787   -0.043  124.434467  27.536680  58166.286620  58438.443669   
21  0.126    0.005  118.878208  23.172869  58154.202361  58423.517199   
22  0.560   -0.043  118.878204  23.172853  58166.241898  58443.328391   
23  0.571   -0.022  122.206835  22.529068  58166.241400  58443.502685   
24  0.725   -0.028  122.206839  22.529049  58166.241898  58441.477384   
25  0.734   -0.022  122.206823  22.529073  58154.202361  58243.155370   
26  0.891   -0.023  123.938578  25.154503  58166.241898  58438.423449   
27  0.737   -0.009  123.938546  25.154521  58154.202361  58227.159178   
28  0.846   -0.005  119.007293  26.460948  58154.202361  58372.516065   
29  0.320    0.000  119.007295  26.460944  58166.241898  58441.477384   
30  0.443   -0.012  123.528584  13.456499  58154.231042  58190.149456   
31  0.429   -0.009  123.528582  13.456498  58166.240903  58437.479514   
32  0.478   -0.024  117.846142  26.282478  58154.202361  58217.194155   
33  0.430   -0.017  117.846137  26.282469  58166.241898  58438.443669   
34  0.986   -0.066  121.454779  24.868164  58154.202361  58227.159178   
35  0.602   -0.038  121.454793  24.868123  58166.241898  58443.328391   
36  0.461   -0.016  124.649777  22.358494  58154.248831  58190.149919   
37  0.875   -0.029  124.649783  22.358481  58166.241400  58443.502685   
38  0.830   -0.034  123.971305  11.196688  58154.212234  58190.149456   
39  0.499   -0.008  123.971321  11.196675  58166.250000  58437.500000   
40  0.335   -0.008  123.443707  19.165689  58166.241400  58443.502685   
41  0.616   -0.008  123.443696  19.165697  58154.202859  58190.149919   
42  0.671   -0.031  106.189321  18.653855  58167.163218  58437.452118   
43  0.898   -0.026  106.189293  18.653885  58154.162488  58160.251285   
44  1.335   -0.012  106.189305  18.653869  58155.168924  58383.505799   
45  0.693   -0.021  120.443268  15.390012  58166.240903  58437.479514   
46  0.838   -0.027  120.443258  15.390015  58154.212234  58190.149456   
47  0.972   -0.013  120.443256  15.390025  58154.203345  58190.149005   
48  0.314   -0.004  120.443279  15.390002  58167.172813  58439.427847   
49  0.810   -0.028  122.431227  22.350003  58166.241400  58443.502685   

   nframesref  
0          16  
1          27  
2          16  
3          15  
4          15  
5          16  
6          18  
7          15  
8          15  
9          15  
10         15  
11         17  
12         17  
13         16  
14         15  
15         16  
16         27  
17         15  
18         15  
19         15  
20         16  
21         15  
22         28  
23         21  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         20  
31         15  
32         15  
33         16  
34         15  
35         25  
36         19  
37         21  
38         17  
39         15  
40         20  
41         21  
42         15  
43         18  
44         15  
45         15  
46         24  
47         15  
48         15  
49         21  

[50 rows x 36 columns]]",,8.331042289733887,2025-07-28T21:01:13,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,4,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,20.364339351654053,2025-07-23T20:01:53,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19aarclsv         7      1954  58577.480799  60709.556250       True   
1   ZTF19aarclsv         7      1954  58577.480799  60709.556250       True   
2   ZTF19aarccfh        22      3819  58322.437384  60528.327650       True   
3   ZTF19aarccfh        22      3819  58322.437384  60528.327650       True   
4   ZTF19aarccfh        22      3819  58322.437384  60528.327650       True   
5   ZTF19aarccfh        22      3819  58322.437384  60528.327650       True   
6   ZTF19aarcxpm         6      2089  58592.402141  60706.562153       True   
7   ZTF19aarcxpm         6      2089  58592.402141  60706.562153       True   
8   ZTF19aarcqkd        12      2218  58526.555185  60709.554815       True   
9   ZTF19aarcqkd        12      2218  58526.555185  60709.554815       True   
10  ZTF19aardjsu         7      1850  58331.363657  60656.122685       True   
11  ZTF19aardjsu         7      1850  58331.363657  60656.122685       True   
12  ZTF19aardjsu         7      1850  58331.363657  60656.122685       True   
13  ZTF19aardvvl        16      3195  58592.458160  60881.210104       True   
14  ZTF19aardvvl        16      3195  58592.458160  60881.210104       True   
15  ZTF19aardvvl        16      3195  58592.458160  60881.210104       True   
16  ZTF19aardvvl        16      3195  58592.458160  60881.210104       True   
17  ZTF19aardvvl        16      3195  58592.458160  60881.210104       True   
18  ZTF18abdkepx        10      1569  58300.500000  59778.250000       True   
19  ZTF18abdkepx        10      1569  58300.500000  59778.250000       True   
20  ZTF18abdkvun        20      1298  58301.325197  59082.320590       True   
21  ZTF18abdkvun        20      1298  58301.325197  59082.320590       True   
22  ZTF18abdllaq         6       784  58291.409699  59354.441354       True   
23  ZTF18abdllaq         6       784  58291.409699  59354.441354       True   
24  ZTF18abdlunn         2        35  58289.415023  58301.379190       True   
25  ZTF18abdlvcg        15      1008  58277.372234  58632.464398       True   
26  ZTF18abdlvcg        15      1008  58277.372234  58632.464398       True   
27  ZTF18abdlvcg        15      1008  58277.372234  58632.464398       True   
28  ZTF18abdlkdp         9      1228  58291.500000  60158.250000       True   
29  ZTF18abdlkdp         9      1228  58291.500000  60158.250000       True   
30  ZTF18abdkuvy       201       767  58218.508056  60391.446887       True   
31  ZTF18abdkuvy       201       767  58218.508056  60391.446887       True   
32  ZTF18abdmysu         9      3181  58589.423738  60679.566667       True   
33  ZTF18abdmysu         9      3181  58589.423738  60679.566667       True   
34  ZTF18abdnmmz         4      3941  58728.271099  60762.447604       True   
35  ZTF18abdnmmz         4      3941  58728.271099  60762.447604       True   
36  ZTF18abdnmmz         4      3941  58728.271099  60762.447604       True   
37  ZTF18abdnmmz         4      3941  58728.271099  60762.447604       True   
38  ZTF18abdpkcu         2        89  58302.408299  58316.431192       True   
39  ZTF18abdpkcu         2        89  58302.408299  58316.431192       True   
40  ZTF18abdpkru         6      1664  58302.413576  59080.413044      False   
41  ZTF18abdpkru         6      1664  58302.413576  59080.413044      False   
42  ZTF18abdpviz         6       272  58302.436123  58389.234583       True   
43  ZTF18abdpviz         6       272  58302.436123  58389.234583       True   
44  ZTF18abdpxpx        23      3917  58302.450278  60645.315532       True   
45  ZTF18abdpxpx        23      3917  58302.450278  60645.315532       True   
46  ZTF18abdpxpx        23      3917  58302.450278  60645.315532       True   
47  ZTF18abdqinc         2        77  58303.177523  58469.529479      False   
48  ZTF18abdqinc         2        77  58303.177523  58469.529479      False   
49  ZTF18abdqnpv         9      1865  58311.231308  60676.499306       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0      True     3       NaN           NaN  ...    435  15.834000     0.018   
1      True     3       NaN           NaN  ...   1481  15.894000     0.031   
2      True    14  1.272749      0.474814  ...    829  14.715000     0.017   
3      True    14  1.272749      0.474814  ...    830  14.688000     0.018   
4      True    14  1.272749      0.474814  ...    829  14.118999     0.018   
5      True    14  1.272749      0.474814  ...    830  14.111999     0.016   
6      True     2       NaN           NaN  ...    639  12.967000     0.015   
7      True     2       NaN           NaN  ...   1636  12.974000     0.019   
8      True     2       NaN           NaN  ...    435  15.026000     0.015   
9      True     2       NaN           NaN  ...   1480  15.023999     0.019   
10     True     5       NaN           NaN  ...    851  13.957000     0.012   
11     True     5       NaN           NaN  ...   1859  12.686999     0.022   
12     True     5       NaN           NaN  ...    851  12.684000     0.014   
13    False    16       NaN           NaN  ...    330  14.893000     0.013   
14    False    16       NaN           NaN  ...    330  13.752000     0.023   
15    False    16       NaN           NaN  ...    279  14.940000     0.009   
16    False    16       NaN           NaN  ...    280  13.789000     0.022   
17    False    16       NaN           NaN  ...    280  14.917000     0.010   
18    False     4  2.575969      0.438221  ...    730  13.099999     0.015   
19    False     4  2.575969      0.438221  ...    730  13.546000     0.014   
20     True    16  0.108199      0.622973  ...    803  14.428000     0.012   
21     True    16  0.108199      0.622973  ...    803  13.695999     0.012   
22     True     5  1.902747      1.460986  ...    385  13.292000     0.017   
23     True     5  1.902747      1.460986  ...    385  14.747000     0.013   
24     True     2  1.026735      0.545909  ...    640  14.509999     0.020   
25     True    10  2.641049      1.099230  ...    639  14.547999     0.018   
26     True    10  2.641049      1.099230  ...    640  13.457000     0.017   
27     True    10  2.641049      1.099230  ...    639  13.474999     0.015   
28    False     3  0.726522      0.538160  ...    385  14.377999     0.018   
29    False     3  0.726522      0.538160  ...    385  14.913000     0.017   
30    False   115  2.120761      2.336558  ...    540  15.257000     0.026   
31    False   115  2.120761      2.336558  ...    540  17.749000     0.024   
32     True     4       NaN           NaN  ...    587  16.258000     0.018   
33     True     4       NaN           NaN  ...   1582  15.778000     0.016   
34    False     4       NaN           NaN  ...    800  14.655000     0.021   
35    False     4       NaN           NaN  ...    799  14.676000     0.019   
36    False     4       NaN           NaN  ...    799  14.139999     0.016   
37    False     4       NaN           NaN  ...    800  14.139000     0.018   
38     True     2 -0.058113      0.352430  ...    805  16.865000     0.015   
39     True     2 -0.058113      0.352430  ...    736  17.623001     0.014   
40    False     3  0.549538           NaN  ...    648  13.202000     0.014   
41    False     3  0.549538           NaN  ...    649  13.547000     0.015   
42     True     4  1.140634      0.996813  ...    639  15.063000     0.025   
43     True     4  1.140634      0.996813  ...    639  14.049000     0.040   
44     True    15       NaN           NaN  ...    806  17.033000     0.017   
45     True    15       NaN           NaN  ...    832  17.074000     0.013   
46     True    15       NaN           NaN  ...    806  18.386000     0.016   
47    False     2  0.709997           NaN  ...    629  14.646999     0.013   
48    False     2  0.709997           NaN  ...    629  15.158999     0.014   
49    False     5       NaN           NaN  ...    529  15.462000     0.023   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.582   -0.020  280.180434  -0.077769  58217.484028  58287.314537   
1   1.204    0.021  280.180450  -0.077789  58593.500000  59765.250000   
2   0.605    0.018  319.939801  62.722039  58254.449190  58364.248206   
3   0.520   -0.022  319.939779  62.722016  58209.493009  58637.473194   
4   0.776   -0.029  319.939796  62.722021  58216.514815  58423.134549   
5   0.466   -0.014  319.939778  62.722021  58217.492604  58643.466146   
6   0.299    0.014  293.397501  25.632190  58186.532512  58321.349768   
7   0.413    0.039  293.397522  25.632175  58270.500000  58757.250000   
8   0.507   -0.007  276.880178  -2.489120  58218.505278  58338.191273   
9   0.509   -0.044  276.880188  -2.489151  58593.250000  59815.250000   
10  0.427    0.000  314.065169  66.758774  58230.490718  58436.172535   
11  0.882    0.110  314.065181  66.758769  58271.426944  58593.374919   
12  0.312    0.012  314.065162  66.758785  58217.495428  58334.358588   
13  0.507   -0.015  254.275246 -20.648319  58205.471285  58363.147523   
14  0.840   -0.034  254.275245 -20.648315  58217.469028  58289.322558   
15  0.339    0.004  254.275253 -20.648302  58246.250000  58643.250000   
16  0.812   -0.113  254.275269 -20.648290  58257.438449  58302.276667   
17  0.481   -0.008  254.275253 -20.648298  58248.500000  58670.250000   
18  0.410    0.019  312.571142  41.128312  58222.497870  58318.365232   
19  0.452    0.002  312.571135  41.128309  58206.524132  58282.402523   
20  0.268   -0.013  334.794766  55.241144  58228.489526  58287.433958   
21  0.263    0.013  334.794772  55.241142  58217.493982  58305.404630   
22  0.278   -0.010  284.621592 -10.510417  58292.356910  58292.403021   
23  0.468   -0.007  284.621587 -10.510416  58246.461319  58369.250845   
24  0.732   -0.039  299.395418  29.538631  58217.488831  58293.318090   
25  0.760   -0.041  296.791809  29.415801  58203.506921  58252.440405   
26  0.355   -0.051  296.791795  29.415801  58217.488831  58290.378113   
27  0.417   -0.018  296.791789  29.415811  58186.532512  58295.298206   
28  0.332   -0.027  285.201362  -8.311685  58291.364838  58293.392593   
29  0.566   -0.043  285.201355  -8.311681  58246.500000  58363.250000   
30  0.793    0.011  292.887646  11.075343  58273.418310  58341.304468   
31  1.123   -0.060  292.887642  11.075350  58205.510799  58293.420324   
32  0.810   -0.034  266.197173  16.827790  58203.502755  58232.482060   
33  0.443   -0.046  266.197174  16.827778  58246.500000  59435.250000   
34  0.974   -0.087  296.256603  53.621753  58204.516759  58311.366539   
35  0.731   -0.061  296.256656  53.621755  58228.491505  58274.403935   
36  0.630   -0.015  296.256650  53.621756  58186.521053  58279.411273   
37  0.343   -0.004  296.256622  53.621735  58255.500000  58441.250000   
38  0.509   -0.031    1.671300  51.332651  58247.469734  58287.473252   
39  0.662   -0.032    1.671286  51.332661  58246.484352  58303.422824   
40  0.863   -0.012    4.211928  36.305795  58271.443657  58289.470046   
41  0.637   -0.012    4.211929  36.305798  58274.451609  58340.476643   
42  1.399    0.078  295.831381  28.710056  58203.506921  58294.446516   
43  1.780    0.100  295.831382  28.710073  58294.332836  58337.318796   
44  0.616   -0.001  359.638960  62.125578  58256.483495  58367.359525   
45  0.600   -0.016  359.638959  62.125581  58246.450845  58282.469572   
46  0.622   -0.042  359.638970  62.125579  58252.467512  58287.432083   
47  0.339    0.013  217.789788  28.858909  58160.468750  58222.317928   
48  0.414   -0.002  217.789792  28.858905  58166.467002  58303.213518   
49  0.992   -0.072  213.605875  14.776428  58160.499502  58229.358380   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          15  
6          15  
7          26  
8          15  
9          16  
10         15  
11         15  
12         15  
13         15  
14         40  
15         15  
16         40  
17         15  
18         15  
19         15  
20         15  
21         15  
22         40  
23         15  
24         20  
25         15  
26         17  
27         17  
28         24  
29         15  
30         40  
31         20  
32         18  
33         15  
34         15  
35         15  
36         15  
37         40  
38         15  
39         15  
40         15  
41         16  
42         27  
43         40  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,9.935746431350708,2025-07-28T21:01:27,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,5,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,18.596433639526367,2025-07-23T20:02:12,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF17aacvxgo        22      3508  58045.526667  60595.445590       True   
1   ZTF17aacvxgo        22      3508  58045.526667  60595.445590       True   
2   ZTF17aacvxgo        22      3508  58045.526667  60595.445590       True   
3   ZTF17aacvxgv        18      3508  58045.526667  60595.445590      False   
4   ZTF17aacvxgv        18      3508  58045.526667  60595.445590      False   
5   ZTF17aacvxgv        18      3508  58045.526667  60595.445590      False   
6   ZTF17aacvxgv        18      3508  58045.526667  60595.445590      False   
7   ZTF17aabiluf        23      3496  58096.349850  60595.445590       True   
8   ZTF17aabiluf        23      3496  58096.349850  60595.445590       True   
9   ZTF17aabiluf        23      3496  58096.349850  60595.445590       True   
10  ZTF17aabiluf        23      3496  58096.349850  60595.445590       True   
11  ZTF17aacvxis        22      3508  58045.526667  60595.445590       True   
12  ZTF17aacvxis        22      3508  58045.526667  60595.445590       True   
13  ZTF17aacvxis        22      3508  58045.526667  60595.445590       True   
14  ZTF17aacvxis        22      3508  58045.526667  60595.445590       True   
15  ZTF18ackxldz         6      1636  58439.250000  60174.500000       True   
16  ZTF18ackxldz         6      1636  58439.250000  60174.500000       True   
17  ZTF18aclditf         9      2600  58435.500000  60174.500000       True   
18  ZTF18aclditf         9      2600  58435.500000  60174.500000       True   
19  ZTF18aclditf         9      2600  58435.500000  60174.500000       True   
20  ZTF18acldvjm         3      1589  58435.250000  60174.500000       True   
21  ZTF18acldvjm         3      1589  58435.250000  60174.500000       True   
22  ZTF18aaefutg        21      3504  58096.349850  60595.445590       True   
23  ZTF18aaefutg        21      3504  58096.349850  60595.445590       True   
24  ZTF18aaefutg        21      3504  58096.349850  60595.445590       True   
25  ZTF18aaefutg        21      3504  58096.349850  60595.445590       True   
26  ZTF19aabxcsm        11      1121  58491.428437  60357.277477       True   
27  ZTF19aabxcsm        11      1121  58491.428437  60357.277477       True   
28  ZTF19aabxcsm        11      1121  58491.428437  60357.277477       True   
29  ZTF19aabxcsm        11      1121  58491.428437  60357.277477       True   
30  ZTF19aabxqsd         2       196  58491.413831  58838.459248       True   
31  ZTF19aabxqsd         2       196  58491.413831  58838.459248       True   
32  ZTF18abcoedn        17      2066  58281.378681  60709.559201       True   
33  ZTF18abcoedn        17      2066  58281.378681  60709.559201       True   
34  ZTF18abcodxh         4       428  58290.399572  58371.169815       True   
35  ZTF18abcodxh         4       428  58290.399572  58371.169815       True   
36  ZTF18abcojow         8       290  58283.402893  58360.147083       True   
37  ZTF18abcojow         8       290  58283.402893  58360.147083       True   
38  ZTF18abcovaw         2      1791  58290.429583  59054.370394       True   
39  ZTF18abcovaw         2      1791  58290.429583  59054.370394       True   
40  ZTF18abcolkd        20      1680  58283.500000  59807.250000       True   
41  ZTF18abcolkd        20      1680  58283.500000  59807.250000       True   
42  ZTF18abcoucb        14      2048  58290.425382  60562.216933       True   
43  ZTF18abcoucb        14      2048  58290.425382  60562.216933       True   
44  ZTF18abcoucb        14      2048  58290.425382  60562.216933       True   
45  ZTF18abcqfev        15       677  58281.354537  59010.343600       True   
46  ZTF18abcqfev        15       677  58281.354537  59010.343600       True   
47  ZTF18abcqqcq        20      1366  58291.427893  59076.349780       True   
48  ZTF18abcqqcq        20      1366  58291.427893  59076.349780       True   
49  ZTF18abcqxvu        19      2016  58267.500000  59994.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False    10       NaN           NaN  ...    664  13.188000     0.013   
1     False    10       NaN           NaN  ...    665  13.203000     0.010   
2     False    10       NaN           NaN  ...    664  12.877000     0.020   
3     False     7       NaN           NaN  ...    665  13.488999     0.011   
4     False     7       NaN           NaN  ...    664  13.030999     0.017   
5     False     7       NaN           NaN  ...    665  12.997999     0.015   
6     False     7       NaN           NaN  ...    664  13.467000     0.016   
7     False    11       NaN           NaN  ...    664  15.111999     0.010   
8     False    11       NaN           NaN  ...    664  14.622999     0.018   
9     False    11       NaN           NaN  ...    665  14.598000     0.015   
10    False    11       NaN           NaN  ...    665  15.128000     0.012   
11    False     9       NaN           NaN  ...    665  15.478000     0.014   
12    False     9       NaN           NaN  ...    665  14.504000     0.022   
13    False     9       NaN           NaN  ...    664  15.474999     0.011   
14    False     9       NaN           NaN  ...    664  14.537999     0.018   
15    False     3  0.873684      0.872377  ...   1657  15.175000     0.013   
16    False     3  0.873684      0.872377  ...    660  14.657000     0.014   
17    False     5  0.611292      0.494106  ...    565  15.204000     0.011   
18    False     5  0.611292      0.494106  ...    565  14.863999     0.013   
19    False     5  0.611292      0.494106  ...    564  14.856000     0.019   
20    False     4  1.184378      0.704397  ...    614  14.257999     0.012   
21    False     4  1.184378      0.704397  ...    614  14.745999     0.014   
22    False    12       NaN           NaN  ...    664  15.363999     0.010   
23    False    12       NaN           NaN  ...    665  15.382000     0.013   
24    False    12       NaN           NaN  ...    665  14.245000     0.030   
25    False    12       NaN           NaN  ...    664  14.289000     0.020   
26    False     8 -0.156646      0.466242  ...    312  15.377000     0.010   
27    False     8 -0.156646      0.466242  ...    362  15.422000     0.012   
28    False     8 -0.156646      0.466242  ...    362  14.874000     0.015   
29    False     8 -0.156646      0.466242  ...    312  14.835000     0.012   
30     True     2 -0.824333     -0.130825  ...    261  14.627000     0.009   
31     True     2 -0.824333     -0.130825  ...    261  14.427000     0.006   
32     True     8       NaN           NaN  ...    487  15.819000     0.017   
33     True     8       NaN           NaN  ...   1534  14.778000     0.015   
34     True     2  1.097910      0.693878  ...    540  14.519000     0.015   
35     True     2  1.097910      0.693878  ...    540  15.234000     0.017   
36     True     8  0.612614      0.642328  ...    540  15.412999     0.017   
37     True     8  0.612614      0.642328  ...    540  16.095001     0.014   
38     True     2 -0.622236      0.875807  ...    800  19.078000     0.020   
39     True     2 -0.622236      0.875807  ...    800  17.546000     0.020   
40    False     7  2.343651      0.946367  ...    539  13.929999     0.014   
41    False     7  2.343651      0.946367  ...    539  13.252999     0.015   
42     True     7       NaN           NaN  ...    730  14.755000     0.015   
43     True     7       NaN           NaN  ...    730  14.167000     0.021   
44     True     7       NaN           NaN  ...   1729  14.143000     0.021   
45     True    10  3.119165      2.921159  ...    435  14.144000     0.013   
46     True    10  3.119165      2.921159  ...    435  17.069000     0.018   
47     True     5  1.124088      0.482762  ...    729  14.122000     0.012   
48     True     5  1.124088      0.482762  ...    729  13.544000     0.011   
49    False     9  0.926592      0.427935  ...    687  12.424999     0.026   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.735   -0.022  129.750179  32.068845  58166.245799  58426.475475   
1   0.293   -0.004  129.750145  32.068826  58202.263067  58437.489803   
2   1.296   -0.015  129.750143  32.068854  58154.244375  58229.185197   
3   0.351   -0.010  129.518683  32.133213  58202.263067  58437.489803   
4   1.035   -0.021  129.518672  32.133239  58154.244375  58229.185197   
5   0.538    0.019  129.518676  32.133220  58154.217164  58184.234641   
6   0.761   -0.034  129.518707  32.133228  58166.250000  58426.500000   
7   0.278   -0.005  129.250083  31.533951  58166.245799  58426.475475   
8   1.151   -0.027  129.250049  31.533952  58154.244375  58229.185197   
9   0.551    0.046  129.250032  31.533947  58154.217164  58184.234641   
10  0.461   -0.013  129.250046  31.533941  58202.250000  58437.500000   
11  0.841   -0.036  129.762861  31.780618  58202.263067  58437.489803   
12  1.042   -0.044  129.762853  31.780621  58154.217164  58184.234641   
13  0.461   -0.013  129.762893  31.780627  58166.245799  58426.475475   
14  1.052    0.008  129.762852  31.780643  58154.244375  58229.185197   
15  0.449    0.010   94.542315  32.478200  58166.168252  58495.224375   
16  0.692   -0.006   94.542296  32.478224  58154.172512  58367.505776   
17  0.144   -0.007  105.957890  19.657806  58167.165799  58443.288299   
18  0.739   -0.011  105.957884  19.657836  58154.162488  58160.251285   
19  1.195   -0.021  105.957901  19.657820  58155.250000  58431.500000   
20  0.470   -0.021  105.239918  28.425925  58154.228079  58397.516678   
21  0.481   -0.038  105.239930  28.425928  58166.287697  58437.475810   
22  0.471   -0.012  129.799995  32.251142  58166.245799  58426.475475   
23  0.575   -0.024  129.799962  32.251121  58202.263067  58437.489803   
24  1.574   -0.080  129.799957  32.251136  58154.217164  58184.234641   
25  1.406    0.020  129.799958  32.251162  58154.244375  58229.185197   
26  0.488   -0.013  128.088335 -13.530492  58204.220579  58509.248345   
27  0.597   -0.001  128.088326 -13.530491  58204.221944  58472.462847   
28  0.868   -0.036  128.088332 -13.530497  58218.196157  58469.473426   
29  0.627   -0.008  128.088333 -13.530490  58218.250000  58509.250000   
30  0.562   -0.011  120.772267 -27.882620  58206.134340  58539.211759   
31  0.280    0.000  120.772274 -27.882643  58218.197072  58486.415324   
32  0.614   -0.035  283.344092   6.692659  58205.509410  58263.440590   
33  0.203   -0.016  283.344086   6.692640  58285.250000  59742.250000   
34  0.430   -0.012  295.319932   9.429914  58197.504954  58293.298171   
35  0.490   -0.029  295.319918   9.429908  58205.510799  58277.373611   
36  0.373    0.017  294.593210  14.434066  58218.487685  58293.298171   
37  0.374    0.025  294.593207  14.434073  58205.510799  58263.442870   
38  0.735    0.004  307.442210  58.191156  58228.476157  58281.407026   
39  0.491   -0.007  307.442195  58.191155  58216.516690  58360.286991   
40  0.379   -0.003  287.453325  15.029536  58204.507674  58255.418067   
41  0.376   -0.014  287.453331  15.029530  58186.533692  58294.315313   
42  0.497   -0.036  312.019551  37.222754  58206.524132  58282.402523   
43  1.072   -0.038  312.019553  37.222756  58222.497870  58287.449224   
44  0.515   -0.054  312.019550  37.222758  58271.433877  58433.081204   
45  0.244   -0.022  274.998144  -3.364605  58230.458137  58280.335035   
46  0.889   -0.057  274.998144  -3.364627  58205.527373  58285.420046   
47  0.320   -0.014  306.343209  40.821964  58205.513576  58263.447211   
48  0.178   -0.010  306.343204  40.821960  58222.464178  58373.279016   
49  1.306    0.124  302.872879  31.819776  58217.489768  58303.369965   

   nframesref  
0          15  
1          15  
2          15  
3          15  
4          15  
5          17  
6          15  
7          15  
8          15  
9          17  
10         15  
11         15  
12         17  
13         15  
14         15  
15         15  
16         15  
17         33  
18         17  
19         15  
20         15  
21         15  
22         15  
23         15  
24         17  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         40  
32         15  
33         16  
34         24  
35         15  
36         15  
37         15  
38         15  
39         15  
40         15  
41         27  
42         15  
43         15  
44         24  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,11.343572616577148,2025-07-28T21:01:43,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,6,-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects with a reference change-- Limit the result to 50 rowsSELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,16.77010178565979,2025-07-23T20:02:28,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abhdwug        78      2058  58247.436505  60818.356528       True   
1   ZTF18abhdwug        78      2058  58247.436505  60818.356528       True   
2   ZTF19aaamszl         7       593  58487.365000  60694.335220       True   
3   ZTF19aaamszl         7       593  58487.365000  60694.335220       True   
4   ZTF19aaasldr         9      2281  58488.093229  60744.530382       True   
5   ZTF19aaasldr         9      2281  58488.093229  60744.530382       True   
6   ZTF19aaasldr         9      2281  58488.093229  60744.530382       True   
7   ZTF19aafoltu        18      1951  58511.566667  60692.563345       True   
8   ZTF19aafoltu        18      1951  58511.566667  60692.563345       True   
9   ZTF19aafparm         6      2114  58511.571632  60688.574664       True   
10  ZTF19aafparm         6      2114  58511.571632  60688.574664       True   
11  ZTF19aafudfm        18       688  58505.369259  60296.496285       True   
12  ZTF19aafudfm        18       688  58505.369259  60296.496285       True   
13  ZTF19aafudfm        18       688  58505.369259  60296.496285       True   
14  ZTF19aaftzyv        20      1024  58199.250833  60355.335613       True   
15  ZTF19aaftzyv        20      1024  58199.250833  60355.335613       True   
16  ZTF19aaftzyv        20      1024  58199.250833  60355.335613       True   
17  ZTF19aakknsd       121      2126  58263.441042  60710.570498      False   
18  ZTF19aakknsd       121      2126  58263.441042  60710.570498      False   
19  ZTF19aakrcnv         4       513  58539.272280  60620.532049       True   
20  ZTF19aakrcnv         4       513  58539.272280  60620.532049       True   
21  ZTF19aakrdlr         4       372  58539.250000  60086.250000       True   
22  ZTF19aakrdlr         4       372  58539.250000  60086.250000       True   
23  ZTF19aaktawj         2       213  58539.378507  59539.540602       True   
24  ZTF19aaktawj         2       213  58539.378507  59539.540602       True   
25  ZTF19aakthca         3       218  58539.378507  59539.543113       True   
26  ZTF19aakthca         3       218  58539.378507  59539.543113       True   
27  ZTF19aaktasz         3       233  58539.378958  59305.315104       True   
28  ZTF19aaktasz         3       233  58539.378958  59305.315104       True   
29  ZTF18abtuzrm         5        13  58368.229873  58637.480313       True   
30  ZTF18abtuzrm         5        13  58368.229873  58637.480313       True   
31  ZTF18abtvcxc         8      2921  58368.230810  60448.438750       True   
32  ZTF18abtvcxc         8      2921  58368.230810  60448.438750       True   
33  ZTF18abuaccn         7       241  58343.430972  58511.121250      False   
34  ZTF18abuadii         4       262  58342.427743  58384.508044      False   
35  ZTF18abuahrb        11       206  58368.469120  58547.119433       True   
36  ZTF18abuahrb        11       206  58368.469120  58547.119433       True   
37  ZTF18abuaacr        29      3058  58368.449526  60560.422581       True   
38  ZTF18abuaacr        29      3058  58368.449526  60560.422581       True   
39  ZTF18abuaacr        29      3058  58368.449526  60560.422581       True   
40  ZTF18abuaacr        29      3058  58368.449526  60560.422581       True   
41  ZTF18abubpbq        14      2553  58307.377407  60694.574016       True   
42  ZTF18abubpbq        14      2553  58307.377407  60694.574016       True   
43  ZTF18abuehwz        17      1229  58369.250000  60154.500000       True   
44  ZTF18abuehwz        17      1229  58369.250000  60154.500000       True   
45  ZTF18abudzkc         8      1749  58369.250000  60172.250000       True   
46  ZTF18abudzkc         8      1749  58369.250000  60172.250000       True   
47  ZTF19aaauwwh         2        58  58488.137766  58618.312222       True   
48  ZTF19aaauwwh         2        58  58488.137766  58618.312222       True   
49  ZTF19aaaxjqn        18      4843  58349.305972  60883.194502       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False    14       NaN           NaN  ...    485  18.224000     0.022   
1     False    14       NaN           NaN  ...    485  19.467001     0.030   
2      True     3       NaN           NaN  ...    261  12.799000     0.008   
3      True     3       NaN           NaN  ...    261  13.761000     0.016   
4     False     3  1.227498      0.332399  ...    543  12.731999     0.021   
5     False     3  1.227498      0.332399  ...    543  13.470000     0.014   
6     False     3  1.227498      0.332399  ...   1537  12.785999     0.021   
7      True     3       NaN           NaN  ...    486  15.367000     0.015   
8      True     3       NaN           NaN  ...   1532  14.797999     0.014   
9      True     2       NaN           NaN  ...    486  12.938999     0.017   
10     True     2       NaN           NaN  ...   1479  12.927000     0.017   
11    False     4  1.497607      0.718203  ...    367  15.082999     0.013   
12    False     4  1.497607      0.718203  ...    367  15.554999     0.012   
13    False     4  1.497607      0.718203  ...    367  15.073999     0.018   
14    False     7  1.063876      0.696612  ...    367  15.521999     0.012   
15    False     7  1.063876      0.696612  ...    367  15.004000     0.013   
16    False     7  1.063876      0.696612  ...    367  14.995999     0.015   
17    False     2       NaN           NaN  ...    436  14.162000     0.018   
18    False     2       NaN           NaN  ...   1482  14.243000     0.018   
19    False     4       NaN           NaN  ...    315  14.929999     0.013   
20    False     4       NaN           NaN  ...    315  14.528000     0.011   
21    False     6  1.419586      0.533635  ...    317  15.320000     0.011   
22    False     6  1.419586      0.533635  ...    317  14.658000     0.014   
23     True     2  0.631747      0.706961  ...    320  15.382999     0.013   
24     True     2  0.631747      0.706961  ...    320  14.665999     0.012   
25     True     3  1.713300      0.686054  ...    320  14.198999     0.023   
26     True     3  1.713300      0.686054  ...    320  13.662999     0.032   
27     True     3       NaN           NaN  ...    319  16.363000     0.008   
28     True     3       NaN           NaN  ...    370  16.369000     0.018   
29     True     5  0.599841      0.852067  ...    335  14.348000     0.015   
30     True     5  0.599841      0.852067  ...    335  12.943999     0.012   
31    False    10       NaN           NaN  ...    384  13.142000     0.014   
32    False    10       NaN           NaN  ...    385  13.161000     0.013   
33    False     8  1.510517           NaN  ...    776  19.945000     0.037   
34    False     4  0.553947           NaN  ...    776  21.570000     0.124   
35     True     2       NaN           NaN  ...    706  20.353000     0.060   
36     True     2       NaN           NaN  ...   1704  20.669000     0.059   
37     True    11       NaN           NaN  ...    858  13.236000     0.012   
38     True    11       NaN           NaN  ...    858  12.877000     0.012   
39     True    11       NaN           NaN  ...    857  13.202000     0.021   
40     True    11       NaN           NaN  ...    857  12.823999     0.016   
41     True     5       NaN           NaN  ...    487  15.318999     0.025   
42     True     5       NaN           NaN  ...   1533  15.318000     0.018   
43    False     5  1.994081      0.533658  ...    494  15.469000     0.014   
44    False     5  1.994081      0.533658  ...    494  15.971000     0.014   
45    False     6  0.952578      0.519948  ...    730  15.551000     0.015   
46    False     6  0.952578      0.519948  ...    730  14.861999     0.016   
47     True     2  2.219545      0.658139  ...    851  14.631000     0.010   
48     True     2  2.219545      0.658139  ...   1859  13.799000     0.015   
49    False    12       NaN           NaN  ...    867  15.809999     0.017   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.942    0.018  270.348684   3.720318  58186.535486  58291.294109   
1   1.073    0.020  270.348663   3.720289  58204.500000  58347.250000   
2   0.544   -0.014  117.415581 -26.847328  58218.197072  58486.413947   
3   0.920   -0.023  117.415590 -26.847342  58427.503183  58539.211759   
4   0.722   -0.033  309.805631   8.508793  58252.484988  58322.392384   
5   0.518   -0.024  309.805634   8.508787  58228.500000  58283.500000   
6   1.068    0.051  309.805634   8.508784  58332.250000  59894.250000   
7   0.501   -0.011  271.475850   6.723698  58204.529514  58334.302222   
8   0.369   -0.018  271.475861   6.723684  58580.500000  59719.500000   
9   0.509   -0.007  272.212285   1.941486  58186.534896  58389.107292   
10  0.396    0.032  272.212311   1.941467  58593.250000  59813.250000   
11  0.407   -0.019  162.482366  -9.122307  58165.395058  58449.542049   
12  0.700   -0.024  162.482360  -9.122301  58204.187002  58464.519988   
13  0.526   -0.038  162.482361  -9.122312  58199.250000  59710.250000   
14  0.578   -0.013  162.154438 -13.412990  58204.280567  58464.519988   
15  0.409   -0.011  162.154436 -13.412990  58165.395058  58465.501921   
16  0.269   -0.025  162.154434 -13.412992  58199.250000  59710.250000   
17  0.488    0.023  286.999928   0.304887  58218.484329  58318.337199   
18  0.421   -0.032  286.999939   0.304869  58593.500000  59751.500000   
19  0.531   -0.018  150.957714 -17.934682  58202.253715  58469.499306   
20  0.390   -0.017  150.957718 -17.934681  58218.250000  59703.250000   
21  0.542   -0.019  164.351185 -15.575900  58204.214560  58492.504398   
22  0.437   -0.024  164.351196 -15.575900  58218.250000  59703.250000   
23  0.728   -0.013  185.623374 -18.049257  58204.299028  58511.440104   
24  0.363   -0.012  185.623383 -18.049259  58216.238160  58587.252130   
25  1.819    0.092  184.626046 -18.088779  58204.299028  58511.440104   
26  2.769    0.128  184.626040 -18.088819  58216.238160  58587.252130   
27  0.258    0.006  179.888767 -13.340789  58203.303738  58568.231933   
28  0.926   -0.031  179.888763 -13.340801  58203.304201  58482.524155   
29  0.718   -0.025  290.878318 -19.700035  58246.460868  58365.250845   
30  0.310    0.015  290.878326 -19.700023  58246.457037  58368.273461   
31  0.421   -0.001  284.192659  -8.139863  58246.462245  58347.330382   
32  0.209    0.005  284.192647  -8.139863  58246.461319  58377.210544   
33  1.055    0.039   36.478811  52.323238  58283.471887  58349.482025   
34  0.767    0.171   32.946549  51.277903  58283.471887  58365.391690   
35  1.358    0.001  107.667180  37.384948  58154.197824  58362.452315   
36  1.025    0.017  107.667225  37.384940  58154.173993  58449.425486   
37  0.361    0.022   98.790075  77.715936  58247.180243  58373.431840   
38  0.493    0.015   98.790090  77.715942  58197.267627  58364.489919   
39  0.962   -0.023   98.790159  77.715969  58227.179456  58351.443206   
40  0.496    0.033   98.790123  77.715950  58218.250000  58364.500000   
41  0.655   -0.054  278.879694   8.003279  58216.507454  58293.296690   
42  0.226   -0.022  278.879700   8.003258  58338.250000  59392.500000   
43  0.353   -0.017  332.891808   2.428231  58254.482442  58429.128727   
44  0.576    0.039  332.891819   2.428234  58246.481505  58337.375394   
45  0.601   -0.026  310.290771  38.785089  58229.504352  58282.402523   
46  0.346   -0.004  310.290758  38.785089  58229.454016  58430.176539   
47  0.220    0.001  314.987887  66.760401  58262.446968  58436.172535   
48  0.286    0.000  314.987883  66.760396  58271.426944  58593.374919   
49  0.520   -0.020  309.269992  79.927347  58262.446505  58367.286331   

   nframesref  
0          15  
1          15  
2          40  
3          15  
4          15  
5          15  
6          21  
7          15  
8          15  
9          15  
10         15  
11         15  
12         19  
13        100  
14         17  
15         16  
16        100  
17         15  
18         15  
19         15  
20        100  
21         16  
22        100  
23         15  
24         15  
25         15  
26         15  
27         15  
28         15  
29         15  
30         21  
31         16  
32         15  
33         15  
34         15  
35         16  
36         23  
37         15  
38         15  
39         15  
40         16  
41         22  
42         15  
43         15  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,9.923925638198853,2025-07-28T21:01:59,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,7,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- that had a change in the reference image, limited to 50 rows.SELECT     object.*,     reference.* FROM     objectINNER JOIN     reference ON     object.oid = reference.oidWHERE     object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,19.98659086227417,2025-07-23T20:02:49,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18acvtznr         8       269  58465.392905  58875.230787       True   
1   ZTF18acvtznr         8       269  58465.392905  58875.230787       True   
2   ZTF18acvuhxd        15      1848  58491.414294  59637.211111      False   
3   ZTF18acvuhxd        15      1848  58491.414294  59637.211111      False   
4   ZTF18acvuhxd        15      1848  58491.414294  59637.211111      False   
5   ZTF18abllluy         2        73  58305.330289  58333.320289       True   
6   ZTF18ablmepg         3        94  58334.157002  58602.270579       True   
7   ZTF18ablmepg         3        94  58334.157002  58602.270579       True   
8   ZTF18aczbhsd         8       438  58374.500000  59888.250000       True   
9   ZTF18aczbhsd         8       438  58374.500000  59888.250000       True   
10  ZTF18ablpqcn         2        62  58322.430741  58334.350255       True   
11  ZTF18ablrgxy         4      2297  58336.227083  60707.565278       True   
12  ZTF18ablrgxy         4      2297  58336.227083  60707.565278       True   
13  ZTF18ablrgxy         4      2297  58336.227083  60707.565278       True   
14  ZTF18ablrgtm        27      2289  58320.345926  60709.561169       True   
15  ZTF18ablrgtm        27      2289  58320.345926  60709.561169       True   
16  ZTF18ablqryf        86       979  58292.293009  60859.335949       True   
17  ZTF18ablqryf        86       979  58292.293009  60859.335949       True   
18  ZTF19abgcatr        84       716  58677.250000  59725.500000      False   
19  ZTF19abgcatr        84       716  58677.250000  59725.500000      False   
20  ZTF18ablrfih         5       697  58314.286516  59381.314421       True   
21  ZTF18ablrfih         5       697  58314.286516  59381.314421       True   
22  ZTF18ablrpyf        11      2067  58508.565023  60709.561169       True   
23  ZTF18ablrpyf        11      2067  58508.565023  60709.561169       True   
24  ZTF18ablrpyf        11      2067  58508.565023  60709.561169       True   
25  ZTF18ablrozd        15      3682  58340.316921  60687.569618       True   
26  ZTF18ablrozd        15      3682  58340.316921  60687.569618       True   
27  ZTF18ablrozd        15      3682  58340.316921  60687.569618       True   
28  ZTF18ablrozd        15      3682  58340.316921  60687.569618       True   
29  ZTF18ablrsfo        11      2189  58362.230891  60709.559201       True   
30  ZTF18ablrsfo        11      2189  58362.230891  60709.559201       True   
31  ZTF18ablrsfo        11      2189  58362.230891  60709.559201       True   
32  ZTF18ablrrwb        52       857  58305.313727  59308.499907       True   
33  ZTF18ablrrwb        52       857  58305.313727  59308.499907       True   
34  ZTF18ablsrhg        13      3326  58336.250000  59758.250000       True   
35  ZTF18ablsrhg        13      3326  58336.250000  59758.250000       True   
36  ZTF18ablslts         8      2883  58336.250000  59871.250000       True   
37  ZTF18ablslts         8      2883  58336.250000  59871.250000       True   
38  ZTF18ablslts         8      2883  58336.250000  59871.250000       True   
39  ZTF18ablvaty         2      3857  60597.106296  60707.560799       True   
40  ZTF18abluwbh         8      2303  58310.346412  58900.488229       True   
41  ZTF18abluwbh         8      2303  58310.346412  58900.488229       True   
42  ZTF18ablvqsn        14      3517  58337.359792  60847.397535       True   
43  ZTF18ablvqsn        14      3517  58337.359792  60847.397535       True   
44  ZTF18ablvqsn        14      3517  58337.359792  60847.397535       True   
45  ZTF18ablwjfw         6      1010  58337.399525  59138.366412       True   
46  ZTF18ablwjfw         6      1010  58337.399525  59138.366412       True   
47  ZTF18ablwjfw         6      1010  58337.399525  59138.366412       True   
48  ZTF18ablwjfw         6      1010  58337.399525  59138.366412       True   
49  ZTF18ablwrth        14      2082  58304.250000  60049.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0      True     6  0.817104      1.215077  ...    308  15.549000     0.011   
1      True     6  0.817104      1.215077  ...    308  14.460000     0.015   
2     False     5  0.156754      0.585538  ...    260  15.047999     0.015   
3     False     5  0.156754      0.585538  ...    310  15.641000     0.010   
4     False     5  0.156754      0.585538  ...    260  15.622000     0.011   
5      True     2  0.862946      1.071200  ...    686  15.580999     0.023   
6      True     2       NaN           NaN  ...    629  13.941000     0.016   
7      True     2       NaN           NaN  ...   1625  13.941000     0.020   
8     False     7  0.594557      0.476629  ...    249  14.613999     0.010   
9     False     7  0.594557      0.476629  ...    249  15.019000     0.011   
10     True     2  0.893181      0.528117  ...    729  14.575000     0.017   
11    False     3       NaN           NaN  ...    487  14.691999     0.015   
12    False     3       NaN           NaN  ...    487  15.986000     0.017   
13    False     3       NaN           NaN  ...   1533  14.688999     0.015   
14     True     5       NaN           NaN  ...    487  13.412999     0.017   
15     True     5       NaN           NaN  ...   1533  13.400000     0.019   
16    False    54       NaN           NaN  ...    280  16.743000     0.016   
17    False    54       NaN           NaN  ...    280  14.445000     0.030   
18    False    10  3.249282           NaN  ...    282  18.334000     0.059   
19    False    10  3.249282           NaN  ...    282  20.897000     0.169   
20     True     2  1.265122      1.632933  ...    333  13.877000     0.037   
21     True     2  1.265122      1.632933  ...    333  15.682000     0.017   
22     True     5       NaN           NaN  ...    538  15.035000     0.013   
23     True     5       NaN           NaN  ...    538  14.502999     0.029   
24     True     5       NaN           NaN  ...   1533  14.563000     0.016   
25     True     9       NaN           NaN  ...    589  14.335999     0.017   
26     True     9       NaN           NaN  ...    589  13.118999     0.016   
27     True     9       NaN           NaN  ...    538  14.345000     0.013   
28     True     9       NaN           NaN  ...   1584  13.084000     0.021   
29    False     6       NaN           NaN  ...    488  12.997000     0.018   
30    False     6       NaN           NaN  ...    488  15.526999     0.017   
31    False     6       NaN           NaN  ...   1534  13.042999     0.024   
32     True     8  0.817270      1.057633  ...    588  14.559999     0.020   
33     True     8  0.817270      1.057633  ...    588  15.457000     0.026   
34    False     3       NaN           NaN  ...    730  14.403000     0.018   
35    False     3       NaN           NaN  ...    731  14.389999     0.018   
36    False     7  1.266435      1.622511  ...    805  17.399000     0.016   
37    False     7  1.266435      1.622511  ...    804  17.410000     0.015   
38    False     7  1.266435      1.622511  ...    805  18.883000     0.026   
39     True     2       NaN           NaN  ...    487  15.679999     0.016   
40     True     3       NaN           NaN  ...    865  16.607000     0.013   
41     True     3       NaN           NaN  ...    848  16.604000     0.013   
42    False     5 -0.262613      0.683996  ...    436  15.096000     0.013   
43    False     5 -0.262613      0.683996  ...    436  14.486000     0.017   
44    False     5 -0.262613      0.683996  ...    385  15.101000     0.018   
45     True     7  0.516535      0.713011  ...    775  16.661000     0.018   
46     True     7  0.516535      0.713011  ...    774  16.679000     0.025   
47     True     7  0.516535      0.713011  ...    774  17.374000     0.012   
48     True     7  0.516535      0.713011  ...    775  17.399000     0.017   
49    False     5  0.240186      0.522231  ...    332  14.575999     0.014   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.809   -0.010  101.435675 -19.499175  58378.497083  58748.522118   
1   0.456   -0.031  101.435673 -19.499164  58383.523576  58464.460162   
2   0.437    0.001  111.152299 -20.666836  58476.336806  58476.398056   
3   0.178   -0.006  111.152290 -20.666841  58204.185903  58450.435382   
4   0.690   -0.013  111.152310 -20.666829  58206.134815  58539.211308   
5   1.038    0.076  297.294578  33.169962  58217.489294  58322.388657   
6   0.606   -0.033  217.865285  23.054569  58160.468750  58229.359294   
7   0.930   -0.043  217.865300  23.054588  58160.467766  58580.329143   
8   0.482   -0.006   34.125518 -23.960758  58338.500799  58505.108310   
9   0.494   -0.030   34.125540 -23.960770  58335.500694  58441.250891   
10  0.462   -0.030  301.100198  38.012613  58217.491169  58333.320833   
11  0.268   -0.004  279.719081   5.389089  58217.484491  58292.315046   
12  0.763   -0.048  279.719086   5.389088  58205.500000  58273.500000   
13  0.346    0.036  279.719086   5.389068  58348.250000  59424.250000   
14  0.583   -0.014  280.043968   4.746666  58217.484491  58292.315046   
15  0.530   -0.014  280.043976   4.746649  58348.250000  59393.500000   
16  0.889    0.011  260.020105 -25.510774  58248.376412  58670.278646   
17  1.614   -0.081  260.020127 -25.510729  58302.259306  58302.280775   
18  0.910   -0.129  273.703365 -22.461142  58288.292500  58308.259838   
19  0.555   -0.047  273.703386 -22.462052  58246.488067  58712.188414   
20  1.419   -0.049  277.310462 -19.070454  58315.253032  58315.280440   
21  0.856   -0.036  277.310451 -19.070449  58262.401238  58365.252222   
22  0.324   -0.002  280.371882   9.667397  58204.529051  58316.356806   
23  0.833    0.003  280.371882   9.667383  58273.378681  58333.282917   
24  0.278   -0.024  280.371887   9.667374  58338.250000  59392.500000   
25  0.610   -0.033  279.509635  15.451277  58203.505521  58313.336389   
26  0.194   -0.005  279.509640  15.451280  58186.528900  58433.093056   
27  0.405    0.020  279.509657  15.451299  58204.507211  58303.286528   
28  0.407    0.028  279.509674  15.451283  58280.500000  59377.500000   
29  0.610   -0.006  286.683780   4.972791  58198.504259  58285.376956   
30  0.909   -0.084  286.683781   4.972768  58205.509873  58285.435926   
31  0.495    0.000  286.683777   4.972765  58285.250000  59392.500000   
32  0.806   -0.036  274.764022  21.790870  58186.525787  58360.217755   
33  1.347   -0.085  274.764020  21.790862  58203.505058  58320.207211   
34  0.743   -0.017  317.379188  43.608333  58218.494306  58270.434317   
35  0.292   -0.007  317.379190  43.608325  58242.474433  58360.302975   
36  0.427   -0.026  351.643076  55.675482  58244.485023  58367.340764   
37  0.585   -0.013  351.643078  55.675472  58242.469699  58282.470035   
38  0.786   -0.014  351.643084  55.675463  58246.484803  58287.431597   
39  0.409   -0.049  277.771813   7.097414  58217.484491  58279.378831   
40  0.509   -0.004  268.856168  72.781723  58198.363773  58351.218947   
41  0.444   -0.019  268.856194  72.781740  58186.519745  58226.506505   
42  0.313   -0.020  284.954101  -6.249174  58246.461782  58292.414421   
43  0.181    0.035  284.954102  -6.249177  58334.250000  58347.250000   
44  0.665   -0.012  284.954132  -6.249161  58246.500000  58363.250000   
45  0.625    0.037   22.103518  55.787447  58276.465313  58344.469005   
46  1.183   -0.066   22.103499  55.787450  58277.429306  58429.281528   
47  0.219    0.000   22.103493  55.787473  58274.449757  58337.387801   
48  0.834   -0.046   22.103507  55.787439  58277.464769  58305.470000   
49  0.349   -0.010  265.882690 -15.242464  58218.468345  58607.356481   

   nframesref  
0          15  
1          40  
2          40  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          17  
10         15  
11         20  
12         15  
13         15  
14         20  
15         16  
16         15  
17         31  
18         20  
19         15  
20         30  
21         15  
22         15  
23         40  
24         15  
25         15  
26         40  
27         15  
28         15  
29         15  
30         15  
31         16  
32         15  
33         15  
34         15  
35         15  
36         15  
37         15  
38         15  
39         15  
40         16  
41         16  
42         19  
43         40  
44         15  
45         15  
46         15  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,10.724566221237183,2025-07-28T21:02:14,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,8,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limiting the result to 50 rows.SELECT     object.*,     reference.*FROM     objectINNER JOIN     referenceON     object.oid = reference.oidWHERE     object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,19.28803539276123,2025-07-23T20:03:08,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF17aacwwml         5       160  58045.353704  58732.455625       True   
1   ZTF17aacwwml         5       160  58045.353704  58732.455625       True   
2   ZTF17aacwxtv         3       171  58045.353704  58721.435775       True   
3   ZTF17aacwxtv         3       171  58045.353704  58721.435775       True   
4   ZTF17aacxhmq         4       149  58045.353704  58732.455625       True   
5   ZTF17aacxhmq         4       149  58045.353704  58732.455625       True   
6   ZTF17aacxarw        12       943  58045.250000  60222.500000       True   
7   ZTF17aacxarw        12       943  58045.250000  60222.500000       True   
8   ZTF17aacxhhs         5       684  58045.250000  59905.250000       True   
9   ZTF17aacxhhs         5       684  58045.250000  59905.250000       True   
10  ZTF17aadeyhq         4       988  58045.250000  60171.500000      False   
11  ZTF17aadeyhq         4       988  58045.250000  60171.500000      False   
12  ZTF18aaacveo        15      3159  58129.398970  60678.227026       True   
13  ZTF18aaacveo        15      3159  58129.398970  60678.227026       True   
14  ZTF18aaacveo        15      3159  58129.398970  60678.227026       True   
15  ZTF18aaacveo        15      3159  58129.398970  60678.227026       True   
16  ZTF17aadfwjt         6       432  58045.358125  58839.275081       True   
17  ZTF17aadfwjt         6       432  58045.358125  58839.275081       True   
18  ZTF17aadhtrr        22      2531  58045.347512  60624.357836       True   
19  ZTF17aadhtrr        22      2531  58045.347512  60624.357836       True   
20  ZTF17aadhtrr        22      2531  58045.347512  60624.357836       True   
21  ZTF17aadhtrr        22      2531  58045.347512  60624.357836       True   
22  ZTF17aadgvmy         7      2524  58045.477639  60639.358125       True   
23  ZTF17aadgvmy         7      2524  58045.477639  60639.358125       True   
24  ZTF17aadhlnh         6      1075  58045.347512  60560.432697       True   
25  ZTF17aadhlnh         6      1075  58045.347512  60560.432697       True   
26  ZTF17aadhjpx        11       472  58045.347512  59511.360474       True   
27  ZTF17aadhjpx        11       472  58045.347512  59511.360474       True   
28  ZTF17aadinym        11      1170  58045.349282  60697.184317       True   
29  ZTF17aadinym        11      1170  58045.349282  60697.184317       True   
30  ZTF17aadikxe        18      1799  58045.349282  60534.453032       True   
31  ZTF17aadikxe        18      1799  58045.349282  60534.453032       True   
32  ZTF17aadikxe        18      1799  58045.349282  60534.453032       True   
33  ZTF17aadikxe        18      1799  58045.349282  60534.453032       True   
34  ZTF17aadijct         9       817  58045.349282  60560.476435       True   
35  ZTF17aadijct         9       817  58045.349282  60560.476435       True   
36  ZTF17aadpbet        24      3145  58041.506262  60667.374502       True   
37  ZTF17aadqbib        17      3623  58041.506262  60671.282593       True   
38  ZTF17aadqbib        17      3623  58041.506262  60671.282593       True   
39  ZTF18aaafspo        10      3266  58131.250000  60165.500000       True   
40  ZTF18aaafspo        10      3266  58131.250000  60165.500000       True   
41  ZTF18aaafspo        10      3266  58131.250000  60165.500000       True   
42  ZTF18aaajkte        11      1502  58132.500000  60083.250000       True   
43  ZTF18aaajkte        11      1502  58132.500000  60083.250000       True   
44  ZTF18aaajzuu        70      4860  58131.447870  60758.262546       True   
45  ZTF18aaajzuu        70      4860  58131.447870  60758.262546       True   
46  ZTF18aaajzuu        70      4860  58131.447870  60758.262546       True   
47  ZTF18aaamebr        10      2822  58132.250000  59800.500000       True   
48  ZTF18aaamebr        10      2822  58132.250000  59800.500000       True   
49  ZTF18aaamebr        10      2822  58132.250000  59800.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0      True     2 -0.006134      1.023244  ...    509  14.040000     0.017   
1      True     2 -0.006134      1.023244  ...    509  14.841000     0.013   
2      True     2  0.105148      1.696422  ...    509  13.672999     0.014   
3      True     2  0.105148      1.696422  ...    509  15.031000     0.014   
4      True     2  1.138004      1.452422  ...    509  15.601000     0.016   
5      True     2  1.138004      1.452422  ...    509  17.093000     0.017   
6     False    10 -1.171174      1.280038  ...    509  14.547000     0.015   
7     False    10 -1.171174      1.280038  ...    509  13.382999     0.013   
8     False     2  0.587073      0.873372  ...    509  14.549000     0.015   
9     False     2  0.587073      0.873372  ...    509  15.297999     0.013   
10    False     2  1.927687           NaN  ...    507  14.879000     0.016   
11    False     2  1.927687           NaN  ...    507  14.387000     0.013   
12    False     7       NaN           NaN  ...    568  13.990000     0.017   
13    False     7       NaN           NaN  ...    569  13.988999     0.011   
14    False     7       NaN           NaN  ...    568  14.490000     0.014   
15    False     7       NaN           NaN  ...    569  14.503000     0.011   
16     True     2  2.206259      0.175591  ...    562  13.440000     0.013   
17     True     2  2.206259      0.175591  ...    562  13.028000     0.021   
18     True    11       NaN           NaN  ...    453  14.535999     0.014   
19     True    11       NaN           NaN  ...    452  14.599000     0.023   
20     True    11       NaN           NaN  ...    452  15.012000     0.023   
21     True    11       NaN           NaN  ...    453  14.962999     0.012   
22     True     4       NaN           NaN  ...    562  14.984000     0.017   
23     True     4       NaN           NaN  ...    562  14.368000     0.013   
24     True     5       NaN           NaN  ...    453  13.809999     0.019   
25     True     5       NaN           NaN  ...    453  13.322000     0.017   
26     True    10  1.787971      0.740324  ...    453  13.592999     0.015   
27     True    10  1.787971      0.740324  ...    453  14.099999     0.022   
28     True     7       NaN           NaN  ...    454  14.316999     0.013   
29     True     7       NaN           NaN  ...    454  13.934000     0.021   
30     True    11  1.330645      0.634977  ...    454  14.238000     0.013   
31     True    11  1.330645      0.634977  ...    453  15.000999     0.017   
32     True    11  1.330645      0.634977  ...    453  14.236999     0.018   
33     True    11  1.330645      0.634977  ...    454  15.000000     0.016   
34    False     5       NaN           NaN  ...    454  13.773000     0.019   
35    False     5       NaN           NaN  ...    454  14.789000     0.013   
36     True     9       NaN           NaN  ...    614  12.825000     0.012   
37     True     4       NaN           NaN  ...    614  13.400000     0.014   
38     True     4       NaN           NaN  ...    613  13.764000     0.014   
39    False     4  2.080863      0.492567  ...    705  15.575000     0.020   
40    False     4  2.080863      0.492567  ...    706  15.537000     0.014   
41    False     4  2.080863      0.492567  ...    705  16.064001     0.021   
42    False     3       NaN           NaN  ...   1573  16.595000     0.014   
43    False     3       NaN           NaN  ...    577  16.475000     0.014   
44    False    10       NaN           NaN  ...    753  15.912000     0.053   
45    False    10       NaN           NaN  ...    753  16.760000     0.051   
46    False    10       NaN           NaN  ...    713  15.910000     0.050   
47    False     5  2.926334      1.185412  ...    706  15.089999     0.018   
48    False     5  2.926334      1.185412  ...    705  15.080000     0.024   
49    False     5  2.926334      1.185412  ...    706  15.665999     0.009   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.911   -0.024   71.360304  11.243431  58160.163623  58434.336655   
1   0.373   -0.016   71.360306  11.243432  58168.117963  58437.415370   
2   0.430   -0.006   69.920667  14.757017  58160.163623  58434.336655   
3   0.545   -0.021   69.920669  14.757013  58167.118426  58439.432963   
4   0.440   -0.032   72.699081  13.024804  58160.163623  58434.336655   
5   0.677   -0.043   72.699082  13.024790  58168.117963  58443.314248   
6   0.472   -0.020   68.522449  10.609801  58167.145498  58439.432963   
7   0.122    0.006   68.522441  10.609809  58338.482419  58434.336655   
8   0.631   -0.031   72.859711  13.510087  58160.163623  58434.336655   
9   0.422   -0.026   72.859718  13.510081  58168.000000  58443.250000   
10  0.546   -0.032   57.325152  11.157052  58337.427315  58426.344444   
11  0.375   -0.002   57.325150  11.157051  58324.500000  58434.250000   
12  1.039   -0.041  134.613875  19.772460  58154.247836  58190.151759   
13  0.292    0.012  134.613864  19.772445  58154.233021  58184.273276   
14  0.649   -0.037  134.613883  19.772454  58166.253229  58443.524109   
15  0.438   -0.022  134.613876  19.772459  58166.250000  58443.500000   
16  0.457   -0.035   89.776975  17.559665  58167.121713  58375.476505   
17  0.659   -0.009   89.776983  17.559646  58186.130174  58441.422245   
18  0.368   -0.004   43.935982   4.251808  58319.465197  58435.300521   
19  0.715   -0.004   43.935979   4.251805  58314.442234  58353.484352   
20  1.007   -0.040   43.935991   4.251840  58314.477014  58365.418808   
21  0.324   -0.021   43.935978   4.251809  58314.476099  58441.255463   
22  0.753   -0.053   90.070055  20.253065  58168.114109  58380.504954   
23  0.307   -0.006   90.070065  20.253062  58160.161528  58434.358808   
24  0.764   -0.046   45.747693   2.001274  58314.476099  58397.377477   
25  0.717   -0.027   45.747694   2.001271  58319.465197  58447.352824   
26  0.622   -0.023   50.533588   3.647538  58319.465197  58425.315637   
27  1.210   -0.037   50.533598   3.647546  58314.476099  58441.255463   
28  0.236    0.008   53.193898   1.948281  58337.427778  58425.357292   
29  1.000   -0.055   53.193900   1.948280  58324.486470  58431.346736   
30  0.383   -0.003   50.799248   6.888573  58324.486470  58434.338935   
31  0.712   -0.041   50.799248   6.888578  58314.476099  58441.255463   
32  0.802   -0.011   50.799246   6.888571  58336.462419  58432.312118   
33  0.622   -0.008   50.799249   6.888572  58327.486782  58441.268681   
34  0.481   -0.013   55.432211   3.865968  58324.486470  58447.360741   
35  0.402   -0.017   55.432219   3.865971  58337.427778  58428.332245   
36  0.542   -0.017  102.980276  29.614101  58154.163472  58190.166354   
37  0.692   -0.013  102.562051  25.346799  58154.137072  58183.131227   
38  0.552   -0.037  102.562065  25.346798  58167.000000  58422.500000   
39  1.275    0.016  102.205737  39.925939  58154.195336  58353.509792   
40  0.737   -0.010  102.205742  39.925923  58154.197824  58223.171053   
41  1.082    0.022  102.205772  39.925919  58166.250000  58426.250000   
42  0.544   -0.025  197.793723  18.102924  58160.429514  58582.269560   
43  0.730   -0.028  197.793727  18.102922  58155.440544  58449.526192   
44  4.838    0.299  167.096251  44.150326  58154.379201  58186.323437   
45  5.207    0.296  167.096293  44.150328  58166.320683  58255.200498   
46  4.683    0.341  167.096248  44.150338  58154.324664  58186.324352   
47  1.128   -0.019  101.804265  40.293329  58154.197824  58223.171053   
48  1.632   -0.029  101.804280  40.293332  58154.195336  58353.509792   
49  0.191   -0.006  101.804270  40.293314  58166.177732  58367.472199   

   nframesref  
0          15  
1          15  
2          15  
3          32  
4          15  
5          28  
6          31  
7          15  
8          15  
9          28  
10         15  
11         16  
12         20  
13         16  
14         22  
15         22  
16         15  
17         40  
18         15  
19         15  
20         15  
21         27  
22         16  
23         15  
24         15  
25         30  
26         15  
27         25  
28         15  
29         15  
30         15  
31         26  
32         15  
33         27  
34         32  
35         15  
36         17  
37         15  
38         15  
39         15  
40         15  
41         15  
42         15  
43         40  
44         19  
45         15  
46         29  
47         15  
48         15  
49         15  

[50 rows x 36 columns]]",,11.498764514923096,2025-07-28T21:02:30,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,9,"-- Retrieve all columns from the 'object' and 'reference' tables for ZTF objects-- where there was a change in the reference image, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,17.697061777114868,2025-07-23T20:03:26,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18acmymrr         2        71  58427.300903  58437.329097       True   
1   ZTF18ackzyhm        15      2740  58370.250000  59905.250000       True   
2   ZTF18ackzyhm        15      2740  58370.250000  59905.250000       True   
3   ZTF18ackzyhm        15      2740  58370.250000  59905.250000       True   
4   ZTF18ackzhqy         8      1973  58435.250000  59783.500000       True   
5   ZTF18ackzhqy         8      1973  58435.250000  59783.500000       True   
6   ZTF18ackzhqy         8      1973  58435.250000  59783.500000       True   
7   ZTF18ackzhqy         8      1973  58435.250000  59783.500000       True   
8   ZTF18ackzkcn        56      3755  58431.244433  60839.479850       True   
9   ZTF18ackzkcn        56      3755  58431.244433  60839.479850       True   
10  ZTF18ackzmia         6      2511  58316.421354  60810.495660       True   
11  ZTF18ackzmia         6      2511  58316.421354  60810.495660       True   
12  ZTF18aclarhs         3        91  58435.399248  58776.469699      False   
13  ZTF18aclarhs         3        91  58435.399248  58776.469699      False   
14  ZTF18aclayev        22      2134  58435.363160  60745.132442       True   
15  ZTF18aclayev        22      2134  58435.363160  60745.132442       True   
16  ZTF18aclayev        22      2134  58435.363160  60745.132442       True   
17  ZTF18aclayev        22      2134  58435.363160  60745.132442       True   
18  ZTF18aclbopo        12      1863  58131.293935  60639.400868       True   
19  ZTF18aclbopo        12      1863  58131.293935  60639.400868       True   
20  ZTF18aclbuip         4       703  58435.500000  59901.500000       True   
21  ZTF18aclbuip         4       703  58435.500000  59901.500000       True   
22  ZTF18aclaqnt        21       716  58104.250000  59873.500000       True   
23  ZTF18aclaqnt        21       716  58104.250000  59873.500000       True   
24  ZTF18aclbugl        13      2522  58435.363160  60678.208391       True   
25  ZTF18aclbugl        13      2522  58435.363160  60678.208391       True   
26  ZTF18aclbugl        13      2522  58435.363160  60678.208391       True   
27  ZTF18abwfkzk        14      1218  58376.317593  59713.476898       True   
28  ZTF18abwfkzk        14      1218  58376.317593  59713.476898       True   
29  ZTF18aclcryq         2      1831  58435.393901  60683.308507       True   
30  ZTF18aclcryq         2      1831  58435.393901  60683.308507       True   
31  ZTF18abftewz        14      2981  58308.500000  60180.250000       True   
32  ZTF18abftewz        14      2981  58308.500000  60180.250000       True   
33  ZTF18acldlfh         4       931  58435.500000  59958.250000       True   
34  ZTF18acldlfh         4       931  58435.500000  59958.250000       True   
35  ZTF18acldlvn         6      1042  58078.340648  58846.248264       True   
36  ZTF18acldlvn         6      1042  58078.340648  58846.248264       True   
37  ZTF18acldqcx         7       484  58210.136875  58480.465417       True   
38  ZTF18acldqcx         7       484  58210.136875  58480.465417       True   
39  ZTF18acldjcl         5       747  58160.189757  59496.486123       True   
40  ZTF18acldjcl         5       747  58160.189757  59496.486123       True   
41  ZTF18acldopm         4      1256  58435.392986  60667.374977      False   
42  ZTF18aclebso         9      3389  58435.374919  60671.283067       True   
43  ZTF18aclebso         9      3389  58435.374919  60671.283067       True   
44  ZTF18aclebso         9      3389  58435.374919  60671.283067       True   
45  ZTF18aclebso         9      3389  58435.374919  60671.283067       True   
46  ZTF18aclezmi         2      2746  58435.500000  60174.500000       True   
47  ZTF18aclezmi         2      2746  58435.500000  60174.500000       True   
48  ZTF18aclfjrg        12      1783  58434.355150  60560.484236       True   
49  ZTF18aclfjrg        12      1783  58434.355150  60560.484236       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0      True     2  0.076513      1.004822  ...    506  15.030999     0.028   
1     False     9  0.480089      0.735736  ...    805  14.879000     0.012   
2     False     9  0.480089      0.735736  ...    773  14.011000     0.019   
3     False     9  0.480089      0.735736  ...    805  14.037000     0.015   
4     False     7  2.781731      1.742394  ...    868  15.750999     0.011   
5     False     7  2.781731      1.742394  ...    869  16.806000     0.015   
6     False     7  2.781731      1.742394  ...    868  16.738000     0.017   
7     False     7  2.781731      1.742394  ...    869  15.752999     0.022   
8     False    13       NaN           NaN  ...    776  15.375999     0.027   
9     False    13       NaN           NaN  ...    777  15.318000     0.022   
10     True     3       NaN           NaN  ...    650  13.391000     0.015   
11     True     3       NaN           NaN  ...   1694  13.363000     0.015   
12    False     2  0.222822           NaN  ...    305  13.561999     0.014   
13    False     2  0.222822           NaN  ...    305  14.226000     0.013   
14    False     8       NaN           NaN  ...    305  14.212000     0.012   
15    False     8       NaN           NaN  ...    305  14.962999     0.012   
16    False     8       NaN           NaN  ...    356  14.955000     0.012   
17    False     8       NaN           NaN  ...    356  14.202000     0.014   
18    False     6       NaN           NaN  ...    566  14.955999     0.014   
19    False     6       NaN           NaN  ...    566  15.575000     0.012   
20    False     2 -0.889009      1.336991  ...    306  15.428000     0.012   
21    False     2 -0.889009      1.336991  ...    306  16.078001     0.010   
22    False     4  1.752288     -1.008967  ...    305  16.289000     0.010   
23    False     4  1.752288     -1.008967  ...    305  15.860000     0.014   
24    False     4       NaN           NaN  ...    306  15.636000     0.015   
25    False     4       NaN           NaN  ...    305  15.530999     0.019   
26    False     4       NaN           NaN  ...    306  16.055000     0.011   
27     True     9 -0.776932      0.084598  ...    773  13.250999     0.013   
28     True     9 -0.776932      0.084598  ...    773  13.513000     0.016   
29     True     3       NaN           NaN  ...    565  14.309999     0.015   
30     True     3       NaN           NaN  ...    565  14.834000     0.019   
31    False     4  0.457457      0.661296  ...    596  15.372000     0.015   
32    False     4  0.457457      0.661296  ...    596  14.780999     0.016   
33    False     4 -0.399143     -0.230145  ...    514  14.056999     0.015   
34    False     4 -0.399143     -0.230145  ...    514  13.837999     0.013   
35     True     3  1.291418      1.250643  ...    563  14.221000     0.017   
36     True     3  1.291418      1.250643  ...    564  15.379000     0.016   
37     True     2  0.869148      0.449657  ...    514  14.377999     0.013   
38     True     2  0.869148      0.449657  ...    514  14.809000     0.015   
39     True     3  0.640456      0.843653  ...    514  12.678000     0.012   
40     True     3  0.640456      0.843653  ...    514  13.408999     0.015   
41    False     3       NaN           NaN  ...    514  14.405999     0.010   
42    False     5       NaN           NaN  ...    564  14.992000     0.017   
43    False     5       NaN           NaN  ...    565  14.993000     0.017   
44    False     5       NaN           NaN  ...    565  15.080999     0.018   
45    False     5       NaN           NaN  ...    564  15.065000     0.018   
46    False     2       NaN           NaN  ...    563  15.431999     0.015   
47    False     2       NaN           NaN  ...    564  15.433000     0.017   
48     True     3       NaN           NaN  ...    305  14.830000     0.014   
49     True     3       NaN           NaN  ...    356  15.675000     0.015   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   1.896    0.042   53.052408   9.254520  58340.456678  58434.339398   
1   0.580    0.009    1.093631  55.098888  58246.484803  58285.450104   
2   0.450   -0.010    1.093647  55.098884  58257.468472  58447.325891   
3   0.836   -0.025    1.093625  55.098885  58247.469734  58287.473252   
4   0.775    0.009    3.500108  79.724486  58216.514213  58318.362801   
5   0.821   -0.015    3.500158  79.724451  58643.454537  58704.380509   
6   0.857   -0.037    3.500088  79.724480  58255.500000  58423.250000   
7   0.978   -0.062    3.500108  79.724442  58643.500000  58750.250000   
8   1.300   -0.058   45.471823  57.323967  58288.467801  58370.482211   
9   1.042   -0.075   45.471834  57.323955  58303.473206  58383.516470   
10  0.323   -0.028   16.665326  36.361407  58276.463889  58373.451863   
11  0.289    0.003   16.665331  36.361404  58335.500000  58761.250000   
12  0.338   -0.018   77.405098 -19.681716  58365.518924  58449.411655   
13  0.907   -0.020   77.405104 -19.681720  58365.464178  58432.434051   
14  0.531   -0.018   81.311833 -13.483397  58368.477870  58432.399201   
15  0.443   -0.013   81.311835 -13.483400  58365.464178  58432.434051   
16  0.495   -0.018   81.311836 -13.483410  58360.500000  58439.500000   
17  0.392   -0.025   81.311829 -13.483403  58363.500000  58449.500000   
18  0.653   -0.007  118.591956  16.220093  58154.203345  58223.182685   
19  0.466   -0.018  118.591973  16.220066  58166.286100  58441.478310   
20  0.263   -0.004   83.577191 -14.207377  58367.500741  58432.400116   
21  0.564    0.014   83.577194 -14.207376  58373.500000  58441.500000   
22  0.390   -0.008   78.420929 -17.928591  58365.464178  58430.402037   
23  0.643   -0.013   78.420938 -17.928596  58365.518924  58449.411655   
24  0.465   -0.019   82.917893 -14.643061  58367.500741  58432.400116   
25  0.793   -0.024   82.918627 -14.643263  58368.477870  58432.399201   
26  0.451   -0.017   82.918633 -14.643270  58373.500000  58441.500000   
27  0.205   -0.004    6.626394  57.531234  58257.468472  58447.325891   
28  0.724   -0.037    6.626387  57.531252  58274.447905  58349.400764   
29  0.699   -0.042  108.669727  15.514175  58154.162488  58243.156736   
30  1.209   -0.041  108.669739  15.514150  58167.250000  58438.500000   
31  0.681   -0.044  329.610632  17.559413  58247.483391  58290.440787   
32  0.550   -0.026  329.610623  17.559408  58247.472616  58432.107535   
33  0.743   -0.021  108.993217   8.791598  58154.209757  58374.517720   
34  0.135   -0.006  108.993230   8.791578  58166.232558  58437.476736   
35  1.022    0.001   99.151571  17.707231  58154.167569  58219.200694   
36  0.731   -0.034   99.151572  17.707195  58167.163218  58443.503276   
37  0.634    0.004  102.984069  14.440929  58154.209757  58217.156898   
38  0.725   -0.015  102.984095  14.440914  58166.232558  58439.429213   
39  0.404   -0.012  104.506397  10.593780  58154.160012  58377.463414   
40  0.652   -0.041  104.506400  10.593761  58166.232558  58438.421169   
41  0.323   -0.005  105.288133   8.798512  58154.160012  58380.475139   
42  0.794   -0.013  106.328341  20.098806  58155.168924  58377.474641   
43  0.737   -0.049  106.328327  20.098809  58154.162488  58190.167870   
44  0.763   -0.036  106.328339  20.098808  58167.250000  58438.500000   
45  0.792   -0.053  106.328346  20.098803  58167.250000  58437.500000   
46  1.082   -0.033   99.017069  19.548235  58154.167569  58219.200694   
47  1.323   -0.024   99.017075  19.548223  58154.250000  58436.250000   
48  0.365   -0.026   81.225036 -13.534428  58368.477870  58432.399201   
49  0.746   -0.031   81.225040 -13.534447  58360.477859  58439.532442   

   nframesref  
0          15  
1          15  
2          34  
3          15  
4          15  
5          15  
6          15  
7          15  
8          15  
9          15  
10         15  
11         40  
12         27  
13         15  
14         15  
15         15  
16         18  
17         16  
18         16  
19         15  
20         15  
21         25  
22         15  
23         26  
24         15  
25         16  
26         25  
27         29  
28         15  
29         15  
30         16  
31         15  
32         15  
33         15  
34         15  
35         15  
36         31  
37         15  
38         15  
39         15  
40         15  
41         15  
42         15  
43         20  
44         16  
45         15  
46         15  
47         15  
48         15  
49         18  

[50 rows x 36 columns]]",,9.90286922454834,2025-07-28T21:02:45,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,94,10,"-- Query to retrieve all columns from the 'object' and 'reference' tables-- for ZTF objects that had a change in the reference, limited to 50 rows.SELECT *FROM objectINNER JOIN reference ON object.oid = reference.oidWHERE object.reference_change = TRUELIMIT 50","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,16.29969334602356,2025-07-23T20:03:42,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19abbginx         7      2092  58660.425301  60786.502315       True   
1   ZTF19abbginx         7      2092  58660.425301  60786.502315       True   
2   ZTF19abbginx         7      2092  58660.425301  60786.502315       True   
3   ZTF19abbgtbx        10      2099  58316.434468  60786.497465       True   
4   ZTF19abbgtbx        10      2099  58316.434468  60786.497465       True   
5   ZTF19abbgtbx        10      2099  58316.434468  60786.497465       True   
6   ZTF18acqcrer         4      2016  58442.268148  60761.515220       True   
7   ZTF18acqcrer         4      2016  58442.268148  60761.515220       True   
8   ZTF19abbllrk        14      1616  58332.491806  60839.473102       True   
9   ZTF19abbllrk        14      1616  58332.491806  60839.473102       True   
10  ZTF19abbljeo         5      2414  58660.447037  60839.485197       True   
11  ZTF19abbljeo         5      2414  58660.447037  60839.485197       True   
12  ZTF19abbljeo         5      2414  58660.447037  60839.485197       True   
13  ZTF20absmynq         3      1954  58663.372650  60733.539028       True   
14  ZTF20absmynq         3      1954  58663.372650  60733.539028       True   
15  ZTF20acolycg         5      1853  59154.110914  60707.561262       True   
16  ZTF20acolycg         5      1853  59154.110914  60707.561262       True   
17  ZTF18abscvxj        23      2607  58361.500000  59788.500000       True   
18  ZTF18abscvxj        23      2607  58361.500000  59788.500000       True   
19  ZTF18abscvxj        23      2607  58361.500000  59788.500000       True   
20  ZTF18abscvxj        23      2607  58361.500000  59788.500000       True   
21  ZTF18aciwbna         4      1702  59082.314132  60761.524005       True   
22  ZTF18aciwbna         4      1702  59082.314132  60761.524005       True   
23  ZTF18aciwofw        10      3823  58773.207512  60761.531343       True   
24  ZTF18aciwofw        10      3823  58773.207512  60761.531343       True   
25  ZTF19aaksjvn         4       373  58539.250000  60064.250000       True   
26  ZTF19aaksjvn         4       373  58539.250000  60064.250000       True   
27  ZTF19aadiath        11      4096  58495.180417  60832.489213       True   
28  ZTF19aadiath        11      4096  58495.180417  60832.489213       True   
29  ZTF19aadiath        11      4096  58495.180417  60832.489213       True   
30  ZTF19aadiath        11      4096  58495.180417  60832.489213       True   
31  ZTF19aadiath        11      4096  58495.180417  60832.489213       True   
32  ZTF19aadlerc         2       110  58495.253542  58885.190162       True   
33  ZTF19aadlerc         2       110  58495.253542  58885.190162       True   
34  ZTF19aadlxoj         3       704  58495.254907  59672.149583       True   
35  ZTF19aadlxoj         3       704  58495.254907  59672.149583       True   
36  ZTF19acezqsv        10      2085  58277.374988  60709.555787       True   
37  ZTF19acezqsv        10      2085  58277.374988  60709.555787       True   
38  ZTF19acezrtp        12      1885  58773.090995  60733.539502       True   
39  ZTF19acezrtp        12      1885  58773.090995  60733.539502       True   
40  ZTF18aaosbrf         8      1331  58232.193125  59496.511354       True   
41  ZTF18aaosbrf         8      1331  58232.193125  59496.511354       True   
42  ZTF18aaoulhm         6      1420  58232.250000  59784.250000       True   
43  ZTF18aaoulhm         6      1420  58232.250000  59784.250000       True   
44  ZTF18aaosanu        13       935  58232.190787  60675.479190       True   
45  ZTF18aaosanu        13       935  58232.190787  60675.479190       True   
46  ZTF18aaosanu        13       935  58232.190787  60675.479190       True   
47  ZTF18aapgulz       479      1336  58232.495289  59271.531644       True   
48  ZTF18aapgulz       479      1336  58232.495289  59271.531644       True   
49  ZTF18aapgulz       479      1336  58232.495289  59271.531644       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...  field      magnr  sigmagnr  \
0     False     3       NaN           NaN  ...    693  13.641000     0.015   
1     False     3       NaN           NaN  ...    693  13.231000     0.018   
2     False     3       NaN           NaN  ...   1734  13.226000     0.013   
3     False     8       NaN           NaN  ...    693  14.730000     0.019   
4     False     8       NaN           NaN  ...    693  15.204000     0.018   
5     False     8       NaN           NaN  ...   1734  14.726999     0.026   
6      True     4       NaN           NaN  ...    690  14.443000     0.017   
7      True     4       NaN           NaN  ...   1688  14.009000     0.013   
8     False     6       NaN           NaN  ...    603  15.040000     0.013   
9     False     6       NaN           NaN  ...    603  14.443000     0.016   
10     True     3       NaN           NaN  ...    697  14.415000     0.015   
11     True     3       NaN           NaN  ...    697  13.740000     0.016   
12     True     3       NaN           NaN  ...   1738  13.735000     0.015   
13     True     2       NaN           NaN  ...    490  15.500000     0.016   
14     True     2       NaN           NaN  ...   1483  15.148999     0.021   
15     True     2       NaN           NaN  ...    486  14.044000     0.015   
16     True     2       NaN           NaN  ...   1480  13.552000     0.017   
17    False     9  0.467177      0.475504  ...    776  16.059000     0.024   
18    False     9  0.467177      0.475504  ...    776  16.553000     0.021   
19    False     9  0.467177      0.475504  ...    775  16.593000     0.016   
20    False     9  0.467177      0.475504  ...    775  16.058000     0.017   
21    False     4       NaN           NaN  ...    494  15.962000     0.018   
22    False     4       NaN           NaN  ...    494  16.514000     0.015   
23     True     3       NaN           NaN  ...    597  14.933000     0.015   
24     True     3       NaN           NaN  ...   1642  14.919000     0.018   
25    False     4 -1.029087      0.158831  ...    319  14.889000     0.021   
26    False     4 -1.029087      0.158831  ...    319  15.615000     0.012   
27    False     9       NaN           NaN  ...    699  14.634999     0.015   
28    False     9       NaN           NaN  ...    698  14.653000     0.022   
29    False     9       NaN           NaN  ...    699  14.955999     0.017   
30    False     9       NaN           NaN  ...    698  14.971000     0.016   
31    False     9       NaN           NaN  ...   1696  14.662000     0.016   
32     True     2  1.462172      1.283981  ...    310  13.886000     0.017   
33     True     2  1.462172      1.283981  ...    310  12.608000     0.011   
34     True     3       NaN           NaN  ...    362  16.257000     0.012   
35     True     3       NaN           NaN  ...    312  16.240000     0.017   
36     True     3       NaN           NaN  ...    487  13.547999     0.018   
37     True     3       NaN           NaN  ...   1534  13.570999     0.020   
38     True     2       NaN           NaN  ...    489  14.783999     0.017   
39     True     2       NaN           NaN  ...   1536  14.752999     0.030   
40     True     3 -0.123853      0.893867  ...    516  13.339000     0.013   
41     True     3 -0.123853      0.893867  ...    516  14.053000     0.015   
42    False     3  1.014039      0.496886  ...    629  16.297000     0.025   
43    False     3  1.014039      0.496886  ...    629  15.162000     0.013   
44    False     6       NaN           NaN  ...    314  14.742000     0.010   
45    False     6       NaN           NaN  ...    314  14.421000     0.015   
46    False     6       NaN           NaN  ...    265  14.733000     0.011   
47     True    53  0.458368      0.428407  ...    765  14.830000     0.011   
48     True    53  0.458368      0.428407  ...    765  14.412000     0.025   
49     True    53  0.458368      0.428407  ...   1801  14.387000     0.017   

    chinr  sharpnr        ranr      decnr   mjdstartref     mjdendref  \
0   0.601   -0.010  354.641010  33.938827  58246.483414  58361.392130   
1   0.343   -0.027  354.640991  33.938801  58254.500000  58447.250000   
2   0.216    0.015  354.640991  33.938793  58326.250000  58744.500000   
3   0.844   -0.025  355.970317  34.453368  58257.465671  58368.303333   
4   0.811   -0.036  355.970320  34.453381  58246.483414  58343.403368   
5   0.760   -0.025  355.970306  34.453354  58326.250000  58744.500000   
6   0.658   -0.037  331.377522  33.173094  58244.452905  58323.458113   
7   0.217    0.018  331.377502  33.173069  58300.500000  58763.250000   
8   0.425   -0.013   24.337991  26.316027  58277.463310  58348.502650   
9   0.413   -0.046   24.337990  26.316009  58281.465660  58447.330961   
10  0.686   -0.026   30.386606  42.883154  58283.450266  58346.465961   
11  0.404   -0.035   30.386608  42.883141  58283.500000  58447.250000   
12  0.169   -0.002   30.386604  42.883133  58345.500000  58759.250000   
13  0.589   -0.037  299.210129   1.235308  58231.482500  58344.351759   
14  0.676   -0.037  299.210175   1.235301  59061.500000  59766.250000   
15  0.528   -0.023  274.785414   3.930313  58204.529514  58347.332211   
16  0.322    0.027  274.785431   3.930303  58593.250000  59775.250000   
17  0.946   -0.010   32.920147  53.425045  58283.471887  58365.391690   
18  0.823   -0.052   32.920145  53.425046  58291.451366  58324.447986   
19  0.975   -0.033   32.920149  53.425062  58277.464769  58316.427940   
20  0.826    0.005   32.920156  53.425054  58276.465313  58343.470486   
21  0.583   -0.048  327.450316   7.008885  58246.452847  58423.144375   
22  0.493    0.004  327.450317   7.008882  58246.481505  58363.297488   
23  0.487   -0.042  339.130201  21.549553  58273.434224  58379.309502   
24  0.411   -0.023  339.130188  21.549545  58310.500000  58763.250000   
25  1.077    0.021  178.895966 -16.787038  58199.327812  58472.453646   
26  0.622    0.009  178.895956 -16.787024  58203.303738  58557.312627   
27  0.469    0.001   41.450353  40.307982  58310.450475  58428.286609   
28  0.796   -0.027   41.450357  40.307982  58303.471736  58363.471030   
29  0.501   -0.024   41.450340  40.307978  58304.467789  58375.448692   
30  0.339   -0.001   41.450373  40.308013  58303.451609  58346.466435   
31  0.298   -0.015   41.450363  40.307964  58345.500000  58765.500000   
32  0.764   -0.046  112.321009 -18.299955  58204.185903  58450.435382   
33  0.466   -0.013  112.321000 -18.299950  58218.197523  58507.250683   
34  0.774   -0.015  128.420067 -13.450402  58204.221944  58472.462847   
35  1.205   -0.022  128.420063 -13.450395  58204.220579  58509.248345   
36  0.600   -0.042  283.366997   7.285151  58217.484491  58279.378831   
37  0.805    0.007  283.367004   7.285126  58285.250000  59385.250000   
38  0.358   -0.025  297.127773   4.728859  58218.487222  58340.296863   
39  0.775   -0.064  297.127777   4.728832  59061.250000  59424.250000   
40  0.774   -0.025  118.016776  13.879414  58154.212234  58190.149456   
41  0.700   -0.021  118.016789  13.879395  58166.240903  58438.460532   
42  1.204   -0.060  220.432135  28.423323  58166.467002  58314.231921   
43  0.340   -0.023  220.432131  28.423337  58160.468750  58222.317928   
44  0.479   -0.012  145.190068 -20.720722  58202.253241  58468.440243   
45  0.766   -0.024  145.190058 -20.720697  58218.193866  58226.145463   
46  0.475   -0.006  145.190079 -20.720709  58229.250000  58598.250000   
47  0.424   -0.016  280.264818  47.944998  58204.476424  58231.491227   
48  1.643   -0.029  280.264795  47.945031  58155.552512  58247.448461   
49  0.521   -0.042  280.264826  47.944996  58268.386516  58443.117639   

   nframesref  
0          15  
1          29  
2          39  
3          15  
4          15  
5          40  
6          15  
7          40  
8          15  
9          30  
10         15  
11         28  
12         40  
13         15  
14         15  
15         15  
16         15  
17         15  
18         15  
19         15  
20         15  
21         15  
22         15  
23         15  
24         36  
25         15  
26         15  
27         15  
28         15  
29         15  
30         15  
31         40  
32         17  
33         15  
34         15  
35         15  
36         15  
37         15  
38         40  
39         16  
40         23  
41         16  
42         15  
43         15  
44         15  
45         22  
46         15  
47         16  
48         16  
49         18  

[50 rows x 36 columns]]",,10.012656688690186,2025-07-28T21:03:00,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,90,0,"SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking <= 2
    AND oid in
(
SELECT
    oid
FROM
    feature
WHERE
    name = 'Multiband_period'
    AND version = 'lc_classifier_1.2.1-P'
    AND value < 5
LIMIT 100
)",,,,,"[              oid classifier_name     classifier_version class_name  \
0    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        CEP   
1    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0       DSCT   
2    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        RRL   
3    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0        RRL   
4    ZTF18abadjvy   lc_classifier  hierarchical_rf_1.1.0          E   
..            ...             ...                    ...        ...   
341  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0          E   
342  ZTF18abasovn   lc_classifier   lc_classifier_1.1.13          E   
343  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0        RRL   
344  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0     Blazar   
345  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0        QSO   

     probability  ranking  
0       0.161280        2  
1       0.283360        1  
2       0.190720        1  
3       0.227040        2  
4       0.093744        2  
..           ...      ...  
341     0.424664        1  
342     0.309624        1  
343     0.188956        2  
344     0.205800        2  
345     0.678160        1  

[346 rows x 6 columns]]",,4.481142520904541,2025-07-28T21:03:05,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,1,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_features AS (    -- Subquery 1: Filter the 'feature' table for 'multiband_period' with value < 5 and specific version    SELECT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter the 'probability' table for relevant objects and conditions    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2)      AND oid IN (SELECT oid FROM filtered_features))-- Final Query: Limit the results to 100 rowsSELECT *FROM filtered_probabilitiesLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,31.50260758399964,2025-07-23T20:04:14,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Corrected Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days
-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table
-- for the light curve classifier with rankings 1 or 2.

WITH filtered_features AS (
    -- Subquery 1: Filter the 'feature' table for 'multiband_period' with value < 5 and specific version
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),
filtered_probabilities AS (
    -- Subquery 2: Filter the 'probability' table for relevant objects and conditions
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
      AND oid IN (SELECT oid FROM filtered_features) -- Ensure the subquery is properly referenced
)
-- Final Query: Limit the results to 100 rows
SELECT *
FROM filtered_probabilities
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.08579683303833,2025-07-28T21:05:21,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,90,2,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_features AS (    -- Subquery 1: Filter objects based on multiband period    SELECT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter probabilities for the light curve classifier    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Combine the filters using an INNER JOINSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_features fON p.oid = f.oid-- Limit the results to at most 100 objectsLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,30.014174222946167,2025-07-23T20:04:44,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,11.120007038116455,2025-07-28T21:05:37,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,3,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings of 1 or 2.WITH filtered_features AS (    -- Subquery 1: Filter the 'feature' table for objects with multiband_period < 5    SELECT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter the 'probability' table for the light curve classifier with rankings 1 or 2    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND (ranking = 1 OR ranking = 2))-- Final Query: Join the filtered results and limit to 100 rowsSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_features fON p.oid = f.oidLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,22.95187830924988,2025-07-23T20:05:07,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,11.00113558769226,2025-07-28T21:05:53,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,4,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.SELECT *FROM probabilityWHERE oid IN (    -- Subquery to filter objects based on the 'feature' table    SELECT DISTINCT f.oid    FROM feature f    WHERE f.name = 'multiband_period'      AND f.value < 5      AND f.version = 'lc_classifier_1.2.1-P')AND classifier_name = 'lc_classifier'AND ranking IN (1, 2)LIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,25.2764630317688,2025-07-23T20:05:32,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,10.550509929656982,2025-07-28T21:06:08,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,5,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- and return all columns from the 'probability' table for the light curve classifier-- with rankings either 1 or 2.WITH filtered_objects AS (    -- Subquery 1: Filter objects based on multiband period    SELECT DISTINCT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter probabilities for light curve classifier    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Final Query: Join the filtered objects with the filtered probabilitiesSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_objects oON p.oid = o.oidLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,33.1457622051239,2025-07-23T20:06:05,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,10.212655782699585,2025-07-28T21:06:23,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,6,"-- Final Query to retrieve at most 100 ZTF objects with the specified conditionsWITH filtered_objects AS (    -- Subquery 1: Filter objects based on the 'multiband_period' feature    SELECT DISTINCT f.oid    FROM feature f    INNER JOIN object o ON f.oid = o.oid    WHERE f.name = 'multiband_period'      AND f.value < 5      AND f.version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter probabilities for the selected objects    SELECT p.*    FROM probability p    INNER JOIN filtered_objects fo ON p.oid = fo.oid    WHERE p.classifier_name = 'lc_classifier'      AND p.ranking IN (1, 2))-- Final Query: Retrieve all columns from the 'probability' table for the filtered objectsSELECT *FROM filtered_probabilitiesLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,22.64985418319702,2025-07-23T20:06:28,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,10.816632747650146,2025-07-28T21:06:38,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,7,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_features AS (    -- Subquery to filter objects based on the multiband period condition    SELECT oid    FROM feature    WHERE name = 'multiband_period'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery to filter probabilities for the light curve classifier with rankings 1 or 2    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Combine the results of the two subqueries using an INNER JOINSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_features fON p.oid = f.oidLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,23.84159469604492,2025-07-23T20:06:52,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,12.806249141693115,2025-07-28T21:06:56,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,8,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- and return all columns from the 'probability' table for the light curve classifier-- with rankings of 1 or 2.WITH filtered_objects AS (    -- Sub-query to filter objects based on the multiband period    SELECT DISTINCT oid    FROM feature    WHERE name = 'MultibandPeriod'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Sub-query to filter classification data from the probability table    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Combine results by performing an INNER JOIN on the oid columnSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_objects oON p.oid = o.oidLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,34.20009136199951,2025-07-23T20:07:26,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,10.82064151763916,2025-07-28T21:07:12,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,9,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_objects AS (    -- Subquery 1: Filter objects based on multiband period    SELECT DISTINCT oid    FROM feature    WHERE name = 'MultibandPeriod'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Subquery 2: Filter probabilities for light curve classifier    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2))-- Combine the two subqueries using an INNER JOINSELECT p.*FROM filtered_probabilities pINNER JOIN filtered_objects oON p.oid = o.oid-- Limit the results to at most 100 objectsLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,24.92752361297608,2025-07-23T20:07:51,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,10.401615381240845,2025-07-28T21:07:27,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,90,10,"-- Final Query to retrieve at most 100 ZTF objects with a multiband period lower than 5 days-- in the 'lc_classifier_1.2.1-P' feature version, returning all columns from the 'probability' table-- for the light curve classifier with rankings 1 or 2.WITH filtered_objects AS (    -- Step 1: Filter objects based on the multiband period    SELECT DISTINCT oid    FROM feature    WHERE name = 'MultibandPeriod'      AND value < 5      AND version = 'lc_classifier_1.2.1-P'),filtered_probabilities AS (    -- Step 2: Filter probabilities for the relevant objects    SELECT *    FROM probability    WHERE classifier_name = 'lc_classifier'      AND ranking IN (1, 2)      AND oid IN (SELECT oid FROM filtered_objects))-- Step 3: Limit the results to at most 100 objectsSELECT *FROM filtered_probabilitiesLIMIT 100","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,29.481520652771,2025-07-23T20:08:21,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,10.617027044296265,2025-07-28T21:07:42,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,,,51,0,"SELECT
    oid, mjd, fid, mag, e_mag, mag_corr, e_mag_corr_ext, isdiffpos
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aaiutyh'
ORDER BY mjd",,,,,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr_ext  isdiffpos  
0         0.397760         -1  
1         0.385556          1  
2         0.198804          1  
3         0.396211          1  
4         0.359854          1  
..             ...        ...  
60        0.052439          1  
61        0.056607          1  
62        0.044895          1  
63        0.116776          1  
64        0.086913          1  

[65 rows x 8 columns]]",,4.027330636978149,2025-07-28T21:07:47,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,51,1,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.6876368522644043,2025-07-23T20:08:24,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,8.47660517692566,2025-07-28T21:08:00,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,2,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.625335216522217,2025-07-23T20:08:26,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,8.113412618637085,2025-07-28T21:08:12,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,3,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,3.4246535301208496,2025-07-23T20:08:30,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,7.7719573974609375,2025-07-28T21:08:23,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,4,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,3.20593523979187,2025-07-23T20:08:33,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,7.7975358963012695,2025-07-28T21:08:36,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,5,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.528184652328491,2025-07-23T20:08:36,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,7.8378026485443115,2025-07-28T21:08:47,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,6,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.716781616210937,2025-07-23T20:08:39,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,7.64764666557312,2025-07-28T21:08:59,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,7,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.73183274269104,2025-07-23T20:08:41,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,7.8472208976745605,2025-07-28T21:09:10,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,8,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.795102596282959,2025-07-23T20:08:44,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,8.197102308273315,2025-07-28T21:09:22,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,9,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,5.003399610519409,2025-07-23T20:08:49,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,7.71115779876709,2025-07-28T21:09:33,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,51,10,"SELECT     oid AS object_identifier,     mjd AS date,     fid AS filter_identifier,     mag AS difference_magnitude,     e_mag AS difference_magnitude_uncertainty,     mag_corr AS corrected_magnitude,     e_mag_corr AS corrected_magnitude_uncertainty,     isdiffpos FROM     forced_photometry WHERE     oid = 'ZTF24aaiutyh' ORDER BY     mjd","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.981632232666016,2025-07-23T20:08:52,"[   object_identifier          date  filter_identifier  difference_magnitude  \
0       ZTF24aaiutyh  60379.298576                  2             22.773140   
1       ZTF24aaiutyh  60379.353646                  1             24.290796   
2       ZTF24aaiutyh  60388.374248                  2             21.594248   
3       ZTF24aaiutyh  60388.403090                  1             22.186195   
4       ZTF24aaiutyh  60391.247940                  2             20.535074   
..               ...           ...                ...                   ...   
60      ZTF24aaiutyh  60461.285498                  2             19.569294   
61      ZTF24aaiutyh  60463.216609                  1             19.693674   
62      ZTF24aaiutyh  60463.241956                  2             19.620783   
63      ZTF24aaiutyh  60475.197060                  1             19.829998   
64      ZTF24aaiutyh  60475.258437                  2             19.761471   

    difference_magnitude_uncertainty  corrected_magnitude  \
0                           1.164226            21.607100   
1                           4.187508            21.701127   
2                           0.462391            20.677787   
3                           0.958558            21.226965   
4                           0.539723            20.094963   
..                               ...                  ...   
60                          0.063208            19.366501   
61                          0.064697            19.548642   
62                          0.054562            19.409044   
63                          0.135698            19.666953   
64                          0.108217            19.523438   

    corrected_magnitude_uncertainty  isdiffpos  
0                          0.388676         -1  
1                          0.374043          1  
2                          0.195533          1  
3                          0.391576          1  
4                          0.359241          1  
..                              ...        ...  
60                         0.051329          1  
61                         0.055123          1  
62                         0.043485          1  
63                         0.115890          1  
64                         0.086023          1  

[65 rows x 8 columns]]",,8.046676397323608,2025-07-28T21:09:45,0.0,0.0,0.125,0.125,0.0,0.0
0.20.2,,,59,0,"
SELECT
    oid, fid, ndet, magmean
FROM
    magstat
WHERE
    oid = 'ZTF18acsvogv'
",,,,,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,3.172365665435791,2025-07-28T21:09:49,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,1,"SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet, -- number of detections    magmean -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv' -- specific ZTF object","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.17523455619812,2025-07-23T20:08:56,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.159407377243042,2025-07-28T21:10:01,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,2,"SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet, -- number of detections    magmean -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv' -- specific ZTF object","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.412802696228028,2025-07-23T20:08:59,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.916879653930664,2025-07-28T21:10:12,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,3,"SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet, -- number of detections    magmean -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv' -- specific ZTF object","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.603200197219849,2025-07-23T20:09:04,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.74989652633667,2025-07-28T21:10:24,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,4,"SELECT     oid,     fid,     ndet,     magmeanFROM     magstatWHERE     oid = 'ZTF18acsvogv'","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.443042278289795,2025-07-23T20:09:06,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.977929592132568,2025-07-28T21:10:35,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,5,"SELECT     oid,     fid,     ndet,     magmeanFROM     magstatWHERE     oid = 'ZTF18acsvogv'","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.6022911071777344,2025-07-23T20:09:09,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.810571908950806,2025-07-28T21:10:47,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,6,"SELECT     oid,     fid,     ndet,     magmeanFROM     magstatWHERE     oid = 'ZTF18acsvogv'","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.9872853755950928,2025-07-23T20:09:12,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.497445106506348,2025-07-28T21:10:59,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,7,"SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet, -- number of detections    magmean -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv' -- specific ZTF object","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.7542834281921387,2025-07-23T20:09:15,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.9202470779418945,2025-07-28T21:11:10,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,8,"SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet, -- number of detections    magmean -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv' -- specific ZTF object","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.031618595123291,2025-07-23T20:09:19,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.882417678833008,2025-07-28T21:11:22,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,9,"SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet, -- number of detections    magmean -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv' -- specific ZTF object","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.308798313140869,2025-07-23T20:09:21,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.7397401332855225,2025-07-28T21:11:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,59,10,"SELECT     oid,  -- ZTF identifier    fid,  -- filter identifier    ndet, -- number of detections    magmean -- mean difference magnitudeFROM     magstatWHERE     oid = 'ZTF18acsvogv' -- specific ZTF object","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.5514369010925293,2025-07-23T20:09:24,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,8.494914770126343,2025-07-28T21:11:45,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,100,0,"
SELECT
    oid, mjd, fid, isdiffpos,
    magpsf, sigmapsf, NULL as diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'detection' as table
FROM
    detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, NULL as isdiffpos,
    NULL as magpsf, NULL as sigmapsf, diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'non_detection' as table
FROM
    non_detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, isdiffpos,
    NULL as magpsf, NULL as sigmapsf,
    NULL as diffmaglim,
    mag, e_mag,
    'forced_photometry' as table
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aamtvxb'
",,,,,"[              oid           mjd  fid  isdiffpos     magpsf  sigmapsf  \
0    ZTF24aamtvxb  60440.276505    1        1.0  18.307241  0.082498   
1    ZTF24aamtvxb  60442.171227    1        1.0  15.560810  0.033140   
2    ZTF24aamtvxb  60444.229016    1        1.0  14.585193  0.024982   
3    ZTF24aamtvxb  60449.220266    1        1.0  13.173624  0.018505   
4    ZTF24aamtvxb  60449.310336    2        1.0  13.359071  0.016791   
..            ...           ...  ...        ...        ...       ...   
244  ZTF24aamtvxb  60592.533183    2        1.0        NaN       NaN   
245  ZTF24aamtvxb  60600.525556    2        1.0        NaN       NaN   
246  ZTF24aamtvxb  60599.535475    2        1.0        NaN       NaN   
247  ZTF24aamtvxb  60595.530752    2        1.0        NaN       NaN   
248  ZTF24aamtvxb  60594.531447    2        1.0        NaN       NaN   

     diffmaglim        mag     e_mag              table  
0           NaN        NaN       NaN          detection  
1           NaN        NaN       NaN          detection  
2           NaN        NaN       NaN          detection  
3           NaN        NaN       NaN          detection  
4           NaN        NaN       NaN          detection  
..          ...        ...       ...                ...  
244         NaN  17.383959  0.047817  forced_photometry  
245         NaN  17.480049  0.060428  forced_photometry  
246         NaN  17.442333  0.028261  forced_photometry  
247         NaN  17.347569  0.024500  forced_photometry  
248         NaN  17.469713  0.041608  forced_photometry  

[249 rows x 10 columns]]",,3.7384376525878906,2025-07-28T21:11:50,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,100,1,"-- Final query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'-- The query combines data from the detection, non_detection, and forced_photometry tables-- and returns all epochs in a unified output table with the specified columns.SELECT     oid,     mjd,     fid,     isdiffpos,     magpsf,     sigmapsf,     diffmaglim,     NULL AS mag,     NULL AS e_mag,     'detection' AS tableFROM     detectionWHERE     oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid,     mjd,     fid,     NULL AS isdiffpos,     NULL AS magpsf,     NULL AS sigmapsf,     diffmaglim,     NULL AS mag,     NULL AS e_mag,     'non_detection' AS tableFROM     non_detectionWHERE     oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid,     mjd,     fid,     isdiffpos,     NULL AS magpsf,     NULL AS sigmapsf,     NULL AS diffmaglim,     mag,     e_mag,     'forced_photometry' AS tableFROM     forced_photometryWHERE     oid = 'ZTF24aamtvxb'ORDER BY     mjd ASC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,39.43829584121704,2025-07-23T20:10:04,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 50:     mag, 
             ^

[SQL: 
-- Corrected query to retrieve all detections, non-detections, and forced photometry points for the ZTF object 'ZTF24aamtvxb'
-- The query combines data from the detection, non_detection, and forced_photometry tables
-- and returns all epochs in a unified output table with the specified columns.

SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    magpsf, 
    sigmapsf, 
    diffmaglim, 
    NULL AS mag, 
    NULL AS e_mag, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid, 
    mjd, 
    fid, 
    NULL AS isdiffpos, 
    NULL AS magpsf, 
    NULL AS sigmapsf, 
    diffmaglim, 
    NULL AS mag, 
    NULL AS e_mag, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    NULL AS magpsf, 
    NULL AS sigmapsf, 
    NULL AS diffmaglim, 
    mag, 
    e_mag, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY 
    mjd ASC
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.859505653381348,2025-07-28T21:12:04,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,2,"-- [FINAL QUERY HERE]SELECT     oid,    mjd,    fid,    isdiffpos,    magpsf,    sigmapsf,    diffmaglim,    mag AS forced_mag,    e_mag AS forced_mag_uncertainty,    'detection' AS tableFROM detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid,    mjd,    fid,    NULL AS isdiffpos,    NULL AS magpsf,    NULL AS sigmapsf,    diffmaglim,    NULL AS forced_mag,    NULL AS forced_mag_uncertainty,    'non_detection' AS tableFROM non_detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid,    mjd,    fid,    isdiffpos,    NULL AS magpsf,    NULL AS sigmapsf,    diffmaglim,    mag AS forced_mag,    e_mag AS forced_mag_uncertainty,    'forced_photometry' AS tableFROM forced_photometryWHERE oid = 'ZTF24aamtvxb'ORDER BY mjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,19.29073452949524,2025-07-23T20:10:23,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 43:     mag AS forced_mag, 
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    magpsf, 
    sigmapsf, 
    diffmaglim, 
    NULL AS forced_mag, 
    NULL AS forced_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT 
    oid, 
    mjd, 
    fid, 
    NULL AS isdiffpos, 
    NULL AS magpsf, 
    NULL AS sigmapsf, 
    diffmaglim, 
    NULL AS forced_mag, 
    NULL AS forced_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    NULL AS magpsf, 
    NULL AS sigmapsf, 
    diffmaglim, 
    mag AS forced_mag, 
    e_mag AS forced_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
ORDER BY 
    mjd
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.29696249961853,2025-07-28T21:12:17,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,3,"-- [FINAL QUERY HERE]SELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    magpsf AS detection_diff_mag,    sigmapsf AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'detection' AS tableFROM detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    NULL AS isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'non_detection' AS tableFROM non_detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    NULL AS five_sigma_mag_limit,    mag AS forced_diff_mag,    e_mag AS forced_diff_mag_uncertainty,    'forced_photometry' AS tableFROM forced_photometryWHERE oid = 'ZTF24aamtvxb'ORDER BY epoch_date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,23.593995809555054,2025-07-23T20:10:47,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 47:     mag AS forced_diff_mag, 
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    NULL AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY 
    epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.110914707183838,2025-07-28T21:12:31,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,4,"-- [FINAL QUERY HERE]SELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    magpsf AS detection_diff_mag,    sigmapsf AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'detection' AS tableFROM     detectionWHERE     oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    NULL AS isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'non_detection' AS tableFROM     non_detectionWHERE     oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    mag AS forced_diff_mag,    e_mag AS forced_diff_mag_uncertainty,    'forced_photometry' AS tableFROM     forced_photometryWHERE     oid = 'ZTF24aamtvxb'ORDER BY     epoch_date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,28.366579055786133,2025-07-23T20:11:15,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 47:     mag AS forced_diff_mag,
             ^

[SQL: 
-- [FINAL QUERY HERE]
SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    isdiffpos,
    magpsf AS detection_diff_mag,
    sigmapsf AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    NULL AS forced_diff_mag,
    NULL AS forced_diff_mag_uncertainty,
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    NULL AS isdiffpos,
    NULL AS detection_diff_mag,
    NULL AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    NULL AS forced_diff_mag,
    NULL AS forced_diff_mag_uncertainty,
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    isdiffpos,
    NULL AS detection_diff_mag,
    NULL AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    mag AS forced_diff_mag,
    e_mag AS forced_diff_mag_uncertainty,
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY 
    epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.88185977935791,2025-07-28T21:12:45,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,5,"-- [FINAL QUERY HERE]SELECT     oid AS ""ZTF identifier"",    mjd AS ""epoch date"",    fid AS ""filter identifier"",    isdiffpos AS ""isdiffpos flag"",    magpsf AS ""detection difference magnitude"",    sigmapsf AS ""detection difference magnitude uncertainty"",    diffmaglim AS ""5-sigma magnitude limit"",    NULL AS ""forced difference magnitude"",    NULL AS ""forced difference magnitude uncertainty"",    'detection' AS ""table""FROM detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ""ZTF identifier"",    mjd AS ""epoch date"",    fid AS ""filter identifier"",    NULL AS ""isdiffpos flag"",    NULL AS ""detection difference magnitude"",    NULL AS ""detection difference magnitude uncertainty"",    diffmaglim AS ""5-sigma magnitude limit"",    NULL AS ""forced difference magnitude"",    NULL AS ""forced difference magnitude uncertainty"",    'non_detection' AS ""table""FROM non_detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ""ZTF identifier"",    mjd AS ""epoch date"",    fid AS ""filter identifier"",    isdiffpos AS ""isdiffpos flag"",    NULL AS ""detection difference magnitude"",    NULL AS ""detection difference magnitude uncertainty"",    NULL AS ""5-sigma magnitude limit"",    mag AS ""forced difference magnitude"",    e_mag AS ""forced difference magnitude uncertainty"",    'forced_photometry' AS ""table""FROM forced_photometryWHERE oid = 'ZTF24aamtvxb'ORDER BY ""epoch date"" ASC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,26.47834587097168,2025-07-23T20:11:42,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 43:     mag AS ""forced difference magnitude"", 
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    magpsf AS ""detection difference magnitude"", 
    sigmapsf AS ""detection difference magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    NULL AS ""forced difference magnitude"", 
    NULL AS ""forced difference magnitude uncertainty"", 
    'detection' AS ""table""
FROM detection
WHERE oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    NULL AS ""isdiffpos flag"", 
    NULL AS ""detection difference magnitude"", 
    NULL AS ""detection difference magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    NULL AS ""forced difference magnitude"", 
    NULL AS ""forced difference magnitude uncertainty"", 
    'non_detection' AS ""table""
FROM non_detection
WHERE oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    NULL AS ""detection difference magnitude"", 
    NULL AS ""detection difference magnitude uncertainty"", 
    NULL AS ""5-sigma magnitude limit"", 
    mag AS ""forced difference magnitude"", 
    e_mag AS ""forced difference magnitude uncertainty"", 
    'forced_photometry' AS ""table""
FROM forced_photometry
WHERE oid = 'ZTF24aamtvxb'

ORDER BY ""epoch date"" ASC
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.66056489944458,2025-07-28T21:12:58,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,6,"-- [FINAL QUERY HERE]SELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    magpsf AS detection_diff_mag,    sigmapsf AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'detection' AS tableFROM detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    NULL AS isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'non_detection' AS tableFROM non_detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    NULL AS five_sigma_mag_limit,    mag AS forced_diff_mag,    e_mag AS forced_diff_mag_uncertainty,    'forced_photometry' AS tableFROM forced_photometryWHERE oid = 'ZTF24aamtvxb'ORDER BY epoch_date ASC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,22.68731164932251,2025-07-23T20:12:04,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 43:     mag AS forced_diff_mag, 
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM detection
WHERE oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM non_detection
WHERE oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    NULL AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM forced_photometry
WHERE oid = 'ZTF24aamtvxb'

ORDER BY epoch_date ASC
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.686530828475952,2025-07-28T21:13:12,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,7,"-- [FINAL QUERY HERE]SELECT     oid,    mjd,    fid,    isdiffpos,    magpsf,    sigmapsf,    diffmaglim,    mag AS forced_mag,    e_mag AS forced_mag_uncertainty,    tableFROM (    -- Subquery for detection table    SELECT         oid,        mjd,        fid,        isdiffpos,        magpsf,        sigmapsf,        diffmaglim,        NULL AS mag,        NULL AS e_mag,        'detection' AS table    FROM detection    WHERE oid = 'ZTF24aamtvxb'        UNION ALL        -- Subquery for non_detection table    SELECT         oid,        mjd,        fid,        NULL AS isdiffpos,        NULL AS magpsf,        NULL AS sigmapsf,        diffmaglim,        NULL AS mag,        NULL AS e_mag,        'non_detection' AS table    FROM non_detection    WHERE oid = 'ZTF24aamtvxb'        UNION ALL        -- Subquery for forced_photometry table    SELECT         oid,        mjd,        fid,        isdiffpos,        NULL AS magpsf,        NULL AS sigmapsf,        NULL AS diffmaglim,        mag,        e_mag,        'forced_photometry' AS table    FROM forced_photometry    WHERE oid = 'ZTF24aamtvxb') AS combined_resultsORDER BY mjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,28.938156127929688,2025-07-23T20:12:34,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 58:         mag, 
                 ^

[SQL: 
-- Corrected SQL Query
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    magpsf, 
    sigmapsf, 
    diffmaglim, 
    mag AS forced_mag, 
    e_mag AS forced_mag_uncertainty, 
    ""table""
FROM (
    -- Subquery for detection table
    SELECT 
        oid, 
        mjd, 
        fid, 
        isdiffpos, 
        magpsf, 
        sigmapsf, 
        diffmaglim, 
        NULL AS mag, 
        NULL AS e_mag, 
        'detection' AS ""table""
    FROM detection
    WHERE oid = 'ZTF24aamtvxb'
    
    UNION ALL
    
    -- Subquery for non_detection table
    SELECT 
        oid, 
        mjd, 
        fid, 
        NULL AS isdiffpos, 
        NULL AS magpsf, 
        NULL AS sigmapsf, 
        diffmaglim, 
        NULL AS mag, 
        NULL AS e_mag, 
        'non_detection' AS ""table""
    FROM non_detection
    WHERE oid = 'ZTF24aamtvxb'
    
    UNION ALL
    
    -- Subquery for forced_photometry table
    SELECT 
        oid, 
        mjd, 
        fid, 
        isdiffpos, 
        NULL AS magpsf, 
        NULL AS sigmapsf, 
        NULL AS diffmaglim, 
        mag, 
        e_mag, 
        'forced_photometry' AS ""table""
    FROM forced_photometry
    WHERE oid = 'ZTF24aamtvxb'
) AS combined_results
ORDER BY mjd
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.747159719467163,2025-07-28T21:13:30,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,8,"-- [FINAL QUERY HERE]SELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    magpsf AS detection_diff_mag,    sigmapsf AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'detection' AS tableFROM detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    NULL AS isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'non_detection' AS tableFROM non_detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    NULL AS five_sigma_mag_limit,    mag AS forced_diff_mag,    e_mag AS forced_diff_mag_uncertainty,    'forced_photometry' AS tableFROM forced_photometryWHERE oid = 'ZTF24aamtvxb'ORDER BY epoch_date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,23.11334085464477,2025-07-23T20:12:57,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 47:     mag AS forced_diff_mag, 
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    NULL AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

ORDER BY 
    epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.04928970336914,2025-07-28T21:13:44,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,9,"-- [FINAL QUERY HERE]SELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    magpsf AS detection_diff_mag,    sigmapsf AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'detection' AS tableFROM detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    NULL AS isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    diffmaglim AS five_sigma_mag_limit,    NULL AS forced_diff_mag,    NULL AS forced_diff_mag_uncertainty,    'non_detection' AS tableFROM non_detectionWHERE oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid AS ztf_identifier,    mjd AS epoch_date,    fid AS filter_identifier,    isdiffpos,    NULL AS detection_diff_mag,    NULL AS detection_diff_mag_uncertainty,    NULL AS five_sigma_mag_limit,    mag AS forced_diff_mag,    e_mag AS forced_diff_mag_uncertainty,    'forced_photometry' AS tableFROM forced_photometryWHERE oid = 'ZTF24aamtvxb'ORDER BY epoch_date","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,20.73435759544373,2025-07-23T20:13:17,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 43:     mag AS forced_diff_mag,
             ^

[SQL: 
-- [FINAL QUERY HERE]
SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    isdiffpos,
    magpsf AS detection_diff_mag,
    sigmapsf AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    NULL AS forced_diff_mag,
    NULL AS forced_diff_mag_uncertainty,
    'detection' AS table
FROM detection
WHERE oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    NULL AS isdiffpos,
    NULL AS detection_diff_mag,
    NULL AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    NULL AS forced_diff_mag,
    NULL AS forced_diff_mag_uncertainty,
    'non_detection' AS table
FROM non_detection
WHERE oid = 'ZTF24aamtvxb'

UNION ALL

SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    isdiffpos,
    NULL AS detection_diff_mag,
    NULL AS detection_diff_mag_uncertainty,
    NULL AS five_sigma_mag_limit,
    mag AS forced_diff_mag,
    e_mag AS forced_diff_mag_uncertainty,
    'forced_photometry' AS table
FROM forced_photometry
WHERE oid = 'ZTF24aamtvxb'

ORDER BY epoch_date
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.210740566253662,2025-07-28T21:13:57,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,100,10,"-- [FINAL QUERY HERE]SELECT     oid,     mjd,     fid,     isdiffpos,     magpsf,     sigmapsf,     diffmaglim,     mag,     e_mag,     'detection' AS tableFROM     detectionWHERE     oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid,     mjd,     fid,     NULL AS isdiffpos,     NULL AS magpsf,     NULL AS sigmapsf,     diffmaglim,     NULL AS mag,     NULL AS e_mag,     'non_detection' AS tableFROM     non_detectionWHERE     oid = 'ZTF24aamtvxb'UNION ALLSELECT     oid,     mjd,     fid,     isdiffpos,     NULL AS magpsf,     NULL AS sigmapsf,     NULL AS diffmaglim,     mag,     e_mag,     'forced_photometry' AS tableFROM     forced_photometryWHERE     oid = 'ZTF24aamtvxb'ORDER BY     mjd ASC","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,20.536624908447266,2025-07-23T20:13:38,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 43:     mag, 
             ^

[SQL: 
-- Corrected SQL Query
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    magpsf, 
    sigmapsf, 
    diffmaglim, 
    NULL AS mag, 
    NULL AS e_mag, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT 
    oid, 
    mjd, 
    fid, 
    NULL AS isdiffpos, 
    NULL AS magpsf, 
    NULL AS sigmapsf, 
    diffmaglim, 
    NULL AS mag, 
    NULL AS e_mag, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    NULL AS magpsf, 
    NULL AS sigmapsf, 
    NULL AS diffmaglim, 
    mag, 
    e_mag, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
ORDER BY 
    mjd ASC
]
(Background on this error at: https://sqlalche.me/e/20/f405)",8.915570735931396,2025-07-28T21:14:10,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,,,106,0,"
SELECT
    sq1.oid, sq1.ndet, sq1.firstmjd,
    sq1.probability as prob_stamp_bogus,
    sq2.probability as prob_lc_transient
FROM
(
SELECT
    object.oid, object.ndet, object.firstmjd,
    probability.class_name,
    probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    ndet > 10
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'bogus'
    AND probability > 0.7
    AND classifier_version = 'stamp_classifier_1.0.4'
) AS sq1
INNER JOIN
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier_top'
    AND class_name = 'Transient'
    AND probability > 0.9
) AS sq2
ON sq1.oid = sq2.oid
ORDER BY sq1.oid
LIMIT 30
",,,,,"[             oid  ndet      firstmjd  prob_stamp_bogus  prob_lc_transient
0   ZTF17aaahhwn    16  60168.430151          0.771008              1.000
1   ZTF18aajkcdn    11  59904.431377          0.767230              0.954
2   ZTF18abjrfqx    56  58325.466678          0.745006              1.000
3   ZTF18ablowct    25  58334.328206          0.700790              1.000
4   ZTF18abmwnov    57  58346.359896          0.715889              1.000
5   ZTF18absdojk   499  58362.167813          0.705910              0.952
6   ZTF18abuicad    68  58371.378785          0.835837              0.956
7   ZTF18abzbkby    40  58385.452824          0.864839              0.994
8   ZTF18acbwxcc    23  58423.140255          0.777057              0.970
9   ZTF18acszayr    30  58456.220949          0.767309              0.938
10  ZTF19aaoyjoz    17  58580.254491          0.761249              0.982
11  ZTF19aauoiow   117  58636.423935          0.773761              1.000
12  ZTF19aavjzrz   113  58643.455984          0.794810              1.000
13  ZTF19aawsdlq    39  58636.421644          0.792299              1.000
14  ZTF19aazfvhh    63  58646.469097          0.722329              0.996
15  ZTF19abqxibq    42  58719.397650          0.800936              0.994
16  ZTF19abqysic    42  58716.483102          0.798074              1.000
17  ZTF19abwsecm    26  58725.461806          0.808821              1.000
18  ZTF19abxjimu   155  58732.422708          0.721538              0.998
19  ZTF19abzqwpr    66  58746.390891          0.713936              0.998
20  ZTF19abzsnqm    31  58746.390394          0.788473              0.988
21  ZTF19acbkczc    25  58754.207940          0.911203              0.936
22  ZTF19aczmkbo    19  58836.133241          0.822191              1.000
23  ZTF20aafpojg    23  58863.214120          0.729397              0.964
24  ZTF20abjsyqn    21  59036.374190          0.710259              0.922
25  ZTF20abylbuf    90  59096.384016          0.724529              1.000
26  ZTF20acjbhhp    60  59136.325822          0.703471              1.000
27  ZTF20acoyvdg    23  59157.236493          0.705165              0.996
28  ZTF20acpmgdz    64  59165.336678          0.724588              1.000
29  ZTF20acqzjqz   107  59169.318993          0.752268              1.000]",,42.597280740737915,2025-07-28T21:14:53,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,106,1,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,     o.ndet AS number_of_detections,     o.firstmjd AS first_detection_date,     p_stamp.probability AS prob_stamp_bogus,     p_lc.probability AS prob_lc_transientFROM     object o-- Join for the stamp classifier probabilitiesINNER JOIN     probability p_stamp     ON o.oid = p_stamp.oid    AND p_stamp.classifier_name = 'stamp_classifier'    AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'    AND p_stamp.class_name = 'bogus'    AND p_stamp.probability > 0.7    AND p_stamp.ranking = 1-- Join for the light curve classifier probabilitiesINNER JOIN     probability p_lc     ON o.oid = p_lc.oid    AND p_lc.classifier_name = 'lc_classifier_top'    AND p_lc.class_name = 'transient'    AND p_lc.probability > 0.9    AND p_lc.ranking = 1WHERE     o.ndet > 10 -- Filter for objects with more than 10 detectionsORDER BY     o.oid -- Order by ZTF identifierLIMIT 30 -- Limit the results to at most 30 rows","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,28.21929121017456,2025-07-23T20:14:06,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,9.633801460266113,2025-07-28T21:15:10,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,106,2,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,  -- ZTF identifier    o.ndet AS number_of_detections,  -- Number of detections    o.firstmjd AS first_detection_date,  -- First detection date    p1.probability AS prob_stamp_bogus,  -- Probability in the stamp classifier    p2.probability AS prob_lc_transient  -- Probability in the light curve classifierFROM     object oINNER JOIN     probability p1    ON o.oid = p1.oid    AND p1.class_name = 'bogus'    AND p1.classifier_name = 'stamp_classifier'    AND p1.classifier_version = 'stamp_classifier_1.0.4'    AND p1.probability > 0.7    AND p1.ranking = 1INNER JOIN     probability p2    ON o.oid = p2.oid    AND p2.class_name = 'transient'    AND p2.classifier_name = 'lc_classifier_top'    AND p2.probability > 0.9    AND p2.ranking = 1WHERE     o.ndet > 10  -- More than 10 detectionsORDER BY     o.oid  -- Order by ZTF identifierLIMIT 30  -- Limit to at most 30 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,17.75589919090271,2025-07-23T20:14:24,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.05092716217041,2025-07-28T21:15:26,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,106,3,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsWITH stamp_classifier AS (    SELECT         oid,         probability AS prob_stamp_bogus    FROM         probability    WHERE         class_name = 'bogus'        AND classifier_name = 'stamp_classifier'        AND classifier_version = 'stamp_classifier_1.0.4'        AND probability > 0.7        AND ranking = 1),lc_classifier_top AS (    SELECT         oid,         probability AS prob_lc_transient    FROM         probability    WHERE         class_name = 'transient'        AND classifier_name = 'lc_classifier_top'        AND probability > 0.9        AND ranking = 1)SELECT     o.oid,     o.ndet,     o.firstmjd,     sc.prob_stamp_bogus,     lc.prob_lc_transientFROM     object oINNER JOIN     stamp_classifier sc ON o.oid = sc.oidINNER JOIN     lc_classifier_top lc ON o.oid = lc.oidWHERE     o.ndet > 10ORDER BY     sc.prob_stamp_bogus DESC, -- Order by probability in stamp classifier    o.oidLIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.10590171813965,2025-07-23T20:14:44,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,12.512794494628906,2025-07-28T21:15:45,0.0,0.0,1.0,1.0,0.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,106,4,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,     o.ndet AS number_of_detections,     o.firstmjd AS first_detection_date,     p1.probability AS prob_stamp_bogus,     p2.probability AS prob_lc_transientFROM     object oINNER JOIN     probability p1     ON o.oid = p1.oid    AND p1.class_name = 'bogus'    AND p1.classifier_name = 'stamp_classifier'    AND p1.classifier_version = 'stamp_classifier_1.0.4'    AND p1.probability > 0.7    AND p1.ranking = 1INNER JOIN     probability p2     ON o.oid = p2.oid    AND p2.class_name = 'transient'    AND p2.classifier_name = 'lc_classifier_top'    AND p2.probability > 0.9    AND p2.ranking = 1WHERE     o.ndet > 10ORDER BY     o.oidLIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,16.816241025924683,2025-07-23T20:15:01,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.009861469268799,2025-07-28T21:16:02,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,106,5,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,     o.ndet AS number_of_detections,     o.firstmjd AS first_detection_date,     p1.probability AS prob_stamp_bogus,     p2.probability AS prob_lc_transientFROM     object oINNER JOIN     probability p1     ON o.oid = p1.oidINNER JOIN     probability p2     ON o.oid = p2.oidWHERE     -- Condition for number of detections    o.ndet > 10    -- Conditions for the stamp classifier    AND p1.classifier_name = 'stamp_classifier'    AND p1.classifier_version = 'stamp_classifier_1.0.4'    AND p1.class_name = 'bogus'    AND p1.probability > 0.7    AND p1.ranking = 1    -- Conditions for the light curve classifier    AND p2.classifier_name = 'lc_classifier_top'    AND p2.class_name = 'transient'    AND p2.probability > 0.9    AND p2.ranking = 1ORDER BY     o.oid -- Sorting by ZTF identifierLIMIT 30 -- Limiting the results to at most 30 objects","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.1854350566864,2025-07-23T20:15:23,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,13.592436790466309,2025-07-28T21:16:21,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,106,6,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,  -- ZTF identifier    o.ndet AS number_of_detections,  -- Number of detections    o.firstmjd AS first_detection_date,  -- First detection date    p1.probability AS prob_stamp_bogus,  -- Probability in the stamp classifier    p2.probability AS prob_lc_transient  -- Probability in the light curve classifierFROM     object oINNER JOIN     probability p1 ON o.oid = p1.oid  -- Join for stamp classifier probabilitiesINNER JOIN     probability p2 ON o.oid = p2.oid  -- Join for light curve classifier probabilitiesWHERE     o.ndet > 10  -- Objects with more than 10 detections    AND p1.class_name = 'bogus'  -- Class name for stamp classifier    AND p1.classifier_name = 'stamp_classifier'  -- Classifier name for stamp classifier    AND p1.classifier_version = 'stamp_classifier_1.0.4'  -- Classifier version for stamp classifier    AND p1.probability > 0.7  -- Probability condition for stamp classifier    AND p2.class_name = 'transient'  -- Class name for light curve classifier    AND p2.classifier_name = 'lc_classifier_top'  -- Classifier name for light curve classifier    AND p2.probability > 0.9  -- Probability condition for light curve classifier    AND p1.ranking = 1  -- Most likely probability for stamp classifier    AND p2.ranking = 1  -- Most likely probability for light curve classifierORDER BY     o.oid  -- Order by ZTF identifierLIMIT 30  -- Limit to at most 30 results","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,19.39578890800476,2025-07-23T20:15:42,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,13.875284910202026,2025-07-28T21:16:41,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,106,7,"-- Retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,     o.ndet AS number_of_detections,     o.firstmjd AS first_detection_date,     ps.probability AS prob_stamp_bogus,     pl.probability AS prob_lc_transientFROM     object o-- Join with the probability table for the stamp classifier conditionsINNER JOIN     probability ps    ON o.oid = ps.oid    AND ps.classifier_name = 'stamp_classifier'    AND ps.classifier_version = 'stamp_classifier_1.0.4'    AND ps.class_name = 'bogus'    AND ps.probability > 0.7    AND ps.ranking = 1-- Join with the probability table for the light curve classifier conditionsINNER JOIN     probability pl    ON o.oid = pl.oid    AND pl.classifier_name = 'lc_classifier'    AND pl.class_name = 'transient'    AND pl.probability > 0.9    AND pl.ranking = 1-- Apply the condition for number of detectionsWHERE     o.ndet > 10-- Order by ZTF identifier of objects classified as bogus in the stamp classifierORDER BY     o.oid-- Limit the results to at most 30 objectsLIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.427013635635376,2025-07-23T20:16:06,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,12.213255405426025,2025-07-28T21:16:59,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,106,8,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,     o.ndet AS number_of_detections,     o.firstmjd AS first_detection_date,     p1.probability AS prob_stamp_bogus,     p2.probability AS prob_lc_transientFROM     object oINNER JOIN     probability p1     ON o.oid = p1.oid    AND p1.classifier_name = 'stamp_classifier'    AND p1.classifier_version = 'stamp_classifier_1.0.4'    AND p1.class_name = 'bogus'    AND p1.probability > 0.7    AND p1.ranking = 1INNER JOIN     probability p2     ON o.oid = p2.oid    AND p2.classifier_name = 'lc_classifier_top'    AND p2.class_name = 'transient'    AND p2.probability > 0.9    AND p2.ranking = 1WHERE     o.ndet > 10ORDER BY     o.oidLIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,16.865504503250122,2025-07-23T20:16:23,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,11.435491800308228,2025-07-28T21:17:17,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,106,9,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,     o.ndet AS number_of_detections,     o.firstmjd AS first_detection_date,     p_stamp.probability AS prob_stamp_bogus,     p_lc.probability AS prob_lc_transientFROM     object oINNER JOIN     probability p_stamp     ON o.oid = p_stamp.oidINNER JOIN     probability p_lc     ON o.oid = p_lc.oidWHERE     o.ndet > 10 -- Condition for number of detections    AND p_stamp.classifier_name = 'stamp_classifier'     AND p_stamp.classifier_version = 'stamp_classifier_1.0.4'     AND p_stamp.class_name = 'bogus'     AND p_stamp.probability > 0.7 -- Condition for stamp classifier probability    AND p_stamp.ranking = 1 -- Default condition for probability ranking    AND p_lc.classifier_name = 'lc_classifier'     AND p_lc.class_name = 'transient'     AND p_lc.probability > 0.9 -- Condition for light curve classifier probability    AND p_lc.ranking = 1 -- Default condition for probability rankingORDER BY     p_stamp.probability DESC, -- Order by probability in stamp classifier    o.oid -- Secondary order by ZTF identifierLIMIT 30 -- Limit the results to at most 30 rows","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.81005620956421,2025-07-23T20:16:43,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,12.154868841171265,2025-07-28T21:17:35,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,106,10,"-- Query to retrieve at most 30 ZTF objects satisfying the specified conditionsSELECT     o.oid AS ztf_identifier,     o.ndet AS number_of_detections,     o.firstmjd AS first_detection_date,     p1.probability AS prob_stamp_bogus,     p2.probability AS prob_lc_transientFROM     object oINNER JOIN     probability p1     ON o.oid = p1.oid    AND p1.class_name = 'bogus'    AND p1.classifier_name = 'stamp_classifier'    AND p1.classifier_version = 'stamp_classifier_1.0.4'    AND p1.probability > 0.7    AND p1.ranking = 1INNER JOIN     probability p2     ON o.oid = p2.oid    AND p2.class_name = 'transient'    AND p2.classifier_name = 'lc_classifier_top'    AND p2.probability > 0.9    AND p2.ranking = 1WHERE     o.ndet > 10ORDER BY     o.oidLIMIT 30","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,21.78323745727539,2025-07-23T20:17:05,"[Empty DataFrame
Columns: [ztf_identifier, number_of_detections, first_detection_date, prob_stamp_bogus, prob_lc_transient]
Index: []]",,12.377855062484741,2025-07-28T21:17:54,0.0,0.0,0.4,0.4,0.0,0.0
0.20.2,,,56,0,"SELECT
    oid, ndet, meanra, meandec,
    firstmjd, lastmjd,
    g_r_mean, g_r_mean_corr
FROM
    object
WHERE
    oid IN ('ZTF20abywydb','ZTF20abzpxxu','ZTF20acduffd')
    AND not corrected
ORDER BY firstmjd",,,,,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,4.13477897644043,2025-07-28T21:17:59,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,56,1,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS mean_g_r_difference,    o.g_r_mean_corr AS mean_g_r_corrected_differenceFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.008080959320068,2025-07-23T20:17:09,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  mean_g_r_difference  \
0          59104.424294         59168.290590             0.266079   
1          59116.400822         59150.279444                  NaN   

  mean_g_r_corrected_difference  
0                          None  
1                          None  ]",,12.293303966522217,2025-07-28T21:18:17,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,2,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS mean_g_r_difference,    o.g_r_mean_corr AS mean_g_r_corrected_differenceFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.154188871383667,2025-07-23T20:17:14,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  mean_g_r_difference  \
0          59104.424294         59168.290590             0.266079   
1          59116.400822         59150.279444                  NaN   

  mean_g_r_corrected_difference  
0                          None  
1                          None  ]",,11.325434684753418,2025-07-28T21:18:33,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,3,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS g_r_mean_diff,    o.g_r_mean_corr AS g_r_mean_corr_diffFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,7.210140228271484,2025-07-23T20:17:21,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  g_r_mean_diff g_r_mean_corr_diff  
0          59104.424294         59168.290590       0.266079               None  
1          59116.400822         59150.279444            NaN               None  ]",,11.609994411468506,2025-07-28T21:18:49,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,4,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS g_r_mean_diff,    o.g_r_mean_corr AS g_r_mean_corr_diffFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,4.42706561088562,2025-07-23T20:17:25,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  g_r_mean_diff g_r_mean_corr_diff  
0          59104.424294         59168.290590       0.266079               None  
1          59116.400822         59150.279444            NaN               None  ]",,11.614334106445312,2025-07-28T21:19:05,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,5,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS mean_g_r_difference,    o.g_r_mean_corr AS mean_g_r_corrected_differenceFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.7699434757232666,2025-07-23T20:17:29,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  mean_g_r_difference  \
0          59104.424294         59168.290590             0.266079   
1          59116.400822         59150.279444                  NaN   

  mean_g_r_corrected_difference  
0                          None  
1                          None  ]",,12.45078182220459,2025-07-28T21:19:22,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,6,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS mean_g_r_difference,    o.g_r_mean_corr AS mean_g_r_corrected_differenceFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.876905202865601,2025-07-23T20:17:34,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  mean_g_r_difference  \
0          59104.424294         59168.290590             0.266079   
1          59116.400822         59150.279444                  NaN   

  mean_g_r_corrected_difference  
0                          None  
1                          None  ]",,10.87676453590393,2025-07-28T21:19:38,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,7,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS mean_g_r_difference,    o.g_r_mean_corr AS mean_g_r_corrected_differenceFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,5.084411382675171,2025-07-23T20:17:39,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  mean_g_r_difference  \
0          59104.424294         59168.290590             0.266079   
1          59116.400822         59150.279444                  NaN   

  mean_g_r_corrected_difference  
0                          None  
1                          None  ]",,12.30983281135559,2025-07-28T21:19:55,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,8,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS mean_g_r_difference,    o.g_r_mean_corr AS mean_g_r_corrected_differenceFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.812206268310547,2025-07-23T20:17:43,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  mean_g_r_difference  \
0          59104.424294         59168.290590             0.266079   
1          59116.400822         59150.279444                  NaN   

  mean_g_r_corrected_difference  
0                          None  
1                          None  ]",,11.450072526931763,2025-07-28T21:20:11,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,9,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS mean_g_r_difference,    o.g_r_mean_corr AS mean_g_r_corrected_differenceFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.801647424697876,2025-07-23T20:17:47,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  mean_g_r_difference  \
0          59104.424294         59168.290590             0.266079   
1          59116.400822         59150.279444                  NaN   

  mean_g_r_corrected_difference  
0                          None  
1                          None  ]",,13.252902269363403,2025-07-28T21:20:29,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,56,10,"WITH catalog (oid) AS (    VALUES         ('ZTF20abywydb'),        ('ZTF20abzpxxu'),        ('ZTF20acduffd'))SELECT     o.oid AS ztf_identifier,    o.ndet AS number_of_detections,    o.meanra AS mean_ra,    o.meandec AS mean_dec,    o.firstmjd AS first_detection_date,    o.lastmjd AS last_detection_date,    o.g_r_mean AS mean_g_r_difference,    o.g_r_mean_corr AS mean_g_r_corrected_differenceFROM     object oINNER JOIN     catalog c ON o.oid = c.oidWHERE     o.corrected = FALSEORDER BY     o.firstmjd","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.847097873687744,2025-07-23T20:17:52,"[            oid  number_of_detections    mean_ra   mean_dec  \
0  ZTF20abywydb                    43  39.007019   3.236207   
1  ZTF20acduffd                    16  37.838208  43.464778   

   first_detection_date  last_detection_date  mean_g_r_difference  \
0          59104.424294         59168.290590             0.266079   
1          59116.400822         59150.279444                  NaN   

  mean_g_r_corrected_difference  
0                          None  
1                          None  ]",,12.441108226776123,2025-07-28T21:20:46,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,,,48,0,"SELECT
    oid, name, value, fid, version
FROM
    feature
WHERE
    oid = 'ZTF18abqyaix'
ORDER BY name, fid, version
",,,,,"[              oid             name     value  fid                version
0    ZTF18abqyaix        Amplitude  0.269018    1  lc_classifier_1.2.1-P
1    ZTF18abqyaix        Amplitude  0.599888    2  lc_classifier_1.2.1-P
2    ZTF18abqyaix  AndersonDarling  0.249661    1  lc_classifier_1.2.1-P
3    ZTF18abqyaix  AndersonDarling  0.994609    2  lc_classifier_1.2.1-P
4    ZTF18abqyaix   Autocor_length  5.000000    1  lc_classifier_1.2.1-P
..            ...              ...       ...  ...                    ...
173  ZTF18abqyaix              Std  0.360955    2  lc_classifier_1.2.1-P
174  ZTF18abqyaix         StetsonK  0.869824    1  lc_classifier_1.2.1-P
175  ZTF18abqyaix         StetsonK  0.941219    2  lc_classifier_1.2.1-P
176  ZTF18abqyaix            W1-W2       NaN    0  lc_classifier_1.2.1-P
177  ZTF18abqyaix            W2-W3       NaN    0  lc_classifier_1.2.1-P

[178 rows x 5 columns]]",,4.53106427192688,2025-07-28T21:20:51,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,48,1,"-- Query to retrieve all features for the ZTF object 'ZTF18abqyaix'SELECT     feature.oid AS ""ZTF identifier"",     feature.name AS ""Feature name"",     feature.value AS ""Feature value"",     feature.fid AS ""Filter identifier"",     feature.version AS ""Feature version""FROM     featureWHERE     feature.oid = 'ZTF18abqyaix' -- Filter for the specific ZTF objectORDER BY     feature.oid,     feature.fid,     feature.version -- Sort by ZTF identifier, filter identifier, and feature version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,19.027129411697388,2025-07-23T20:18:11,"[    ZTF identifier    Feature name  Feature value  Filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           Feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,10.206565380096436,2025-07-28T21:21:07,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,2,"-- Retrieve all features for the ZTF object 'ZTF18abqyaix'-- Return the specified columns: ZTF identifier, feature name, feature value, filter identifier, and feature version-- Sort the results by ZTF identifier, filter identifier, and feature versionSELECT     object.oid AS ztf_identifier,  -- ZTF identifier    feature.name AS feature_name, -- Feature name    feature.value AS feature_value, -- Feature value    feature.fid AS filter_identifier, -- Filter identifier    feature.version AS feature_version -- Feature versionFROM     objectINNER JOIN     feature ON object.oid = feature.oid -- Join object and feature tables on oidWHERE     object.oid = 'ZTF18abqyaix' -- Filter for the specific ZTF objectORDER BY     object.oid, -- Sort by ZTF identifier    feature.fid, -- Then by filter identifier    feature.version -- Finally by feature version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,27.05294680595398,2025-07-23T20:18:38,"[              oid    feature_name  feature_value  filter_identifier  \
0    ZTF18abqyaix            g-W3            NaN                  0   
1    ZTF18abqyaix            g-W2            NaN                  0   
2    ZTF18abqyaix           W2-W3            NaN                  0   
3    ZTF18abqyaix           W1-W2            NaN                  0   
4    ZTF18abqyaix        sgscore1       0.003750                  0   
..            ...             ...            ...                ...   
173  ZTF18abqyaix    Power_rate_2       0.145128                 12   
174  ZTF18abqyaix    Power_rate_3       0.146342                 12   
175  ZTF18abqyaix    Power_rate_4       0.090179                 12   
176  ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177  ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature_version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,10.881304264068604,2025-07-28T21:21:22,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,3,"-- Retrieve all features for the ZTF object 'ZTF18abqyaix'SELECT     oid AS ""ZTF identifier"",  -- ZTF object identifier    name AS ""Feature name"",   -- Name of the feature    value AS ""Feature value"", -- Value of the feature    fid AS ""Filter identifier"", -- Filter identifier (e.g., 1 for g-band, 2 for r-band, etc.)    version AS ""Feature version"" -- Feature versionFROM     featureWHERE     oid = 'ZTF18abqyaix' -- Filter for the specific ZTF objectORDER BY     oid,  -- Sort by ZTF identifier    fid,  -- Then by filter identifier    version -- Finally by feature version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,22.623474836349487,2025-07-23T20:19:01,"[    ZTF identifier    Feature name  Feature value  Filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           Feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,10.292070865631104,2025-07-28T21:21:37,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,4,"-- Retrieve all features for the ZTF object 'ZTF18abqyaix'SELECT     oid AS ""ZTF identifier"",     name AS ""Feature name"",     value AS ""Feature value"",     fid AS ""Filter identifier"",     version AS ""Feature version""FROM     featureWHERE     oid = 'ZTF18abqyaix'ORDER BY     oid,     fid,     version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,15.382853984832764,2025-07-23T20:19:17,"[    ZTF identifier    Feature name  Feature value  Filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           Feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.92638874053955,2025-07-28T21:21:52,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,5,"-- Retrieve all features for the ZTF object 'ZTF18abqyaix', sorted by ZTF identifier, filter identifier, and feature versionSELECT     object.oid AS ztf_identifier,  -- ZTF identifier    feature.name AS feature_name, -- Feature name    feature.value AS feature_value, -- Feature value    feature.fid AS filter_identifier, -- Filter identifier    feature.version AS feature_version -- Feature versionFROM     objectINNER JOIN     feature ON object.oid = feature.oid -- Join object and feature tables on oidWHERE     object.oid = 'ZTF18abqyaix' -- Filter for the specific ZTF objectORDER BY     object.oid, -- Sort by ZTF identifier    feature.fid, -- Sort by filter identifier    feature.version -- Sort by feature version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,23.49716663360596,2025-07-23T20:19:40,"[              oid    feature_name  feature_value  filter_identifier  \
0    ZTF18abqyaix            g-W3            NaN                  0   
1    ZTF18abqyaix            g-W2            NaN                  0   
2    ZTF18abqyaix           W2-W3            NaN                  0   
3    ZTF18abqyaix           W1-W2            NaN                  0   
4    ZTF18abqyaix        sgscore1       0.003750                  0   
..            ...             ...            ...                ...   
173  ZTF18abqyaix    Power_rate_2       0.145128                 12   
174  ZTF18abqyaix    Power_rate_3       0.146342                 12   
175  ZTF18abqyaix    Power_rate_4       0.090179                 12   
176  ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177  ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature_version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.9838125705719,2025-07-28T21:22:07,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,6,"-- Query to retrieve all features for the ZTF object 'ZTF18abqyaix'-- Includes ZTF identifier, feature name, feature value, filter identifier, and feature version-- Results are sorted by ZTF identifier, filter identifier, and feature versionSELECT     feature.oid AS ""ZTF identifier"",  -- ZTF object identifier    feature.name AS ""Feature name"",  -- Name of the feature    feature.value AS ""Feature value"",  -- Value of the feature    feature.fid AS ""Filter identifier"",  -- Filter identifier    feature.version AS ""Feature version""  -- Feature versionFROM     featureWHERE     feature.oid = 'ZTF18abqyaix'  -- Filter for the specific ZTF objectORDER BY     feature.oid,  -- Sort by ZTF identifier    feature.fid,  -- Then by filter identifier    feature.version  -- Finally by feature version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,19.03989624977112,2025-07-23T20:19:59,"[    ZTF identifier    Feature name  Feature value  Filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           Feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,10.803955078125,2025-07-28T21:22:23,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,7,"-- Retrieve all features for the ZTF object 'ZTF18abqyaix'-- Return the specified columns: ZTF identifier, feature name, feature value, filter identifier, and feature version-- Sort the results by ZTF identifier, filter identifier, and feature versionSELECT     oid AS ""ZTF identifier"",     name AS ""Feature name"",     value AS ""Feature value"",     fid AS ""Filter identifier"",     version AS ""Feature version""FROM     featureWHERE     oid = 'ZTF18abqyaix'ORDER BY     oid,     fid,     version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,16.199148178100586,2025-07-23T20:20:16,"[    ZTF identifier    Feature name  Feature value  Filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           Feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,10.228441715240479,2025-07-28T21:22:38,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,8,"-- Query to retrieve all features for the ZTF object 'ZTF18abqyaix'SELECT     feature.oid AS ""ZTF identifier"",     feature.name AS ""Feature name"",     feature.value AS ""Feature value"",     feature.fid AS ""Filter identifier"",     feature.version AS ""Feature version""FROM     featureWHERE     feature.oid = 'ZTF18abqyaix'ORDER BY     feature.oid,     feature.fid,     feature.version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,14.85729193687439,2025-07-23T20:20:31,"[    ZTF identifier    Feature name  Feature value  Filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           Feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,9.832106351852417,2025-07-28T21:22:53,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,9,"-- Retrieve all features for the ZTF object 'ZTF18abqyaix'SELECT     object.oid AS ""ZTF identifier"",     feature.name AS ""Feature name"",     feature.value AS ""Feature value"",     feature.fid AS ""Filter identifier"",     feature.version AS ""Feature version""FROM     objectINNER JOIN     feature ON object.oid = feature.oidWHERE     object.oid = 'ZTF18abqyaix'ORDER BY     object.oid,     feature.fid,     feature.version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,16.609687566757202,2025-07-23T20:20:47,"[    ZTF identifier    Feature name  Feature value  Filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           Feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,10.234869241714478,2025-07-28T21:23:08,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,48,10,"-- Retrieve all features for the ZTF object 'ZTF18abqyaix'-- Return the specified columns and sort by ZTF identifier, filter identifier, and feature versionSELECT     feature.oid AS ""ZTF identifier"",  -- ZTF object identifier    feature.name AS ""Feature name"",  -- Name of the feature    feature.value AS ""Feature value"",  -- Value of the feature    feature.fid AS ""Filter identifier"",  -- Filter identifier    feature.version AS ""Feature version""  -- Feature versionFROM     featureWHERE     feature.oid = 'ZTF18abqyaix'  -- Filter for the specific ZTF objectORDER BY     feature.oid,  -- Sort by ZTF identifier    feature.fid,  -- Then by filter identifier    feature.version  -- Finally by feature version","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,18.843568801879883,2025-07-23T20:21:06,"[    ZTF identifier    Feature name  Feature value  Filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           Feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,10.957305669784546,2025-07-28T21:23:23,1.0,1.0,0.0,0.0,1.0,0.0
0.20.2,,,58,0,"SELECT
    *
FROM
    object
WHERE
    ndet >= 30
    AND g_r_max_corr > 3.5
    AND deltajd > 10
LIMIT 20",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,8.81455945968628,2025-07-28T21:23:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,1,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.701324701309204,2025-07-23T20:21:09,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,11.660259485244751,2025-07-28T21:23:49,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,2,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.3431873321533203,2025-07-23T20:21:12,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,10.900612354278564,2025-07-28T21:24:05,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,3,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.476728677749634,2025-07-23T20:21:14,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,10.73927116394043,2025-07-28T21:24:20,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,4,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.801356792449951,2025-07-23T20:21:17,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,10.48276662826538,2025-07-28T21:24:36,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,5,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.622677803039551,2025-07-23T20:21:20,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,10.352354526519775,2025-07-28T21:24:51,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,6,SELECT * FROM objectWHERE ndet >= 30   AND g_r_max_corr > 3.5   AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,5.464680671691895,2025-07-23T20:21:25,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,10.194520235061646,2025-07-28T21:25:06,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,7,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.9882922172546387,2025-07-23T20:21:28,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,10.478856563568115,2025-07-28T21:25:21,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,8,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.4283711910247803,2025-07-23T20:21:31,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,8.977703094482422,2025-07-28T21:25:34,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,9,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.1600887775421143,2025-07-23T20:21:34,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,11.85127067565918,2025-07-28T21:25:50,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,58,10,SELECT * FROM objectWHERE ndet >= 30  AND g_r_max_corr > 3.5  AND deltajd > 20LIMIT 20,"['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.196394681930542,2025-07-23T20:21:37,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
10  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
11  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
12  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
13  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
14  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
15  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
16  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
17  ZTF20acuvief       344       797  58092.250000  59899.250000       True   
18  ZTF22aaajyil       639      1197  58246.439826  59696.420937       True   
19  ZTF18adjueuq       366       760  58218.512488  59708.350949       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
10    False    30  3.383300      3.520334  ...  310.549843  35.871089   
11     True    30  3.475138      3.820012  ...  301.753875  29.373305   
12    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
13    False    30  3.680100      4.137546  ...  290.258009  10.990085   
14    False    30  2.575001      3.506628  ...  282.768116   8.093893   
15    False    30  3.118599      3.936478  ...  301.286563  32.979345   
16    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
17    False    30  3.220251      3.507006  ...   86.453306  -0.210206   
18     True    30  3.235800      3.623149  ...  277.959517  -6.129832   
19     True    30  4.414199      4.344023  ...  307.824393  35.148033   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.000179  0.000103   831.860810  59140.373819  59972.234630   
10  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
11  0.000080  0.000054   801.834838  58616.422049  59418.256887   
12  0.032683  0.030612   422.832072  59904.414514  60327.246586   
13  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
14  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
15  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
16  0.000097  0.000124   383.936829  59139.397928  59523.334757   
17  0.000086  0.000120   632.193252  59267.152049  59899.345301   
18  0.000109  0.000111    74.875255  59621.545683  59696.420937   
19  0.000057  0.000025    85.807083  59622.543866  59708.350949   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9              1.1.6    False            False  
10  correction_1.0.6    False            False  
11  correction_1.0.6    False            False  
12   corr_bulk_0.0.1    False            False  
13            24.5.1    False            False  
14            24.5.1    False            False  
15             1.2.1    False            False  
16  correction_1.0.6    False            False  
17             1.1.6    False            False  
18  correction_1.0.6    False            False  
19  correction_1.0.6    False            False  

[20 rows x 22 columns]]",,10.569982528686523,2025-07-28T21:26:05,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,78,0,"SELECT
    *
FROM
    taxonomy
WHERE
    classifier_name = 'lc_classifier'",,,,,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,3.35526442527771,2025-07-28T21:26:09,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,1,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.455318212509156,2025-07-23T20:21:40,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,8.166426658630371,2025-07-28T21:26:21,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,2,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.0172924995422363,2025-07-23T20:21:43,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.905147552490234,2025-07-28T21:26:33,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,3,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.2752175331115723,2025-07-23T20:21:45,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.670559883117676,2025-07-28T21:26:44,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,4,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.6992104053497314,2025-07-23T20:21:48,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.888084888458252,2025-07-28T21:26:56,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,5,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,1.9033560752868648,2025-07-23T20:21:50,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,8.577146053314209,2025-07-28T21:27:09,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,6,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.652212858200073,2025-07-23T20:21:53,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.5683746337890625,2025-07-28T21:27:20,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,7,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.165491342544556,2025-07-23T20:21:55,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.930840492248535,2025-07-28T21:27:32,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,8,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.405667304992676,2025-07-23T20:21:58,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.532045841217041,2025-07-28T21:27:43,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,9,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.476260185241699,2025-07-23T20:22:00,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.276720762252808,2025-07-28T21:27:55,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,78,10,"SELECT     classifier_name,     classifier_version,     classesFROM     taxonomyWHERE     classifier_name = 'lc_classifier'","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,1.972563982009888,2025-07-23T20:22:02,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.885512828826904,2025-07-28T21:28:06,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,,,39,0,"SELECT
  sq.oid, sq.meanra, sq.meandec,
  detection.candid, detection.fid as f_id,detection.magpsf, detection.sigmapsf_corr, detection.sigmapsf_corr_ext
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier_stochastic'
    AND probability.class_name='CV/Nova'
    AND probability.ranking = 1
) AS sq
  INNER JOIN detection
  ON sq.oid = detection.oid
WHERE
  sq.ndet < 50
  AND detection.fid = 2
ORDER BY oid
LIMIT 1000
",,,,,"[              oid      meanra    meandec               candid  f_id  \
0    ZTF17aaaaanb  324.816860  45.593583   537475640115015008     2   
1    ZTF17aaaaanb  324.816860  45.593583   607270780115015027     2   
2    ZTF17aaaaanb  324.816860  45.593583   613325340115010003     2   
3    ZTF17aaaaanb  324.816860  45.593583   536383390115015014     2   
4    ZTF17aaaaanb  324.816860  45.593583   529390300115015005     2   
..            ...         ...        ...                  ...   ...   
995  ZTF17aaadgdr  116.399044  32.744831   681505042515015130     2   
996  ZTF17aaadgdr  116.399044  32.744831   802157632515025029     2   
997  ZTF17aaadgdr  116.399044  32.744831  2956199252515010007     2   
998  ZTF17aaadgdr  116.399044  32.744831  2898468212515010008     2   
999  ZTF17aaadgdr  116.399044  32.744831  2856464272515010002     2   

        magpsf  sigmapsf_corr  sigmapsf_corr_ext  
0    19.760700       0.021343           0.031418  
1    19.648392       0.026439           0.034795  
2    19.791729       0.025855           0.043814  
3    19.882864       0.022219           0.032339  
4    19.678644     100.000000           0.019559  
..         ...            ...                ...  
995  18.556820     100.000000           0.006979  
996  18.840248     100.000000           0.007158  
997  17.286455       0.004021           0.018319  
998  16.842810       0.010724           0.023377  
999  16.578600       0.026890           0.036021  

[1000 rows x 8 columns]]",,5.471098899841309,2025-07-28T21:28:12,1.0,1.0,1.0,1.0,1.0,1.0
0.20.2,gpt-4o-2024-11-20,v4,39,1,"-- [FINAL QUERY HERE]WITH filtered_probabilities AS (    SELECT         oid    FROM         probability    WHERE         ranking = 1        AND class_name = 'CV/Nova'        AND classifier_name = 'lc_classifier_stochastic'),filtered_objects AS (    SELECT         o.oid,         o.meanra,         o.meandec,         o.ndet    FROM         object o    INNER JOIN         filtered_probabilities fp    ON         o.oid = fp.oid    WHERE         o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.magpsf    FROM         detection d    INNER JOIN         filtered_objects fo    ON         d.oid = fo.oid    WHERE         d.fid = 2),r_band_magstats AS (    SELECT         m.oid,         (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects fo    ON         m.oid = fo.oid    WHERE         m.fid = 2)SELECT     rbd.oid,     rbd.candid,     rbd.fid AS f_id,     fo.meanra AS ra,     fo.meandec AS dec,     rbd.magpsf_corr,     rbd.magpsf,     rbm.max_riseFROM     r_band_detections rbdINNER JOIN     filtered_objects foON     rbd.oid = fo.oidINNER JOIN     r_band_magstats rbmON     rbd.oid = rbm.oidORDER BY     rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,45.71933388710022,2025-07-23T20:22:48,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_probabilities AS (
    -- Filter probabilities for the most likely class 'CV/Nova' using the stochastic light curve classifier
    SELECT 
        oid
    FROM 
        probability
    WHERE 
        ranking = 1
        AND class_name = 'CV/Nova'
        AND classifier_name = 'lc_classifier_stochastic'
),
filtered_objects AS (
    -- Filter objects with at most 50 detections and join with filtered probabilities
    SELECT 
        o.oid, 
        o.meanra, 
        o.meandec, 
        o.ndet
    FROM 
        object o
    INNER JOIN 
        filtered_probabilities fp
    ON 
        o.oid = fp.oid
    WHERE 
        o.ndet <= 50
),
r_band_detections AS (
    -- Select detections in the r-band (fid = 2) and join with filtered objects
    SELECT 
        d.oid, 
        d.candid, 
        d.fid, 
        d.magpsf_corr, 
        d.magpsf
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo
    ON 
        d.oid = fo.oid
    WHERE 
        d.fid = 2
),
r_band_magstats AS (
    -- Calculate the maximum rise in corrected magnitude for the r-band (fid = 2) and join with filtered objects
    SELECT 
        m.oid, 
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects fo
    ON 
        m.oid = fo.oid
    WHERE 
        m.fid = 2
)
-- Final query to combine results and retrieve the required columns
SELECT 
    rbd.oid, 
    rbd.candid, 
    rbd.fid AS f_id, 
    fo.meanra AS ra, 
    fo.meandec AS dec, 
    rbd.magpsf_corr, 
    rbd.magpsf, 
    rbm.max_rise
FROM 
    r_band_detections rbd
INNER JOIN 
    filtered_objects fo
ON 
    rbd.oid = fo.oid
INNER JOIN 
    r_band_magstats rbm
ON 
    rbd.oid = rbm.oid
ORDER BY 
    rbd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",134.17928266525269,2025-07-28T21:30:32,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,2,"-- [FINAL QUERY HERE]WITH classified_objects AS (    SELECT         p.oid    FROM         probability p    WHERE         p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier_stochastic'        AND p.ranking = 1),filtered_objects AS (    SELECT         o.oid,         o.meanra AS ra,         o.meandec AS dec    FROM         object o    INNER JOIN         classified_objects co ON o.oid = co.oid    WHERE         o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.sigmapsf_corr    FROM         detection d    WHERE         d.fid = 2),r_band_magstats AS (    SELECT         m.oid,         (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    WHERE         m.fid = 2)SELECT     fo.oid,     rbd.candid,     rbd.fid,     fo.ra,     fo.dec,     rbd.magpsf_corr,     rbd.sigmapsf_corr,     rbm.max_riseFROM     filtered_objects foINNER JOIN     r_band_detections rbd ON fo.oid = rbd.oidINNER JOIN     r_band_magstats rbm ON fo.oid = rbm.oidORDER BY     fo.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,34.42355036735535,2025-07-23T20:23:23,"[              oid               candid  fid          ra        dec  \
0    ZTF17aaaaanb   537475640115015008    2  324.816860  45.593583   
1    ZTF17aaaaanb   607270780115015027    2  324.816860  45.593583   
2    ZTF17aaaaanb   613325340115010003    2  324.816860  45.593583   
3    ZTF17aaaaanb   536383390115015014    2  324.816860  45.593583   
4    ZTF17aaaaanb   529390300115015005    2  324.816860  45.593583   
..            ...                  ...  ...         ...        ...   
995  ZTF17aaadapx   804166083615010003    2   83.292583   5.590759   
996  ZTF17aaadapx  1060227143615010050    2   83.292583   5.590759   
997  ZTF17aaadapx   708315553615010001    2   83.292583   5.590759   
998  ZTF17aaadapx   754282503615015015    2   83.292583   5.590759   
999  ZTF17aaadapx   701271903615010005    2   83.292583   5.590759   

     magpsf_corr  sigmapsf_corr  max_rise  
0      17.878054       0.021343  0.524338  
1      17.857359       0.026439  0.524338  
2      18.342743       0.025855  0.524338  
3      17.898651       0.022219  0.524338  
4      17.863106     100.000000  0.524338  
..           ...            ...       ...  
995    15.607551     100.000000  0.512533  
996    15.639658     100.000000  0.512533  
997    15.888783     100.000000  0.512533  
998    15.394182     100.000000  0.512533  
999    15.902959     100.000000  0.512533  

[1000 rows x 8 columns]]",,11.128512382507324,2025-07-28T21:30:47,0.939,0.943,0.375,0.375,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,3,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         p.oid    FROM         probability p    INNER JOIN         object o ON p.oid = o.oid    WHERE         p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier_stochastic'        AND p.ranking = 1        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,        d.candid,        d.fid,        d.ra,        d.dec,        d.magpsf_corr,        d.sigmapsf_corr    FROM         detection d    INNER JOIN         filtered_objects fo ON d.oid = fo.oid    WHERE         d.fid = 2 -- r-band filter),r_band_magstats AS (    SELECT         m.oid,        (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects fo ON m.oid = fo.oid    WHERE         m.fid = 2 -- r-band filter)SELECT     rbd.oid,    rbd.candid,    rbd.fid AS f_id,    rbd.ra,    rbd.dec,    rbd.magpsf_corr,    rbd.sigmapsf_corr,    rbm.max_riseFROM     r_band_detections rbdLEFT JOIN     r_band_magstats rbm ON rbd.oid = rbm.oidORDER BY     rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,29.421626806259155,2025-07-23T20:23:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Step 1: Filter objects classified as 'CV/Nova' by the stochastic light curve classifier
    -- with ranking = 1 and number of detections (ndet) <= 50
    SELECT 
        p.oid
    FROM 
        probability p
    INNER JOIN 
        object o ON p.oid = o.oid
    WHERE 
        p.class_name = 'CV/Nova' 
        AND p.classifier_name = 'lc_classifier_stochastic' 
        AND p.ranking = 1 
        AND o.ndet <= 50
),
r_band_detections AS (
    -- Step 2: Get detections in the r-band filter (fid = 2) for the filtered objects
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.ra,
        d.dec,
        d.magpsf_corr,
        d.sigmapsf_corr
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo ON d.oid = fo.oid
    WHERE 
        d.fid = 2 -- r-band filter
),
r_band_magstats AS (
    -- Step 3: Calculate the maximum rise (magmax_corr - magmin_corr) in the r-band filter for the filtered objects
    SELECT 
        m.oid,
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects fo ON m.oid = fo.oid
    WHERE 
        m.fid = 2 -- r-band filter
)
-- Step 4: Combine the r-band detections and r-band magstats, and return the required columns
SELECT 
    rbd.oid,
    rbd.candid,
    rbd.fid AS f_id,
    rbd.ra,
    rbd.dec,
    rbd.magpsf_corr,
    rbd.sigmapsf_corr,
    rbm.max_rise
FROM 
    r_band_detections rbd
LEFT JOIN 
    r_band_magstats rbm ON rbd.oid = rbm.oid
ORDER BY 
    rbd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.55687618255615,2025-07-28T21:33:04,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,4,"-- [FINAL QUERY HERE]WITH classified_objects AS (    -- Step 1: Filter objects classified as 'CV/Nova' with the highest probability    SELECT p.oid    FROM probability p    WHERE p.class_name = 'CV/Nova'      AND p.classifier_name = 'lc_classifier_stochastic'      AND p.ranking = 1),filtered_objects AS (    -- Step 2: Filter objects with ndet <= 50    SELECT o.oid, o.meanra AS ra, o.meandec AS dec    FROM object o    INNER JOIN classified_objects co ON o.oid = co.oid    WHERE o.ndet <= 50),r_band_detections AS (    -- Step 3: Filter detections in the r-band filter (fid = 2)    SELECT d.oid, d.candid, d.fid, d.magpsf_corr, d.sigmapsf_corr    FROM detection d    INNER JOIN filtered_objects fo ON d.oid = fo.oid    WHERE d.fid = 2),magnitude_stats AS (    -- Step 4: Calculate maximum rise in magnitude for the r-band filter    SELECT m.oid, (m.magmax_corr - m.magmin_corr) AS max_rise    FROM magstat m    WHERE m.fid = 2)-- Step 5: Combine results and limit to 1000 rowsSELECT rbd.oid, rbd.candid, rbd.fid AS f_id, fo.ra, fo.dec,        rbd.magpsf_corr, rbd.sigmapsf_corr, ms.max_riseFROM r_band_detections rbdINNER JOIN filtered_objects fo ON rbd.oid = fo.oidINNER JOIN magnitude_stats ms ON rbd.oid = ms.oidORDER BY rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,29.58437752723694,2025-07-23T20:24:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH classified_objects AS (
    -- Step 1: Filter objects classified as 'CV/Nova' with the highest probability
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'CV/Nova'
      AND p.classifier_name = 'lc_classifier_stochastic'
      AND p.ranking = 1
),
filtered_objects AS (
    -- Step 2: Filter objects with ndet <= 50
    SELECT o.oid, o.meanra AS ra, o.meandec AS dec
    FROM object o
    INNER JOIN classified_objects co ON o.oid = co.oid
    WHERE o.ndet <= 50
),
r_band_detections AS (
    -- Step 3: Filter detections in the r-band filter (fid = 2)
    SELECT d.oid, d.candid, d.fid, d.magpsf_corr, d.sigmapsf_corr
    FROM detection d
    INNER JOIN filtered_objects fo ON d.oid = fo.oid
    WHERE d.fid = 2
),
magnitude_stats AS (
    -- Step 4: Calculate maximum rise in magnitude for the r-band filter
    SELECT m.oid, (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM magstat m
    WHERE m.fid = 2
)
-- Step 5: Combine results and limit to 1000 rows
SELECT rbd.oid, rbd.candid, rbd.fid AS f_id, fo.ra, fo.dec,
       rbd.magpsf_corr, rbd.sigmapsf_corr, ms.max_rise
FROM r_band_detections rbd
INNER JOIN filtered_objects fo ON rbd.oid = fo.oid
INNER JOIN magnitude_stats ms ON rbd.oid = ms.oid
ORDER BY rbd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",129.770437002182,2025-07-28T21:35:18,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,5,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         p.oid    FROM         probability p    INNER JOIN         object o ON p.oid = o.oid    WHERE         p.ranking = 1        AND p.classifier_name = 'lc_classifier'        AND p.class_name = 'CV/Nova'        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,        d.candid,        d.fid,        d.ra AS meanra,        d.dec AS meandec,        d.magpsf_corr,        d.magpsf    FROM         detection d    INNER JOIN         filtered_objects fo ON d.oid = fo.oid    WHERE         d.fid = 2 -- r-band filter),r_band_magstats AS (    SELECT         m.oid,        m.fid,        (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects fo ON m.oid = fo.oid    WHERE         m.fid = 2 -- r-band filter)SELECT     rbd.oid,    rbd.candid,    rbd.fid AS f_id,    rbd.meanra,    rbd.meandec,    rbd.magpsf_corr,    rbd.magpsf,    rbm.max_riseFROM     r_band_detections rbdINNER JOIN     r_band_magstats rbm ON rbd.oid = rbm.oid AND rbd.fid = rbm.fidORDER BY     rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,26.56500649452209,2025-07-23T20:24:48,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Filter objects classified as 'CV/Nova' by the 'lc_classifier' with ranking = 1 and ndet <= 50
    SELECT 
        p.oid
    FROM 
        probability p
    INNER JOIN 
        object o ON p.oid = o.oid
    WHERE 
        p.ranking = 1
        AND p.classifier_name = 'lc_classifier'
        AND p.class_name = 'CV/Nova'
        AND o.ndet <= 50
),
r_band_detections AS (
    -- Select detections in the r-band (fid = 2) for the filtered objects
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.ra AS meanra,
        d.dec AS meandec,
        d.magpsf_corr,
        d.magpsf
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo ON d.oid = fo.oid
    WHERE 
        d.fid = 2 -- r-band filter
),
r_band_magstats AS (
    -- Calculate the maximum rise (magmax_corr - magmin_corr) in the r-band (fid = 2) for the filtered objects
    SELECT 
        m.oid,
        m.fid,
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects fo ON m.oid = fo.oid
    WHERE 
        m.fid = 2 -- r-band filter
)
-- Final query to combine detections and magnitude statistics, ordered by object identifier
SELECT 
    rbd.oid,
    rbd.candid,
    rbd.fid AS f_id,
    rbd.meanra,
    rbd.meandec,
    rbd.magpsf_corr,
    rbd.magpsf,
    rbm.max_rise
FROM 
    r_band_detections rbd
INNER JOIN 
    r_band_magstats rbm ON rbd.oid = rbm.oid AND rbd.fid = rbm.fid
ORDER BY 
    rbd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.28021502494812,2025-07-28T21:37:36,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,6,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,        o.ndet    FROM         object o    INNER JOIN         probability p    ON         o.oid = p.oid    WHERE         p.ranking = 1        AND p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier_stochastic'        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,        d.candid,        d.fid,        d.ra,        d.dec,        d.magpsf_corr,        d.sigmapsf_corr    FROM         detection d    INNER JOIN         filtered_objects fo    ON         d.oid = fo.oid    WHERE         d.fid = 2),magnitude_stats AS (    SELECT         oid,        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise    FROM         r_band_detections    GROUP BY         oid)SELECT     rbd.oid,    rbd.candid,    rbd.fid AS f_id,    rbd.ra,    rbd.dec,    rbd.magpsf_corr,    rbd.sigmapsf_corr,    ms.max_riseFROM     r_band_detections rbdINNER JOIN     magnitude_stats msON     rbd.oid = ms.oidORDER BY     rbd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.45722913742065,2025-07-23T20:25:13,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Filter objects with the highest probability class as 'CV/Nova' by the stochastic light curve classifier
    -- and with a number of detections (ndet) of at most 50
    SELECT 
        o.oid,
        o.ndet
    FROM 
        object o
    INNER JOIN 
        probability p
    ON 
        o.oid = p.oid
    WHERE 
        p.ranking = 1 -- Default condition for the most likely probability
        AND p.class_name = 'CV/Nova' -- Filter for 'CV/Nova' class
        AND p.classifier_name = 'lc_classifier_stochastic' -- Use the stochastic light curve classifier
        AND o.ndet <= 50 -- Filter objects with at most 50 detections
),
r_band_detections AS (
    -- Select detections in the r-band filter (fid = 2) for the filtered objects
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.ra,
        d.dec,
        d.magpsf_corr,
        d.sigmapsf_corr
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo
    ON 
        d.oid = fo.oid
    WHERE 
        d.fid = 2 -- Filter for r-band detections (fid = 2)
),
magnitude_stats AS (
    -- Calculate the maximum rise in corrected magnitude (max_rise) for each object
    SELECT 
        oid,
        MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise
    FROM 
        r_band_detections
    GROUP BY 
        oid
)
-- Final query to combine the r-band detections with the calculated max_rise
SELECT 
    rbd.oid,
    rbd.candid,
    rbd.fid AS f_id,
    rbd.ra,
    rbd.dec,
    rbd.magpsf_corr,
    rbd.sigmapsf_corr,
    ms.max_rise
FROM 
    r_band_detections rbd
INNER JOIN 
    magnitude_stats ms
ON 
    rbd.oid = ms.oid
ORDER BY 
    rbd.oid -- Order by object identifier
LIMIT 1000 -- Limit the result to the first 1000 rows
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",134.1619791984558,2025-07-28T21:39:55,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,7,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    -- Step 1: Filter objects classified as 'CV/Nova' with the highest probability    SELECT         p.oid    FROM         probability p    WHERE         p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier_stochastic'        AND p.ranking = 1),filtered_objects_with_detections AS (    -- Step 2: Filter objects with ndet <= 50    SELECT         o.oid    FROM         object o    INNER JOIN         filtered_objects fo ON o.oid = fo.oid    WHERE         o.ndet <= 50),detection_data AS (    -- Step 3: Retrieve detection-level data for r-band filter (fid = 2)    SELECT         d.oid,        d.candid,        d.fid,        d.ra,        d.dec,        d.magpsf_corr,        d.sigmapsf_corr    FROM         detection d    INNER JOIN         filtered_objects_with_detections fod ON d.oid = fod.oid    WHERE         d.fid = 2),magnitude_stats AS (    -- Step 4: Calculate maximum rise from minimum magnitude for r-band filter (fid = 2)    SELECT         m.oid,        (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects_with_detections fod ON m.oid = fod.oid    WHERE         m.fid = 2)-- Step 5: Combine results and limit to 1000 rowsSELECT     dd.oid,    dd.candid,    dd.fid AS f_id,    dd.ra,    dd.dec,    dd.magpsf_corr,    dd.sigmapsf_corr,    ms.max_riseFROM     detection_data ddINNER JOIN     magnitude_stats ms ON dd.oid = ms.oidORDER BY     dd.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.90203070640564,2025-07-23T20:25:44,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Step 1: Filter objects classified as 'CV/Nova' with the highest probability
    SELECT 
        p.oid
    FROM 
        probability p
    WHERE 
        p.class_name = 'CV/Nova' 
        AND p.classifier_name = 'lc_classifier_stochastic' 
        AND p.ranking = 1
),
filtered_objects_with_detections AS (
    -- Step 2: Filter objects with ndet <= 50
    SELECT 
        o.oid
    FROM 
        object o
    INNER JOIN 
        filtered_objects fo ON o.oid = fo.oid
    WHERE 
        o.ndet <= 50
),
detection_data AS (
    -- Step 3: Retrieve detection-level data for r-band filter (fid = 2)
    SELECT 
        d.oid,
        d.candid,
        d.fid,
        d.ra,
        d.dec,
        d.magpsf_corr,
        d.sigmapsf_corr
    FROM 
        detection d
    INNER JOIN 
        filtered_objects_with_detections fod ON d.oid = fod.oid
    WHERE 
        d.fid = 2
),
magnitude_stats AS (
    -- Step 4: Calculate maximum rise from minimum magnitude for r-band filter (fid = 2)
    SELECT 
        m.oid,
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects_with_detections fod ON m.oid = fod.oid
    WHERE 
        m.fid = 2
)
-- Step 5: Combine results and limit to 1000 rows
SELECT 
    dd.oid,
    dd.candid,
    dd.fid AS f_id,
    dd.ra,
    dd.dec,
    dd.magpsf_corr,
    dd.sigmapsf_corr,
    ms.max_rise
FROM 
    detection_data dd
INNER JOIN 
    magnitude_stats ms ON dd.oid = ms.oid
ORDER BY 
    dd.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.8572690486908,2025-07-28T21:42:15,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,8,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,         o.meanra,         o.meandec,         o.ndet    FROM         object o    INNER JOIN         probability p    ON         o.oid = p.oid    WHERE         p.ranking = 1         AND p.classifier_name = 'lc_classifier'         AND p.class_name = 'CV/Nova'        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.magpsf    FROM         detection d    INNER JOIN         filtered_objects fo    ON         d.oid = fo.oid    WHERE         d.fid = 2 -- r-band filter),r_band_magstats AS (    SELECT         m.oid,         m.magmax_corr,         m.magmin_corr,         (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    INNER JOIN         filtered_objects fo    ON         m.oid = fo.oid    WHERE         m.fid = 2 -- r-band filter)SELECT     fo.oid,     rd.candid,     rd.fid AS f_id,     fo.meanra,     fo.meandec,     rd.magpsf_corr,     rd.magpsf,     rms.max_riseFROM     filtered_objects foINNER JOIN     r_band_detections rdON     fo.oid = rd.oidINNER JOIN     r_band_magstats rmsON     fo.oid = rms.oidORDER BY     fo.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,33.55208945274353,2025-07-23T20:26:18,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- [FINAL QUERY HERE]
WITH filtered_objects AS (
    -- Filter objects with the highest probability class as 'CV/Nova' by the 'lc_classifier' and ndet <= 50
    SELECT 
        o.oid, 
        o.meanra, 
        o.meandec, 
        o.ndet
    FROM 
        object o
    INNER JOIN 
        probability p
    ON 
        o.oid = p.oid
    WHERE 
        p.ranking = 1 -- Default condition for the most likely probability
        AND p.classifier_name = 'lc_classifier' -- Default condition for the light curve classifier
        AND p.class_name = 'CV/Nova' -- Filter for the 'CV/Nova' class
        AND o.ndet <= 50 -- Filter for objects with at most 50 detections
),
r_band_detections AS (
    -- Get detections in the r-band filter (fid = 2) for the filtered objects
    SELECT 
        d.oid, 
        d.candid, 
        d.fid, 
        d.magpsf_corr, 
        d.magpsf
    FROM 
        detection d
    INNER JOIN 
        filtered_objects fo
    ON 
        d.oid = fo.oid
    WHERE 
        d.fid = 2 -- r-band filter
),
r_band_magstats AS (
    -- Get corrected magnitude statistics in the r-band filter (fid = 2) for the filtered objects
    SELECT 
        m.oid, 
        m.magmax_corr, 
        m.magmin_corr, 
        (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM 
        magstat m
    INNER JOIN 
        filtered_objects fo
    ON 
        m.oid = fo.oid
    WHERE 
        m.fid = 2 -- r-band filter
)
-- Final query to combine the results and retrieve the required columns
SELECT 
    fo.oid, 
    rd.candid, 
    rd.fid AS f_id, 
    fo.meanra, 
    fo.meandec, 
    rd.magpsf_corr, 
    rd.magpsf, 
    rms.max_rise
FROM 
    filtered_objects fo
INNER JOIN 
    r_band_detections rd
ON 
    fo.oid = rd.oid
INNER JOIN 
    r_band_magstats rms
ON 
    fo.oid = rms.oid
ORDER BY 
    fo.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.40278434753418,2025-07-28T21:44:32,0.0,0.0,0.0,0.0,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,9,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,         o.meanra,         o.meandec,         o.ndet    FROM         object o    INNER JOIN         probability p    ON         o.oid = p.oid    WHERE         p.ranking = 1         AND p.class_name = 'CV/Nova'         AND p.classifier_name = 'lc_classifier_stochastic'        AND o.ndet <= 50),detections_r_band AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.magpsf    FROM         detection d    INNER JOIN         filtered_objects fo    ON         d.oid = fo.oid    WHERE         d.fid = 2 -- r-band filter),magstats_r_band AS (    SELECT         m.oid,         m.magmax_corr,         m.magmin_corr    FROM         magstat m    INNER JOIN         filtered_objects fo    ON         m.oid = fo.oid    WHERE         m.fid = 2 -- r-band filter)SELECT     d.oid,     d.candid,     d.fid AS f_id,     fo.meanra,     fo.meandec,     d.magpsf_corr,     d.magpsf,     (m.magmax_corr - m.magmin_corr) AS max_riseFROM     detections_r_band dINNER JOIN     magstats_r_band mON     d.oid = m.oidINNER JOIN     filtered_objects foON     d.oid = fo.oidORDER BY     d.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,41.020668268203735,2025-07-23T20:26:59,"[              oid               candid  f_id      meanra    meandec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816860  45.593583   
1    ZTF17aaaaanb   607270780115015027     2  324.816860  45.593583   
2    ZTF17aaaaanb   613325340115010003     2  324.816860  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816860  45.593583   
4    ZTF17aaaaanb   529390300115015005     2  324.816860  45.593583   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaadapx   804166083615010003     2   83.292583   5.590759   
996  ZTF17aaadapx  1060227143615010050     2   83.292583   5.590759   
997  ZTF17aaadapx   708315553615010001     2   83.292583   5.590759   
998  ZTF17aaadapx   754282503615015015     2   83.292583   5.590759   
999  ZTF17aaadapx   701271903615010005     2   83.292583   5.590759   

     magpsf_corr     magpsf  max_rise  
0      17.878054  19.760700  0.524338  
1      17.857359  19.648392  0.524338  
2      18.342743  19.791729  0.524338  
3      17.898651  19.882864  0.524338  
4      17.863106  19.678644  0.524338  
..           ...        ...       ...  
995    15.607551  17.850340  0.512533  
996    15.639658  17.625643  0.512533  
997    15.888783  16.732200  0.512533  
998    15.394182  18.216800  0.512533  
999    15.902959  16.702000  0.512533  

[1000 rows x 8 columns]]",,59.71382164955139,2025-07-28T21:45:37,0.939,0.943,0.75,0.75,0.0,0.0
0.20.2,gpt-4o-2024-11-20,v4,39,10,"-- [FINAL QUERY HERE]WITH filtered_objects AS (    SELECT         o.oid,         o.meanra,         o.meandec,         o.ndet    FROM         object o    INNER JOIN         probability p    ON         o.oid = p.oid    WHERE         p.class_name = 'CV/Nova'        AND p.classifier_name = 'lc_classifier'        AND p.ranking = 1        AND o.ndet <= 50),r_band_detections AS (    SELECT         d.oid,         d.candid,         d.fid,         d.magpsf_corr,         d.magpsf    FROM         detection d    WHERE         d.fid = 2 -- r-band filter),r_band_magstats AS (    SELECT         m.oid,         m.magmax_corr,         m.magmin_corr,         (m.magmax_corr - m.magmin_corr) AS max_rise    FROM         magstat m    WHERE         m.fid = 2 -- r-band filter)SELECT     fo.oid,     rd.candid,     rd.fid AS f_id,     fo.meanra,     fo.meandec,     rd.magpsf_corr,     rd.magpsf,     rms.max_riseFROM     filtered_objects foINNER JOIN     r_band_detections rdON     fo.oid = rd.oidINNER JOIN     r_band_magstats rmsON     fo.oid = rms.oidORDER BY     fo.oidLIMIT 1000","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.519238471984863,2025-07-23T20:27:29,"[              oid               candid  f_id     meanra    meandec  \
0    ZTF17aaaagbn  2144326145315010012     2  86.961766  36.581581   
1    ZTF17aaaagbn  2146359715315010004     2  86.961766  36.581581   
2    ZTF17aaaagbn  2148379005315010068     2  86.961766  36.581581   
3    ZTF17aaaagbn  2429471815315010008     2  86.961766  36.581581   
4    ZTF17aaaagbn  2767487322415015006     2  86.961766  36.581581   
..            ...                  ...   ...        ...        ...   
995  ZTF17aabgohw   714475355915010005     2  98.666799  14.032232   
996  ZTF17aabgohw   614472825915010007     2  98.666799  14.032232   
997  ZTF17aabgohw  2786499423115010003     2  98.666799  14.032232   
998  ZTF17aabgohw  2785500173115015010     2  98.666799  14.032232   
999  ZTF17aabgohw  2785500173115015009     2  98.666799  14.032232   

     magpsf_corr     magpsf  max_rise  
0      17.639595  16.610700  0.995937  
1      16.394550  18.551500  0.995937  
2      16.667952  17.504500  0.995937  
3      16.957747  17.059800  0.995937  
4      16.190163  18.536910  0.995937  
..           ...        ...       ...  
995    18.367954  17.497267  0.000000  
996    17.562614  18.235018  0.000000  
997    16.522040  18.626333  0.000000  
998    16.105429  17.746517  0.000000  
999    16.062378  17.563713  0.000000  

[1000 rows x 8 columns]]",,19.523279190063477,2025-07-28T21:46:01,0.109,0.081,0.75,0.75,0.0,0.0
