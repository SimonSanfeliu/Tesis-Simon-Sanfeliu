,code_tag,llm_used,query_id,query_run,sql_query,tab_schema,label,query_gen_time,query_gen_date,query_results,query_error,sql_time,sql_date,r_row,p_row,r_col,p_col,N_perfect_row,N_perfect_col
0,['0.14.14'],[None],[13],[0],"[""\r\nSELECT\r\n    object.oid, probability.class_name, object.lastmjd, object.firstmjd\r\nFROM\r\n    object INNER JOIN\r\n    probability\r\n    ON object.oid = probability.oid\r\nWHERE\r\n    probability.classifier_name='lc_classifier'\r\n    AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\r\n    AND probability.ranking = 1\r\n    AND object.firstmjd < 60217.0\r\n    AND object.firstmjd > 59914.0\r\n""]",[None],[None],[None],[None],"[               oid class_name       lastmjd      firstmjd
0     ZTF23aasfkpz       SNIa  60185.347593  60141.337870
1     ZTF23aamzkrs       SNIa  60124.189074  60097.242882
2     ZTF23aamxbpd       SNIa  60120.218900  60100.190417
3     ZTF23aafwzmi       SNIa  60078.406505  60050.470231
4     ZTF23aackdba       SNII  60073.174653  59992.212407
...            ...        ...           ...           ...
4551  ZTF23aagaoax       SNII  60761.252708  60049.210880
4552  ZTF20aanlftl       SNII  60786.408137  59977.563657
4553  ZTF23aaavavg       SNIa  60770.256586  59967.353044
4554  ZTF23aaefijg       SNII  60786.461586  60036.459398
4555  ZTF23aablruf       SNII  60786.442083  59971.566250

[4556 rows x 4 columns]]",[None],[4.15048623085022],['2025-04-24T02:13:41'],[1],[1],[1],[1],[1],[1]
1,['0.14.14'],['gpt-4o'],[13],[1],"[""\nSELECT \n    probability.class_name, \n    object.firstmjd, \n    object.lastmjd, \n    object.oid\nFROM \n    object\nINNER JOIN \n    probability ON object.oid = probability.oid\nWHERE \n    probability.ranking = 1\n    AND probability.classifier_name = 'lc_classifier'\n    AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')\n    AND object.firstmjd BETWEEN 59946.0 AND 60188.0 -- MJD for December 1, 2022 is 59946.0 and for September 1, 2023 is 60188.0\n""]","[""['\\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\\n    firstmjd DOUBLE PRECISION, /* time of first detection */\\n    lastmjd DOUBLE PRECISION, /* time of last detection */\\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\\n    ncovhist INTEGER,  /* number of visits */\\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\\n    corrected BOOLEAN, /* whether the object was corrected */\\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\\n    ndet INTEGER, /* total number of detections for the object */\\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\\n    meanra DOUBLE PRECISION,  /* mean right ascension */\\n    meandec DOUBLE PRECISION,  /* mean declination */\\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\\n    step_id_corr VARCHAR, /* correction step pipeline version */\\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\\n    reference_change BOOLEAN /* whether the reference image changes */\\n);\\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\\n    class_name VARCHAR, /* name of the class */\\n    classifier_name VARCHAR, /* name of the classifier */\\n    classifier_version VARCHAR, /* version of the classiifer */\\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\\n);\\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\\n']""]",['simple'],[2.9207019805908203],['2025-04-24T01:38:26'],[None],"[ObjectNotExecutableError('Not an executable object: 0    \\nSELECT \\n    probability.class_name, \\n    o...\nName: sql_query, dtype: object')]",[2.949418067932129],['2025-04-24T02:13:44'],[0],[0],[0],[0],[0],[0]
2,['0.14.14'],[None],[10],[0],"[""\r\nSELECT\r\n  sq1.oid, sq1.probability as SN_prob, sq2.probability as CV_prob\r\nFROM\r\n  (\r\nSELECT\r\n    object.oid, probability.probability\r\nFROM\r\n    object INNER JOIN\r\n    probability\r\n    ON object.oid = probability.oid\r\nWHERE\r\n    probability.classifier_name='lc_classifier'\r\n    AND probability.class_name='SNIa'\r\n    AND probability.ranking = 1\r\n) AS sq1\r\n  INNER JOIN (\r\nSELECT\r\n    object.oid, probability.probability\r\nFROM\r\n    object INNER JOIN\r\n    probability\r\n    ON object.oid = probability.oid\r\nWHERE\r\n    probability.classifier_name='lc_classifier'\r\n    AND probability.class_name='CV/Nova'\r\n    AND probability.ranking = 2\r\n) as sq2\r\n  ON sq1.oid = sq2.oid\r\nWHERE\r\n  sq1.probability - sq2.probability < 0.1\r\n""]",[None],[None],[None],[None],"[              oid   sn_prob   cv_prob
0    ZTF18ackboax  0.149968  0.140304
1    ZTF20abwurfg  0.222384  0.187248
2    ZTF22aaiwnyi  0.144396  0.126280
3    ZTF20aajcabp  0.225924  0.132600
4    ZTF20abbgnpu  0.161424  0.132300
..            ...       ...       ...
231  ZTF20abvypkc  0.151312  0.117876
232  ZTF18abacgmg  0.117552  0.117936
233  ZTF22aacuebc  0.195780  0.130192
234  ZTF18abasehb  0.177376  0.129200
235  ZTF18aaaekak  0.211088  0.167620

[236 rows x 3 columns]]",[None],[3.892746925354004],['2025-04-24T02:13:47'],[1],[1],[1],[1],[1],[1]
3,['0.14.14'],['gpt-4o'],[10],[1],"[""\n-- Subquery for 'SNIa' classification with ranking=1\nWITH SNIa_prob AS (\n    SELECT oid, probability AS SN_prob\n    FROM probability\n    WHERE class_name = 'SNIa'\n      AND ranking = 1\n      AND classifier_name = 'lc_classifier'\n),\n\n-- Subquery for 'CV/Nova' classification with ranking=2\nCV_Nova_prob AS (\n    SELECT oid, probability AS CV_prob\n    FROM probability\n    WHERE class_name = 'CV/Nova'\n      AND ranking = 2\n      AND classifier_name = 'lc_classifier'\n)\n\n-- Join the subqueries and filter by probability difference\nSELECT SNIa_prob.oid, SNIa_prob.SN_prob, CV_Nova_prob.CV_prob\nFROM SNIa_prob\nINNER JOIN CV_Nova_prob ON SNIa_prob.oid = CV_Nova_prob.oid\nWHERE ABS(SNIa_prob.SN_prob - CV_Nova_prob.CV_prob) < 0.1\n""]","[""['\\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\\n    firstmjd DOUBLE PRECISION, /* time of first detection */\\n    lastmjd DOUBLE PRECISION, /* time of last detection */\\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\\n    ncovhist INTEGER,  /* number of visits */\\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\\n    corrected BOOLEAN, /* whether the object was corrected */\\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\\n    ndet INTEGER, /* total number of detections for the object */\\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\\n    meanra DOUBLE PRECISION,  /* mean right ascension */\\n    meandec DOUBLE PRECISION,  /* mean declination */\\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\\n    step_id_corr VARCHAR, /* correction step pipeline version */\\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\\n    reference_change BOOLEAN /* whether the reference image changes */\\n);\\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\\n    class_name VARCHAR, /* name of the class */\\n    classifier_name VARCHAR, /* name of the classifier */\\n    classifier_version VARCHAR, /* version of the classiifer */\\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\\n);\\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\\n', '\\nCREATE TABLE taxonomy (\\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\\n);\\n']""]",['advanced'],[12.366127729415894],['2025-04-24T01:38:41'],[None],"[ObjectNotExecutableError(""Not an executable object: 0    \\n-- Subquery for 'SNIa' classification with r...\nName: sql_query, dtype: object"")]",[2.946643114089966],['2025-04-24T02:13:50'],[0],[0],[0],[0],[0],[0]
4,['0.14.14'],[None],[15],[0],"[""\r\nSELECT\r\n    sq.oid, sq.probability, sq.candid, sq.fid, sq.mjd,\r\n    magstat.fid as magstat_fid, magstat.dmdt_first\r\nFROM\r\n  (\r\nSELECT\r\n  detection.oid, detection.candid, detection.fid, detection.mjd,\r\n  obj_oids.probability\r\nFROM\r\n  (\r\nSELECT\r\n    object.oid, probability.probability\r\nFROM\r\n    object INNER JOIN\r\n    probability\r\n    ON object.oid = probability.oid\r\nWHERE\r\n    probability.classifier_name='stamp_classifier'\r\n    AND probability.class_name='SN'\r\n    AND probability.ranking=1\r\n    AND object.firstmjd > 60188.0\r\n    AND object.firstmjd < 60189.0\r\n) as obj_oids\r\n    INNER JOIN\r\n    detection ON detection.oid = obj_oids.oid\r\n) AS sq\r\n  INNER JOIN magstat\r\n  ON sq.oid = magstat.oid\r\nWHERE\r\n  magstat.dmdt_first < -0.25\r\nORDER BY oid\r\n""]",[None],[None],[None],[None],"[             oid  probability               candid  fid           mjd  \
0   ZTF18aaiaclp     0.520409  2434223984915015031    2  60188.223982   
1   ZTF18aakjgzj     0.319556  2434219693515015039    2  60188.219699   
2   ZTF18aaleydm     0.613368  2434217801715015066    2  60188.217801   
3   ZTF18aamxief     0.323881  2434223031815015040    2  60188.223032   
4   ZTF18aanglcr     0.336435  2434215873315015004    2  60188.215880   
5   ZTF18aaouvke     0.282244  2434220161815015099    2  60188.220162   
6   ZTF18aaqsuyn     0.414416  2434215875015015115    2  60188.215880   
7   ZTF18aattenu     0.599858  2434216851815015097    2  60188.216852   
8   ZTF18aaxkcvg     0.492333  2434224440015015034    2  60188.224444   
9   ZTF18abgaubg     0.367991  2434219694115015021    2  60188.219699   
10  ZTF18abglnwb     0.329889  2434216353715015103    2  60188.216354   
11  ZTF18abhwgok     0.365993  2434182950715015047    1  60188.182951   
12  ZTF18ablaynw     0.342683  2434184374315015053    1  60188.184375   
13  ZTF18ableqag     0.379848  2434216850215015033    2  60188.216852   
14  ZTF18acdasef     0.323562  2434185780915015012    1  60188.185787   
15  ZTF18acxanzv     0.381807  2434171450015015078    1  60188.171458   
16  ZTF19aamctar     0.611254  2434170520115015077    1  60188.170521   
17  ZTF19aaqjtmu     0.316548  2434185785515015196    1  60188.185787   
18  ZTF19aaxcivg     0.387324  2434185784315015146    1  60188.185787   
19  ZTF19abvvndq     0.439971  2434172404115015076    1  60188.172407   
20  ZTF19acpkrqy     0.336011  2434171450015015085    1  60188.171458   
21  ZTF20abkqomr     0.584670  2434220160015015096    2  60188.220162   
22  ZTF20abkrdwi     0.378856  2434220632315015080    2  60188.220637   
23  ZTF20achfwjr     0.386997  2434226822515015233    2  60188.226829   
24  ZTF20adimwph     0.373529  2434215400115015120    2  60188.215405   
25  ZTF21abevufp     0.402187  2434183903615015008    1  60188.183901   
26  ZTF22aaqqlbm     0.382260  2434170992215015013    1  60188.170995   
27  ZTF22aatmbdd     0.404035  2434169570815015161    1  60188.169572   
28  ZTF23abasyxe     0.323214  2434170523915015034    1  60188.170521   
29  ZTF23abatcyd     0.278659  2434182954115015147    1  60188.182951   
30  ZTF23abatdoy     0.344793  2434168631015015070    1  60188.168634   
31  ZTF23abatgxx     0.449466  2434191153815015239    2  60188.191157   
32  ZTF23abatlea     0.376271  2434186272115015073    1  60188.186273   
33  ZTF23abatmhd     0.359963  2434185783715015163    1  60188.185787   
34  ZTF23abatokz     0.528303  2434216352615015059    2  60188.216354   
35  ZTF23abatqpu     0.351905  2434216851815015039    2  60188.216852   
36  ZTF23abatqpw     0.702023  2434216851815015088    2  60188.216852   
37  ZTF23abatriq     0.453436  2434219690515015189    2  60188.219699   
38  ZTF23abatwjf     0.262842  2434223983715015179    2  60188.223982   
39  ZTF23abatxuz     0.614179  2434215870415015187    2  60188.215880   
40  ZTF23abaudpp     0.348228  2434226822115015013    2  60188.226829   
41  ZTF23abaudrd     0.735403  2434220160015015156    2  60188.220162   

    magstat_fid  dmdt_first  
0             2   -0.445361  
1             2   -0.341342  
2             2   -0.830610  
3             2   -0.298997  
4             2   -0.713267  
5             2   -0.333054  
6             2   -0.880376  
7             2   -0.651601  
8             2   -0.346522  
9             2   -0.415153  
10            2   -0.443484  
11            1   -0.580608  
12            1   -0.970855  
13            2   -0.522742  
14            1   -0.901711  
15            1   -0.696760  
16            1   -0.363331  
17            1   -0.542452  
18            1   -0.414204  
19            1   -0.426276  
20            1   -0.363061  
21            2   -0.253318  
22            2   -0.471683  
23            2   -0.389240  
24            2   -0.539711  
25            1   -1.214308  
26            1   -0.456345  
27            1   -0.795624  
28            1   -0.389963  
29            1   -0.554422  
30            1   -0.672678  
31            2   -0.514062  
32            1   -0.330905  
33            1   -0.894516  
34            2   -0.714582  
35            2   -0.452335  
36            2   -0.469563  
37            2   -0.268780  
38            2   -0.348651  
39            2   -0.719351  
40            2   -0.973436  
41            2   -0.334129  ]",[None],[3.899892568588257],['2025-04-24T02:13:54'],[1],[1],[1],[1],[1],[1]
5,['0.14.14'],['gpt-4o'],[15],[1],"[""\nWITH highest_prob_sn AS (\n    SELECT oid\n    FROM probability\n    WHERE class_name = 'SN'\n      AND classifier_name = 'stamp_classifier'\n      AND ranking = 1\n),\nfirst_detection_september AS (\n    SELECT oid\n    FROM object\n    WHERE firstmjd BETWEEN 60154 AND 60155  -- MJD for the first 2 days of September 2023\n),\nfast_risers AS (\n    SELECT oid\n    FROM magstat\n    WHERE dmdt_first IS NOT NULL  -- Assuming a non-null dmdt_first indicates a fast riser\n),\nqualified_objects AS (\n    SELECT oid\n    FROM highest_prob_sn\n    INTERSECT\n    SELECT oid\n    FROM first_detection_september\n    INTERSECT\n    SELECT oid\n    FROM fast_risers\n)\nSELECT o.oid, p.probability, d.candid, d.fid, m.fid AS magstat_fid, m.dmdt_first\nFROM qualified_objects qo\nJOIN object o ON qo.oid = o.oid\nJOIN probability p ON o.oid = p.oid\nJOIN detection d ON o.oid = d.oid\nJOIN magstat m ON o.oid = m.oid\nWHERE p.class_name = 'SN'\n  AND p.classifier_name = 'stamp_classifier'\n  AND p.ranking = 1\nORDER BY o.oid\n""]","[""['\\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\\n    firstmjd DOUBLE PRECISION, /* time of first detection */\\n    lastmjd DOUBLE PRECISION, /* time of last detection */\\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\\n    ncovhist INTEGER,  /* number of visits */\\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\\n    corrected BOOLEAN, /* whether the object was corrected */\\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\\n    ndet INTEGER, /* total number of detections for the object */\\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\\n    meanra DOUBLE PRECISION,  /* mean right ascension */\\n    meandec DOUBLE PRECISION,  /* mean declination */\\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\\n    step_id_corr VARCHAR, /* correction step pipeline version */\\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\\n    reference_change BOOLEAN /* whether the reference image changes */\\n);\\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\\n    class_name VARCHAR, /* name of the class */\\n    classifier_name VARCHAR, /* name of the classifier */\\n    classifier_version VARCHAR, /* version of the classiifer */\\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\\n);\\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\\n    pid FLOAT NOT NULL, /* program identifier */\\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\\n    nid INTEGER, /* unique night identifier */\\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\\n);\\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\\n);\\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\\n']""]",['advanced'],[15.910300493240356],['2025-04-24T01:39:10'],[None],"[ObjectNotExecutableError('Not an executable object: 0    \\nWITH highest_prob_sn AS (\\n    SELECT oid\\n ...\nName: sql_query, dtype: object')]",[2.956136703491211],['2025-04-24T02:13:57'],[0],[0],[0],[0],[0],[0]
