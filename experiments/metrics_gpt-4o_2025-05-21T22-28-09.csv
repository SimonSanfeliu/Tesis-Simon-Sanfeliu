code_tag,llm_used,prompt_version,query_id,query_run,sql_query,tab_schema,label,query_gen_time,query_gen_date,query_results,query_error,sql_time,sql_date,r_row,p_row,r_col,p_col,N_perfect_row,N_perfect_col
0.16.3,,,8,0,"
SELECT
    *
FROM
    object
INNER JOIN
    probability
ON
    object.oid = probability.oid
WHERE
    object.firstMJD > 60173.0
    and object.firstMJD < 60177.0
    AND probability.class_name='SN'
    AND probability.classifier_name='stamp_classifier'
    AND probability.ranking=1
    AND (probability.probability>0.5
    OR object.ndet>1)
",,,,,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF21abvqbxd        35      4229  58290.250000  60173.250000      False   
1    ZTF23aaygkbn         1       805  60173.250000  60173.250000       True   
2    ZTF23aaygleo         1       801  60173.250000  60173.250000       True   
3    ZTF19abvashq        62      4100  58284.277732  60532.194178      False   
4    ZTF18aaoihga        40      3828  58231.500000  60173.250000      False   
..            ...       ...       ...           ...           ...        ...   
179  ZTF23aazhlya         8      2799  60175.250000  60194.250000       True   
180  ZTF23aazhofz         2      1852  59788.250000  60175.250000       True   
181  ZTF20abkrbep        18      5024  58230.283079  60465.343935       True   
182  ZTF23aazvaet         2      1895  60175.250000  60182.250000       True   
183  ZTF18aanykdg        16      3532  58230.500000  60175.250000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60173.176100  60173.176100   
1      False     1       NaN           NaN  ...  60173.169005  60173.169005   
2      False     1       NaN           NaN  ...  60173.169005  60173.169005   
3      False     6       NaN           NaN  ...  60173.180822  60532.194178   
4      False     1       NaN           NaN  ...  60173.178461  60173.178461   
..       ...   ...       ...           ...  ...           ...           ...   
179    False     8 -0.032068      0.637914  ...  60175.184363  60194.201111   
180    False     1       NaN           NaN  ...  60175.181007  60175.181007   
181     True     2       NaN           NaN  ...  60175.185301  60465.343935   
182     True     2       NaN           NaN  ...  60175.192697  60182.239526   
183    False     1       NaN           NaN  ...  60175.194340  60175.194340   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
179         1.2.0     True             False  stamp_classifier   
180         1.2.0     True             False  stamp_classifier   
181        24.5.1     True             False  stamp_classifier   
182         1.2.0     True             False  stamp_classifier   
183         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.526146       1  
1    stamp_classifier_1.0.4          SN     0.639198       1  
2    stamp_classifier_1.0.4          SN     0.514766       1  
3    stamp_classifier_1.0.4          SN     0.306560       1  
4    stamp_classifier_1.0.4          SN     0.657241       1  
..                      ...         ...          ...     ...  
179  stamp_classifier_1.0.4          SN     0.698527       1  
180  stamp_classifier_1.0.4          SN     0.622088       1  
181  stamp_classifier_1.0.4          SN     0.317975       1  
182  stamp_classifier_1.0.4          SN     0.631699       1  
183  stamp_classifier_1.0.4          SN     0.569558       1  

[184 rows x 27 columns]]",,21.44612836837769,2025-05-20T09:53:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,8,1,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SN' 
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.probability > 0.5
  AND object.firstmjd BETWEEN 59440 AND 59444  -- Julian dates for August 17 to August 21, 2021
  AND (object.ndet >= 2 OR probability.probability > 0.5)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.512856245040894,2025-04-28T23:34:39,"[              oid   classifier_name      classifier_version class_name  \
0    ZTF23aaugtqx  stamp_classifier  stamp_classifier_1.0.4         SN   
1    ZTF23aauvxgu  stamp_classifier  stamp_classifier_1.0.4         SN   
2    ZTF23aauhblv  stamp_classifier  stamp_classifier_1.0.4         SN   
3    ZTF23aawdbyu  stamp_classifier  stamp_classifier_1.0.4         SN   
4    ZTF18adrwflu  stamp_classifier  stamp_classifier_1.0.4         SN   
..            ...               ...                     ...        ...   
340  ZTF23aavnqsz  stamp_classifier  stamp_classifier_1.0.4         SN   
341  ZTF23aavevjd  stamp_classifier  stamp_classifier_1.0.4         SN   
342  ZTF18adfwlgu  stamp_classifier  stamp_classifier_1.0.4         SN   
343  ZTF23aavfdux  stamp_classifier  stamp_classifier_1.0.4         SN   
344  ZTF23aavffkq  stamp_classifier  stamp_classifier_1.0.4         SN   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.639903        1        13      1393  60150.250000  60179.250000   
1       0.412764        1         7      1787  58691.250000  60152.250000   
2       0.410632        1         7      1631  58694.288958  60553.257732   
3       0.480507        1         5      1374  60150.250000  60162.250000   
4       0.388430        1      1090      2551  58218.508056  60634.133056   
..           ...      ...       ...       ...           ...           ...   
340     0.511295        1        11      1044  60153.500000  60161.500000   
341     0.521393        1         1      1332  60153.500000  60153.500000   
342     0.362726        1         6      1380  58095.283970  60760.241343   
343     0.540236        1         1       864  60153.500000  60153.500000   
344     0.672242        1        11      1058  60153.500000  60162.500000   

     ...      meanra    meandec   sigmara  sigmadec     deltajd      firstmjd  \
0    ...  224.848497   3.801643  0.000062  0.000044   28.984062  60150.192847   
1    ...  286.177984   1.849842  0.000006  0.000025    2.045741  60150.202280   
2    ...  293.893110   3.313766  0.085142  0.085000  403.054514  60150.203218   
3    ...  226.822263   2.179942  0.000092  0.000046   12.013160  60150.214896   
4    ...  293.664336  12.923707  0.020408  0.019891  483.930312  60150.202743   
..   ...         ...        ...       ...       ...         ...           ...   
340  ...   79.087142  17.145319  0.000063  0.000037    7.996516  60153.488264   
341  ...   71.428212  20.147191       NaN       NaN    0.000000  60153.473704   
342  ...   80.681997  19.866585  0.054901  0.051633  606.753079  60153.488264   
343  ...   82.236441  20.694914       NaN       NaN    0.000000  60153.490694   
344  ...   80.906242  19.240411  0.000031  0.000044    8.986331  60153.495544   

          lastmjd  step_id_corr  diffpos  reference_change  
0    60179.176910         1.2.0     True             False  
1    60152.248021         1.2.0     True             False  
2    60553.257732      24.5.2a6     True             False  
3    60162.228056         1.2.0     True             False  
4    60634.133056      24.5.2a6     True             False  
..            ...           ...      ...               ...  
340  60161.484780         1.2.0     True             False  
341  60153.473704         1.2.0     True             False  
342  60760.241343        27.5.2     True             False  
343  60153.490694         1.2.0     True             False  
344  60162.481875         1.2.0     True             False  

[345 rows x 27 columns]]",,29.44029951095581,2025-05-20T09:54:10,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,2,"
SELECT * 
FROM object 
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND object.firstmjd BETWEEN 60000 AND 60004  -- Replace with actual Julian dates for August 17 to August 21, 2023
  AND (probability.probability > 0.5 OR object.ndet >= 2)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.834654569625854,2025-04-28T23:34:50,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aavvqcc         1       874  60160.250000  60160.250000      False   
1    ZTF23aavtrsk       184      4331  60156.250000  60255.250000      False   
2    ZTF23aavtqzj       131      4206  60159.250000  60207.250000      False   
3    ZTF23aavwqoh        21      3248  58400.250000  60181.250000       True   
4    ZTF23aauzuzv        10      1596  60153.250000  60171.250000      False   
..            ...       ...       ...           ...           ...        ...   
210  ZTF23aawlome         1      1178  60163.500000  60163.500000      False   
211  ZTF23aawlnby         3      1021  60163.500000  60173.500000       True   
212  ZTF23aaynliq        17       900  60163.500000  60200.500000      False   
213  ZTF23aaxbgho         6       857  60163.500000  60173.500000       True   
214  ZTF23aaxaszo       342      2943  59084.465058  60735.137535       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60160.177465  60160.177465   
1      False    42  0.231931      0.243656  ...  60160.187014  60255.137280   
2      False    26 -0.009924           NaN  ...  60160.187488  60207.160185   
3      False    18  0.178982      0.750361  ...  60160.262651  60181.221319   
4      False     7  0.154513           NaN  ...  60160.182095  60171.226724   
..       ...   ...       ...           ...  ...           ...           ...   
210    False     1       NaN           NaN  ...  60163.448472  60163.448472   
211    False     3       NaN           NaN  ...  60163.459734  60173.463495   
212    False    11  0.068636           NaN  ...  60163.459734  60200.378287   
213    False     6 -0.008692      0.229774  ...  60163.460208  60173.442025   
214    False   221       NaN           NaN  ...  60163.461296  60735.137535   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.1     True             False  stamp_classifier   
2           1.2.1     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
210         1.2.0     True             False  stamp_classifier   
211         1.2.0     True             False  stamp_classifier   
212         1.2.1     True             False  stamp_classifier   
213         1.2.0     True             False  stamp_classifier   
214        27.4.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.568443       1  
1    stamp_classifier_1.0.4          SN     0.890891       1  
2    stamp_classifier_1.0.4          SN     0.668517       1  
3    stamp_classifier_1.0.4          SN     0.701830       1  
4    stamp_classifier_1.0.4          SN     0.830135       1  
..                      ...         ...          ...     ...  
210  stamp_classifier_1.0.4          SN     0.709408       1  
211  stamp_classifier_1.0.4          SN     0.500361       1  
212  stamp_classifier_1.0.4          SN     0.746097       1  
213  stamp_classifier_1.0.4          SN     0.762870       1  
214  stamp_classifier_1.0.4          SN     0.497768       1  

[215 rows x 27 columns]]",,13.154714107513428,2025-05-20T09:54:23,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,3,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SN' 
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.probability > 0.5
  AND object.firstmjd BETWEEN 59434 AND 59438  -- Corresponding to August 17, 2023, and August 21, 2023
  OR object.ndet >= 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.07533359527588,2025-04-28T23:35:00,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
      AND classifier_name = 'stamp_classifier' 
      AND ranking = 1 
      AND probability > 0.5
) AS prob
INNER JOIN (
    SELECT oid 
    FROM object 
    WHERE firstmjd BETWEEN 59434 AND 59438 
       OR ndet >= 2
) AS obj ON prob.oid = obj.oid
INNER JOIN object ON obj.oid = object.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.4696819782257,2025-05-20T10:04:33,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,8,4,"
SELECT * 
FROM object 
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND (probability.probability > 0.5 OR object.ndet >= 2)
  AND object.firstmjd BETWEEN 59434 AND 59438  -- Julian dates for August 17, 2023, to August 21, 2023
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.491053342819214,2025-04-28T23:35:11,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
3    ZTF18adrwflu      1090      2551  58218.508056  60634.133056       True   
4    ZTF18abhccag         3      2568  58315.250000  60233.250000      False   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   
344  ZTF23aavffkq        11      1058  60153.500000  60162.500000      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13 -0.039900       0.69668  ...  60150.192847  60179.176910   
1      False     2       NaN           NaN  ...  60150.202280  60152.248021   
2      False     2       NaN           NaN  ...  60150.203218  60553.257732   
3       True   140       NaN           NaN  ...  60150.202743  60634.133056   
4      False     2  1.778375           NaN  ...  60150.227512  60233.127049   
..       ...   ...       ...           ...  ...           ...           ...   
340    False    21       NaN           NaN  ...  60153.466181  60223.450579   
341    False    10       NaN           NaN  ...  60153.488264  60161.484780   
342    False     2       NaN           NaN  ...  60153.488264  60760.241343   
343    False     1       NaN           NaN  ...  60153.490694  60153.490694   
344    False    11       NaN           NaN  ...  60153.495544  60162.481875   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2        24.5.2a6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.1     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.410632       1  
3    stamp_classifier_1.0.4          SN     0.388430       1  
4    stamp_classifier_1.0.4          SN     0.332478       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.511295       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.540236       1  
344  stamp_classifier_1.0.4          SN     0.672242       1  

[345 rows x 27 columns]]",,17.037501573562622,2025-05-20T10:04:55,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,5,"
SELECT * 
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND object.firstmjd BETWEEN 59800 AND 59804  -- Julian dates for August 17 to August 21, 2023
  AND (probability.probability > 0.5 OR object.ndet >= 2)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.03310203552246,2025-04-28T23:35:21,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aavvqcc         1       874  60160.250000  60160.250000      False   
1    ZTF23aavtrsk       184      4331  60156.250000  60255.250000      False   
2    ZTF23aavtqzj       131      4206  60159.250000  60207.250000      False   
3    ZTF23aayjunj        11      1802  60160.260278  60609.143102       True   
4    ZTF23aavwqoh        21      3248  58400.250000  60181.250000       True   
..            ...       ...       ...           ...           ...        ...   
210  ZTF23aaxauuk        50      1563  60163.500000  60234.250000       True   
211  ZTF23aawkxxn         1      1166  60163.500000  60163.500000       True   
212  ZTF19adffepx        30      1240  58763.250000  60252.250000      False   
213  ZTF23aaxtmfu         5      1793  60163.500000  60170.500000       True   
214  ZTF23abaifly       122      2113  58749.298981  60533.368067       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False     1       NaN           NaN  ...  60160.177465  60160.177465   
1      False    42  0.231931      0.243656  ...  60160.187014  60255.137280   
2      False    26 -0.009924           NaN  ...  60160.187488  60207.160185   
3      False    10       NaN           NaN  ...  60160.260278  60609.143102   
4      False    18  0.178982      0.750361  ...  60160.262651  60181.221319   
..       ...   ...       ...           ...  ...           ...           ...   
210    False    30 -0.181240     -0.083966  ...  60163.418843  60234.294155   
211    False     1       NaN           NaN  ...  60163.425799  60163.425799   
212    False    16  1.007700           NaN  ...  60163.425799  60252.286806   
213    False     5  0.052500      0.274559  ...  60163.434838  60170.421562   
214    False    63 -0.095500     -0.017114  ...  60163.435787  60533.368067   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.1     True             False  stamp_classifier   
2           1.2.1     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
210         1.2.1     True             False  stamp_classifier   
211         1.2.0     True             False  stamp_classifier   
212         1.2.1     True             False  stamp_classifier   
213         1.2.0     True             False  stamp_classifier   
214      24.5.2a6     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.568443       1  
1    stamp_classifier_1.0.4          SN     0.890891       1  
2    stamp_classifier_1.0.4          SN     0.668517       1  
3    stamp_classifier_1.0.4          SN     0.351652       1  
4    stamp_classifier_1.0.4          SN     0.701830       1  
..                      ...         ...          ...     ...  
210  stamp_classifier_1.0.4          SN     0.512269       1  
211  stamp_classifier_1.0.4          SN     0.510492       1  
212  stamp_classifier_1.0.4          SN     0.812095       1  
213  stamp_classifier_1.0.4          SN     0.676709       1  
214  stamp_classifier_1.0.4          SN     0.690404       1  

[215 rows x 27 columns]]",,20.03476500511169,2025-05-20T10:05:19,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,6,"
SELECT * 
FROM object 
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND object.firstmjd BETWEEN 60000 + 17 AND 60000 + 21  -- Adjusted for Modified Julian Date
  AND (probability.probability > 0.5 OR object.ndet >= 2)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,9.806586265563965,2025-04-28T23:35:31,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF19aaqyrjv        25      9636  58476.532083  60759.500081       True   
1    ZTF23aazjwck        16      1746  60178.250000  60203.250000       True   
2    ZTF23aazjohh         7      2788  60178.250000  60186.250000      False   
3    ZTF23aazjoiz         6      2853  60178.250000  60186.250000      False   
4    ZTF18acilsts         6      3174  58435.083391  60632.119224       True   
..            ...       ...       ...           ...           ...        ...   
219  ZTF23aazugwe        12      2191  60181.500000  60212.500000       True   
220  ZTF23abamsmu        11      1910  60181.500000  60200.500000       True   
221  ZTF23aazudtr       282      1424  58437.417708  60739.112986       True   
222  ZTF23abcxsbr         4      1666  58814.250000  60200.500000      False   
223  ZTF23aazzgxk        10      2317  60181.500000  60194.500000       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0       True     3       NaN           NaN  ...  60178.206181  60759.500081   
1      False    16  0.050074      0.615963  ...  60178.251921  60203.269155   
2      False     6 -0.009882           NaN  ...  60178.207581  60186.228345   
3      False     3  0.258396           NaN  ...  60178.208588  60186.243935   
4       True     2       NaN           NaN  ...  60178.208588  60632.119224   
..       ...   ...       ...           ...  ...           ...           ...   
219    False    12  0.867681      1.012818  ...  60181.490069  60212.453982   
220    False    11  0.556196      0.667280  ...  60181.483588  60200.497442   
221    False   170       NaN           NaN  ...  60181.483588  60739.112986   
222    False     2       NaN           NaN  ...  60181.486123  60200.470440   
223    False    10 -0.003635      0.101698  ...  60181.490069  60194.488461   

     step_id_corr  diffpos  reference_change   classifier_name  \
0          27.5.0     True             False  stamp_classifier   
1           1.2.1     True             False  stamp_classifier   
2           1.2.0     True             False  stamp_classifier   
3           1.2.0     True             False  stamp_classifier   
4        24.5.2a6     True             False  stamp_classifier   
..            ...      ...               ...               ...   
219         1.2.1     True             False  stamp_classifier   
220         1.2.1     True             False  stamp_classifier   
221        27.4.0     True             False  stamp_classifier   
222         1.2.1     True             False  stamp_classifier   
223         1.2.1     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.531398       1  
1    stamp_classifier_1.0.4          SN     0.821255       1  
2    stamp_classifier_1.0.4          SN     0.407398       1  
3    stamp_classifier_1.0.4          SN     0.792339       1  
4    stamp_classifier_1.0.4          SN     0.312209       1  
..                      ...         ...          ...     ...  
219  stamp_classifier_1.0.4          SN     0.659402       1  
220  stamp_classifier_1.0.4          SN     0.490252       1  
221  stamp_classifier_1.0.4          SN     0.544171       1  
222  stamp_classifier_1.0.4          SN     0.374474       1  
223  stamp_classifier_1.0.4          SN     0.610367       1  

[224 rows x 27 columns]]",,32.14444398880005,2025-05-20T10:05:56,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,7,"
SELECT * 
FROM object 
WHERE oid IN (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
    AND classifier_name = 'stamp_classifier' 
    AND probability > 0.5
) 
AND (firstmjd BETWEEN 59436 AND 59440)  -- August 17, 2023 to August 21, 2023 in MJD
AND (ndet >= 2 OR oid IN (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
    AND classifier_name = 'stamp_classifier' 
    AND probability > 0.5
))
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,23.180312871932983,2025-04-28T23:35:54,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM object 
WHERE oid IN (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
    AND classifier_name = 'stamp_classifier' 
    AND probability > 0.5 
    AND ranking = 1
) 
AND (firstmjd BETWEEN 59436 AND 59440)  -- August 17, 2023 to August 21, 2023 in MJD
AND (ndet >= 2 OR oid IN (
    SELECT oid 
    FROM probability 
    WHERE class_name = 'SN' 
    AND classifier_name = 'stamp_classifier' 
    AND probability > 0.5 
    AND ranking = 1
))
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.57287669181824,2025-05-20T10:10:12,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,8,8,"
SELECT * 
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.ranking = 1
  AND object.firstmjd BETWEEN 59440 AND 59444  -- August 17, 2023 to August 21, 2023 in MJD
  AND (probability.probability > 0.5 OR object.ndet >= 2)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,10.813979148864746,2025-04-28T23:36:05,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF23aaugtqx        13      1393  60150.250000  60179.250000       True   
1    ZTF23aauvxgu         7      1787  58691.250000  60152.250000       True   
2    ZTF18adrwflu      1090      2551  58218.508056  60634.133056       True   
3    ZTF23aauhblv         7      1631  58694.288958  60553.257732      False   
4    ZTF23aawdbyu         5      1374  60150.250000  60162.250000       True   
..            ...       ...       ...           ...           ...        ...   
340  ZTF23aaqeuck        42      1666  60125.500000  60223.500000       True   
341  ZTF23aavevjd         1      1332  60153.500000  60153.500000      False   
342  ZTF18adfwlgu         6      1380  58095.283970  60760.241343       True   
343  ZTF23aavnqsz        11      1044  60153.500000  60161.500000       True   
344  ZTF23aavfdux         1       864  60153.500000  60153.500000       True   

     stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    13  -0.0399      0.696680  ...  60150.192847  60179.176910   
1      False     2      NaN           NaN  ...  60150.202280  60152.248021   
2       True   140      NaN           NaN  ...  60150.202743  60634.133056   
3      False     2      NaN           NaN  ...  60150.203218  60553.257732   
4      False     4   0.1346      0.192719  ...  60150.214896  60162.228056   
..       ...   ...      ...           ...  ...           ...           ...   
340    False    21      NaN           NaN  ...  60153.466181  60223.450579   
341    False     1      NaN           NaN  ...  60153.473704  60153.473704   
342    False     2      NaN           NaN  ...  60153.488264  60760.241343   
343    False    10      NaN           NaN  ...  60153.488264  60161.484780   
344    False     1      NaN           NaN  ...  60153.490694  60153.490694   

     step_id_corr  diffpos  reference_change   classifier_name  \
0           1.2.0     True             False  stamp_classifier   
1           1.2.0     True             False  stamp_classifier   
2        24.5.2a6     True             False  stamp_classifier   
3        24.5.2a6     True             False  stamp_classifier   
4           1.2.0     True             False  stamp_classifier   
..            ...      ...               ...               ...   
340         1.2.1     True             False  stamp_classifier   
341         1.2.0     True             False  stamp_classifier   
342        27.5.2     True             False  stamp_classifier   
343         1.2.0     True             False  stamp_classifier   
344         1.2.0     True             False  stamp_classifier   

         classifier_version  class_name  probability ranking  
0    stamp_classifier_1.0.4          SN     0.639903       1  
1    stamp_classifier_1.0.4          SN     0.412764       1  
2    stamp_classifier_1.0.4          SN     0.388430       1  
3    stamp_classifier_1.0.4          SN     0.410632       1  
4    stamp_classifier_1.0.4          SN     0.480507       1  
..                      ...         ...          ...     ...  
340  stamp_classifier_1.0.4          SN     0.798089       1  
341  stamp_classifier_1.0.4          SN     0.521393       1  
342  stamp_classifier_1.0.4          SN     0.362726       1  
343  stamp_classifier_1.0.4          SN     0.511295       1  
344  stamp_classifier_1.0.4          SN     0.540236       1  

[345 rows x 27 columns]]",,26.688146352767944,2025-05-20T10:10:43,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,9,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SN' 
  AND probability.classifier_name = 'stamp_classifier'
  AND (probability.probability > 0.5 OR object.ndet >= 2)
  AND object.firstmjd BETWEEN 60000 AND 60004 -- Replace 60000 and 60004 with the actual MJD values for August 17 and August 21, 2023
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.164272785186768,2025-04-28T23:36:18,"[              oid   classifier_name      classifier_version class_name  \
0    ZTF23aaugtqx  stamp_classifier  stamp_classifier_1.0.4         SN   
1    ZTF23aauvxgu  stamp_classifier  stamp_classifier_1.0.4         SN   
2    ZTF18adrwflu  stamp_classifier  stamp_classifier_1.0.4         SN   
3    ZTF23aauhblv  stamp_classifier  stamp_classifier_1.0.4         SN   
4    ZTF23aawdbyu  stamp_classifier  stamp_classifier_1.0.4         SN   
..            ...               ...                     ...        ...   
340  ZTF18adfwlgu  stamp_classifier  stamp_classifier_1.0.4         SN   
341  ZTF23aavevjd  stamp_classifier  stamp_classifier_1.0.4         SN   
342  ZTF23aavnqsz  stamp_classifier  stamp_classifier_1.0.4         SN   
343  ZTF23aavfdux  stamp_classifier  stamp_classifier_1.0.4         SN   
344  ZTF23aavffkq  stamp_classifier  stamp_classifier_1.0.4         SN   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.639903        1        13      1393  60150.250000  60179.250000   
1       0.412764        1         7      1787  58691.250000  60152.250000   
2       0.388430        1      1090      2551  58218.508056  60634.133056   
3       0.410632        1         7      1631  58694.288958  60553.257732   
4       0.480507        1         5      1374  60150.250000  60162.250000   
..           ...      ...       ...       ...           ...           ...   
340     0.362726        1         6      1380  58095.283970  60760.241343   
341     0.521393        1         1      1332  60153.500000  60153.500000   
342     0.511295        1        11      1044  60153.500000  60161.500000   
343     0.540236        1         1       864  60153.500000  60153.500000   
344     0.672242        1        11      1058  60153.500000  60162.500000   

     ...      meanra    meandec   sigmara  sigmadec     deltajd      firstmjd  \
0    ...  224.848497   3.801643  0.000062  0.000044   28.984062  60150.192847   
1    ...  286.177984   1.849842  0.000006  0.000025    2.045741  60150.202280   
2    ...  293.664336  12.923707  0.020408  0.019891  483.930312  60150.202743   
3    ...  293.893110   3.313766  0.085142  0.085000  403.054514  60150.203218   
4    ...  226.822263   2.179942  0.000092  0.000046   12.013160  60150.214896   
..   ...         ...        ...       ...       ...         ...           ...   
340  ...   80.681997  19.866585  0.054901  0.051633  606.753079  60153.488264   
341  ...   71.428212  20.147191       NaN       NaN    0.000000  60153.473704   
342  ...   79.087142  17.145319  0.000063  0.000037    7.996516  60153.488264   
343  ...   82.236441  20.694914       NaN       NaN    0.000000  60153.490694   
344  ...   80.906242  19.240411  0.000031  0.000044    8.986331  60153.495544   

          lastmjd  step_id_corr  diffpos  reference_change  
0    60179.176910         1.2.0     True             False  
1    60152.248021         1.2.0     True             False  
2    60634.133056      24.5.2a6     True             False  
3    60553.257732      24.5.2a6     True             False  
4    60162.228056         1.2.0     True             False  
..            ...           ...      ...               ...  
340  60760.241343        27.5.2     True             False  
341  60153.473704         1.2.0     True             False  
342  60161.484780         1.2.0     True             False  
343  60153.490694         1.2.0     True             False  
344  60162.481875         1.2.0     True             False  

[345 rows x 27 columns]]",,11.73304533958435,2025-05-20T10:10:59,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,8,10,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SN'
  AND probability.classifier_name = 'stamp_classifier'
  AND probability.probability > 0.5
  AND object.firstmjd BETWEEN 59434 AND 59438  -- Julian dates for August 17 to August 21, 2023
  AND (object.ndet >= 2 OR probability.probability > 0.5)
  AND probability.ranking = 1  -- Default condition for probability table
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,13.359689235687256,2025-04-28T23:36:31,"[              oid   classifier_name      classifier_version class_name  \
0    ZTF23aaugtqx  stamp_classifier  stamp_classifier_1.0.4         SN   
1    ZTF23aauhblv  stamp_classifier  stamp_classifier_1.0.4         SN   
2    ZTF23aauvxgu  stamp_classifier  stamp_classifier_1.0.4         SN   
3    ZTF18adrwflu  stamp_classifier  stamp_classifier_1.0.4         SN   
4    ZTF23aauhzmk  stamp_classifier  stamp_classifier_1.0.4         SN   
..            ...               ...                     ...        ...   
340  ZTF23aavevjd  stamp_classifier  stamp_classifier_1.0.4         SN   
341  ZTF23aavefel  stamp_classifier  stamp_classifier_1.0.4         SN   
342  ZTF23aavfdux  stamp_classifier  stamp_classifier_1.0.4         SN   
343  ZTF23aavnqsz  stamp_classifier  stamp_classifier_1.0.4         SN   
344  ZTF23aavffkq  stamp_classifier  stamp_classifier_1.0.4         SN   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.639903        1        13      1393  60150.250000  60179.250000   
1       0.410632        1         7      1631  58694.288958  60553.257732   
2       0.412764        1         7      1787  58691.250000  60152.250000   
3       0.388430        1      1090      2551  58218.508056  60634.133056   
4       0.691511        1        91      1504  60150.250000  60207.250000   
..           ...      ...       ...       ...           ...           ...   
340     0.521393        1         1      1332  60153.500000  60153.500000   
341     0.615143        1        73      1483  59906.259201  60592.424248   
342     0.540236        1         1       864  60153.500000  60153.500000   
343     0.511295        1        11      1044  60153.500000  60161.500000   
344     0.672242        1        11      1058  60153.500000  60162.500000   

     ...      meanra    meandec   sigmara  sigmadec     deltajd      firstmjd  \
0    ...  224.848497   3.801643  0.000062  0.000044   28.984062  60150.192847   
1    ...  293.893110   3.313766  0.085142  0.085000  403.054514  60150.203218   
2    ...  286.177984   1.849842  0.000006  0.000025    2.045741  60150.202280   
3    ...  293.664336  12.923707  0.020408  0.019891  483.930312  60150.202743   
4    ...  306.728299  13.069903  0.000033  0.000035   56.877465  60150.309178   
..   ...         ...        ...       ...       ...         ...           ...   
340  ...   71.428212  20.147191       NaN       NaN    0.000000  60153.473704   
341  ...   37.032906  12.187744  0.061490  0.060104  438.959074  60153.465174   
342  ...   82.236441  20.694914       NaN       NaN    0.000000  60153.490694   
343  ...   79.087142  17.145319  0.000063  0.000037    7.996516  60153.488264   
344  ...   80.906242  19.240411  0.000031  0.000044    8.986331  60153.495544   

          lastmjd  step_id_corr  diffpos  reference_change  
0    60179.176910         1.2.0     True             False  
1    60553.257732      24.5.2a6     True             False  
2    60152.248021         1.2.0     True             False  
3    60634.133056      24.5.2a6     True             False  
4    60207.186643         1.2.1     True             False  
..            ...           ...      ...               ...  
340  60153.473704         1.2.0     True             False  
341  60592.424248      24.5.2a6     True             False  
342  60153.490694         1.2.0     True             False  
343  60161.484780         1.2.0     True             False  
344  60162.481875         1.2.0     True             False  

[345 rows x 27 columns]]",,11.777739524841309,2025-05-20T10:11:16,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,27,0,"
SELECT
    object.oid, object.meanra, object.meandec, object.ndet,
    object.firstMJD, object.deltajd, object.g_r_max,
    probability.classifier_name, probability.class_name,
    probability.ranking, probability.probability
FROM
    object INNER JOIN probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name = 'lc_classifier'
    AND object.ndet >= 100
    AND object.oid IN
(
SELECT
    oid
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND class_name IN ('CEP')
    AND ranking = 1
    AND probability > 0.76
)
",,,,,"[               oid      meanra    meandec  ndet      firstmjd      deltajd  \
0     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
1     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
2     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
3     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
4     ZTF18abcjwgb  342.022389  61.750446   136  58289.422477  2394.697431   
...            ...         ...        ...   ...           ...          ...   
5455  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5456  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5457  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5458  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   
5459  ZTF18achaojc  333.447494  55.410730   133  58432.181667  2106.183576   

      g_r_max classifier_name class_name  ranking  probability  
0         NaN   lc_classifier        AGN       14     0.000104  
1         NaN   lc_classifier        AGN       15     0.000976  
2         NaN   lc_classifier     Blazar       13     0.000312  
3         NaN   lc_classifier     Blazar       13     0.003416  
4         NaN   lc_classifier        CEP        1     0.791208  
...       ...             ...        ...      ...          ...  
5455      NaN   lc_classifier      SNIbc       12     0.000452  
5456      NaN   lc_classifier       SNII       10     0.017820  
5457      NaN   lc_classifier       SNII       12     0.000452  
5458      NaN   lc_classifier        YSO        2     0.092564  
5459      NaN   lc_classifier        YSO        4     0.033216  

[5460 rows x 11 columns]]",,5.648105382919312,2025-05-20T10:11:22,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,27,1,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    object.ndet >= 100
    AND probability.ranking = 1
    AND probability.classifier_name = 'lc_classifier'
    AND probability.class_name = 'Ceph'
    AND probability.probability > 0.76
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,10.118314027786257,2025-04-28T23:36:42,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,10.512355089187622,2025-05-20T10:11:39,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,2,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    object.ndet >= 100
    AND probability.classifier_name = 'lc_classifier'
    AND probability.class_name = 'Ceph'
    AND probability.ranking = 1
    AND probability.probability > 0.76
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,11.337930917739868,2025-04-28T23:36:53,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,11.055119276046751,2025-05-20T10:11:55,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,3,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    probability.classifier_name = 'lc_classifier' 
    AND probability.class_name = 'Ceph' 
    AND probability.ranking = 1 
    AND probability.probability > 0.76 
    AND object.ndet >= 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,11.20435643196106,2025-04-28T23:37:04,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,8.794422149658203,2025-05-20T10:12:09,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,4,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    object.ndet >= 100
    AND probability.classifier_name = 'lc_classifier'
    AND probability.class_name = 'Ceph'
    AND probability.probability > 0.76
    AND probability.ranking = 1
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,18.279829025268555,2025-04-28T23:37:23,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,9.916807889938354,2025-05-20T10:12:24,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,5,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    p.classifier_name = 'lc_classifier' 
    AND p.class_name = 'Ceph' 
    AND p.ranking = 1 
    AND p.probability > 0.76 
    AND o.ndet >= 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,9.938629627227783,2025-04-28T23:37:32,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,8.666622638702393,2025-05-20T10:12:38,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,6,"
SELECT 
    object.oid, 
    object.meanra, 
    object.meandec, 
    object.ndet, 
    object.firstmjd, 
    object.deltajd, 
    object.g_r_max, 
    probability.classifier_name, 
    probability.class_name, 
    probability.ranking, 
    probability.probability
FROM 
    object
INNER JOIN 
    probability ON object.oid = probability.oid
WHERE 
    probability.ranking = 1
    AND probability.classifier_name = 'lc_classifier'
    AND probability.class_name = 'Ceph'
    AND probability.probability > 0.76
    AND object.ndet >= 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",medium,22.88480424880981,2025-04-28T23:37:55,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,12.264780282974243,2025-05-20T10:12:56,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,7,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 100
    AND p.classifier_name = 'lc_classifier'
    AND p.class_name = 'Ceph'
    AND p.ranking = 1
    AND p.probability > 0.76
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.7889387607574463,2025-04-28T23:37:58,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,8.3048095703125,2025-05-20T10:13:10,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,8,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 100
    AND p.classifier_name = 'lc_classifier'
    AND p.class_name = 'Ceph'
    AND p.ranking = 1
    AND p.probability > 0.76
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.040435552597046,2025-04-28T23:38:01,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,9.20308256149292,2025-05-20T10:13:24,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,9,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 100
    AND p.class_name = 'Ceph'
    AND p.probability > 0.76
    AND p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,7.69147801399231,2025-04-28T23:38:09,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,8.530823945999146,2025-05-20T10:13:38,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,27,10,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    o.deltajd, 
    o.g_r_max, 
    p.classifier_name, 
    p.class_name, 
    p.ranking, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.ndet >= 100
    AND p.class_name = 'Ceph'
    AND p.probability > 0.76
    AND p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,8.117822885513306,2025-04-28T23:38:17,"[Empty DataFrame
Columns: [oid, meanra, meandec, ndet, firstmjd, deltajd, g_r_max, classifier_name, class_name, ranking, probability]
Index: []]",,9.00680422782898,2025-05-20T10:13:52,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,17,0,"
SELECT
  *
FROM
  (
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.version, feature.fid
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name = 'AGN'
    AND probability.ranking = 1
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'ExcessVar'
  AND feature.fid = 1
  AND feature.value < -0.001
ORDER BY feature.value ASC
) as sq1
UNION
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.version, feature.fid
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name = 'AGN'
    AND probability.ranking = 1
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'ExcessVar'
  AND feature.fid = 2
  AND feature.value > -0.000001
) as sq2
ORDER BY oid
) AS sq
WHERE
  sq.oid in (
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.version, feature.fid
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name = 'AGN'
    AND probability.ranking = 1
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'ExcessVar'
  AND feature.fid = 1
  AND feature.value < -0.001
ORDER BY feature.value ASC
) as sq1
INTERSECT
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.version, feature.fid
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name = 'AGN'
    AND probability.ranking = 1
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'ExcessVar'
  AND feature.fid = 2
  AND feature.value > -0.000001
) as sq2
ORDER BY oid
)
ORDER BY oid
",,,,,"[             oid     value       name                             version  fid
0   ZTF18aaiakhj -0.001117  ExcessVar                            23.12.25    1
1   ZTF18aaiakhj -0.001080  ExcessVar  lc_classifier_1.2.1-P-transitional    1
2   ZTF18aaiakhj  0.000230  ExcessVar                              26.0.0    2
3   ZTF18aaxzddt  0.000156  ExcessVar                            23.12.25    2
4   ZTF18aaxzddt -0.001317  ExcessVar                              27.4.0    1
..           ...       ...        ...                                 ...  ...
88  ZTF20abntycb  0.000000  ExcessVar               lc_classifier_1.2.1-P    2
89  ZTF20abntycb -0.001023  ExcessVar               lc_classifier_1.2.1-P    1
90  ZTF21abduazj -0.001005  ExcessVar                         23.12.26a85    1
91  ZTF21abduazj  0.000000  ExcessVar               lc_classifier_1.2.1-P    2
92  ZTF21abduazj -0.001005  ExcessVar                              27.5.6    1

[93 rows x 5 columns]]",,155.44772696495056,2025-05-20T10:16:28,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,17,1,"
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 2
      AND m.magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 1
      AND (m.ndet = 0 OR m.magsigma = 0) -- No detections or no variability
),
features_union AS (
    SELECT f.oid, f.name, f.value
    FROM feature f
    INNER JOIN agn_objects ao ON f.oid = ao.oid
    WHERE f.fid IN (1, 2) -- Considering features for g and r bands
),
features_intersect AS (
    SELECT f.oid
    FROM feature f
    INNER JOIN agn_objects ao ON f.oid = ao.oid
    WHERE f.fid IN (1, 2)
    GROUP BY f.oid
    HAVING COUNT(DISTINCT f.fid) = 2 -- Ensure both g and r band features exist
)
SELECT o.*
FROM object o
WHERE o.oid IN (
    SELECT oid
    FROM features_union
    WHERE oid IN (SELECT oid FROM features_intersect)
)
AND o.oid IN (SELECT oid FROM agn_objects)
AND o.oid IN (SELECT oid FROM r_band_variability)
AND o.oid IN (SELECT oid FROM g_band_no_detections)
ORDER BY o.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,27.322832107543945,2025-04-28T23:38:44,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 2
      AND m.magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 1
      AND (m.ndet = 0 OR m.magsigma = 0) -- No detections or no variability
),
features_ordered AS (
    SELECT f.oid, f.name, f.value
    FROM feature f
    INNER JOIN agn_objects ao ON f.oid = ao.oid
    WHERE f.fid IN (1, 2) -- Considering features for g and r bands
    ORDER BY f.value ASC
)
SELECT o.*
FROM object o
WHERE o.oid IN (
    SELECT oid
    FROM features_ordered
)
AND o.oid IN (SELECT oid FROM agn_objects)
AND o.oid IN (SELECT oid FROM r_band_variability)
AND o.oid IN (SELECT oid FROM g_band_no_detections)
ORDER BY o.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.38039803504944,2025-05-20T10:20:54,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,2,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_oids AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
),
features_ordered AS (
    SELECT f.oid, f.name, f.value
    FROM feature f
    INNER JOIN filtered_oids fo ON f.oid = fo.oid
    ORDER BY f.value ASC
)
SELECT o.oid, f.name, f.value
FROM object o
INNER JOIN features_ordered f ON o.oid = f.oid
ORDER BY o.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.39830207824707,2025-04-28T23:39:08,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_oids AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
SELECT o.oid, f.name, f.value
FROM object o
INNER JOIN feature f ON o.oid = f.oid
WHERE o.oid IN (SELECT oid FROM filtered_oids)
ORDER BY o.oid, f.value ASC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.4594779014588,2025-05-20T10:25:13,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,3,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_oids AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
SELECT f.*
FROM feature f
INNER JOIN filtered_oids fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.405792474746704,2025-04-28T23:39:31,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
)
SELECT f.*
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.2436158657074,2025-05-20T10:29:31,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,4,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
SELECT f.*
FROM feature f
JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.820398092269897,2025-04-28T23:39:56,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
)
SELECT f.*
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.2752366065979,2025-05-20T10:33:56,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,5,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    EXCEPT
    SELECT oid
    FROM g_band_no_detection_or_no_variability
)
SELECT f.*
FROM feature f
JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.561721086502075,2025-04-28T23:40:21,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    WHERE oid IN (SELECT oid FROM r_band_variability)
      AND oid NOT IN (SELECT oid FROM g_band_no_detection_or_no_variability)
)
SELECT f.*
FROM feature f
WHERE f.oid IN (SELECT oid FROM filtered_objects)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.16026735305783,2025-05-20T10:38:44,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,6,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_oids AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
SELECT f.*
FROM feature f
INNER JOIN filtered_oids fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.71831083297729,2025-04-28T23:40:45,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_detection_or_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
)
SELECT f.*
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detection_or_variability
)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.4143707752228,2025-05-20T10:43:02,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,7,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
SELECT f.oid, f.name, f.value
FROM feature f
INNER JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,25.356778860092163,2025-04-28T23:41:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability
)
SELECT f.oid, f.name, f.value
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
ORDER BY f.value ASC, f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.27195644378665,2025-05-20T10:47:54,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,8,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
SELECT f.*
FROM feature f
JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid ASC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.127763032913208,2025-04-28T23:41:34,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0) -- No detections or no variability
),
filtered_objects AS (
    SELECT ao.oid
    FROM agn_objects ao
    JOIN r_band_variability rv ON ao.oid = rv.oid
    LEFT JOIN g_band_no_detections_or_no_variability gv ON ao.oid = gv.oid
    WHERE gv.oid IS NOT NULL
)
SELECT f.*
FROM feature f
JOIN filtered_objects fo ON f.oid = fo.oid
ORDER BY f.value ASC, f.oid ASC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.4764218330384,2025-05-20T10:52:46,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,9,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma <= 0) -- Assuming magsigma <= 0 indicates no variability
),
selected_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
SELECT f.*
FROM feature f
JOIN selected_objects so ON f.oid = so.oid
ORDER BY f.value ASC, f.oid ASC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,26.81316304206848,2025-04-28T23:42:01,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0 -- Assuming magsigma > 0 indicates variability
),
g_band_no_detections_or_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma <= 0) -- Assuming magsigma <= 0 indicates no variability
)
SELECT f.*
FROM feature f
WHERE f.oid IN (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_detections_or_no_variability
)
ORDER BY f.value ASC, f.oid ASC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.68339705467224,2025-05-20T10:57:03,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,17,10,"
WITH agn_objects AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
r_band_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magsigma > 0
),
g_band_no_variability AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND (ndet = 0 OR magsigma = 0)
),
filtered_objects AS (
    SELECT oid
    FROM agn_objects
    INTERSECT
    SELECT oid
    FROM r_band_variability
    INTERSECT
    SELECT oid
    FROM g_band_no_variability
),
ordered_features AS (
    SELECT f.*
    FROM feature f
    INNER JOIN filtered_objects fo ON f.oid = fo.oid
    ORDER BY f.value ASC
)
SELECT o.*
FROM object o
INNER JOIN ordered_features ofe ON o.oid = ofe.oid
ORDER BY o.oid ASC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,21.823970079422,2025-04-28T23:42:23,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF18aaakcqk        51      2250  58150.527326  60705.379086       True   
1    ZTF18aaavwka       134      2000  58150.522685  60411.269433       True   
2    ZTF18aabeibl        35      2397  58158.447789  60814.341736       True   
3    ZTF18aacaqvb       387      2293  58184.350683  60411.284178       True   
4    ZTF18aadyxlg        71       470  58054.528229  60554.507569       True   
..            ...       ...       ...           ...           ...        ...   
214  ZTF25aadzyzg        10      1142  60707.346852  60709.383866       True   
215  ZTF25aaecusw        30      2627  58852.437361  60709.394907       True   
216  ZTF25aaeegag        13      2581  60434.240069  60709.319514       True   
217  ZTF25aaefgsh        18      1591  59217.421412  60709.377176       True   
218  ZTF25aalvwgv         7      2818  60772.494849  60795.384884       True   

     stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      False    14       NaN           NaN  ...  197.858326  18.502101   
1      False    46  0.299198      0.899683  ...  188.934305  16.093386   
2      False     7       NaN           NaN  ...  205.365911  28.857782   
3      False   134       NaN           NaN  ...  187.245886  24.009494   
4      False    17       NaN           NaN  ...  125.576913  33.091165   
..       ...   ...       ...           ...  ...         ...        ...   
214    False    10       NaN           NaN  ...  158.900750   8.368057   
215    False    15       NaN           NaN  ...  146.788316  14.517783   
216    False    12       NaN           NaN  ...  156.002714  21.118956   
217    False    11       NaN           NaN  ...  140.660282  17.638685   
218    False     7       NaN           NaN  ...  309.383742  78.752159   

      sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0    0.023370  0.022162  2262.870683  58442.508403  60705.379086   
1    0.062556  0.060104  1867.930822  58543.338611  60411.269433   
2    0.034952  0.030612  2537.085428  58277.256308  60814.341736   
3    0.042875  0.039166  2168.993634  58242.290544  60411.284178   
4    0.071740  0.060104  2130.991308  58423.516262  60554.507569   
..        ...       ...          ...           ...           ...   
214  0.026253  0.025973     2.037014  60707.346852  60709.383866   
215  0.022153  0.021445     1.084884  60708.310023  60709.394907   
216  0.025559  0.023842     2.017083  60707.302431  60709.319514   
217  0.026065  0.024839     2.016713  60707.360463  60709.377176   
218  0.156941  0.030612    22.890035  60772.494849  60795.384884   

     step_id_corr  diffpos reference_change  
0          27.3.0    False             True  
1          24.4.1    False             True  
2          27.5.6    False            False  
3          24.4.1    False            False  
4        24.5.2a6     True             True  
..            ...      ...              ...  
214        27.3.0    False            False  
215        27.3.0     True            False  
216        27.3.0    False            False  
217        27.3.0    False            False  
218        27.5.6     True            False  

[219 rows x 22 columns]]",,176.71860122680664,2025-05-20T11:00:08,0.0,0.0,0.2,0.0454545454545454,0.0,0.0
0.16.3,,,37,0,"
SELECT
    *
FROM
  probability
WHERE
    classifier_name = 'lc_classifier'
    AND class_name IN ('SNIa')
    AND ranking=1
ORDER BY probability DESC
LIMIT 200
",,,,,"[              oid classifier_name     classifier_version class_name  \
0    ZTF20acobvxk   lc_classifier  hierarchical_rf_1.1.0       SNIa   
1    ZTF22aalpfln   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2    ZTF21abuyhau   lc_classifier  hierarchical_rf_1.1.0       SNIa   
3    ZTF21abywdxt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
4    ZTF22abqdmwt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
..            ...             ...                    ...        ...   
195  ZTF21aaufthj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
196  ZTF21aarmkuj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
197  ZTF20abgfvav   lc_classifier  hierarchical_rf_1.1.0       SNIa   
198  ZTF20abewogd   lc_classifier  hierarchical_rf_1.1.0       SNIa   
199  ZTF20aairvsi   lc_classifier  hierarchical_rf_1.1.0       SNIa   

     probability  ranking  
0       0.722000        1  
1       0.722000        1  
2       0.720000        1  
3       0.716564        1  
4       0.714568        1  
..           ...      ...  
195     0.636000        1  
196     0.636000        1  
197     0.636000        1  
198     0.636000        1  
199     0.636000        1  

[200 rows x 6 columns]]",,3.728102445602417,2025-05-20T11:00:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,37,1,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.89289927482605,2025-04-28T23:42:36,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,10.125230073928831,2025-05-20T11:00:26,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,2,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT * 
FROM probability
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,13.24457859992981,2025-04-28T23:42:49,"[              oid classifier_name     classifier_version class_name  \
0    ZTF20acobvxk   lc_classifier  hierarchical_rf_1.1.0       SNIa   
1    ZTF22aalpfln   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2    ZTF21abuyhau   lc_classifier  hierarchical_rf_1.1.0       SNIa   
3    ZTF21abywdxt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
4    ZTF22abqdmwt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
..            ...             ...                    ...        ...   
195  ZTF21aaufthj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
196  ZTF21aarmkuj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
197  ZTF20abgfvav   lc_classifier  hierarchical_rf_1.1.0       SNIa   
198  ZTF20abewogd   lc_classifier  hierarchical_rf_1.1.0       SNIa   
199  ZTF20aairvsi   lc_classifier  hierarchical_rf_1.1.0       SNIa   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.722000        1       102       502  59149.448125  59204.198831   
1       0.722000        1        59      2921  59724.250000  59766.250000   
2       0.720000        1        53      2702  59448.184097  59478.194873   
3       0.716564        1        44      1171  59464.267917  59502.204410   
4       0.714568        1        28       699  59877.250000  59932.250000   
..           ...      ...       ...       ...           ...           ...   
195     0.636000        1        27       659  59313.207350  59361.195984   
196     0.636000        1        35      1237  59306.233287  59350.217257   
197     0.636000        1        44      1264  59019.234178  59063.179873   
198     0.636000        1        57       293  59013.243611  59075.306400   
199     0.636000        1       106      1139  58873.195289  58915.143796   

     ...      meanra    meandec   sigmara  sigmadec    deltajd      firstmjd  \
0    ...   37.673533 -14.569121  0.000080  0.000059  54.750706  59149.448125   
1    ...  224.503742  49.953109  0.000049  0.000022  41.892627  59724.349155   
2    ...  244.075462  37.636849  0.000064  0.000032  28.030926  59450.163947   
3    ...  326.503610  21.962614  0.000025  0.000023  37.007465  59465.196944   
4    ...   28.288162 -14.140191  0.000040  0.000052  53.900000  59878.310451   
..   ...         ...        ...       ...       ...        ...           ...   
195  ...  151.805684  14.773050  0.000036  0.000027  47.988634  59313.207350   
196  ...  136.109002   8.012789  0.000021  0.000015  43.983970  59306.233287   
197  ...  226.922647  32.009601  0.000034  0.000020  43.945695  59019.234178   
198  ...  312.095377  83.077586  0.000341  0.000026  62.062789  59013.243611   
199  ...  108.453967  35.836392  0.000035  0.000043  41.948507  58873.195289   

          lastmjd      step_id_corr  diffpos  reference_change  
0    59204.198831   corr_bulk_0.0.1     True             False  
1    59766.241782               dev     True             False  
2    59478.194873  correction_1.0.6     True             False  
3    59502.204410  correction_1.0.6     True             False  
4    59932.210451             1.1.6     True             False  
..            ...               ...      ...               ...  
195  59361.195984  correction_0.0.1     True             False  
196  59350.217257  correction_0.0.1     True             False  
197  59063.179873   corr_bulk_0.0.1     True             False  
198  59075.306400   corr_bulk_0.0.1     True             False  
199  58915.143796   corr_bulk_0.0.1     True             False  

[200 rows x 27 columns]]",,10.45835256576538,2025-05-20T11:00:41,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,3,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.70656180381775,2025-04-28T23:43:06,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,9.726696729660034,2025-05-20T11:00:55,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,4,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,10.64267349243164,2025-04-28T23:43:17,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,9.496082067489624,2025-05-20T11:01:09,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,5,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM probability
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.443302154541016,2025-04-28T23:43:29,"[              oid classifier_name     classifier_version class_name  \
0    ZTF20acobvxk   lc_classifier  hierarchical_rf_1.1.0       SNIa   
1    ZTF22aalpfln   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2    ZTF21abuyhau   lc_classifier  hierarchical_rf_1.1.0       SNIa   
3    ZTF21abywdxt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
4    ZTF22abqdmwt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
..            ...             ...                    ...        ...   
195  ZTF21aaufthj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
196  ZTF21aarmkuj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
197  ZTF20abgfvav   lc_classifier  hierarchical_rf_1.1.0       SNIa   
198  ZTF20abewogd   lc_classifier  hierarchical_rf_1.1.0       SNIa   
199  ZTF20aairvsi   lc_classifier  hierarchical_rf_1.1.0       SNIa   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.722000        1       102       502  59149.448125  59204.198831   
1       0.722000        1        59      2921  59724.250000  59766.250000   
2       0.720000        1        53      2702  59448.184097  59478.194873   
3       0.716564        1        44      1171  59464.267917  59502.204410   
4       0.714568        1        28       699  59877.250000  59932.250000   
..           ...      ...       ...       ...           ...           ...   
195     0.636000        1        27       659  59313.207350  59361.195984   
196     0.636000        1        35      1237  59306.233287  59350.217257   
197     0.636000        1        44      1264  59019.234178  59063.179873   
198     0.636000        1        57       293  59013.243611  59075.306400   
199     0.636000        1       106      1139  58873.195289  58915.143796   

     ...      meanra    meandec   sigmara  sigmadec    deltajd      firstmjd  \
0    ...   37.673533 -14.569121  0.000080  0.000059  54.750706  59149.448125   
1    ...  224.503742  49.953109  0.000049  0.000022  41.892627  59724.349155   
2    ...  244.075462  37.636849  0.000064  0.000032  28.030926  59450.163947   
3    ...  326.503610  21.962614  0.000025  0.000023  37.007465  59465.196944   
4    ...   28.288162 -14.140191  0.000040  0.000052  53.900000  59878.310451   
..   ...         ...        ...       ...       ...        ...           ...   
195  ...  151.805684  14.773050  0.000036  0.000027  47.988634  59313.207350   
196  ...  136.109002   8.012789  0.000021  0.000015  43.983970  59306.233287   
197  ...  226.922647  32.009601  0.000034  0.000020  43.945695  59019.234178   
198  ...  312.095377  83.077586  0.000341  0.000026  62.062789  59013.243611   
199  ...  108.453967  35.836392  0.000035  0.000043  41.948507  58873.195289   

          lastmjd      step_id_corr  diffpos  reference_change  
0    59204.198831   corr_bulk_0.0.1     True             False  
1    59766.241782               dev     True             False  
2    59478.194873  correction_1.0.6     True             False  
3    59502.204410  correction_1.0.6     True             False  
4    59932.210451             1.1.6     True             False  
..            ...               ...      ...               ...  
195  59361.195984  correction_0.0.1     True             False  
196  59350.217257  correction_0.0.1     True             False  
197  59063.179873   corr_bulk_0.0.1     True             False  
198  59075.306400   corr_bulk_0.0.1     True             False  
199  58915.143796   corr_bulk_0.0.1     True             False  

[200 rows x 27 columns]]",,9.392160177230837,2025-05-20T11:01:23,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,6,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,13.818251132965088,2025-04-28T23:43:43,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,15.585176706314089,2025-05-20T11:01:42,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,7,"
SELECT * 
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,14.260555982589722,2025-04-28T23:43:57,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,12.284666776657104,2025-05-20T11:01:58,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,8,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,13.248966217041016,2025-04-28T23:44:10,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,9.744914770126345,2025-05-20T11:02:15,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,9,"
-- Query to retrieve the top 200 objects classified as 'SNIa' by the light curve classifier
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.class_name = 'SNIa'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,13.32813811302185,2025-04-28T23:44:24,"[              oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0    ZTF20acobvxk       102       502  59149.448125  59204.198831      False   
1    ZTF22aalpfln        59      2921  59724.250000  59766.250000      False   
2    ZTF21abuyhau        53      2702  59448.184097  59478.194873      False   
3    ZTF21abywdxt        44      1171  59464.267917  59502.204410      False   
4    ZTF22abqdmwt        28       699  59877.250000  59932.250000      False   
..            ...       ...       ...           ...           ...        ...   
195  ZTF21aaufthj        27       659  59313.207350  59361.195984      False   
196  ZTF21aarmkuj        35      1237  59306.233287  59350.217257      False   
197  ZTF20abgfvav        44      1264  59019.234178  59063.179873      False   
198  ZTF20abewogd        57       293  59013.243611  59075.306400      False   
199  ZTF20aairvsi       106      1139  58873.195289  58915.143796      False   

     stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd       lastmjd  \
0      False    37 -0.185314      0.588599  ...  59149.448125  59204.198831   
1      False    28 -0.179750           NaN  ...  59724.349155  59766.241782   
2      False    28 -0.180090      0.486082  ...  59450.163947  59478.194873   
3      False    27 -0.098903           NaN  ...  59465.196944  59502.204410   
4      False    21 -0.086032           NaN  ...  59878.310451  59932.210451   
..       ...   ...       ...           ...  ...           ...           ...   
195    False    28 -0.013462           NaN  ...  59313.207350  59361.195984   
196    False    35 -0.110087           NaN  ...  59306.233287  59350.217257   
197    False    44 -0.008980           NaN  ...  59019.234178  59063.179873   
198    False    57 -0.022940           NaN  ...  59013.243611  59075.306400   
199    False    33 -0.161451           NaN  ...  58873.195289  58915.143796   

         step_id_corr  diffpos  reference_change  classifier_name  \
0     corr_bulk_0.0.1     True             False    lc_classifier   
1                 dev     True             False    lc_classifier   
2    correction_1.0.6     True             False    lc_classifier   
3    correction_1.0.6     True             False    lc_classifier   
4               1.1.6     True             False    lc_classifier   
..                ...      ...               ...              ...   
195  correction_0.0.1     True             False    lc_classifier   
196  correction_0.0.1     True             False    lc_classifier   
197   corr_bulk_0.0.1     True             False    lc_classifier   
198   corr_bulk_0.0.1     True             False    lc_classifier   
199   corr_bulk_0.0.1     True             False    lc_classifier   

        classifier_version  class_name  probability ranking  
0    hierarchical_rf_1.1.0        SNIa     0.722000       1  
1    hierarchical_rf_1.1.0        SNIa     0.722000       1  
2    hierarchical_rf_1.1.0        SNIa     0.720000       1  
3    hierarchical_rf_1.1.0        SNIa     0.716564       1  
4    hierarchical_rf_1.1.0        SNIa     0.714568       1  
..                     ...         ...          ...     ...  
195  hierarchical_rf_1.1.0        SNIa     0.636000       1  
196  hierarchical_rf_1.1.0        SNIa     0.636000       1  
197  hierarchical_rf_1.1.0        SNIa     0.636000       1  
198  hierarchical_rf_1.1.0        SNIa     0.636000       1  
199  hierarchical_rf_1.1.0        SNIa     0.636000       1  

[200 rows x 27 columns]]",,9.94803500175476,2025-05-20T11:02:31,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,gpt-4o,v1,37,10,"
SELECT * 
FROM probability 
INNER JOIN object ON probability.oid = object.oid
WHERE probability.class_name = 'SNIa' 
  AND probability.classifier_name = 'lc_classifier' 
  AND probability.ranking = 1
ORDER BY probability.probability DESC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,12.553942918777466,2025-04-28T23:44:36,"[              oid classifier_name     classifier_version class_name  \
0    ZTF20acobvxk   lc_classifier  hierarchical_rf_1.1.0       SNIa   
1    ZTF22aalpfln   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2    ZTF21abuyhau   lc_classifier  hierarchical_rf_1.1.0       SNIa   
3    ZTF21abywdxt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
4    ZTF22abqdmwt   lc_classifier  hierarchical_rf_1.1.0       SNIa   
..            ...             ...                    ...        ...   
195  ZTF21aaufthj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
196  ZTF21aarmkuj   lc_classifier  hierarchical_rf_1.1.0       SNIa   
197  ZTF20abgfvav   lc_classifier  hierarchical_rf_1.1.0       SNIa   
198  ZTF20abewogd   lc_classifier  hierarchical_rf_1.1.0       SNIa   
199  ZTF20aairvsi   lc_classifier  hierarchical_rf_1.1.0       SNIa   

     probability  ranking  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       0.722000        1       102       502  59149.448125  59204.198831   
1       0.722000        1        59      2921  59724.250000  59766.250000   
2       0.720000        1        53      2702  59448.184097  59478.194873   
3       0.716564        1        44      1171  59464.267917  59502.204410   
4       0.714568        1        28       699  59877.250000  59932.250000   
..           ...      ...       ...       ...           ...           ...   
195     0.636000        1        27       659  59313.207350  59361.195984   
196     0.636000        1        35      1237  59306.233287  59350.217257   
197     0.636000        1        44      1264  59019.234178  59063.179873   
198     0.636000        1        57       293  59013.243611  59075.306400   
199     0.636000        1       106      1139  58873.195289  58915.143796   

     ...      meanra    meandec   sigmara  sigmadec    deltajd      firstmjd  \
0    ...   37.673533 -14.569121  0.000080  0.000059  54.750706  59149.448125   
1    ...  224.503742  49.953109  0.000049  0.000022  41.892627  59724.349155   
2    ...  244.075462  37.636849  0.000064  0.000032  28.030926  59450.163947   
3    ...  326.503610  21.962614  0.000025  0.000023  37.007465  59465.196944   
4    ...   28.288162 -14.140191  0.000040  0.000052  53.900000  59878.310451   
..   ...         ...        ...       ...       ...        ...           ...   
195  ...  151.805684  14.773050  0.000036  0.000027  47.988634  59313.207350   
196  ...  136.109002   8.012789  0.000021  0.000015  43.983970  59306.233287   
197  ...  226.922647  32.009601  0.000034  0.000020  43.945695  59019.234178   
198  ...  312.095377  83.077586  0.000341  0.000026  62.062789  59013.243611   
199  ...  108.453967  35.836392  0.000035  0.000043  41.948507  58873.195289   

          lastmjd      step_id_corr  diffpos  reference_change  
0    59204.198831   corr_bulk_0.0.1     True             False  
1    59766.241782               dev     True             False  
2    59478.194873  correction_1.0.6     True             False  
3    59502.204410  correction_1.0.6     True             False  
4    59932.210451             1.1.6     True             False  
..            ...               ...      ...               ...  
195  59361.195984  correction_0.0.1     True             False  
196  59350.217257  correction_0.0.1     True             False  
197  59063.179873   corr_bulk_0.0.1     True             False  
198  59075.306400   corr_bulk_0.0.1     True             False  
199  58915.143796   corr_bulk_0.0.1     True             False  

[200 rows x 27 columns]]",,10.17675805091858,2025-05-20T11:02:46,1.0,1.0,1.0,0.2222222222222222,1.0,1.0
0.16.3,,,34,0,"
SELECT
    *
FROM
    feature
WHERE
    (name='Amplitude'
    OR name='Multiband_period')
    AND oid in ('ZTF17aaadpsi','ZTF19aaduncs','ZTF18abnvehl','ZTF19abrqsxy','ZTF19aaduodl','ZTF19aadovdv','ZTF18aammkke','ZTF18abtriul','ZTF17aabwtky','ZTF18abwjpfy')
",,,,,"[              oid              name     value  fid                version
0    ZTF19aaduodl         Amplitude  0.351974    1  lc_classifier_1.2.1-P
1    ZTF18abtriul         Amplitude  0.307038    2  lc_classifier_1.2.1-P
2    ZTF18abtriul  Multiband_period  0.326399   12  lc_classifier_1.2.1-P
3    ZTF19aadovdv         Amplitude  0.217939    2  lc_classifier_1.2.1-P
4    ZTF18aammkke         Amplitude  0.362162    1  lc_classifier_1.2.1-P
..            ...               ...       ...  ...                    ...
337  ZTF18aammkke  Multiband_period  0.653667   12                 27.5.6
338  ZTF18aammkke         Amplitude  0.251297    2                 27.5.6
339  ZTF17aaadpsi  Multiband_period  0.629546   12                 27.5.6
340  ZTF17aaadpsi         Amplitude  0.249162    2                 27.5.6
341  ZTF17aaadpsi         Amplitude  0.307740    1                 27.5.6

[342 rows x 5 columns]]",,3.8129749298095694,2025-05-20T11:02:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,1,"
-- Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Sub-query for the 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Sub-query for the 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Combine the results of the two feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Intersect to find common oids between the two feature sub-queries
intersect_features AS (
    SELECT oid FROM amplitude_subquery
    INTERSECT
    SELECT oid FROM multiband_period_subquery
)

-- Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,20.31040573120117,2025-04-28T23:44:57,[None],"(psycopg2.errors.SyntaxError) syntax error at or near ""amplitude_subquery""
LINE 5: amplitude_subquery AS (
        ^

[SQL: 
-- Corrected query to retrieve 'Amplitude' or 'Multiband_period' features for specified oids

-- Sub-query for the 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    WHERE f.name = 'Amplitude'
      AND f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Sub-query for the 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    WHERE f.name = 'Multiband_period'
      AND f.oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Combine the results of the two feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
)

-- Final query to select the combined results
SELECT cf.*
FROM combined_features cf
]
(Background on this error at: https://sqlalche.me/e/20/f405)",15.224180936813354,2025-05-20T11:03:09,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,34,2,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results using UNION and INTERSECT
combined_features AS (
    SELECT * FROM amplitude_feature
    UNION
    SELECT * FROM multiband_period_feature
),

intersected_oids AS (
    SELECT oid FROM amplitude_feature
    INTERSECT
    SELECT oid FROM multiband_period_feature
)

-- Step 5: Final query to filter combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersected_oids)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,15.625924825668337,2025-04-28T23:45:12,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,15.864273309707642,2025-05-20T11:03:29,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,3,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results using UNION
combined_features AS (
    SELECT * FROM amplitude_feature
    UNION
    SELECT * FROM multiband_period_feature
),

-- Step 5: Find common oids using INTERSECT
intersected_oids AS (
    SELECT oid FROM amplitude_feature
    INTERSECT
    SELECT oid FROM multiband_period_feature
)

-- Step 6: Final query to filter combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersected_oids)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,13.969372034072876,2025-04-28T23:45:26,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,11.929279088974,2025-05-20T11:03:45,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,4,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results of the sub-queries for 'Amplitude' and 'Multiband_period'
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 5: Intersect to find common oids between 'Amplitude' and 'Multiband_period'
intersect_features AS (
    SELECT oid
    FROM amplitude_subquery
    INTERSECT
    SELECT oid
    FROM multiband_period_subquery
)

-- Step 6: Final query to filter the combined results
SELECT *
FROM combined_features
WHERE oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,18.64547538757324,2025-04-28T23:45:45,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,17.482257604599,2025-05-20T11:04:07,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,5,"
-- Step 1: Sub-query for Probability Table
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-queries for Each Feature
amplitude_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

multiband_period_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 3: Combine Feature Sub-queries
union_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 4: Intersect Feature Sub-queries
intersect_features AS (
    SELECT oid FROM amplitude_subquery
    INTERSECT
    SELECT oid FROM multiband_period_subquery
)

-- Step 5: Final Query Construction
SELECT uf.*
FROM union_features uf
WHERE uf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,15.227156162261965,2025-04-28T23:46:00,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,10.920546531677246,2025-05-20T11:04:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,6,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results of the feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 5: Find common oids between the feature sub-queries
intersect_features AS (
    SELECT oid
    FROM amplitude_subquery
    INTERSECT
    SELECT oid
    FROM multiband_period_subquery
)

-- Step 6: Final query to filter the combined results
SELECT *
FROM combined_features
WHERE oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,15.267089366912842,2025-04-28T23:46:16,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,13.422691106796265,2025-05-20T11:04:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,7,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.oid, f.name, f.value, f.fid, f.version
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine results using UNION
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 5: Intersect to ensure oids have both features
intersect_features AS (
    SELECT oid
    FROM amplitude_subquery
    INTERSECT
    SELECT oid
    FROM multiband_period_subquery
)

-- Step 6: Final query to filter combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,17.18593955039978,2025-04-28T23:46:33,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,16.430436611175537,2025-05-20T11:05:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,8,"
-- Sub-query to filter the probability table for the specified oids with default conditions
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Sub-query for 'Amplitude' feature
amplitude_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Amplitude'
),

-- Sub-query for 'Multiband_period' feature
multiband_period_feature AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Multiband_period'
),

-- Combine the results of the sub-queries for 'Amplitude' and 'Multiband_period'
combined_features AS (
    SELECT * FROM amplitude_feature
    UNION
    SELECT * FROM multiband_period_feature
),

-- Intersect to find common oids between the sub-queries for 'Amplitude' and 'Multiband_period'
intersected_oids AS (
    SELECT oid
    FROM amplitude_feature
    INTERSECT
    SELECT oid
    FROM multiband_period_feature
)

-- Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersected_oids)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,15.504189491271973,2025-04-28T23:46:48,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,12.987902879714966,2025-05-20T11:05:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,9,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_features AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_features AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_filtered pf ON f.oid = pf.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results of the feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_features
    UNION
    SELECT * FROM multiband_period_features
),

-- Step 5: Find common oids between the feature sub-queries
intersect_features AS (
    SELECT oid
    FROM amplitude_features
    INTERSECT
    SELECT oid
    FROM multiband_period_features
)

-- Step 6: Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,14.708109617233276,2025-04-28T23:47:03,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,18.500808238983154,2025-05-20T11:05:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,34,10,"
-- Step 1: Sub-query to filter the probability table for the specified oids
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND oid IN ('ZTF17aaadpsi', 'ZTF19aaduncs', 'ZTF18abnvehl', 'ZTF19abrqsxy', 'ZTF19aaduodl', 'ZTF19aadovdv', 'ZTF18aammkke', 'ZTF18abtriul', 'ZTF17aabwtky', 'ZTF18abwjpfy')
),

-- Step 2: Sub-query for 'Amplitude' feature
amplitude_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Amplitude'
),

-- Step 3: Sub-query for 'Multiband_period' feature
multiband_period_subquery AS (
    SELECT f.*
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
    WHERE f.name = 'Multiband_period'
),

-- Step 4: Combine the results of the feature sub-queries
combined_features AS (
    SELECT * FROM amplitude_subquery
    UNION
    SELECT * FROM multiband_period_subquery
),

-- Step 5: Find common oids between the feature sub-queries
intersect_features AS (
    SELECT oid
    FROM amplitude_subquery
    INTERSECT
    SELECT oid
    FROM multiband_period_subquery
)

-- Step 6: Final query to filter the combined results
SELECT cf.*
FROM combined_features cf
WHERE cf.oid IN (SELECT oid FROM intersect_features)
","['CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",advanced,16.277417421340942,2025-04-28T23:47:20,"[              oid              name     value  fid  \
0    ZTF19aaduncs  Multiband_period  0.617545   12   
1    ZTF18aammkke         Amplitude  0.350759    1   
2    ZTF19aaduodl         Amplitude  0.244648    2   
3    ZTF17aabwtky  Multiband_period  0.719888   12   
4    ZTF17aabwtky         Amplitude  0.287888    2   
..            ...               ...       ...  ...   
337  ZTF17aaadpsi  Multiband_period  1.000000   12   
338  ZTF19aadovdv  Multiband_period  0.290001   12   
339  ZTF18abtriul         Amplitude       NaN    2   
340  ZTF17aaadpsi         Amplitude       NaN    1   
341  ZTF18aammkke         Amplitude  0.231831    2   

                                version  
0                                27.5.6  
1                                27.5.4  
2                              23.12.25  
3                                27.5.4  
4                                26.0.0  
..                                  ...  
337                         23.12.26a85  
338  lc_classifier_1.2.1-P-transitional  
339                            25.0.1a3  
340                            25.0.1a0  
341  lc_classifier_1.2.1-P-transitional  

[342 rows x 5 columns]]",,13.070780992507936,2025-05-20T11:05:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,1,0,"
SELECT
  sq.oid, sq.value, sq.name, sq.fid as feature_fid, sq.version, sq.ndet, sq.meanra, sq.meandec,
  magstat.magmax, magstat.magmin,  magstat.magmax-magstat.magmin as delta_mag, magstat.fid as magstat_fid
FROM
  (
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 1
  AND feature.fid = 1
) as sq1
UNION
SELECT *
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 0.5
  AND feature.fid = 2
) as sq2
ORDER BY oid
) AS sq
  INNER JOIN magstat
  ON sq.oid = magstat.oid
WHERE
  sq.oid in (
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 1
  AND feature.fid = 1
) as sq1
INTERSECT
SELECT oid
FROM (
SELECT
  feature.oid, feature.value, feature.name, feature.fid, feature.version, obj_oids.meanra, obj_oids.meandec, obj_oids.ndet
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name='AGN'
    AND probability.probability > 0.6
    AND object.deltajd > 365
    AND object.ndet > 20
) as obj_oids
    INNER JOIN
    feature ON feature.oid = obj_oids.oid
WHERE
  feature.name = 'Amplitude'
  AND feature.value > 0.5
  AND feature.fid = 2
) as sq2
ORDER BY oid
)
  AND magstat.ndet > 20
  AND magstat.corrected = TRUE
ORDER BY oid
",,,,,"[              oid      value       name  feature_fid version  ndet  \
0    ZTF18aajadqs  32.419900  Amplitude            2  24.5.1  1178   
1    ZTF18aajadqs  32.419900  Amplitude            2  24.5.1  1178   
2    ZTF18aajadqs  23.218352  Amplitude            1  24.5.1  1178   
3    ZTF18aajadqs  23.218352  Amplitude            1  24.5.1  1178   
4    ZTF18aakixcl  32.346897  Amplitude            2  24.5.1   822   
..            ...        ...        ...          ...     ...   ...   
437  ZTF22aaihxyw  10.054767  Amplitude            2  24.5.1    99   
438  ZTF23aagpjmh   9.379387  Amplitude            1  24.5.1    97   
439  ZTF23aagpjmh   9.379387  Amplitude            1  24.5.1    97   
440  ZTF23aagpjmh   6.896555  Amplitude            2  24.5.1    97   
441  ZTF23aagpjmh   6.896555  Amplitude            2  24.5.1    97   

         meanra    meandec     magmax     magmin  delta_mag  magstat_fid  
0    262.778525  30.297422  20.614600  18.841400   1.773199            1  
1    262.778525  30.297422  20.236600  18.619764   1.616837            2  
2    262.778525  30.297422  20.614600  18.841400   1.773199            1  
3    262.778525  30.297422  20.236600  18.619764   1.616837            2  
4    234.541788  57.603637  20.211306  18.502560   1.708746            1  
..          ...        ...        ...        ...        ...          ...  
437  258.003528   9.019274  20.471000  19.632126   0.838875            2  
438  270.287184  13.851853  20.859700  19.852900   1.006800            1  
439  270.287184  13.851853  20.569700  19.989302   0.580399            2  
440  270.287184  13.851853  20.859700  19.852900   1.006800            1  
441  270.287184  13.851853  20.569700  19.989302   0.580399            2  

[442 rows x 12 columns]]",,48.36214375495911,2025-05-20T11:06:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,1,1,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_subquery AS (
    SELECT oid, meanra, meandec, ndet
    FROM object
    WHERE deltajd >= 365
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag_g
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag_r
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
feature_subquery AS (
    SELECT oid, value, name, version, fid AS feature_fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr, mg.delta_mag_g,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr, mr.delta_mag_r
FROM probability_subquery p
INNER JOIN object_subquery o ON p.oid = o.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
INNER JOIN feature_subquery f ON o.oid = f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,25.869852781295776,2025-04-28T23:47:46,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_subquery AS (
    SELECT oid, meanra, meandec, ndet
    FROM object
    WHERE deltajd >= 365
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag_g
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, (magmax_corr - magmin_corr) AS delta_mag_r
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
feature_subquery AS (
    SELECT oid, value, name, version, fid AS feature_fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr, mg.delta_mag_g,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr, mr.delta_mag_r
FROM probability_subquery p
INNER JOIN object_subquery o ON p.oid = o.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
INNER JOIN feature_subquery f ON o.oid = f.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.96929717063904,2025-05-20T11:11:07,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,2,"
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.probability > 0.6
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
time_covered_objects AS (
    SELECT o.oid
    FROM object o
    WHERE o.deltajd >= 365
),
sufficient_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.ndet >= 20
),
magnitude_variations AS (
    SELECT m.oid
    FROM magstat m
    WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
       OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
),
filtered_objects AS (
    SELECT DISTINCT a.oid
    FROM agn_objects a
    INNER JOIN time_covered_objects t ON a.oid = t.oid
    INNER JOIN sufficient_detections s ON a.oid = s.oid
    INNER JOIN magnitude_variations v ON a.oid = v.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr,
       (m.magmax_corr - m.magmin_corr) AS delta_mag, m.fid AS magstat_fid
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN feature f ON fo.oid = f.oid
INNER JOIN magstat m ON fo.oid = m.oid
WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
   OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,27.986515045166016,2025-04-28T23:48:14,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.probability > 0.6
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
time_covered_objects AS (
    SELECT o.oid
    FROM object o
    WHERE o.deltajd >= 365
),
sufficient_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.ndet >= 20
),
magnitude_variations_g AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1
),
magnitude_variations_r AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5
),
filtered_objects AS (
    SELECT DISTINCT a.oid
    FROM agn_objects a
    INNER JOIN time_covered_objects t ON a.oid = t.oid
    INNER JOIN sufficient_detections s ON a.oid = s.oid
    INNER JOIN magnitude_variations_g vg ON a.oid = vg.oid
    INNER JOIN magnitude_variations_r vr ON a.oid = vr.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr,
       (m.magmax_corr - m.magmin_corr) AS delta_mag, m.fid AS magstat_fid
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN feature f ON fo.oid = f.oid
INNER JOIN magstat m ON fo.oid = m.oid
WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
   OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",274.5155370235443,2025-05-20T11:15:49,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,3,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
feature_filtered AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, 
       o.meanra, o.meandec, o.ndet, 
       g.magmax_corr AS g_magmax_corr, g.magmin_corr AS g_magmin_corr, 
       r.magmax_corr AS r_magmax_corr, r.magmin_corr AS r_magmin_corr,
       (g.magmax_corr - g.magmin_corr) AS g_delta_mag,
       (r.magmax_corr - r.magmin_corr) AS r_delta_mag
FROM object_filtered o
INNER JOIN feature_filtered f ON o.oid = f.oid
INNER JOIN magstat_g g ON o.oid = g.oid
INNER JOIN magstat_r r ON o.oid = r.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.00185871124268,2025-04-28T23:48:38,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
magstat_filtered AS (
    SELECT oid
    FROM magstat
    WHERE ((fid = 1 AND magmax_corr - magmin_corr > 1) OR (fid = 2 AND magmax_corr - magmin_corr > 0.5))
      AND ndet >= 20
    GROUP BY oid
    HAVING COUNT(DISTINCT fid) = 2
),
feature_filtered AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid, 
       o.meanra, o.meandec, o.ndet, 
       g.magmax_corr AS g_magmax_corr, g.magmin_corr AS g_magmin_corr, 
       r.magmax_corr AS r_magmax_corr, r.magmin_corr AS r_magmin_corr,
       (g.magmax_corr - g.magmin_corr) AS g_delta_mag,
       (r.magmax_corr - r.magmin_corr) AS r_delta_mag
FROM object_filtered o
INNER JOIN feature_filtered f ON o.oid = f.oid
INNER JOIN magstat_filtered m ON o.oid = m.oid
INNER JOIN magstat g ON o.oid = g.oid AND g.fid = 1
INNER JOIN magstat r ON o.oid = r.oid AND r.fid = 2
WHERE g.magmax_corr - g.magmin_corr > 1
  AND r.magmax_corr - r.magmin_corr > 0.5
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.62258887290955,2025-05-20T11:20:11,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,4,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
time_coverage_subquery AS (
    SELECT oid
    FROM object
    WHERE deltajd >= 365
),
detection_count_subquery AS (
    SELECT oid
    FROM magstat
    WHERE ndet >= 20
),
magnitude_variation_g AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
),
magnitude_variation_r AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
),
valid_objects AS (
    SELECT oid
    FROM probability_subquery
    INTERSECT
    SELECT oid
    FROM time_coverage_subquery
    INTERSECT
    SELECT oid
    FROM detection_count_subquery
    INTERSECT
    SELECT oid
    FROM magnitude_variation_g
    INTERSECT
    SELECT oid
    FROM magnitude_variation_r
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg_g.magmax_corr AS g_magmax_corr, mg_g.magmin_corr AS g_magmin_corr,
       mg_g.magmax_corr - mg_g.magmin_corr AS g_delta_mag,
       mg_r.magmax_corr AS r_magmax_corr, mg_r.magmin_corr AS r_magmin_corr,
       mg_r.magmax_corr - mg_r.magmin_corr AS r_delta_mag
FROM valid_objects vo
JOIN object o ON vo.oid = o.oid
JOIN feature f ON vo.oid = f.oid
JOIN magstat mg_g ON vo.oid = mg_g.oid AND mg_g.fid = 1
JOIN magstat mg_r ON vo.oid = mg_r.oid AND mg_r.fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,26.84137845039368,2025-04-28T23:49:05,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
time_coverage_subquery AS (
    SELECT oid
    FROM object
    WHERE deltajd >= 365
),
detection_count_subquery AS (
    SELECT oid
    FROM magstat
    WHERE ndet >= 20
),
magnitude_variation_g AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
),
magnitude_variation_r AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
),
valid_objects AS (
    SELECT oid
    FROM probability_subquery
    INTERSECT
    SELECT oid
    FROM time_coverage_subquery
    INTERSECT
    SELECT oid
    FROM detection_count_subquery
    INTERSECT
    SELECT oid
    FROM magnitude_variation_g
    INTERSECT
    SELECT oid
    FROM magnitude_variation_r
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg_g.magmax_corr AS g_magmax_corr, mg_g.magmin_corr AS g_magmin_corr,
       mg_g.magmax_corr - mg_g.magmin_corr AS g_delta_mag,
       mg_r.magmax_corr AS r_magmax_corr, mg_r.magmin_corr AS r_magmin_corr,
       mg_r.magmax_corr - mg_r.magmin_corr AS r_delta_mag
FROM valid_objects vo
JOIN object o ON vo.oid = o.oid
JOIN feature f ON vo.oid = f.oid
JOIN magstat mg_g ON vo.oid = mg_g.oid AND mg_g.fid = 1
JOIN magstat mg_r ON vo.oid = mg_r.oid AND mg_r.fid = 2
WHERE o.corrected = TRUE
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.14703798294067,2025-05-20T11:24:29,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,5,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
features_filtered AS (
    SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS r_delta_mag
FROM object_filtered o
INNER JOIN features_filtered f ON o.oid = f.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,27.052191257476807,2025-04-28T23:49:32,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
magstat_filtered AS (
    SELECT oid
    FROM magstat
    WHERE (fid = 1 AND magmax_corr - magmin_corr > 1 AND ndet >= 20)
       OR (fid = 2 AND magmax_corr - magmin_corr > 0.5 AND ndet >= 20)
    GROUP BY oid
    HAVING COUNT(DISTINCT fid) = 2
),
features_filtered AS (
    SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS r_delta_mag
FROM object_filtered o
INNER JOIN features_filtered f ON o.oid = f.oid
INNER JOIN magstat_filtered mf ON o.oid = mf.oid
INNER JOIN magstat mg ON o.oid = mg.oid AND mg.fid = 1
INNER JOIN magstat mr ON o.oid = mr.oid AND mr.fid = 2
WHERE mg.magmax_corr - mg.magmin_corr > 1
  AND mr.magmax_corr - mr.magmin_corr > 0.5
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.92270731925964,2025-05-20T11:28:51,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,6,"
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.probability > 0.6
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
time_covered_objects AS (
    SELECT o.oid
    FROM object o
    WHERE o.deltajd >= 365
),
sufficient_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.ndet >= 20
),
magnitude_variations AS (
    SELECT m.oid
    FROM magstat m
    WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
       OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
),
filtered_objects AS (
    SELECT DISTINCT o.oid
    FROM agn_objects o
    INNER JOIN time_covered_objects tco ON o.oid = tco.oid
    INNER JOIN sufficient_detections sd ON o.oid = sd.oid
    INNER JOIN magnitude_variations mv ON o.oid = mv.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr,
       (m.magmax_corr - m.magmin_corr) AS delta_mag, m.fid AS magstat_fid
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN feature f ON fo.oid = f.oid
INNER JOIN magstat m ON fo.oid = m.oid
WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
   OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,25.025559663772583,2025-04-28T23:49:57,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH agn_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'AGN'
      AND p.probability > 0.6
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier'
),
time_covered_objects AS (
    SELECT o.oid
    FROM object o
    WHERE o.deltajd >= 365
),
sufficient_detections AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.ndet >= 20
),
magnitude_variations_g AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1
),
magnitude_variations_r AS (
    SELECT m.oid
    FROM magstat m
    WHERE m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5
),
filtered_objects AS (
    SELECT DISTINCT o.oid
    FROM agn_objects o
    INNER JOIN time_covered_objects tco ON o.oid = tco.oid
    INNER JOIN sufficient_detections sd ON o.oid = sd.oid
    INNER JOIN magnitude_variations_g mvg ON o.oid = mvg.oid
    INNER JOIN magnitude_variations_r mvr ON o.oid = mvr.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       m.magmax_corr, m.magmin_corr,
       (m.magmax_corr - m.magmin_corr) AS delta_mag, m.fid AS magstat_fid
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN feature f ON fo.oid = f.oid
INNER JOIN magstat m ON fo.oid = m.oid
WHERE (m.fid = 1 AND m.magmax_corr - m.magmin_corr > 1)
   OR (m.fid = 2 AND m.magmax_corr - m.magmin_corr > 0.5)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.8930721282959,2025-05-20T11:33:14,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,7,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
feature_subquery AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
),
object_subquery AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    WHERE o.deltajd >= 365
      AND o.oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS r_delta_mag
FROM object_subquery o
INNER JOIN feature_subquery f ON o.oid = f.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,26.85095524787903,2025-04-29T11:57:04,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_subquery AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    WHERE o.deltajd >= 365
      AND o.oid IN (SELECT oid FROM probability_subquery)
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
      AND ndet >= 20
      AND oid IN (SELECT oid FROM object_subquery)
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
      AND ndet >= 20
      AND oid IN (SELECT oid FROM object_subquery)
),
feature_subquery AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM object_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS r_delta_mag
FROM object_subquery o
INNER JOIN feature_subquery f ON o.oid = f.oid
INNER JOIN magstat_g mg ON o.oid = mg.oid
INNER JOIN magstat_r mr ON o.oid = mr.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.71680402755737,2025-05-20T11:37:32,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,8,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
feature_subquery AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM probability_subquery)
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND ndet >= 20
      AND (magmax_corr - magmin_corr) > 1
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND ndet >= 20
      AND (magmax_corr - magmin_corr) > 0.5
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    WHERE o.deltajd >= 365
      AND o.oid IN (SELECT oid FROM probability_subquery)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       (mg.magmax_corr - mg.magmin_corr) AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       (mr.magmax_corr - mr.magmin_corr) AS r_delta_mag
FROM object_filtered o
JOIN feature_subquery f ON o.oid = f.oid
JOIN magstat_g mg ON o.oid = mg.oid
JOIN magstat_r mr ON o.oid = mr.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,29.988709926605225,2025-04-29T11:57:34,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    WHERE o.deltajd >= 365
      AND o.oid IN (SELECT oid FROM probability_subquery)
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 1
      AND ndet >= 20
      AND (magmax_corr - magmin_corr) > 1
      AND oid IN (SELECT oid FROM object_filtered)
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr, fid
    FROM magstat
    WHERE fid = 2
      AND ndet >= 20
      AND (magmax_corr - magmin_corr) > 0.5
      AND oid IN (SELECT oid FROM object_filtered)
),
feature_subquery AS (
    SELECT oid, value, name, version, fid
    FROM feature
    WHERE oid IN (SELECT oid FROM object_filtered)
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr AS g_magmax_corr, mg.magmin_corr AS g_magmin_corr,
       (mg.magmax_corr - mg.magmin_corr) AS g_delta_mag,
       mr.magmax_corr AS r_magmax_corr, mr.magmin_corr AS r_magmin_corr,
       (mr.magmax_corr - mr.magmin_corr) AS r_delta_mag
FROM object_filtered o
JOIN feature_subquery f ON o.oid = f.oid
JOIN magstat_g mg ON o.oid = mg.oid
JOIN magstat_r mr ON o.oid = mr.oid
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.39148950576785,2025-05-20T11:41:52,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,9,"
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT oid
    FROM object
    WHERE deltajd >= 365
      AND ndet >= 20
),
magstat_g AS (
    SELECT oid
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
),
magstat_r AS (
    SELECT oid
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
),
filtered_oids AS (
    SELECT oid
    FROM probability_filtered
    INTERSECT
    SELECT oid
    FROM object_filtered
    INTERSECT
    SELECT oid
    FROM magstat_g
    INTERSECT
    SELECT oid
    FROM magstat_r
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr, mg.magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS delta_mag,
       mr.magmax_corr, mr.magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS delta_mag_r
FROM filtered_oids fo
JOIN object o ON fo.oid = o.oid
JOIN feature f ON fo.oid = f.oid
JOIN magstat mg ON fo.oid = mg.oid AND mg.fid = 1
JOIN magstat mr ON fo.oid = mr.oid AND mr.fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.95455765724182,2025-04-29T11:57:58,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_filtered AS (
    SELECT oid
    FROM object
    WHERE deltajd >= 365
      AND ndet >= 20
),
magstat_g AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 1
      AND magmax_corr - magmin_corr > 1
),
magstat_r AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
      AND magmax_corr - magmin_corr > 0.5
),
filtered_oids AS (
    SELECT pf.oid
    FROM probability_filtered pf
    JOIN object_filtered of ON pf.oid = of.oid
    JOIN magstat_g mg ON pf.oid = mg.oid
    JOIN magstat_r mr ON pf.oid = mr.oid
)
SELECT o.oid, f.value, f.name, f.version, f.fid AS feature_fid,
       o.meanra, o.meandec, o.ndet,
       mg.magmax_corr, mg.magmin_corr,
       mg.magmax_corr - mg.magmin_corr AS delta_mag_g,
       mr.magmax_corr, mr.magmin_corr,
       mr.magmax_corr - mr.magmin_corr AS delta_mag_r
FROM filtered_oids fo
JOIN object o ON fo.oid = o.oid
JOIN feature f ON fo.oid = f.oid
JOIN magstat mg ON fo.oid = mg.oid AND mg.fid = 1
JOIN magstat mr ON fo.oid = mr.oid AND mr.fid = 2
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",263.3253827095032,2025-05-20T11:46:22,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,1,10,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
object_subquery AS (
    SELECT o.oid, o.meanra, o.meandec, o.ndet
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.deltajd >= 365
),
magstat_subquery AS (
    SELECT m.oid, 
           MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) AS magmax_g,
           MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END) AS magmin_g,
           MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) AS magmax_r,
           MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END) AS magmin_r
    FROM magstat m
    INNER JOIN object_subquery o ON m.oid = o.oid
    WHERE m.ndet >= 20
    GROUP BY m.oid
    HAVING (MAX(CASE WHEN m.fid = 1 THEN m.magmax_corr END) - MIN(CASE WHEN m.fid = 1 THEN m.magmin_corr END)) > 1
       AND (MAX(CASE WHEN m.fid = 2 THEN m.magmax_corr END) - MIN(CASE WHEN m.fid = 2 THEN m.magmin_corr END)) > 0.5
),
feature_subquery AS (
    SELECT f.oid, f.value, f.name, f.version, f.fid AS feature_fid
    FROM feature f
    INNER JOIN probability_subquery p ON f.oid = p.oid
)
SELECT o.oid, f.value, f.name, f.version, f.feature_fid, o.meanra, o.meandec, o.ndet,
       m.magmax_g, m.magmin_g, (m.magmax_g - m.magmin_g) AS delta_mag_g,
       m.magmax_r, m.magmin_r, (m.magmax_r - m.magmin_r) AS delta_mag_r
FROM object_subquery o
INNER JOIN magstat_subquery m ON o.oid = m.oid
INNER JOIN feature_subquery f ON o.oid = f.oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,29.711732149124146,2025-04-29T11:58:27,"[                  oid       value          name                version  \
0        ZTF17aabijgi   59.193479         gal_b  lc_classifier_1.2.1-P   
1        ZTF17aabijgi  197.129565         gal_l  lc_classifier_1.2.1-P   
2        ZTF17aabijgi   -0.277531       g-r_max  lc_classifier_1.2.1-P   
3        ZTF17aabijgi    0.323918      g-r_mean  lc_classifier_1.2.1-P   
4        ZTF17aabijgi    0.056372  g-r_max_corr  lc_classifier_1.2.1-P   
...               ...         ...           ...                    ...   
2403728  ZTF23abihzqw    2.119052    mean_chinr                 27.4.0   
2403729  ZTF23abihzqw  528.641739      Timespan                 27.4.0   
2403730  ZTF23abihzqw    0.633514  Coordinate_x                 27.4.0   
2403731  ZTF23abihzqw    0.748131  Coordinate_y                 27.4.0   
2403732  ZTF23abihzqw   -0.197382  Coordinate_z                 27.4.0   

         feature_fid      meanra    meandec  ndet   magmax_g   magmin_g  \
0                  0  157.746229  31.048823   430  17.796800  16.126352   
1                  0  157.746229  31.048823   430  17.796800  16.126352   
2                 12  157.746229  31.048823   430  17.796800  16.126352   
3                 12  157.746229  31.048823   430  17.796800  16.126352   
4                 12  157.746229  31.048823   430  17.796800  16.126352   
...              ...         ...        ...   ...        ...        ...   
2403728           12   49.742215 -11.383920   112  19.801842  18.482588   
2403729            0   49.742215 -11.383920   112  19.801842  18.482588   
2403730            0   49.742215 -11.383920   112  19.801842  18.482588   
2403731            0   49.742215 -11.383920   112  19.801842  18.482588   
2403732            0   49.742215 -11.383920   112  19.801842  18.482588   

         delta_mag_g   magmax_r   magmin_r  delta_mag_r  
0           1.670448  17.206097  16.069980     1.136116  
1           1.670448  17.206097  16.069980     1.136116  
2           1.670448  17.206097  16.069980     1.136116  
3           1.670448  17.206097  16.069980     1.136116  
4           1.670448  17.206097  16.069980     1.136116  
...              ...        ...        ...          ...  
2403728     1.319254  18.933052  18.248608     0.684444  
2403729     1.319254  18.933052  18.248608     0.684444  
2403730     1.319254  18.933052  18.248608     0.684444  
2403731     1.319254  18.933052  18.248608     0.684444  
2403732     1.319254  18.933052  18.248608     0.684444  

[2403733 rows x 14 columns]]",,254.08570671081543,2025-05-20T11:50:43,135.71266968325793,9.152430823223712e-05,0.6666666666666666,0.5714285714285714,0.0,0.0
0.16.3,,,16,0,"SELECT
    sq.oid, sq.probability, sq.diffmaglim, sq.fid, sq.mjd,
    magstat.fid as magstat_fid, magstat.dmdt_first
FROM
  (
SELECT
   non_detection.fid, non_detection.diffmaglim, non_detection.mjd, obj_oids.oid, obj_oids.probability
FROM
  (
SELECT
    object.oid, probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='stamp_classifier'
    AND probability.class_name='SN'
    AND probability.ranking=1
    AND object.firstmjd > 60188.0
    AND object.firstmjd < 60189.0
) as obj_oids
    INNER JOIN
    non_detection ON non_detection.oid = obj_oids.oid
) AS sq
  INNER JOIN magstat
  ON sq.oid = magstat.oid
WHERE
  magstat.dmdt_first < -0.25
ORDER BY oid
LIMIT 100",,,,,"[             oid  probability  diffmaglim  fid           mjd  magstat_fid  \
0   ZTF18aaiaclp     0.520409     20.4159    1  60161.201343            2   
1   ZTF18aaiaclp     0.520409     20.5201    1  60161.206146            2   
2   ZTF18aaiaclp     0.520409     19.7568    1  60161.283750            2   
3   ZTF18aaiaclp     0.520409     19.5815    1  60163.299884            2   
4   ZTF18aaiaclp     0.520409     19.7775    1  60163.300359            2   
..           ...          ...         ...  ...           ...          ...   
95  ZTF18aaleydm     0.613368     16.7941    2  60158.233981            2   
96  ZTF18aaleydm     0.613368     19.9087    2  60161.343796            2   
97  ZTF18aaleydm     0.613368     20.2772    2  60163.288322            2   
98  ZTF18aaleydm     0.613368     20.6824    2  60165.215347            2   
99  ZTF18aaleydm     0.613368     20.2314    2  60169.290069            2   

    dmdt_first  
0    -0.445361  
1    -0.445361  
2    -0.445361  
3    -0.445361  
4    -0.445361  
..         ...  
95   -0.830610  
96   -0.830610  
97   -0.830610  
98   -0.830610  
99   -0.830610  

[100 rows x 7 columns]]",,8.404773235321045,2025-05-20T11:51:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,16,1,"
WITH ProbSubquery AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN detection d ON o.oid = d.oid
    WHERE o.firstmjd BETWEEN 59835 AND 59836  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.dmdt_first, m.fid AS magstat_fid
    FROM magstat m
    WHERE m.dmdt_first IS NOT NULL
),
CombinedSubquery AS (
    SELECT p.oid, o.firstmjd, m.dmdt_first, m.magstat_fid
    FROM ProbSubquery p
    INNER JOIN ObjectSubquery o ON p.oid = o.oid
    INNER JOIN FastRisersSubquery m ON p.oid = m.oid
),
FinalResult AS (
    SELECT c.oid, prob.probability, nd.fid, d.diffmaglim, c.magstat_fid, c.dmdt_first
    FROM CombinedSubquery c
    INNER JOIN probability prob ON c.oid = prob.oid
    INNER JOIN non_detection nd ON c.oid = nd.oid
    INNER JOIN detection d ON c.oid = d.oid
    WHERE prob.classifier_name = 'stamp_classifier'
    ORDER BY c.oid
    LIMIT 100
)
SELECT * FROM FinalResult
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.557520151138306,2025-04-29T11:58:50,"[             oid  probability  fid  diffmaglim  magstat_fid  dmdt_first
0   ZTF18adhqsgr     0.182704    1   18.866247            2   -0.331652
1   ZTF18adhqsgr     0.050225    1   18.866247            2   -0.331652
2   ZTF18adhqsgr     0.219864    1   18.866247            2   -0.331652
3   ZTF18adhqsgr     0.371183    1   18.866247            2   -0.331652
4   ZTF18adhqsgr     0.176023    1   18.866247            2   -0.331652
..           ...          ...  ...         ...          ...         ...
95  ZTF18adldnpk     0.153064    1   19.132053            1   -0.558708
96  ZTF18adldnpk     0.058398    1   19.132053            1   -0.558708
97  ZTF18adldnpk     0.203851    1   19.132053            1   -0.558708
98  ZTF18adldnpk     0.356635    1   19.132053            1   -0.558708
99  ZTF18adldnpk     0.228051    1   19.132053            1   -0.558708

[100 rows x 6 columns]]",,139.3438262939453,2025-05-20T11:53:27,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,2,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND ranking = 1
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 59832 AND 59834  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.dmdt_first, m.fid AS magstat_fid
    FROM magstat m
    INNER JOIN ObjectSubquery os ON m.oid = os.oid
    WHERE m.dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
DetectionSubquery AS (
    SELECT d.oid, d.fid, d.diffmaglim, d.mjd
    FROM detection d
    INNER JOIN FastRisersSubquery fr ON d.oid = fr.oid
),
NonDetectionSubquery AS (
    SELECT nd.oid, nd.fid, nd.diffmaglim, nd.mjd
    FROM non_detection nd
    INNER JOIN FastRisersSubquery fr ON nd.oid = fr.oid
),
CombinedLightCurves AS (
    SELECT oid, fid, diffmaglim, mjd FROM DetectionSubquery
    UNION
    SELECT oid, fid, diffmaglim, mjd FROM NonDetectionSubquery
)
SELECT fr.oid, p.probability, clc.fid, clc.diffmaglim, clc.mjd, fr.magstat_fid, fr.dmdt_first
FROM FastRisersSubquery fr
INNER JOIN ProbSubquery p ON fr.oid = p.oid
INNER JOIN CombinedLightCurves clc ON fr.oid = clc.oid
ORDER BY fr.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,23.131828546524048,2025-04-29T11:59:13,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND ranking = 1
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 60154 AND 60156  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.dmdt_first, m.fid AS magstat_fid
    FROM magstat m
    INNER JOIN ObjectSubquery os ON m.oid = os.oid
    WHERE m.dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
NonDetectionSubquery AS (
    SELECT nd.oid, nd.fid, nd.diffmaglim, nd.mjd
    FROM non_detection nd
    INNER JOIN FastRisersSubquery fr ON nd.oid = fr.oid
),
CombinedLightCurves AS (
    SELECT oid, fid, diffmaglim, mjd FROM NonDetectionSubquery
)
SELECT fr.oid, p.probability, clc.fid, clc.diffmaglim, clc.mjd, fr.magstat_fid, fr.dmdt_first
FROM FastRisersSubquery fr
INNER JOIN ProbSubquery p ON fr.oid = p.oid
INNER JOIN CombinedLightCurves clc ON fr.oid = clc.oid
ORDER BY fr.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.52015686035156,2025-05-20T11:55:41,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,16,3,"
WITH highest_probability_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Julian dates for the first 2 days of September 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL
),
combined_conditions AS (
    SELECT hp.oid, hp.probability, fd.magstat_fid, fd.dmdt_first
    FROM highest_probability_sn hp
    INNER JOIN first_detection_september fs ON hp.oid = fs.oid
    INNER JOIN fast_risers fd ON hp.oid = fd.oid
),
final_selection AS (
    SELECT c.oid, c.probability, d.fid, d.diffmaglim, nd.fid AS non_detection_fid, nd.diffmaglim AS non_detection_diffmaglim, c.magstat_fid, c.dmdt_first
    FROM combined_conditions c
    INNER JOIN detection d ON c.oid = d.oid
    INNER JOIN non_detection nd ON c.oid = nd.oid
)
SELECT *
FROM final_selection
ORDER BY oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.38938474655152,2025-04-29T11:59:34,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH highest_probability_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 60200 AND 60202  -- Corrected Julian dates for the first 2 days of September 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL
),
combined_conditions AS (
    SELECT hp.oid, hp.probability, fr.magstat_fid, fr.dmdt_first
    FROM highest_probability_sn hp
    INNER JOIN first_detection_september fs ON hp.oid = fs.oid
    INNER JOIN fast_risers fr ON hp.oid = fr.oid
),
final_selection AS (
    SELECT c.oid, c.probability, d.fid, d.diffmaglim, nd.fid AS non_detection_fid, nd.diffmaglim AS non_detection_diffmaglim, c.magstat_fid, c.dmdt_first
    FROM combined_conditions c
    LEFT JOIN detection d ON c.oid = d.oid
    LEFT JOIN non_detection nd ON c.oid = nd.oid
)
SELECT *
FROM final_selection
ORDER BY oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.78070878982544,2025-05-20T11:57:57,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,16,4,"
WITH highest_prob_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming a non-null dmdt_first indicates a fast riser
),
light_curves AS (
    SELECT oid, fid, mjd, diffmaglim
    FROM detection
    UNION
    SELECT oid, fid, mjd, diffmaglim
    FROM non_detection
)
SELECT o.oid, hp.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM highest_prob_sn hp
INNER JOIN first_detection_september fd ON hp.oid = fd.oid
INNER JOIN fast_risers fr ON hp.oid = fr.oid
INNER JOIN light_curves lc ON hp.oid = lc.oid
ORDER BY o.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,18.717886209487915,2025-04-29T11:59:52,"[             oid  probability  fid  diffmaglim  magstat_fid  dmdt_first
0   ZTF17aablcym     0.346393    2     19.5153            2   -0.684187
1   ZTF17aablcym     0.346393    2     19.4186            2   -0.684187
2   ZTF17aablcym     0.346393    2     19.5014            2   -0.684187
3   ZTF17aablcym     0.346393    2     19.3641            2   -0.684187
4   ZTF17aablcym     0.346393    2     19.2112            2   -0.684187
..           ...          ...  ...         ...          ...         ...
95  ZTF18aacstrz     0.849426    2     20.3577            2   -0.437475
96  ZTF18aacstrz     0.849426    2     20.3427            2   -0.437475
97  ZTF18aacstrz     0.849426    2     20.3031            2   -0.437475
98  ZTF18aacstrz     0.849426    2     19.8559            2   -0.437475
99  ZTF18aacstrz     0.849426    2     19.5992            2   -0.437475

[100 rows x 6 columns]]",,11.096883296966553,2025-05-20T11:58:12,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,5,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND ranking = 1
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 59832 AND 59833  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
    FROM magstat m
    INNER JOIN ObjectSubquery os ON m.oid = os.oid
    WHERE m.dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
LightCurvesSubquery AS (
    SELECT d.oid, d.fid, d.diffmaglim, d.mjd
    FROM detection d
    INNER JOIN ObjectSubquery os ON d.oid = os.oid
    UNION
    SELECT nd.oid, nd.fid, nd.diffmaglim, nd.mjd
    FROM non_detection nd
    INNER JOIN ObjectSubquery os ON nd.oid = os.oid
)
SELECT os.oid, p.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM ObjectSubquery os
INNER JOIN ProbSubquery p ON os.oid = p.oid
INNER JOIN FastRisersSubquery fr ON os.oid = fr.oid
INNER JOIN LightCurvesSubquery lc ON os.oid = lc.oid
ORDER BY os.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.14790153503418,2025-04-29T12:00:23,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND ranking = 1
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 60154 AND 60155  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
    FROM magstat m
    INNER JOIN ObjectSubquery os ON m.oid = os.oid
    WHERE m.dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
LightCurvesSubquery AS (
    SELECT d.oid, d.fid, d.diffmaglim, d.mjd
    FROM detection d
    INNER JOIN ObjectSubquery os ON d.oid = os.oid
    UNION
    SELECT nd.oid, nd.fid, nd.diffmaglim, nd.mjd
    FROM non_detection nd
    INNER JOIN ObjectSubquery os ON nd.oid = os.oid
)
SELECT os.oid, p.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM ObjectSubquery os
INNER JOIN ProbSubquery p ON os.oid = p.oid
INNER JOIN FastRisersSubquery fr ON os.oid = fr.oid
INNER JOIN LightCurvesSubquery lc ON os.oid = lc.oid
ORDER BY os.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.27574968338013,2025-05-20T12:00:27,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,16,6,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
),
ObjectSubquery AS (
    SELECT o.oid, o.firstmjd
    FROM object o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    WHERE o.firstmjd BETWEEN 59832 AND 59833  -- First 2 days of September 2023
),
MagstatSubquery AS (
    SELECT m.oid, m.fid AS magstat_fid, m.dmdt_first
    FROM magstat m
    INNER JOIN ObjectSubquery o ON m.oid = o.oid
    WHERE m.dmdt_first IS NOT NULL  -- Qualify as fast risers
),
FinalQuery AS (
    SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.magstat_fid, m.dmdt_first
    FROM ObjectSubquery o
    INNER JOIN ProbSubquery p ON o.oid = p.oid
    LEFT JOIN detection d ON o.oid = d.oid
    LEFT JOIN non_detection nd ON o.oid = nd.oid
    INNER JOIN MagstatSubquery m ON o.oid = m.oid
    ORDER BY o.oid
    LIMIT 100
)
SELECT * FROM FinalQuery
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,27.73988914489746,2025-04-29T12:00:50,"[Empty DataFrame
Columns: [oid, probability, fid, diffmaglim, magstat_fid, dmdt_first]
Index: []]",,130.01574754714966,2025-05-20T12:02:41,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,7,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
),
ObjectSubquery AS (
    SELECT oid
    FROM object
    WHERE firstmjd >= 59800 AND firstmjd < 59802  -- First 2 days of September 2023
),
FastRisersSubquery AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming fast risers have a non-null dmdt_first
),
DetectionSubquery AS (
    SELECT oid, fid, diffmaglim
    FROM detection
),
NonDetectionSubquery AS (
    SELECT oid, fid, diffmaglim
    FROM non_detection
)
SELECT o.oid, p.probability, COALESCE(d.fid, nd.fid) AS fid, COALESCE(d.diffmaglim, nd.diffmaglim) AS diffmaglim, 
       fr.magstat_fid, fr.dmdt_first
FROM ProbSubquery p
INNER JOIN ObjectSubquery o ON p.oid = o.oid
INNER JOIN FastRisersSubquery fr ON o.oid = fr.oid
LEFT JOIN DetectionSubquery d ON o.oid = d.oid
LEFT JOIN NonDetectionSubquery nd ON o.oid = nd.oid
ORDER BY o.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,24.837432861328125,2025-04-29T12:01:15,"[             oid  probability  fid  diffmaglim  magstat_fid  dmdt_first
0   ZTF18adhqsgr     0.371183    1     19.9850            2   -0.331652
1   ZTF18adhqsgr     0.371183    1     20.2589            2   -0.331652
2   ZTF18adhqsgr     0.371183    1     20.0762            2   -0.331652
3   ZTF18adhqsgr     0.371183    1     20.5440            2   -0.331652
4   ZTF18adhqsgr     0.371183    1     20.4704            2   -0.331652
..           ...          ...  ...         ...          ...         ...
95  ZTF18adldnpk     0.356635    2     20.8644            2   -1.305204
96  ZTF18adldnpk     0.356635    2     20.6728            2   -1.305204
97  ZTF18adldnpk     0.356635    2     20.2712            2   -1.305204
98  ZTF18adnnxlp     0.324971    1     19.8375            1   -2.316015
99  ZTF18adnnxlp     0.324971    1     18.3563            1   -2.316015

[100 rows x 6 columns]]",,13.119206190109251,2025-05-20T12:02:58,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,8,"
WITH stamp_classifier_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming non-null dmdt_first indicates fast risers
),
combined_criteria AS (
    SELECT sc.oid, sc.probability, fr.magstat_fid, fr.dmdt_first
    FROM stamp_classifier_sn sc
    INNER JOIN first_detection_september fd ON sc.oid = fd.oid
    INNER JOIN fast_risers fr ON sc.oid = fr.oid
),
light_curves AS (
    SELECT d.oid, d.fid, d.diffmaglim
    FROM detection d
    INNER JOIN combined_criteria cc ON d.oid = cc.oid
),
non_detections AS (
    SELECT nd.oid, nd.fid, nd.diffmaglim
    FROM non_detection nd
    INNER JOIN combined_criteria cc ON nd.oid = cc.oid
)
SELECT cc.oid, cc.probability, lc.fid, lc.diffmaglim, cc.magstat_fid, cc.dmdt_first
FROM combined_criteria cc
JOIN light_curves lc ON cc.oid = lc.oid
UNION
SELECT cc.oid, cc.probability, nd.fid, nd.diffmaglim, cc.magstat_fid, cc.dmdt_first
FROM combined_criteria cc
JOIN non_detections nd ON cc.oid = nd.oid
ORDER BY oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.401865005493164,2025-04-29T12:01:38,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH stamp_classifier_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 60154 AND 60156  -- Corrected MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming non-null dmdt_first indicates fast risers
),
combined_criteria AS (
    SELECT sc.oid, sc.probability, fr.magstat_fid, fr.dmdt_first
    FROM stamp_classifier_sn sc
    INNER JOIN first_detection_september fd ON sc.oid = fd.oid
    INNER JOIN fast_risers fr ON sc.oid = fr.oid
),
non_detections AS (
    SELECT nd.oid, nd.fid, nd.diffmaglim
    FROM non_detection nd
    INNER JOIN combined_criteria cc ON nd.oid = cc.oid
)
SELECT cc.oid, cc.probability, nd.fid, nd.diffmaglim, cc.magstat_fid, cc.dmdt_first
FROM combined_criteria cc
JOIN non_detections nd ON cc.oid = nd.oid
ORDER BY cc.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.44159984588623,2025-05-20T12:07:12,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,16,9,"
WITH ProbSubquery AS (
    SELECT oid, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
),
ObjectSubquery AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1st, 2023
),
MagstatSubquery AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first > 0  -- Assuming positive dmdt_first indicates fast risers
),
DetectionSubquery AS (
    SELECT oid, fid, diffmaglim
    FROM detection
),
NonDetectionSubquery AS (
    SELECT oid, fid, diffmaglim
    FROM non_detection
)
SELECT o.oid, p.probability, d.fid, d.diffmaglim, m.magstat_fid, m.dmdt_first
FROM ProbSubquery p
INNER JOIN ObjectSubquery o ON p.oid = o.oid
INNER JOIN MagstatSubquery m ON o.oid = m.oid
LEFT JOIN DetectionSubquery d ON o.oid = d.oid
LEFT JOIN NonDetectionSubquery nd ON o.oid = nd.oid
ORDER BY o.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.54674077033997,2025-04-29T12:02:00,"[             oid  probability  fid  diffmaglim  magstat_fid  dmdt_first
0   ZTF19abefque     0.420330    1     19.8350            2    0.008969
1   ZTF19abefque     0.420330    1     19.8697            2    0.008969
2   ZTF19abefque     0.420330    1     20.2178            2    0.008969
3   ZTF19abefque     0.420330    1     19.8693            2    0.008969
4   ZTF19abefque     0.420330    1     19.8071            2    0.008969
..           ...          ...  ...         ...          ...         ...
95  ZTF21abredlz     0.536512    1     17.4591            1    0.307330
96  ZTF21abredlz     0.536512    1     20.6325            1    0.307330
97  ZTF21abredlz     0.536512    1     20.5029            1    0.307330
98  ZTF21abredlz     0.536512    1     19.2707            1    0.307330
99  ZTF21abredlz     0.536512    1     19.2297            1    0.307330

[100 rows x 6 columns]]",,80.10653352737427,2025-05-20T12:08:36,0.0,0.0,0.8571428571428571,1.0,0.0,0.0
0.16.3,gpt-4o,v1,16,10,"
WITH highest_prob_sn AS (
    SELECT oid, probability
    FROM probability
    WHERE classifier_name = 'stamp_classifier'
      AND class_name = 'SN'
      AND ranking = 1
),
first_detection_september AS (
    SELECT oid
    FROM object
    WHERE firstmjd BETWEEN 59800 AND 59802  -- Assuming 59800 is the MJD for September 1, 2023
),
fast_risers AS (
    SELECT oid, fid AS magstat_fid, dmdt_first
    FROM magstat
    WHERE dmdt_first IS NOT NULL  -- Assuming a non-null dmdt_first indicates a fast riser
),
light_curves AS (
    SELECT oid, fid, diffmaglim
    FROM non_detection
    WHERE oid IN (SELECT oid FROM highest_prob_sn)
)
SELECT o.oid, hp.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM highest_prob_sn hp
INNER JOIN first_detection_september fd ON hp.oid = fd.oid
INNER JOIN fast_risers fr ON hp.oid = fr.oid
INNER JOIN light_curves lc ON hp.oid = lc.oid
ORDER BY o.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.89166045188904,2025-04-29T12:02:23,[None],"(psycopg2.errors.UndefinedTable) relation ""highest_prob_sn"" does not exist
LINE 3: FROM highest_prob_sn hp
             ^

[SQL: 
SELECT hp.oid, hp.probability, lc.fid, lc.diffmaglim, fr.magstat_fid, fr.dmdt_first
FROM highest_prob_sn hp
INNER JOIN first_detection_september fd ON hp.oid = fd.oid
INNER JOIN fast_risers fr ON hp.oid = fr.oid
INNER JOIN light_curves lc ON hp.oid = lc.oid
ORDER BY hp.oid
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.092021226882936,2025-05-20T12:08:49,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,19,0,"SELECT
    object.oid, object.meanra, object.meandec, object.ndet, object.firstmjd,
    probability.class_name, probability.probability
FROM object
INNER JOIN probability
ON object.oid=probability.oid

WHERE
object.firstMJD > 59274.0
AND object.firstMJD < 59305.0
AND object.ndet=1
AND probability.classifier_name='stamp_classifier'
AND probability.ranking=1
AND probability.class_name='asteroid'
AND probability.probability>0.7",,,,,"[                 oid      meanra    meandec  ndet      firstmjd class_name  \
0       ZTF21aanqqpm  135.918218  10.427065     1  59274.223137   asteroid   
1       ZTF21aanqjqc   84.403597  10.469394     1  59274.147813   asteroid   
2       ZTF21aanqpxc  157.088644  15.424231     1  59274.212454   asteroid   
3       ZTF21aanqpwg  156.660014  10.679691     1  59274.212454   asteroid   
4       ZTF21aanqpyv  154.226348  12.072717     1  59274.212454   asteroid   
...              ...         ...        ...   ...           ...        ...   
106745  ZTF21aarfnks  266.139917 -15.875644     1  59304.501123   asteroid   
106746  ZTF21aarfnii  277.897321 -13.554262     1  59304.501597   asteroid   
106747  ZTF21aarfngu  283.121650 -13.887437     1  59304.502072   asteroid   
106748  ZTF21aarfnpk  284.087880 -19.583865     1  59304.502072   asteroid   
106749  ZTF21aarfnqs  284.630585 -19.152846     1  59304.502072   asteroid   

        probability  
0          0.724635  
1          0.725208  
2          0.728637  
3          0.700072  
4          0.710321  
...             ...  
106745     1.000000  
106746     1.000000  
106747     1.000000  
106748     1.000000  
106749     1.000000  

[106750 rows x 7 columns]]",,34.01488304138184,2025-05-20T12:09:25,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,19,1,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59265 AND 59301  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1  -- Ensures only the most likely class is considered
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,29.277488231658936,2025-04-29T12:02:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combining the steps to optimize the query
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM object o
INNER JOIN (
    SELECT oid, class_name, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.7
      AND ranking = 1
) p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 59265 AND 59301  -- Corresponds to March 1st, 2021 to April 1st, 2021
  AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.0479500293732,2025-05-20T12:13:45,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,2,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,29.50137519836425,2025-04-29T12:03:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combine the steps to form the final optimized query
SELECT o.oid, o.meanra, o.meandec, o.ndet, o.firstmjd, p.class_name, p.probability
FROM object o
INNER JOIN (
    SELECT oid, class_name, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'stamp_classifier'
      AND class_name = 'asteroid'
      AND probability > 0.7
) p ON o.oid = p.oid
WHERE o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
  AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.5708630084992,2025-05-20T12:18:11,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,3,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.97780704498291,2025-04-29T12:03:39,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combine the steps into a single optimized query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE class_name = 'asteroid'
       AND classifier_name = 'stamp_classifier'
       AND probability > 0.7
       AND ranking = 1) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.067700624466,2025-05-20T12:22:42,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,4,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1  -- Only the most likely classification
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,19.50720500946045,2025-04-29T12:03:59,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Step 1: Filter the probability table first to get the relevant classifications
WITH filtered_probability AS (
    SELECT 
        oid, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        class_name = 'asteroid'
        AND classifier_name = 'stamp_classifier'
        AND probability > 0.7
        AND ranking = 1
)

-- Step 2: Join the filtered probability results with the object table
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    fp.class_name, 
    fp.probability
FROM 
    object o
INNER JOIN 
    filtered_probability fp ON o.oid = fp.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.32353568077087,2025-05-20T12:27:07,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,5,"
-- Query to retrieve objects that appeared between March 1st and April 1st, 2021,
-- have at most one detection, and are classified as asteroids by the stamp classifier
-- with a probability greater than 0.7.

SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319 -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1 -- Only consider the most likely classification
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,21.61373972892761,2025-04-29T12:04:20,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final optimized query combining the sub-query and main query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE class_name = 'asteroid'
       AND classifier_name = 'stamp_classifier'
       AND probability > 0.7
       AND ranking = 1) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319 -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",252.083194732666,2025-05-20T12:31:32,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,6,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.probability > 0.7
    AND p.ranking = 1
    AND p.classifier_name = 'stamp_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,21.49788808822632,2025-04-29T12:04:42,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combine the steps to form the final optimized query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE ranking = 1
       AND classifier_name = 'stamp_classifier'
       AND class_name = 'asteroid'
       AND probability > 0.7) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.14305758476257,2025-05-20T12:36:00,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,7,"
-- Query to retrieve objects that appeared between March 1st and April 1st of 2021,
-- have at most one detection, and are classified as asteroids by the stamp classifier
-- with a probability greater than 0.7.

SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319 -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1 -- Default condition for probability table
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.84388256072998,2025-04-29T12:04:59,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final optimized query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE class_name = 'asteroid'
       AND classifier_name = 'stamp_classifier'
       AND probability > 0.7
       AND ranking = 1) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319 -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",266.2244806289673,2025-05-20T12:40:44,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,8,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59265 AND 59301  -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1  -- Ensures only the most likely class is considered
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,33.252878189086914,2025-04-29T12:05:32,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combining the steps into a single optimized query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE ranking = 1
       AND classifier_name = 'stamp_classifier'
       AND class_name = 'asteroid'
       AND probability > 0.7) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59265 AND 59301  -- MJD for March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",254.89717936515808,2025-05-20T12:45:19,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,9,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,14.880460739135742,2025-04-29T12:05:47,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Step 1: Filter the probability table for the required conditions
WITH filtered_probability AS (
    SELECT oid, class_name, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.7
      AND ranking = 1
)

-- Step 2: Join the filtered probability with the object table
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    fp.class_name, 
    fp.probability
FROM 
    object o
INNER JOIN 
    filtered_probability fp ON o.oid = fp.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- March 1st, 2021 to April 1st, 2021 in MJD
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.10796213150024,2025-05-20T12:49:48,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,19,10,"
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.probability > 0.7
    AND p.ranking = 1  -- Only consider the most likely classifications
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,16.352998971939087,2025-04-29T12:06:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final Query: Combine the steps into a single optimized query
SELECT 
    o.oid, 
    o.meanra, 
    o.meandec, 
    o.ndet, 
    o.firstmjd, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT oid, class_name, probability
     FROM probability
     WHERE class_name = 'asteroid'
       AND classifier_name = 'stamp_classifier'
       AND probability > 0.7
       AND ranking = 1) p ON o.oid = p.oid
WHERE 
    o.firstmjd BETWEEN 59288 AND 59319  -- Corresponds to March 1st, 2021 to April 1st, 2021
    AND o.ndet <= 1
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",253.03621196746823,2025-05-20T12:54:16,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,14,0,"
SELECT
    det.oid, det.candid,
    det.drb, det.fid,
    det.mjd, det.magpsf, det.sigmapsf,
    det.has_stamp,
    ps1.sgscore1, ps1.distpsnr1
FROM
    (SELECT *
    FROM detection
    WHERE oid in ('ZTF23aavzgjg','ZTF23aaynzyk','ZTF23aavqxos','ZTF23aaknyni','ZTF23aavsdtc','ZTF18aandkua','ZTF23aaxfewt','ZTF23aavshwi','ZTF22aawasao','ZTF23aaxgvnt')
    ) as det
    INNER JOIN
    (SELECT *
    FROM ps1_ztf
    WHERE oid in ('ZTF23aavzgjg','ZTF23aaynzyk','ZTF23aavqxos','ZTF23aaknyni','ZTF23aavsdtc','ZTF18aandkua','ZTF23aaxfewt','ZTF23aavshwi','ZTF22aawasao','ZTF23aaxgvnt')
    ) as ps1
    ON det.oid=ps1.oid
WHERE
     (ps1.sgscore1 < 0.5 OR ps1.distpsnr1 > 1)
    AND det.drb > 0.5
",,,,,"[              oid               candid       drb  fid           mjd  \
0    ZTF18aandkua  2434183903015015056  0.994159    1  60188.183901   
1    ZTF18aandkua  2756269351915010002  0.993011    2  60510.269352   
2    ZTF18aandkua  2772265531915010009  0.850113    2  60526.265532   
3    ZTF18aandkua  2979404491915010015  0.696538    1  60733.404491   
4    ZTF18aandkua  2434183903015015056  0.994159    1  60188.183901   
..            ...                  ...       ...  ...           ...   
168  ZTF23aavzgjg  2440173344115015014  0.999983    2  60194.173345   
169  ZTF23aavzgjg  2442207534115015008  0.998886    2  60196.207535   
170  ZTF23aaxfewt  2415290061315015127  0.999312    2  60169.290069   
171  ZTF23aaxgvnt  2415360251315015012  0.866198    1  60169.360255   
172  ZTF23aaynzyk  2419492286015015010  0.999918    2  60173.492280   

        magpsf  sigmapsf  has_stamp  sgscore1  distpsnr1  
0    17.907194  0.180156       True  0.075167   0.326697  
1    19.379133  0.161114       True  0.075167   0.326697  
2    19.641638  0.183068       True  0.075167   0.326697  
3    18.887863  0.175351       True  0.075167   0.326697  
4    17.907194  0.180156       True  0.075167   1.234589  
..         ...       ...        ...       ...        ...  
168  19.315939  0.112186       True  0.500000   8.032105  
169  19.268260  0.174212       True  0.500000   8.032105  
170  18.205078  0.063636       True  0.134304   0.635949  
171  19.366661  0.139281       True  0.987083   1.361963  
172  20.241919  0.203988       True  0.500000   1.575583  

[173 rows x 10 columns]]",,4.02186393737793,2025-05-20T12:54:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,14,1,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
                      'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
                      'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
ORDER BY 
    detection.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.79786443710327,2025-04-29T12:06:24,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,11.087778091430664,2025-05-20T12:54:37,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,2,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,26.72788381576538,2025-04-29T12:06:51,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,10.93786597251892,2025-05-20T12:54:53,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,3,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.magpsf, 
    d.sigmapsf, 
    d.has_stamp, 
    d.drb, 
    p.sgscore1, 
    p.distpsnr1
FROM 
    detection d
INNER JOIN 
    ps1_ztf p ON d.oid = p.oid
WHERE 
    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND d.drb > 0.5
    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,24.335001468658447,2025-04-29T12:07:15,"[             oid               candid  fid           mjd     magpsf  sigmapsf  \
0   ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1   ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2   ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3   ZTF23aavshwi  2407423334015015007    1  60161.423333  18.688477  0.096587   
4   ZTF23aavshwi  2407462734015015009    2  60161.462732  18.336126  0.060204   
5   ZTF23aavshwi  2414423484015015018    1  60168.423484  19.307604  0.094521   
6   ZTF23aavshwi  2414445984015015007    2  60168.445984  18.701996  0.070969   
7   ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
8   ZTF23aavshwi  2416422074015015019    2  60170.422072  18.754047  0.061804   
9   ZTF23aavshwi  2419451634015015008    2  60173.451632  18.789606  0.067233   
10  ZTF23aavshwi  2419475694015015014    1  60173.475694  19.894947  0.147604   
11  ZTF23aavshwi  2424486604015015016    2  60178.486609  18.973866  0.079126   
12  ZTF23aavshwi  2428469354015015016    2  60182.469352  19.151363  0.086399   
13  ZTF23aavshwi  2430436074015015016    1  60184.436076  20.503382  0.193578   
14  ZTF23aavshwi  2430476444015015012    2  60184.476447  19.384290  0.112882   
15  ZTF23aavshwi  2432427924015015008    2  60186.427928  19.566288  0.176278   
16  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
17  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
18  ZTF23aavshwi  2440490024015015015    2  60194.490023  19.956028  0.172092   
19  ZTF23aavshwi  2446471444015015013    2  60200.471447  20.102201  0.131913   
20  ZTF23aavshwi  2448496784015015039    2  60202.496782  20.105957  0.146235   
21  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
22  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
23  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
24  ZTF18aandkua  2756269351915010002    2  60510.269352  19.379133  0.161114   
25  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
26  ZTF18aandkua  2772265531915010009    2  60526.265532  19.641638  0.183068   
27  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
28  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   
29  ZTF23aavqxos  3003155891315015002    2  60757.155891  19.689983  0.215474   

    has_stamp       drb  sgscore1  distpsnr1  
0        True  0.949127  0.024583   0.183817  
1        True  0.879817  0.209000   0.343322  
2        True  1.000000  0.009583   2.024725  
3        True  1.000000  0.009583   2.024725  
4        True  1.000000  0.009583   2.024725  
5        True  1.000000  0.009583   2.024725  
6        True  1.000000  0.009583   2.024725  
7        True  0.999312  0.134304   0.635949  
8        True  1.000000  0.009583   2.024725  
9        True  1.000000  0.009583   2.024725  
10       True  0.999999  0.009583   2.024725  
11       True  1.000000  0.009583   2.024725  
12       True  1.000000  0.009583   2.024725  
13       True  0.999985  0.009583   2.024725  
14       True  0.999998  0.009583   2.024725  
15       True  0.999994  0.009583   2.024725  
16       True  0.994159  0.075167   0.326697  
17       True  0.994159  0.075167   1.234589  
18       True  0.999963  0.009583   2.024725  
19       True  0.999977  0.009583   2.024725  
20       True  0.999999  0.009583   2.024725  
21       True  0.755912  0.380149   0.673811  
22       True  0.755912  0.380149   0.904783  
23       True  0.993011  0.075167   0.326697  
24       True  0.993011  0.075167   1.234589  
25       True  0.850113  0.075167   0.326697  
26       True  0.850113  0.075167   1.234589  
27       True  0.696538  0.075167   0.326697  
28       True  0.696538  0.075167   1.234589  
29       True  0.921584  0.024583   0.183817  ]",,13.489378690719604,2025-05-20T12:55:12,0.1734104046242774,1.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,4,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,24.67517113685608,2025-04-29T12:07:40,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,18.84318900108337,2025-05-20T12:55:35,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,5,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.magpsf, 
    d.sigmapsf, 
    d.has_stamp, 
    d.drb, 
    p.sgscore1, 
    p.distpsnr1
FROM 
    detection d
INNER JOIN 
    ps1_ztf p ON d.oid = p.oid
WHERE 
    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND d.drb > 0.5
    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,17.367687225341797,2025-04-29T12:07:57,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,13.101221799850464,2025-05-20T12:55:53,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,6,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
                      'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
                      'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.89245104789734,2025-04-29T12:08:21,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,12.237338781356812,2025-05-20T12:56:10,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,7,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 
                      'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 
                      'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.434401988983154,2025-04-29T12:08:42,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,11.802730798721312,2025-05-20T12:56:26,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,8,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.magpsf, 
    d.sigmapsf, 
    d.has_stamp, 
    d.drb, 
    p.sgscore1, 
    p.distpsnr1
FROM 
    detection d
INNER JOIN 
    ps1_ztf p ON d.oid = p.oid
WHERE 
    d.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND d.drb > 0.5
    AND (p.sgscore1 < 0.5 OR p.distpsnr1 < 1)
ORDER BY 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,25.146191596984863,2025-04-29T12:09:07,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,8.833895921707153,2025-05-20T12:56:40,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,9,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
ORDER BY 
    detection.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.004069328308105,2025-04-29T12:09:27,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,9.477088451385498,2025-05-20T12:56:54,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,14,10,"
SELECT 
    object.oid, 
    detection.candid, 
    detection.fid, 
    detection.mjd, 
    detection.magpsf, 
    detection.sigmapsf, 
    detection.has_stamp, 
    detection.drb, 
    ps1_ztf.sgscore1, 
    ps1_ztf.distpsnr1
FROM 
    detection
INNER JOIN 
    object ON detection.oid = object.oid
INNER JOIN 
    ps1_ztf ON detection.oid = ps1_ztf.oid AND detection.candid = ps1_ztf.candid
WHERE 
    detection.oid IN ('ZTF23aavzgjg', 'ZTF23aaynzyk', 'ZTF23aavqxos', 'ZTF23aaknyni', 'ZTF23aavsdtc', 'ZTF18aandkua', 'ZTF23aaxfewt', 'ZTF23aavshwi', 'ZTF22aawasao', 'ZTF23aaxgvnt')
    AND detection.drb > 0.5
    AND (ps1_ztf.sgscore1 < 0.5 OR ps1_ztf.distpsnr1 < 1)
ORDER BY 
    detection.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.435705423355103,2025-04-29T12:09:47,"[            oid               candid  fid           mjd     magpsf  sigmapsf  \
0  ZTF23aavqxos  2403456661315015121    2  60157.456667  19.240726  0.181016   
1  ZTF23aavsdtc  2404379221215015002    1  60158.379225  19.220120  0.216384   
2  ZTF23aavshwi  2404407764015015005    2  60158.407766  18.168100  0.067061   
3  ZTF23aaxfewt  2415290061315015127    2  60169.290069  18.205078  0.063636   
4  ZTF18aandkua  2434183903015015056    1  60188.183901  17.907194  0.180156   
5  ZTF22aawasao  2754319833415015025    2  60508.319838  18.594233  0.143780   
6  ZTF18aandkua  2979404491915010015    1  60733.404491  18.887863  0.175351   

   has_stamp       drb  sgscore1  distpsnr1  
0       True  0.949127  0.024583   0.183817  
1       True  0.879817  0.209000   0.343322  
2       True  1.000000  0.009583   2.024725  
3       True  0.999312  0.134304   0.635949  
4       True  0.994159  0.075167   0.326697  
5       True  0.755912  0.380149   0.904783  
6       True  0.696538  0.075167   1.234589  ]",,11.546791315078735,2025-05-20T12:57:10,0.0404624277456647,4.285714285714286,1.0,1.0,0.0,1.0
0.16.3,,,30,0,"
select oid, class_name, probability from probability where classifier_name = 'lc_classifier' and ranking = 1;
",,,,,"[                  oid      class_name  probability
0        ZTF18acctnmu  Periodic-Other     0.438600
1        ZTF19aalbzsa             LPV     0.807760
2        ZTF19aaelefd  Periodic-Other     0.499968
3        ZTF18abiwdmp             LPV     0.610740
4        ZTF18aacimbu  Periodic-Other     0.344320
...               ...             ...          ...
3883349  ZTF19aaprori             LPV     0.398684
3883350  ZTF18absgisj             RRL     0.169464
3883351  ZTF18abtzdvv             LPV     0.754800
3883352  ZTF19aanmhzp             LPV     0.463200
3883353  ZTF18abbkfyr             RRL     0.353904

[3883354 rows x 3 columns]]",,89.92952871322632,2025-05-20T12:58:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,1,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.6449902057647705,2025-04-29T12:09:51,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF19aamjiwt  Periodic-Other     0.290000
2        ZTF19aamjiys  Periodic-Other     0.650408
3        ZTF18acqyvlk  Periodic-Other     0.372104
4        ZTF19aamjixy               E     0.463848
...               ...             ...          ...
3883349  ZTF18adqfwhc             LPV     0.777744
3883350  ZTF18aazenxt             LPV     0.827648
3883351  ZTF18abegoyx             LPV     0.745128
3883352  ZTF18aaypnoj             LPV     0.845460
3883353  ZTF18aaxjklq             RRL     0.571824

[3883354 rows x 3 columns]]",,109.92178440093994,2025-05-20T16:15:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,2,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.2370994091033936,2025-04-29T12:09:55,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF19aamjisy             QSO     0.340464
3883350  ZTF18aaxjklq             RRL     0.571824
3883351  ZTF17aaaennf             CEP     0.328872
3883352  ZTF21aaylofk             LPV     0.760280
3883353  ZTF19aaxlhak               E     0.313728

[3883354 rows x 3 columns]]",,152.93910455703735,2025-05-20T16:19:52,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,3,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.4529519081115723,2025-04-29T12:09:58,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF18aazenxt             LPV     0.827648
3883350  ZTF18abegoyx             LPV     0.745128
3883351  ZTF18aaypnoj             LPV     0.845460
3883352  ZTF19aaxlhak               E     0.313728
3883353  ZTF18aaxjklq             RRL     0.571824

[3883354 rows x 3 columns]]",,167.98321151733398,2025-05-20T16:26:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,4,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.823147773742676,2025-04-29T12:10:02,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF21aaylofk             LPV     0.760280
3883350  ZTF18abegoyx             LPV     0.745128
3883351  ZTF18aaypnoj             LPV     0.845460
3883352  ZTF18aaxjklq             RRL     0.571824
3883353  ZTF19aaxlhak               E     0.313728

[3883354 rows x 3 columns]]",,135.26395988464355,2025-05-20T16:31:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,5,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.7026286125183105,2025-04-29T12:10:05,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF18adqfwhc             LPV     0.777744
3883350  ZTF18aazenxt             LPV     0.827648
3883351  ZTF18abegoyx             LPV     0.745128
3883352  ZTF18aaypnoj             LPV     0.845460
3883353  ZTF18aaxjklq             RRL     0.571824

[3883354 rows x 3 columns]]",,185.74151158332825,2025-05-20T16:36:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,6,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,4.847445487976074,2025-04-29T12:10:10,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF18aaypnoj             LPV     0.845460
3883350  ZTF18aaxjklq             RRL     0.571824
3883351  ZTF21aakjjhl             YSO     0.184260
3883352  ZTF19aamjisy             QSO     0.340464
3883353  ZTF19aaxlhak               E     0.313728

[3883354 rows x 3 columns]]",,181.3024384975433,2025-05-20T16:42:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,7,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.15111780166626,2025-04-29T12:10:13,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF18adqfwhc             LPV     0.777744
3883350  ZTF18aazenxt             LPV     0.827648
3883351  ZTF18abegoyx             LPV     0.745128
3883352  ZTF18aaypnoj             LPV     0.845460
3883353  ZTF18aaxjklq             RRL     0.571824

[3883354 rows x 3 columns]]",,163.2748851776123,2025-05-20T16:47:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,8,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.731066942214966,2025-04-29T12:10:16,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF21aaylofk             LPV     0.760280
3883350  ZTF19aaxlirh             YSO     0.525888
3883351  ZTF21aakjjhl             YSO     0.184260
3883352  ZTF19aamjisy             QSO     0.340464
3883353  ZTF19aaxlhak               E     0.313728

[3883354 rows x 3 columns]]",,201.5314757823944,2025-05-20T16:53:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,9,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.8162426948547363,2025-04-29T12:10:19,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF18abhwyvk             LPV     0.278460
3883350  ZTF17aaaennf             CEP     0.328872
3883351  ZTF21aaylofk             LPV     0.760280
3883352  ZTF19aamjisy             QSO     0.340464
3883353  ZTF19aaxlhak               E     0.313728

[3883354 rows x 3 columns]]",,201.58671617507932,2025-05-20T16:59:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,30,10,"
SELECT 
    p.oid, 
    p.class_name, 
    p.probability
FROM 
    probability p
WHERE 
    p.ranking = 1 
    AND p.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.055508613586426,2025-04-29T12:10:22,"[                  oid      class_name  probability
0        ZTF19aamjita  Periodic-Other     0.600060
1        ZTF18aaxjkgp               E     0.241508
2        ZTF19aamjiup  Periodic-Other     0.504084
3        ZTF21abinbru             LPV     0.569320
4        ZTF18acrwpap               E     0.173736
...               ...             ...          ...
3883349  ZTF18abhwyvk             LPV     0.278460
3883350  ZTF17aaaennf             CEP     0.328872
3883351  ZTF21aaylofk             LPV     0.760280
3883352  ZTF19aamjisy             QSO     0.340464
3883353  ZTF19aaxlhak               E     0.313728

[3883354 rows x 3 columns]]",,159.20796656608582,2025-05-20T17:04:55,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,22,0,"
SELECT
    *
FROM
    object INNER JOIN (
    SELECT
        *
    FROM
        probability
    WHERE
        classifier_name='lc_classifier'
        AND ranking=1
    ) AS probability_oid
    ON object.oid=probability_oid.oid
WHERE
    probability_oid.classifier_name='lc_classifier'
    AND object.firstmjd BETWEEN 58239.0 AND 58270.0
",,,,,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aaxczcr       182      1708  58244.477778  60811.399421   
1       ZTF18aaxjkgp      1150      4262  58231.484421  60815.442535   
2       ZTF18aagsexu      1185      3012  58173.487454  60814.321528   
3       ZTF18aajorxy      1719      3228  58198.370440  60814.365590   
4       ZTF18aaxczsz       833      2426  58208.526099  60807.406667   
...              ...       ...       ...           ...           ...   
101062  ZTF18aalbxcl       454      3382  58198.385602  60796.364421   
101063  ZTF18aaxdoer      1286      2046  58208.512199  60785.488704   
101064  ZTF18aaptbza      2939      4816  58219.486018  60811.453194   
101065  ZTF18aagstjm      1057      3875  58203.413229  60814.326748   
101066  ZTF18aaxjklq      1212      2071  58209.524653  60811.398484   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   108      NaN           NaN  ...  58266.356319   
1            True    False   802      NaN           NaN  ...  58268.479479   
2            True    False   400      NaN           NaN  ...  58244.331181   
3            True    False   551      NaN           NaN  ...  58248.330648   
4            True    False   516      NaN           NaN  ...  58266.357743   
...           ...      ...   ...      ...           ...  ...           ...   
101062       True    False   119      NaN           NaN  ...  58257.303854   
101063       True    False   872      NaN           NaN  ...  58266.465174   
101064       True    False  1371      NaN           NaN  ...  58242.454560   
101065       True    False   347      NaN           NaN  ...  58245.322164   
101066       True    False   527      NaN           NaN  ...  58268.483843   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60811.399421        27.5.6    False             False   
1       60815.442535        27.5.6     True             False   
2       60814.321528        27.5.6    False             False   
3       60814.365590        27.5.6     True             False   
4       60807.406667        27.5.6    False             False   
...              ...           ...      ...               ...   
101062  60796.364421        27.5.6    False             False   
101063  60785.488704        27.5.6    False             False   
101064  60811.453194        27.5.6     True             False   
101065  60814.326748        27.5.6     True             False   
101066  60811.398484        27.5.6     True              True   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13             LPV     0.665760   
1         lc_classifier  lc_classifier_1.1.13               E     0.241508   
2         lc_classifier  lc_classifier_1.1.13               E     0.353232   
3         lc_classifier  lc_classifier_1.1.13             RRL     0.354220   
4         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.404928   
...                 ...                   ...             ...          ...   
101062    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.457380   
101063    lc_classifier  lc_classifier_1.1.13         CV/Nova     0.265608   
101064    lc_classifier  lc_classifier_1.1.13             LPV     0.658720   
101065    lc_classifier  lc_classifier_1.1.13             LPV     0.605880   
101066    lc_classifier  lc_classifier_1.1.13             RRL     0.571824   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
101062       1  
101063       1  
101064       1  
101065       1  
101066       1  

[101067 rows x 27 columns]]",,22.802282094955444,2025-05-20T17:05:54,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,22,1,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.941379308700561,2025-04-29T12:10:25,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aayeamz       482      2342  58218.469352  60802.462315   
1       ZTF18abcgofw       829      2245  58209.525116  60815.439641   
2       ZTF18abcoemk       752      2150  58209.525116  60815.439641   
3       ZTF18aaxkumx       535      1750  58210.389363  60810.353391   
4       ZTF18abbntjh        41      2257  58258.439861  60708.573403   
...              ...       ...       ...           ...           ...   
333615  ZTF18aayehwv       319      2254  58254.469039  60802.477176   
333616  ZTF18abcdvtf       659      1556  58254.488079  60706.214711   
333617  ZTF18abbnnho       733      2051  58259.441840  60802.481725   
333618  ZTF18abaqsgk       335      4091  58244.473032  60811.406979   
333619  ZTF18abackqv       452      2431  58254.461458  60622.129722   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   317      NaN           NaN  ...  58274.397755   
1            True    False   527      NaN           NaN  ...  58288.376470   
2            True    False   382      NaN           NaN  ...  58290.398657   
3            True    False   336      NaN           NaN  ...  58269.337141   
4            True    False    21      NaN           NaN  ...  58285.436389   
...           ...      ...   ...      ...           ...  ...           ...   
333615       True    False   205      NaN           NaN  ...  58274.402373   
333616       True    False   571      NaN           NaN  ...  58287.474201   
333617       True    False   432      NaN           NaN  ...  58285.435926   
333618       True    False   175      NaN           NaN  ...  58283.391250   
333619       True    False   319      NaN           NaN  ...  58277.372685   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60802.462315        27.5.6    False              True   
1       60815.439641        27.5.6     True             False   
2       60815.439641        27.5.6    False             False   
3       60810.353391        27.5.6     True              True   
4       60708.573403        27.3.0    False              True   
...              ...           ...      ...               ...   
333615  60802.477176        27.5.6     True              True   
333616  60706.214711        27.3.0     True             False   
333617  60802.481725        27.5.6     True              True   
333618  60811.406979        27.5.6    False              True   
333619  60622.129722      24.5.2a6    False              True   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13               E     0.214488   
1         lc_classifier  lc_classifier_1.1.13             LPV     0.570512   
2         lc_classifier  lc_classifier_1.1.13             LPV     0.666936   
3         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.357136   
4         lc_classifier  lc_classifier_1.1.13             YSO     0.371220   
...                 ...                   ...             ...          ...   
333615    lc_classifier  lc_classifier_1.1.13             YSO     0.385216   
333616    lc_classifier  lc_classifier_1.1.13               E     0.333840   
333617    lc_classifier  lc_classifier_1.1.13             LPV     0.842556   
333618    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.209000   
333619    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.319680   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333615       1  
333616       1  
333617       1  
333618       1  
333619       1  

[333620 rows x 27 columns]]",,103.61497592926024,2025-05-20T17:07:53,0.269395549486974,0.0816108146993585,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,2,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND object.firstmjd BETWEEN 58262.0 AND 58292.0 -- MJD dates for June 1st and July 1st, 2018
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.0648434162139893,2025-04-29T12:10:28,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aaxczsz       833      2426  58208.526099  60807.406667   
1       ZTF18abcgofw       829      2245  58209.525116  60815.439641   
2       ZTF18abcoemk       752      2150  58209.525116  60815.439641   
3       ZTF18abbntjh        41      2257  58258.439861  60708.573403   
4       ZTF18aaxyqfo       352      4269  58237.486736  60814.423322   
...              ...       ...       ...           ...           ...   
333615  ZTF18acpemgr       221      2113  58338.363877  60387.513472   
333616  ZTF18aazfdcy      1815      3935  58234.481401  60797.416215   
333617  ZTF18aazmhyr       296      1618  58256.453449  60810.457095   
333618  ZTF18aayfbch      3272      6225  58101.115556  60814.423322   
333619  ZTF18abcobdt       515      2139  58257.458565  60807.395718   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   516       NaN           NaN  ...  58266.357743   
1            True    False   527       NaN           NaN  ...  58288.376470   
2            True    False   382       NaN           NaN  ...  58290.398657   
3            True    False    21       NaN           NaN  ...  58285.436389   
4            True    False   285       NaN           NaN  ...  58273.422512   
...           ...      ...   ...       ...           ...  ...           ...   
333615      False    False   120  1.878227      1.763116  ...  58272.398102   
333616       True    False  1048       NaN           NaN  ...  58278.416736   
333617       True    False   256       NaN           NaN  ...  58279.402778   
333618       True    False  2543       NaN           NaN  ...  58274.471042   
333619       True    False   252       NaN           NaN  ...  58289.395069   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60807.406667        27.5.6    False             False   
1       60815.439641        27.5.6     True             False   
2       60815.439641        27.5.6    False             False   
3       60708.573403        27.3.0    False              True   
4       60814.423322        27.5.6     True              True   
...              ...           ...      ...               ...   
333615  60396.497106         1.2.0    False             False   
333616  60797.416215        27.5.6    False              True   
333617  60810.457095        27.5.6    False             False   
333618  60814.423322        27.5.6     True             False   
333619  60807.395718        27.5.6     True              True   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.404928   
1         lc_classifier  lc_classifier_1.1.13             LPV     0.570512   
2         lc_classifier  lc_classifier_1.1.13             LPV     0.666936   
3         lc_classifier  lc_classifier_1.1.13             YSO     0.371220   
4         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.390264   
...                 ...                   ...             ...          ...   
333615    lc_classifier  lc_classifier_1.1.13             CEP     0.309120   
333616    lc_classifier  lc_classifier_1.1.13             LPV     0.831300   
333617    lc_classifier  lc_classifier_1.1.13             LPV     0.575928   
333618    lc_classifier  lc_classifier_1.1.13             RRL     0.280440   
333619    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.285568   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333615       1  
333616       1  
333617       1  
333618       1  
333619       1  

[333620 rows x 27 columns]]",,105.00894594192503,2025-05-20T17:10:09,0.269395549486974,0.0816108146993585,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,3,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND object.firstmjd BETWEEN 58262.0 AND 58292.0 -- MJD for June 1st, 2018 is 58262.0 and for July 1st, 2018 is 58292.0
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.121047019958496,2025-04-29T12:10:31,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aazuznr       560      2104  58280.413056  60815.440116   
1       ZTF18aaufkam       507      2951  58230.454792  60805.409456   
2       ZTF18abarfav       863      2247  58209.526042  60802.451817   
3       ZTF18acmaevy       995      3627  58226.488738  60387.478438   
4       ZTF18abcocpk       884      1324  58209.525116  60815.439641   
...              ...       ...       ...           ...           ...   
333615  ZTF18aazssqq       136      1927  58280.359062  60629.131215   
333616  ZTF18abcgndv      1300      2216  58261.438796  60815.439641   
333617  ZTF18aapszky       443      3127  58232.405301  60796.465694   
333618  ZTF18abdgavl       942      4115  58245.459213  60815.441539   
333619  ZTF18aaphrtg       397      6655  58231.485891  60802.498414   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   425      NaN           NaN  ...  58280.413056   
1            True    False   340      NaN           NaN  ...  58286.421620   
2            True    False   558      NaN           NaN  ...  58283.399699   
3            True    False   598      NaN           NaN  ...  58271.464988   
4            True    False   516      NaN           NaN  ...  58290.398657   
...           ...      ...   ...      ...           ...  ...           ...   
333615       True    False    37      NaN           NaN  ...  58280.359062   
333616       True    False   642      NaN           NaN  ...  58288.376470   
333617       True    False   230      NaN           NaN  ...  58278.404745   
333618       True    False   838      NaN           NaN  ...  58269.456458   
333619       True    False   192      NaN           NaN  ...  58275.395035   

             lastmjd     step_id_corr  diffpos  reference_change  \
0       60815.440116           27.5.6    False             False   
1       60805.409456           27.5.6    False              True   
2       60802.451817           27.5.6    False              True   
3       60407.498912  corr_bulk_0.0.1     True             False   
4       60815.439641           27.5.6     True             False   
...              ...              ...      ...               ...   
333615  60629.131215         24.5.2a6    False             False   
333616  60815.439641           27.5.6    False             False   
333617  60796.465694           27.5.6     True             False   
333618  60815.441539           27.5.6    False             False   
333619  60802.498414           27.5.6     True              True   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13             LPV     0.740880   
1         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.544320   
2         lc_classifier  lc_classifier_1.1.13             LPV     0.824880   
3         lc_classifier  lc_classifier_1.1.13         CV/Nova     0.129600   
4         lc_classifier  lc_classifier_1.1.13               E     0.225680   
...                 ...                   ...             ...          ...   
333615    lc_classifier  lc_classifier_1.1.13             LPV     0.351384   
333616    lc_classifier  lc_classifier_1.1.13             LPV     0.265144   
333617    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.643140   
333618    lc_classifier  lc_classifier_1.1.13             LPV     0.665432   
333619    lc_classifier  lc_classifier_1.1.13             YSO     0.185224   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333615       1  
333616       1  
333617       1  
333618       1  
333619       1  

[333620 rows x 27 columns]]",,101.08014369010924,2025-05-20T17:12:16,0.269395549486974,0.0816108146993585,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,4,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.791452169418335,2025-04-29T12:10:34,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aazuznr       560      2104  58280.413056  60815.440116   
1       ZTF18aaxczsz       833      2426  58208.526099  60807.406667   
2       ZTF18abcoemk       752      2150  58209.525116  60815.439641   
3       ZTF18aaxkumx       535      1750  58210.389363  60810.353391   
4       ZTF18aaxyqfo       352      4269  58237.486736  60814.423322   
...              ...       ...       ...           ...           ...   
333615  ZTF17aabvagf       825      2900  58095.078600  60810.427477   
333616  ZTF18aamkfng       522      4551  58198.442789  60759.499606   
333617  ZTF18abcjynv      1615      1974  58289.422940  60814.469942   
333618  ZTF18abcpezn      1141      1955  58290.455787  60811.471759   
333619  ZTF18aaxujfv       498      2995  58247.493391  60815.442535   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   425      NaN           NaN  ...  58280.413056   
1            True    False   516      NaN           NaN  ...  58266.357743   
2            True    False   382      NaN           NaN  ...  58290.398657   
3            True    False   336      NaN           NaN  ...  58269.337141   
4            True    False   285      NaN           NaN  ...  58273.422512   
...           ...      ...   ...      ...           ...  ...           ...   
333615       True    False   354      NaN           NaN  ...  58278.452060   
333616       True    False   228      NaN           NaN  ...  58284.372708   
333617       True    False  1244      NaN           NaN  ...  58289.422940   
333618       True    False   821      NaN           NaN  ...  58290.455787   
333619       True    False   357      NaN           NaN  ...  58272.398102   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60815.440116        27.5.6    False             False   
1       60807.406667        27.5.6    False             False   
2       60815.439641        27.5.6    False             False   
3       60810.353391        27.5.6     True              True   
4       60814.423322        27.5.6     True              True   
...              ...           ...      ...               ...   
333615  60810.427477        27.5.6     True             False   
333616  60759.499606        27.5.0     True             False   
333617  60814.469942        27.5.6    False             False   
333618  60811.471759        27.5.6     True             False   
333619  60815.442535        27.5.6     True             False   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13             LPV     0.740880   
1         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.404928   
2         lc_classifier  lc_classifier_1.1.13             LPV     0.666936   
3         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.357136   
4         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.390264   
...                 ...                   ...             ...          ...   
333615    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.310272   
333616    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.531012   
333617    lc_classifier  lc_classifier_1.1.13             LPV     0.787640   
333618    lc_classifier  lc_classifier_1.1.13             LPV     0.863512   
333619    lc_classifier  lc_classifier_1.1.13               E     0.215460   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333615       1  
333616       1  
333617       1  
333618       1  
333619       1  

[333620 rows x 27 columns]]",,76.2666609287262,2025-05-20T17:13:55,0.269395549486974,0.0816108146993585,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,5,"
SELECT *
FROM object
WHERE firstmjd BETWEEN 58262.0 AND 58292.0
AND oid IN (
    SELECT oid
    FROM probability
    WHERE ranking = 1
    AND classifier_name = 'lc_classifier'
)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.518473148345947,2025-04-29T12:10:39,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aabvlbf       672      2236  58088.540683  60814.300393   
1       ZTF18aaavync       693      1842  58110.500000  59967.500000   
2       ZTF18aabpxcm       696      1848  58110.500000  60016.500000   
3       ZTF20aakcvtc       728      2129  58106.530266  60287.511123   
4       ZTF17aabxlik       994      2700  58106.530266  60814.322477   
...              ...       ...       ...           ...           ...   
189655  ZTF18abcrsit        71      2451  58268.423912  60805.409931   
189656  ZTF18abcuxti      1092      2674  58244.494757  60815.442535   
189657  ZTF18abcrsic       512      2361  58291.479514  60815.442535   
189658  ZTF18abiftiy       367      3877  58277.250000  60260.000000   
189659  ZTF18abcrsib       113      2355  58291.479514  60802.479109   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      meanra  \
0            True    False   319       NaN           NaN  ...  194.036703   
1            True    False   127  0.510000      0.429212  ...  213.359308   
2            True    False   223  0.417957      0.402498  ...  213.359287   
3            True    False   360  0.652400      0.975891  ...  208.457785   
4            True    False   311       NaN           NaN  ...  208.457720   
...           ...      ...   ...       ...           ...  ...         ...   
189655       True    False    45       NaN           NaN  ...  297.957120   
189656       True    False   554       NaN           NaN  ...  303.024729   
189657       True    False   401       NaN           NaN  ...  300.531434   
189658       True    False    32  1.041200      1.065340  ...  297.232326   
189659       True     True    37       NaN           NaN  ...  299.889625   

          meandec   sigmara  sigmadec      deltajd      firstmjd  \
0       18.623523  0.004146  0.003929  2552.035671  58262.264722   
1       33.700188  0.000074  0.000066  1705.231725  58262.267627   
2       33.700182  0.000087  0.000068  1754.141400  58262.267627   
3       30.868421  0.028282  0.024275  2136.166169  58262.267627   
4       30.868402  0.004888  0.004196  2552.054850  58262.267627   
...           ...       ...       ...          ...           ...   
189655  23.850361  0.013537  0.012381  2513.930417  58291.479514   
189656  28.931682  0.003773  0.003302  2523.963021  58291.479514   
189657  29.360669  0.004116  0.003587  2523.963021  58291.479514   
189658  24.573618  0.000093  0.000175  1968.634305  58291.479514   
189659  29.184072  0.016006  0.013974  2510.999595  58291.479514   

             lastmjd  step_id_corr  diffpos reference_change  
0       60814.300393        27.5.6    False            False  
1       59967.499352         1.1.6    False            False  
2       60016.409028         1.1.6    False            False  
3       60398.433796         1.1.6    False            False  
4       60814.322477        27.5.6     True            False  
...              ...           ...      ...              ...  
189655  60805.409931        27.5.6    False            False  
189656  60815.442535        27.5.6     True            False  
189657  60815.442535        27.5.6    False            False  
189658  60260.113819         1.2.1    False            False  
189659  60802.479109        27.5.6     True            False  

[189660 rows x 22 columns]]",,43.62428832054138,2025-05-20T17:14:59,0.1490397459111282,0.143556891279131,0.8148148148148148,1.0,0.0,0.0
0.16.3,gpt-4o,v1,22,6,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.6400551795959473,2025-04-29T12:10:42,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aazuznr       560      2104  58280.413056  60815.440116   
1       ZTF18abcgofw       829      2245  58209.525116  60815.439641   
2       ZTF17aabvagg      1428      2932  58095.120567  60804.473901   
3       ZTF18aaxlhpb      1682      2890  58249.319456  60810.469907   
4       ZTF18aawszml      2442      3086  58095.078600  60810.469907   
...              ...       ...       ...           ...           ...   
333615  ZTF18abbvara       206      1759  58254.487141  60694.204363   
333616  ZTF18aayeqce       597      2177  58266.395301  60802.479583   
333617  ZTF18aakcfak       950      1568  58156.401829  60699.400532   
333618  ZTF18aaouprr       626      4223  58115.526331  60810.273426   
333619  ZTF18aazgacb        94      2348  58278.458565  60811.399896   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   425      NaN           NaN  ...  58280.413056   
1            True    False   527      NaN           NaN  ...  58288.376470   
2            True    False   687      NaN           NaN  ...  58266.350891   
3            True    False   957      NaN           NaN  ...  58269.382512   
4            True    False  1170      NaN           NaN  ...  58266.350891   
...           ...      ...   ...      ...           ...  ...           ...   
333615       True    False   161      NaN           NaN  ...  58286.475718   
333616       True    False   462      NaN           NaN  ...  58274.400058   
333617       True    False   562      NaN           NaN  ...  58279.171979   
333618       True    False   261      NaN           NaN  ...  58282.289618   
333619       True    False    55      NaN           NaN  ...  58278.458565   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60815.440116        27.5.6    False             False   
1       60815.439641        27.5.6     True             False   
2       60804.473901        27.5.6    False              True   
3       60810.469907        27.5.6    False              True   
4       60810.469907        27.5.6    False              True   
...              ...           ...      ...               ...   
333615  60694.204363        27.0.0    False             False   
333616  60802.479583        27.5.6     True              True   
333617  60699.400532        27.3.0    False             False   
333618  60810.273426        27.5.6     True             False   
333619  60811.399896        27.5.6    False             False   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13             LPV     0.740880   
1         lc_classifier  lc_classifier_1.1.13             LPV     0.570512   
2         lc_classifier  lc_classifier_1.1.13             CEP     0.335160   
3         lc_classifier  lc_classifier_1.1.13             LPV     0.738840   
4         lc_classifier  lc_classifier_1.1.13         CV/Nova     0.515480   
...                 ...                   ...             ...          ...   
333615    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.500736   
333616    lc_classifier  lc_classifier_1.1.13             LPV     0.766656   
333617    lc_classifier  lc_classifier_1.1.13             AGN     0.578000   
333618    lc_classifier  lc_classifier_1.1.13             RRL     0.430416   
333619    lc_classifier  lc_classifier_1.1.13             YSO     0.353276   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333615       1  
333616       1  
333617       1  
333618       1  
333619       1  

[333620 rows x 27 columns]]",,72.98101687431335,2025-05-20T17:16:30,0.269395549486974,0.0816108146993585,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,7,"
SELECT *
FROM object
WHERE firstmjd BETWEEN 58262.0 AND 58292.0
AND oid IN (
    SELECT oid
    FROM probability
    WHERE ranking = 1
    AND classifier_name = 'lc_classifier'
)
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.949136257171631,2025-04-29T12:10:47,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18aabvlbf       672      2236  58088.540683  60814.300393   
1       ZTF18aaavync       693      1842  58110.500000  59967.500000   
2       ZTF18aabpxcm       696      1848  58110.500000  60016.500000   
3       ZTF20aakcvtc       728      2129  58106.530266  60287.511123   
4       ZTF17aabxlik       994      2700  58106.530266  60814.322477   
...              ...       ...       ...           ...           ...   
189655  ZTF18abcrslb        98      2678  58271.458160  60357.550521   
189656  ZTF18abcuzlb       300      2162  58268.423912  60618.098785   
189657  ZTF18abcrrpp        91      2404  58291.479514  60625.136817   
189658  ZTF18aawstsp       211      2398  58218.511019  60802.479109   
189659  ZTF18abcrryj       402      2824  58282.444294  60496.462697   

        corrected  stellar  ndet   g_r_max  g_r_max_corr  ...      meanra  \
0            True    False   319       NaN           NaN  ...  194.036703   
1            True    False   127  0.510000      0.429212  ...  213.359308   
2            True    False   223  0.417957      0.402498  ...  213.359287   
3            True    False   360  0.652400      0.975891  ...  208.457785   
4            True    False   311       NaN           NaN  ...  208.457720   
...           ...      ...   ...       ...           ...  ...         ...   
189655       True    False    51  2.949922      3.251433  ...  297.508450   
189656       True    False   177       NaN           NaN  ...  299.992689   
189657       True    False    41       NaN           NaN  ...  302.228033   
189658       True    False   107       NaN           NaN  ...  300.321856   
189659       True    False   320  2.374183      2.669055  ...  302.570679   

          meandec   sigmara  sigmadec      deltajd      firstmjd  \
0       18.623523  0.004146  0.003929  2552.035671  58262.264722   
1       33.700188  0.000074  0.000066  1705.231725  58262.267627   
2       33.700182  0.000087  0.000068  1754.141400  58262.267627   
3       30.868421  0.028282  0.024275  2136.166169  58262.267627   
4       30.868402  0.004888  0.004196  2552.054850  58262.267627   
...           ...       ...       ...          ...           ...   
189655  22.700552  0.034825  0.032127  2066.071007  58291.479514   
189656  24.425866  0.093356  0.085000  2326.619271  58291.479514   
189657  26.824586  0.095250  0.085000  2333.657303  58291.479514   
189658  28.971878  0.008877  0.007766  2510.999595  58291.479514   
189659  25.726606  0.010823  0.009750  2204.983183  58291.479514   

             lastmjd  step_id_corr  diffpos reference_change  
0       60814.300393        27.5.6    False            False  
1       59967.499352         1.1.6    False            False  
2       60016.409028         1.1.6    False            False  
3       60398.433796         1.1.6    False            False  
4       60814.322477        27.5.6     True            False  
...              ...           ...      ...              ...  
189655  60357.550521         1.2.1    False            False  
189656  60618.098785      24.5.2a6    False            False  
189657  60625.136817      24.5.2a6    False            False  
189658  60802.479109        27.5.6    False            False  
189659  60496.462697      24.5.2a6    False            False  

[189660 rows x 22 columns]]",,39.93609952926636,2025-05-20T17:17:31,0.1490397459111282,0.143556891279131,0.8148148148148148,1.0,0.0,0.0
0.16.3,gpt-4o,v1,22,8,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE object.firstmjd BETWEEN 58262.0 AND 58292.0
AND probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.121972560882568,2025-04-29T12:10:52,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18abbntjh        41      2257  58258.439861  60708.573403   
1       ZTF18abcocpk       884      1324  58209.525116  60815.439641   
2       ZTF18aayhjtt      1150      2936  58247.447940  60810.427477   
3       ZTF18aazevdp       925      2251  58208.512199  60811.379387   
4       ZTF18aaypeib       865      2369  58218.497106  60810.457095   
...              ...       ...       ...           ...           ...   
333615  ZTF18abcgmpk       799      2903  58247.459572  60804.398507   
333616  ZTF18abbfyyp       605      2020  58284.471227  60814.431377   
333617  ZTF18abaglih      1518      5599  58216.368831  60810.471181   
333618  ZTF18abbkjgh      1477      1998  58236.459641  60811.429340   
333619  ZTF18abeddyq      1468      3996  58095.101667  60814.430428   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False    21      NaN           NaN  ...  58285.436389   
1            True    False   516      NaN           NaN  ...  58290.398657   
2            True    False   679      NaN           NaN  ...  58275.409687   
3            True    False   548      NaN           NaN  ...  58278.412396   
4            True    False   579      NaN           NaN  ...  58276.423889   
...           ...      ...   ...      ...           ...  ...           ...   
333615       True    False   307      NaN           NaN  ...  58288.374630   
333616       True    False   577      NaN           NaN  ...  58284.471227   
333617       True    False   857      NaN           NaN  ...  58282.294329   
333618       True    False   679      NaN           NaN  ...  58285.330498   
333619       True    False  1103      NaN           NaN  ...  58286.476643   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60708.573403        27.3.0    False              True   
1       60815.439641        27.5.6     True             False   
2       60810.427477        27.5.6    False             False   
3       60811.379387        27.5.6    False              True   
4       60810.457095        27.5.6    False             False   
...              ...           ...      ...               ...   
333615  60804.398507        27.5.6     True              True   
333616  60814.431377        27.5.6     True             False   
333617  60810.471181        27.5.6     True              True   
333618  60811.429340        27.5.6    False              True   
333619  60814.429965        27.5.6     True             False   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13             YSO     0.371220   
1         lc_classifier  lc_classifier_1.1.13               E     0.225680   
2         lc_classifier  lc_classifier_1.1.13         CV/Nova     0.296416   
3         lc_classifier  lc_classifier_1.1.13               E     0.205884   
4         lc_classifier  lc_classifier_1.1.13             LPV     0.582888   
...                 ...                   ...             ...          ...   
333615    lc_classifier  lc_classifier_1.1.13             LPV     0.810240   
333616    lc_classifier  lc_classifier_1.1.13             LPV     0.746496   
333617    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.395560   
333618    lc_classifier  lc_classifier_1.1.13             RRL     0.531456   
333619    lc_classifier  lc_classifier_1.1.13               E     0.305520   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333615       1  
333616       1  
333617       1  
333618       1  
333619       1  

[333620 rows x 27 columns]]",,91.90038084983826,2025-05-20T17:19:37,0.269395549486974,0.0816108146993585,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,9,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND object.firstmjd BETWEEN 58262.0 AND 58292.0 -- MJD dates for June 1st and July 1st, 2018
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,3.71767520904541,2025-04-29T12:10:55,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18abcoemk       752      2150  58209.525116  60815.439641   
1       ZTF18abarfav       863      2247  58209.526042  60802.451817   
2       ZTF18aayhjtt      1150      2936  58247.447940  60810.427477   
3       ZTF18aaznawn       951      3160  58078.177292  60811.449306   
4       ZTF18abcpopq      1265      2157  58174.485174  60731.464884   
...              ...       ...       ...           ...           ...   
333615  ZTF18aaxymzv       338      2285  58218.510556  60811.400845   
333616  ZTF18abcdwun       111      4152  58275.428148  60814.431377   
333617  ZTF18aaxcyqj       675      2692  58218.508056  60811.441088   
333618  ZTF18abaydma      1566      2233  58259.458403  60810.451100   
333619  ZTF18aaxpqmw       718      2950  58268.423912  60807.406667   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   382      NaN           NaN  ...  58290.398657   
1            True    False   558      NaN           NaN  ...  58283.399699   
2            True    False   679      NaN           NaN  ...  58275.409687   
3            True    False   472      NaN           NaN  ...  58279.449491   
4            True    False   449      NaN           NaN  ...  58291.254572   
...           ...      ...   ...      ...           ...  ...           ...   
333615       True    False   213      NaN           NaN  ...  58273.381956   
333616       True    False   108      NaN           NaN  ...  58275.428148   
333617       True    False   381      NaN           NaN  ...  58266.356319   
333618       True    False   727      NaN           NaN  ...  58284.335093   
333619       True    False   445      NaN           NaN  ...  58268.423912   

             lastmjd  step_id_corr  diffpos  reference_change  \
0       60815.439641        27.5.6    False             False   
1       60802.451817        27.5.6    False              True   
2       60810.427477        27.5.6    False             False   
3       60811.449306        27.5.6     True             False   
4       60731.464884        27.4.0    False              True   
...              ...           ...      ...               ...   
333615  60811.400845        27.5.6    False             False   
333616  60814.431377        27.5.6    False              True   
333617  60811.441088        27.5.6     True              True   
333618  60810.451100        27.5.6    False             False   
333619  60807.406667        27.5.6     True             False   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13             LPV     0.666936   
1         lc_classifier  lc_classifier_1.1.13             LPV     0.824880   
2         lc_classifier  lc_classifier_1.1.13         CV/Nova     0.296416   
3         lc_classifier  lc_classifier_1.1.13               E     0.359856   
4         lc_classifier  lc_classifier_1.1.13             RRL     0.526264   
...                 ...                   ...             ...          ...   
333615    lc_classifier  lc_classifier_1.1.13             YSO     0.314840   
333616    lc_classifier  lc_classifier_1.1.13             YSO     0.392400   
333617    lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.440756   
333618    lc_classifier  lc_classifier_1.1.13             LPV     0.845460   
333619    lc_classifier  lc_classifier_1.1.13             LPV     0.792300   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333615       1  
333616       1  
333617       1  
333618       1  
333619       1  

[333620 rows x 27 columns]]",,102.70580291748048,2025-05-20T17:21:44,0.269395549486974,0.0816108146993585,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,22,10,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND object.firstmjd BETWEEN 58262.0 AND 58292.0 -- MJD dates for June 1st, 2018 and July 1st, 2018
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.048074960708618,2025-04-29T12:11:00,"[                 oid  ndethist  ncovhist  mjdstarthist    mjdendhist  \
0       ZTF18abcgoaf      1046      2116  58209.525116  60815.439641   
1       ZTF18aaufkam       507      2951  58230.454792  60805.409456   
2       ZTF18aaxkumx       535      1750  58210.389363  60810.353391   
3       ZTF18aaxyqfo       352      4269  58237.486736  60814.423322   
4       ZTF18acmaevy       995      3627  58226.488738  60387.478438   
...              ...       ...       ...           ...           ...   
333615  ZTF18aayoyfg       332      2232  58255.428021  60807.467211   
333616  ZTF18abchpcs       621      3003  58257.487708  60710.566748   
333617  ZTF18aaztkwi       757      1965  58101.142766  60815.445035   
333618  ZTF18aberzyz       688      2413  58244.473507  60776.446030   
333619  ZTF18abbmoue      1248      3860  58244.431759  60815.441065   

        corrected  stellar  ndet  g_r_max  g_r_max_corr  ...      firstmjd  \
0            True    False   542      NaN           NaN  ...  58288.376470   
1            True    False   340      NaN           NaN  ...  58286.421620   
2            True    False   336      NaN           NaN  ...  58269.337141   
3            True    False   285      NaN           NaN  ...  58273.422512   
4            True    False   598      NaN           NaN  ...  58271.464988   
...           ...      ...   ...      ...           ...  ...           ...   
333615       True    False   285      NaN           NaN  ...  58276.411863   
333616       True    False   535      NaN           NaN  ...  58286.341481   
333617       True    False   474      NaN           NaN  ...  58280.370590   
333618       True    False   435      NaN           NaN  ...  58291.427893   
333619       True    False   821      NaN           NaN  ...  58285.421030   

             lastmjd     step_id_corr  diffpos  reference_change  \
0       60815.439641           27.5.6     True             False   
1       60805.409456           27.5.6    False              True   
2       60810.353391           27.5.6     True              True   
3       60814.423322           27.5.6     True              True   
4       60407.498912  corr_bulk_0.0.1     True             False   
...              ...              ...      ...               ...   
333615  60807.467211           27.5.6    False             False   
333616  60710.566748           27.4.0    False              True   
333617  60815.445035           27.5.6     True              True   
333618  60776.446030           27.5.6    False              True   
333619  60815.441065           27.5.6     True             False   

        classifier_name    classifier_version      class_name  probability  \
0         lc_classifier  lc_classifier_1.1.13             LPV     0.801960   
1         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.544320   
2         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.357136   
3         lc_classifier  lc_classifier_1.1.13  Periodic-Other     0.390264   
4         lc_classifier  lc_classifier_1.1.13         CV/Nova     0.129600   
...                 ...                   ...             ...          ...   
333615    lc_classifier  lc_classifier_1.1.13             YSO     0.201804   
333616    lc_classifier  lc_classifier_1.1.13             LPV     0.603780   
333617    lc_classifier  lc_classifier_1.1.13               E     0.243200   
333618    lc_classifier  lc_classifier_1.1.13             YSO     0.492436   
333619    lc_classifier  lc_classifier_1.1.13             RRL     0.387200   

       ranking  
0            1  
1            1  
2            1  
3            1  
4            1  
...        ...  
333615       1  
333616       1  
333617       1  
333618       1  
333619       1  

[333620 rows x 27 columns]]",,108.05981636047365,2025-05-20T17:24:09,0.269395549486974,0.0816108146993585,1.0,1.0,0.0,1.0
0.16.3,,,12,0,"
SELECT o.oid, o.meanra, o.meandec

FROM (
SELECT
    object.oid, object.meanra, object.meandec
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier'
    AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
    AND probability.ranking = 1
    AND object.firstmjd > 59988.0
    AND object.firstmjd < 60197.0
) as o
WHERE
    q3c_poly_query(o.meanra, o.meandec, '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon);
",,,,,"[             oid      meanra    meandec
0   ZTF23aazxfdh   11.327556  -2.327343
1   ZTF23aazneeg  357.339861 -17.674648
2   ZTF23aazxair   14.098124   0.520434
3   ZTF23abawaav  359.369924  -5.159571
4   ZTF23abbbrbi  358.010245  -4.224612
5   ZTF23abbbygf   16.168206  -1.053601
6   ZTF23aazwytj    0.881927 -10.744196
7   ZTF23abbkepd   13.835889   5.077601
8   ZTF23abapoiv    5.230048  -1.758021
9   ZTF23abbjstt   13.706127  -3.710276
10  ZTF23ababooa  347.699685 -15.441363
11  ZTF23aazkvym  357.860400 -11.907847
12  ZTF23abbbybs   12.780815  -5.443683
13  ZTF23abaychv   12.394942  -3.037759
14  ZTF23aaovxwf  351.140762 -19.056710
15  ZTF23aapnlvr  352.465073 -11.202974
16  ZTF23aaowayh  356.647299 -13.542643
17  ZTF23aapvrkk    0.175006 -12.236802
18  ZTF23aapvzyq  359.503657 -11.916706
19  ZTF23aaohpnv    8.491958   4.082251
20  ZTF23aapgxic    7.748520   5.157252
21  ZTF23aapqtxd    8.879058   2.147919
22  ZTF23abbygzm  343.960147 -17.448733
23  ZTF23abcvivc  358.337513  -5.886772
24  ZTF23aaqixha    8.509318  -9.703939
25  ZTF23aazxiuu    6.501685  -0.884798
26  ZTF23aaqixyp    6.388770  -7.758614
27  ZTF23abbefkk    9.982778   6.622644
28  ZTF23aazwshk   10.101225   4.791153
29  ZTF23abawaqe  352.826653 -18.783349
30  ZTF23aaqygof  345.346057 -18.765263
31  ZTF23aapwihe   17.827492   0.742945
32  ZTF23aaretvs   15.263196  -2.912866
33  ZTF23aarfbvs   11.196881  -2.378468
34  ZTF23aarffak  356.743944 -19.262242
35  ZTF23aarfpck    6.464097   2.183000
36  ZTF23aaqluoo  358.419121 -17.190397
37  ZTF23aascfrd  354.052083  -7.437187
38  ZTF23abbbomo  345.634527 -19.724748
39  ZTF23aapgjtm  351.100632 -14.425906
40  ZTF23aasyvbf    9.411387  -4.281495
41  ZTF23aatzjdo    1.226893 -13.502189
42  ZTF23aaovzyu  349.534040 -12.976046
43  ZTF23aaumlxn    6.423729  -1.050326
44  ZTF23aaaweph    1.307964 -11.502395
45  ZTF23aaaweph    1.307964 -11.502395
46  ZTF23aazsfpa  356.794110 -16.513073
47  ZTF23abbjtdn    6.232715   1.033046
48  ZTF23aavlyvc  359.897395  -6.376741
49  ZTF23aavmycb    7.102145   0.441236
50  ZTF23aawqydv   19.468501   0.780816
51  ZTF23aaxavca    9.017651   1.801565
52  ZTF23aaxavca    9.017651   1.801565
53  ZTF23aaxbfyp    4.112309 -10.371170
54  ZTF23aaxbfzl   16.973081   1.732003
55  ZTF23aaxtrgs    1.760985  -9.567699
56  ZTF23abbitkh   10.628642   8.028922
57  ZTF23aaxtdpc    9.048410  -2.151892
58  ZTF22abrrqkf  351.152588 -13.510948]",,33.180007219314575,2025-05-20T17:24:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,12,1,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.9805116653442383,2025-04-29T12:11:04,"[             oid     meanra    meandec
0   ZTF23abdhvab  17.532746   2.468053
1   ZTF23abchvcs  13.272933  -1.453402
2   ZTF23aapwihe  17.827492   0.742945
3   ZTF23abbkepd  13.835889   5.077601
4   ZTF23abapoiv   5.230048  -1.758021
5   ZTF23abbbybs  12.780815  -5.443683
6   ZTF23abbbygf  16.168206  -1.053601
7   ZTF23abbjstt  13.706127  -3.710276
8   ZTF23aazxfdh  11.327556  -2.327343
9   ZTF23aazxair  14.098124   0.520434
10  ZTF23aaxtrgs   1.760985  -9.567699
11  ZTF23aaaweph   1.307964 -11.502395
12  ZTF23aasyvbf   9.411387  -4.281495
13  ZTF23aaaweph   1.307964 -11.502395
14  ZTF23abaychv  12.394942  -3.037759
15  ZTF23aaretvs  15.263196  -2.912866
16  ZTF23abbefkk   9.982778   6.622644
17  ZTF23aarfpck   6.464097   2.183000
18  ZTF23aaumlxn   6.423729  -1.050326
19  ZTF23abbitkh  10.628642   8.028922
20  ZTF23aarfbvs  11.196881  -2.378468
21  ZTF23aapvrkk   0.175006 -12.236802
22  ZTF23aaxavca   9.017651   1.801565
23  ZTF23aapqtxd   8.879058   2.147919
24  ZTF23aawqydv  19.468501   0.780816
25  ZTF23aaxbfzl  16.973081   1.732003
26  ZTF23aaxavca   9.017651   1.801565
27  ZTF23aaohpnv   8.491958   4.082251
28  ZTF23aapgxic   7.748520   5.157252
29  ZTF23aavmycb   7.102145   0.441236
30  ZTF23aaqixyp   6.388770  -7.758614
31  ZTF23aatzjdo   1.226893 -13.502189
32  ZTF23aaxtdpc   9.048410  -2.151892
33  ZTF23aazxiuu   6.501685  -0.884798
34  ZTF23aaqixha   8.509318  -9.703939
35  ZTF23aaxbfyp   4.112309 -10.371170
36  ZTF23aazwshk  10.101225   4.791153
37  ZTF23abbjtdn   6.232715   1.033046
38  ZTF23aazwytj   0.881927 -10.744196]",,22.01093626022339,2025-05-20T17:25:29,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,2,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.610280513763428,2025-04-29T12:11:08,"[             oid     meanra    meandec
0   ZTF23abdhvab  17.532746   2.468053
1   ZTF23abchvcs  13.272933  -1.453402
2   ZTF23aapwihe  17.827492   0.742945
3   ZTF23abbkepd  13.835889   5.077601
4   ZTF23abapoiv   5.230048  -1.758021
5   ZTF23aazxfdh  11.327556  -2.327343
6   ZTF23abbbybs  12.780815  -5.443683
7   ZTF23abbbygf  16.168206  -1.053601
8   ZTF23aaxtrgs   1.760985  -9.567699
9   ZTF23abbjstt  13.706127  -3.710276
10  ZTF23aaaweph   1.307964 -11.502395
11  ZTF23aazxair  14.098124   0.520434
12  ZTF23abbefkk   9.982778   6.622644
13  ZTF23aaaweph   1.307964 -11.502395
14  ZTF23abaychv  12.394942  -3.037759
15  ZTF23aasyvbf   9.411387  -4.281495
16  ZTF23abbitkh  10.628642   8.028922
17  ZTF23aaumlxn   6.423729  -1.050326
18  ZTF23aarfpck   6.464097   2.183000
19  ZTF23aaretvs  15.263196  -2.912866
20  ZTF23aarfbvs  11.196881  -2.378468
21  ZTF23aapvrkk   0.175006 -12.236802
22  ZTF23aapgxic   7.748520   5.157252
23  ZTF23aapqtxd   8.879058   2.147919
24  ZTF23aawqydv  19.468501   0.780816
25  ZTF23aaxavca   9.017651   1.801565
26  ZTF23aaxbfzl  16.973081   1.732003
27  ZTF23aaxavca   9.017651   1.801565
28  ZTF23aaohpnv   8.491958   4.082251
29  ZTF23aavmycb   7.102145   0.441236
30  ZTF23aaqixyp   6.388770  -7.758614
31  ZTF23aatzjdo   1.226893 -13.502189
32  ZTF23aaxtdpc   9.048410  -2.151892
33  ZTF23aaxbfyp   4.112309 -10.371170
34  ZTF23aaqixha   8.509318  -9.703939
35  ZTF23aazxiuu   6.501685  -0.884798
36  ZTF23abbjtdn   6.232715   1.033046
37  ZTF23aazwshk  10.101225   4.791153
38  ZTF23aazwytj   0.881927 -10.744196]",,11.674006938934326,2025-05-20T17:25:53,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,3,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.3914794921875,2025-04-29T12:11:13,"[             oid     meanra    meandec
0   ZTF23abdhvab  17.532746   2.468053
1   ZTF23abchvcs  13.272933  -1.453402
2   ZTF23aapwihe  17.827492   0.742945
3   ZTF23abbkepd  13.835889   5.077601
4   ZTF23abapoiv   5.230048  -1.758021
5   ZTF23abbbybs  12.780815  -5.443683
6   ZTF23abbbygf  16.168206  -1.053601
7   ZTF23aazxfdh  11.327556  -2.327343
8   ZTF23abbjstt  13.706127  -3.710276
9   ZTF23aazxair  14.098124   0.520434
10  ZTF23aaxtrgs   1.760985  -9.567699
11  ZTF23aaaweph   1.307964 -11.502395
12  ZTF23aaaweph   1.307964 -11.502395
13  ZTF23aasyvbf   9.411387  -4.281495
14  ZTF23abaychv  12.394942  -3.037759
15  ZTF23abbefkk   9.982778   6.622644
16  ZTF23aarfpck   6.464097   2.183000
17  ZTF23abbitkh  10.628642   8.028922
18  ZTF23aarfbvs  11.196881  -2.378468
19  ZTF23aaumlxn   6.423729  -1.050326
20  ZTF23aapvrkk   0.175006 -12.236802
21  ZTF23aaretvs  15.263196  -2.912866
22  ZTF23aawqydv  19.468501   0.780816
23  ZTF23aapqtxd   8.879058   2.147919
24  ZTF23aaohpnv   8.491958   4.082251
25  ZTF23aaxavca   9.017651   1.801565
26  ZTF23aapgxic   7.748520   5.157252
27  ZTF23aaxbfzl  16.973081   1.732003
28  ZTF23aaxavca   9.017651   1.801565
29  ZTF23aaqixyp   6.388770  -7.758614
30  ZTF23aavmycb   7.102145   0.441236
31  ZTF23aatzjdo   1.226893 -13.502189
32  ZTF23aaxtdpc   9.048410  -2.151892
33  ZTF23aazxiuu   6.501685  -0.884798
34  ZTF23aaqixha   8.509318  -9.703939
35  ZTF23aaxbfyp   4.112309 -10.371170
36  ZTF23abbjtdn   6.232715   1.033046
37  ZTF23aazwshk  10.101225   4.791153
38  ZTF23aazwytj   0.881927 -10.744196]",,12.717697858810425,2025-05-20T17:26:16,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,4,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.62554383277893,2025-04-29T12:11:17,"[             oid     meanra    meandec
0   ZTF23abdhvab  17.532746   2.468053
1   ZTF23abchvcs  13.272933  -1.453402
2   ZTF23aapwihe  17.827492   0.742945
3   ZTF23abbkepd  13.835889   5.077601
4   ZTF23abapoiv   5.230048  -1.758021
5   ZTF23aazxfdh  11.327556  -2.327343
6   ZTF23abbbygf  16.168206  -1.053601
7   ZTF23abbbybs  12.780815  -5.443683
8   ZTF23abbjstt  13.706127  -3.710276
9   ZTF23aaaweph   1.307964 -11.502395
10  ZTF23aaxtrgs   1.760985  -9.567699
11  ZTF23aazxair  14.098124   0.520434
12  ZTF23aasyvbf   9.411387  -4.281495
13  ZTF23aaaweph   1.307964 -11.502395
14  ZTF23abaychv  12.394942  -3.037759
15  ZTF23abbitkh  10.628642   8.028922
16  ZTF23abbefkk   9.982778   6.622644
17  ZTF23aarfbvs  11.196881  -2.378468
18  ZTF23aarfpck   6.464097   2.183000
19  ZTF23aaumlxn   6.423729  -1.050326
20  ZTF23aapvrkk   0.175006 -12.236802
21  ZTF23aaretvs  15.263196  -2.912866
22  ZTF23aaxavca   9.017651   1.801565
23  ZTF23aapqtxd   8.879058   2.147919
24  ZTF23aaxbfzl  16.973081   1.732003
25  ZTF23aawqydv  19.468501   0.780816
26  ZTF23aaxavca   9.017651   1.801565
27  ZTF23aavmycb   7.102145   0.441236
28  ZTF23aapgxic   7.748520   5.157252
29  ZTF23aaohpnv   8.491958   4.082251
30  ZTF23aatzjdo   1.226893 -13.502189
31  ZTF23aaqixyp   6.388770  -7.758614
32  ZTF23aaxtdpc   9.048410  -2.151892
33  ZTF23abbjtdn   6.232715   1.033046
34  ZTF23aazwytj   0.881927 -10.744196
35  ZTF23aaqixha   8.509318  -9.703939
36  ZTF23aazxiuu   6.501685  -0.884798
37  ZTF23aaxbfyp   4.112309 -10.371170
38  ZTF23aazwshk  10.101225   4.791153]",,12.800698518753052,2025-05-20T17:26:41,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,5,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.8718278408050537,2025-04-29T12:11:21,"[             oid     meanra    meandec
0   ZTF23abapoiv   5.230048  -1.758021
1   ZTF23abdhvab  17.532746   2.468053
2   ZTF23abchvcs  13.272933  -1.453402
3   ZTF23aapwihe  17.827492   0.742945
4   ZTF23abbkepd  13.835889   5.077601
5   ZTF23abbbygf  16.168206  -1.053601
6   ZTF23abbbybs  12.780815  -5.443683
7   ZTF23abbitkh  10.628642   8.028922
8   ZTF23abbjstt  13.706127  -3.710276
9   ZTF23aaaweph   1.307964 -11.502395
10  ZTF23abaychv  12.394942  -3.037759
11  ZTF23aasyvbf   9.411387  -4.281495
12  ZTF23abbefkk   9.982778   6.622644
13  ZTF23aazxfdh  11.327556  -2.327343
14  ZTF23aaxtrgs   1.760985  -9.567699
15  ZTF23aazxair  14.098124   0.520434
16  ZTF23aaaweph   1.307964 -11.502395
17  ZTF23aaretvs  15.263196  -2.912866
18  ZTF23aarfbvs  11.196881  -2.378468
19  ZTF23aarfpck   6.464097   2.183000
20  ZTF23aaumlxn   6.423729  -1.050326
21  ZTF23aaxavca   9.017651   1.801565
22  ZTF23aaxavca   9.017651   1.801565
23  ZTF23aapvrkk   0.175006 -12.236802
24  ZTF23aapqtxd   8.879058   2.147919
25  ZTF23aawqydv  19.468501   0.780816
26  ZTF23aaxbfzl  16.973081   1.732003
27  ZTF23aapgxic   7.748520   5.157252
28  ZTF23aaohpnv   8.491958   4.082251
29  ZTF23aatzjdo   1.226893 -13.502189
30  ZTF23aavmycb   7.102145   0.441236
31  ZTF23aaqixyp   6.388770  -7.758614
32  ZTF23aazxiuu   6.501685  -0.884798
33  ZTF23aaxtdpc   9.048410  -2.151892
34  ZTF23aaqixha   8.509318  -9.703939
35  ZTF23aaxbfyp   4.112309 -10.371170
36  ZTF23aazwytj   0.881927 -10.744196
37  ZTF23abbjtdn   6.232715   1.033046
38  ZTF23aazwshk  10.101225   4.791153]",,10.90208649635315,2025-05-20T17:27:04,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,6,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.172250986099243,2025-04-29T12:11:25,"[             oid     meanra    meandec
0   ZTF23abdhvab  17.532746   2.468053
1   ZTF23abchvcs  13.272933  -1.453402
2   ZTF23aapwihe  17.827492   0.742945
3   ZTF23abbkepd  13.835889   5.077601
4   ZTF23abapoiv   5.230048  -1.758021
5   ZTF23abbjstt  13.706127  -3.710276
6   ZTF23abbbygf  16.168206  -1.053601
7   ZTF23abbbybs  12.780815  -5.443683
8   ZTF23aazxfdh  11.327556  -2.327343
9   ZTF23aaaweph   1.307964 -11.502395
10  ZTF23aaxtrgs   1.760985  -9.567699
11  ZTF23aaaweph   1.307964 -11.502395
12  ZTF23aazxair  14.098124   0.520434
13  ZTF23aasyvbf   9.411387  -4.281495
14  ZTF23abaychv  12.394942  -3.037759
15  ZTF23aaumlxn   6.423729  -1.050326
16  ZTF23abbitkh  10.628642   8.028922
17  ZTF23aarfpck   6.464097   2.183000
18  ZTF23abbefkk   9.982778   6.622644
19  ZTF23aaretvs  15.263196  -2.912866
20  ZTF23aarfbvs  11.196881  -2.378468
21  ZTF23aapqtxd   8.879058   2.147919
22  ZTF23aapvrkk   0.175006 -12.236802
23  ZTF23aawqydv  19.468501   0.780816
24  ZTF23aaxavca   9.017651   1.801565
25  ZTF23aaxavca   9.017651   1.801565
26  ZTF23aaxbfzl  16.973081   1.732003
27  ZTF23aaqixyp   6.388770  -7.758614
28  ZTF23aapgxic   7.748520   5.157252
29  ZTF23aaohpnv   8.491958   4.082251
30  ZTF23aavmycb   7.102145   0.441236
31  ZTF23aazwytj   0.881927 -10.744196
32  ZTF23aazxiuu   6.501685  -0.884798
33  ZTF23abbjtdn   6.232715   1.033046
34  ZTF23aatzjdo   1.226893 -13.502189
35  ZTF23aaxtdpc   9.048410  -2.151892
36  ZTF23aaqixha   8.509318  -9.703939
37  ZTF23aaxbfyp   4.112309 -10.371170
38  ZTF23aazwshk  10.101225   4.791153]",,10.31132459640503,2025-05-20T17:27:27,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,7,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.948074102401733,2025-04-29T12:11:30,"[             oid     meanra    meandec
0   ZTF23abdhvab  17.532746   2.468053
1   ZTF23abchvcs  13.272933  -1.453402
2   ZTF23aapwihe  17.827492   0.742945
3   ZTF23abbkepd  13.835889   5.077601
4   ZTF23abapoiv   5.230048  -1.758021
5   ZTF23abbbybs  12.780815  -5.443683
6   ZTF23abbbygf  16.168206  -1.053601
7   ZTF23abbjstt  13.706127  -3.710276
8   ZTF23aazxfdh  11.327556  -2.327343
9   ZTF23aazxair  14.098124   0.520434
10  ZTF23aaxtrgs   1.760985  -9.567699
11  ZTF23abbefkk   9.982778   6.622644
12  ZTF23aaaweph   1.307964 -11.502395
13  ZTF23aaaweph   1.307964 -11.502395
14  ZTF23abaychv  12.394942  -3.037759
15  ZTF23aasyvbf   9.411387  -4.281495
16  ZTF23aaxavca   9.017651   1.801565
17  ZTF23aarfpck   6.464097   2.183000
18  ZTF23aaumlxn   6.423729  -1.050326
19  ZTF23aarfbvs  11.196881  -2.378468
20  ZTF23aapqtxd   8.879058   2.147919
21  ZTF23aawqydv  19.468501   0.780816
22  ZTF23aaxbfzl  16.973081   1.732003
23  ZTF23abbitkh  10.628642   8.028922
24  ZTF23aaretvs  15.263196  -2.912866
25  ZTF23aapvrkk   0.175006 -12.236802
26  ZTF23aaxavca   9.017651   1.801565
27  ZTF23aaohpnv   8.491958   4.082251
28  ZTF23aapgxic   7.748520   5.157252
29  ZTF23aavmycb   7.102145   0.441236
30  ZTF23aaqixyp   6.388770  -7.758614
31  ZTF23aatzjdo   1.226893 -13.502189
32  ZTF23aaxtdpc   9.048410  -2.151892
33  ZTF23aaqixha   8.509318  -9.703939
34  ZTF23aaxbfyp   4.112309 -10.371170
35  ZTF23aazxiuu   6.501685  -0.884798
36  ZTF23aazwshk  10.101225   4.791153
37  ZTF23abbjtdn   6.232715   1.033046
38  ZTF23aazwytj   0.881927 -10.744196]",,12.290610313415527,2025-05-20T17:27:51,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,8,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.944629669189453,2025-04-29T12:11:34,"[             oid     meanra    meandec
0   ZTF23aazxfdh  11.327556  -2.327343
1   ZTF23abdhvab  17.532746   2.468053
2   ZTF23abchvcs  13.272933  -1.453402
3   ZTF23aapwihe  17.827492   0.742945
4   ZTF23abbkepd  13.835889   5.077601
5   ZTF23abapoiv   5.230048  -1.758021
6   ZTF23abbbygf  16.168206  -1.053601
7   ZTF23abbbybs  12.780815  -5.443683
8   ZTF23aaxtrgs   1.760985  -9.567699
9   ZTF23abbjstt  13.706127  -3.710276
10  ZTF23aazxair  14.098124   0.520434
11  ZTF23aaaweph   1.307964 -11.502395
12  ZTF23aaaweph   1.307964 -11.502395
13  ZTF23abaychv  12.394942  -3.037759
14  ZTF23aasyvbf   9.411387  -4.281495
15  ZTF23abbefkk   9.982778   6.622644
16  ZTF23abbitkh  10.628642   8.028922
17  ZTF23aarfpck   6.464097   2.183000
18  ZTF23aaumlxn   6.423729  -1.050326
19  ZTF23aarfbvs  11.196881  -2.378468
20  ZTF23aaxbfzl  16.973081   1.732003
21  ZTF23aaretvs  15.263196  -2.912866
22  ZTF23aapvrkk   0.175006 -12.236802
23  ZTF23aapqtxd   8.879058   2.147919
24  ZTF23aawqydv  19.468501   0.780816
25  ZTF23aaxavca   9.017651   1.801565
26  ZTF23aaxavca   9.017651   1.801565
27  ZTF23aaqixyp   6.388770  -7.758614
28  ZTF23aaohpnv   8.491958   4.082251
29  ZTF23aavmycb   7.102145   0.441236
30  ZTF23aapgxic   7.748520   5.157252
31  ZTF23aazxiuu   6.501685  -0.884798
32  ZTF23aatzjdo   1.226893 -13.502189
33  ZTF23aaxtdpc   9.048410  -2.151892
34  ZTF23aaqixha   8.509318  -9.703939
35  ZTF23aaxbfyp   4.112309 -10.371170
36  ZTF23abbjtdn   6.232715   1.033046
37  ZTF23aazwshk  10.101225   4.791153
38  ZTF23aazwytj   0.881927 -10.744196]",,11.452914476394652,2025-05-20T17:28:13,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,9,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.006241083145142,2025-04-29T12:11:38,"[             oid     meanra    meandec
0   ZTF23abdhvab  17.532746   2.468053
1   ZTF23abchvcs  13.272933  -1.453402
2   ZTF23aapwihe  17.827492   0.742945
3   ZTF23abbkepd  13.835889   5.077601
4   ZTF23abapoiv   5.230048  -1.758021
5   ZTF23abbbybs  12.780815  -5.443683
6   ZTF23abbbygf  16.168206  -1.053601
7   ZTF23aazxfdh  11.327556  -2.327343
8   ZTF23aazxair  14.098124   0.520434
9   ZTF23abbjstt  13.706127  -3.710276
10  ZTF23aaxtrgs   1.760985  -9.567699
11  ZTF23aaaweph   1.307964 -11.502395
12  ZTF23aaaweph   1.307964 -11.502395
13  ZTF23abbitkh  10.628642   8.028922
14  ZTF23abbefkk   9.982778   6.622644
15  ZTF23abaychv  12.394942  -3.037759
16  ZTF23aasyvbf   9.411387  -4.281495
17  ZTF23aarfpck   6.464097   2.183000
18  ZTF23aaumlxn   6.423729  -1.050326
19  ZTF23aapvrkk   0.175006 -12.236802
20  ZTF23aaretvs  15.263196  -2.912866
21  ZTF23aarfbvs  11.196881  -2.378468
22  ZTF23aaxbfzl  16.973081   1.732003
23  ZTF23aapqtxd   8.879058   2.147919
24  ZTF23aawqydv  19.468501   0.780816
25  ZTF23aaxavca   9.017651   1.801565
26  ZTF23abbjtdn   6.232715   1.033046
27  ZTF23aaxavca   9.017651   1.801565
28  ZTF23aaohpnv   8.491958   4.082251
29  ZTF23aatzjdo   1.226893 -13.502189
30  ZTF23aaxtdpc   9.048410  -2.151892
31  ZTF23aaxbfyp   4.112309 -10.371170
32  ZTF23aazwshk  10.101225   4.791153
33  ZTF23aapgxic   7.748520   5.157252
34  ZTF23aavmycb   7.102145   0.441236
35  ZTF23aaqixyp   6.388770  -7.758614
36  ZTF23aaqixha   8.509318  -9.703939
37  ZTF23aazxiuu   6.501685  -0.884798
38  ZTF23aazwytj   0.881927 -10.744196]",,12.081048965454102,2025-05-20T17:28:37,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,12,10,"
SELECT object.oid, object.meanra, object.meandec
FROM object
INNER JOIN probability ON object.oid = probability.oid
WHERE probability.ranking = 1
AND probability.classifier_name = 'lc_classifier'
AND probability.class_name IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
AND object.firstmjd BETWEEN 59988.0 AND 60200.0
AND point(object.meanra, object.meandec) <@ '((-20, -20), (-2, -20), (20, 1), (10, 10))'::polygon
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.978456974029541,2025-04-29T12:11:42,"[             oid     meanra    meandec
0   ZTF23abdhvab  17.532746   2.468053
1   ZTF23abchvcs  13.272933  -1.453402
2   ZTF23aapwihe  17.827492   0.742945
3   ZTF23abbkepd  13.835889   5.077601
4   ZTF23abapoiv   5.230048  -1.758021
5   ZTF23abbjstt  13.706127  -3.710276
6   ZTF23abbbybs  12.780815  -5.443683
7   ZTF23aazxfdh  11.327556  -2.327343
8   ZTF23abbbygf  16.168206  -1.053601
9   ZTF23aaaweph   1.307964 -11.502395
10  ZTF23aazxair  14.098124   0.520434
11  ZTF23aaxtrgs   1.760985  -9.567699
12  ZTF23abaychv  12.394942  -3.037759
13  ZTF23aaaweph   1.307964 -11.502395
14  ZTF23aasyvbf   9.411387  -4.281495
15  ZTF23abbefkk   9.982778   6.622644
16  ZTF23abbitkh  10.628642   8.028922
17  ZTF23aaumlxn   6.423729  -1.050326
18  ZTF23aarfpck   6.464097   2.183000
19  ZTF23aaretvs  15.263196  -2.912866
20  ZTF23aarfbvs  11.196881  -2.378468
21  ZTF23aapvrkk   0.175006 -12.236802
22  ZTF23aaohpnv   8.491958   4.082251
23  ZTF23aaxbfzl  16.973081   1.732003
24  ZTF23aaxavca   9.017651   1.801565
25  ZTF23aapgxic   7.748520   5.157252
26  ZTF23aapqtxd   8.879058   2.147919
27  ZTF23aawqydv  19.468501   0.780816
28  ZTF23aaxavca   9.017651   1.801565
29  ZTF23aatzjdo   1.226893 -13.502189
30  ZTF23aaqixyp   6.388770  -7.758614
31  ZTF23aavmycb   7.102145   0.441236
32  ZTF23aaxtdpc   9.048410  -2.151892
33  ZTF23aaqixha   8.509318  -9.703939
34  ZTF23aazxiuu   6.501685  -0.884798
35  ZTF23aaxbfyp   4.112309 -10.371170
36  ZTF23aazwshk  10.101225   4.791153
37  ZTF23abbjtdn   6.232715   1.033046
38  ZTF23aazwytj   0.881927 -10.744196]",,10.79017734527588,2025-05-20T17:29:00,0.6271186440677966,0.9487179487179488,1.0,1.0,0.0,1.0
0.16.3,,,57,0,"WITH catalog (id, obj_ra, obj_dec, r_deg) AS (
VALUES
('id_1', 354.67, 15.954, 0.00833333),
('id_2', 20.7993, 1.00331, 0.00555556)
)
SELECT
    c.id, c.obj_ra, c.obj_dec, r_deg, oid, ndet,
    meanra, meandec, firstmjd
FROM
    catalog AS c, object AS o
WHERE
    q3c_join(c.obj_ra, c.obj_dec, o.meanra, o.meandec, c.r_deg)
ORDER BY lastmjd DESC",,,,,"[     id    obj_ra   obj_dec     r_deg           oid  ndet      meanra  \
0  id_1  354.6700  15.95400  0.008333  ZTF18acfqezx     2  354.671235   
1  id_1  354.6700  15.95400  0.008333  ZTF22acabgbb     1  354.663704   
2  id_1  354.6700  15.95400  0.008333  ZTF20abyptpc    96  354.670313   
3  id_2   20.7993   1.00331  0.005556  ZTF20abywohm    89   20.799247   
4  id_2   20.7993   1.00331  0.005556  ZTF18abqyaix    46   20.799251   

     meandec      firstmjd  
0  15.954552  58431.216979  
1  15.955837  59935.163229  
2  15.954038  59098.360544  
3   1.003320  59073.419086  
4   1.003313  59073.419086  ]",,3.4585769176483154,2025-05-20T17:29:07,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,57,1,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        i.identifier, 
        i.ra AS input_ra, 
        i.dec AS input_dec, 
        i.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects i
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(o.meandec)) * SIN(RADIANS(i.dec)) + COS(RADIANS(o.meandec)) * COS(RADIANS(i.dec)) * COS(RADIANS(o.meanra - i.ra)))) <= i.search_radius)
)
SELECT 
    identifier, 
    input_ra AS ra, 
    input_dec AS dec, 
    search_radius, 
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date
FROM 
    ztf_objects
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,42.59938836097717,2025-04-29T12:12:25,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        i.identifier, 
        i.ra AS input_ra, 
        i.dec AS input_dec, 
        i.search_radius
    FROM 
        object o
    JOIN 
        input_objects i ON (DEGREES(ACOS(SIN(RADIANS(o.meandec)) * SIN(RADIANS(i.dec)) + COS(RADIANS(o.meandec)) * COS(RADIANS(i.dec)) * COS(RADIANS(o.meanra - i.ra)))) <= i.search_radius)
)
SELECT 
    identifier, 
    input_ra AS ra, 
    input_dec AS dec, 
    search_radius, 
    oid AS ztf_identifier, 
    ndet AS number_of_detections, 
    meanra AS mean_ra, 
    meandec AS mean_dec, 
    firstmjd AS first_detection_date
FROM 
    ztf_objects
ORDER BY 
    lastmjd DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",255.52133989334104,2025-05-20T17:33:35,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,57,2,"
WITH distance_calculation AS (
    SELECT 
        oid,
        meanra,
        meandec,
        ndet,
        firstmjd,
        lastmjd,
        -- Calculate distance from id_1
        DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 354.67)))) * 3600 AS distance_id_1,
        -- Calculate distance from id_2
        DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 20.7993)))) * 3600 AS distance_id_2
    FROM 
        object
),
filtered_objects AS (
    SELECT 
        oid,
        meanra,
        meandec,
        ndet,
        firstmjd,
        lastmjd
    FROM 
        distance_calculation
    WHERE 
        distance_id_1 <= 30 OR distance_id_2 <= 20
)
SELECT 
    'id_1' AS input_identifier,
    354.67 AS input_ra,
    15.954 AS input_dec,
    30/3600.0 AS search_radius_deg,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
WHERE 
    DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30

UNION

SELECT 
    'id_2' AS input_identifier,
    20.7993 AS input_ra,
    1.00331 AS input_dec,
    20/3600.0 AS search_radius_deg,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
WHERE 
    DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,26.44642853736877,2025-04-29T12:12:51,[None],"(psycopg2.errors.UndefinedColumn) column ""mjdendhist"" does not exist
LINE 62:     mjdendhist DESC -- Corrected column name from lastmjd to...
             ^

[SQL: 
WITH distance_calculation AS (
    SELECT 
        oid,
        meanra,
        meandec,
        ndet,
        firstmjd,
        mjdendhist, -- Corrected column name from lastmjd to mjdendhist
        -- Calculate distance from id_1
        DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 354.67)))) * 3600 AS distance_id_1,
        -- Calculate distance from id_2
        DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 20.7993)))) * 3600 AS distance_id_2
    FROM 
        object
),
filtered_objects AS (
    SELECT 
        oid,
        meanra,
        meandec,
        ndet,
        firstmjd,
        mjdendhist -- Corrected column name from lastmjd to mjdendhist
    FROM 
        distance_calculation
    WHERE 
        distance_id_1 <= 30 OR distance_id_2 <= 20
)
SELECT 
    'id_1' AS input_identifier,
    354.67 AS input_ra,
    15.954 AS input_dec,
    30/3600.0 AS search_radius_deg,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
WHERE 
    DEGREES(ACOS(SIN(RADIANS(15.954)) * SIN(RADIANS(meandec)) + COS(RADIANS(15.954)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 354.67)))) * 3600 <= 30

UNION

SELECT 
    'id_2' AS input_identifier,
    20.7993 AS input_ra,
    1.00331 AS input_dec,
    20/3600.0 AS search_radius_deg,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
WHERE 
    DEGREES(ACOS(SIN(RADIANS(1.00331)) * SIN(RADIANS(meandec)) + COS(RADIANS(1.00331)) * COS(RADIANS(meandec)) * COS(RADIANS(meanra - 20.7993)))) * 3600 <= 20
ORDER BY 
    mjdendhist DESC -- Corrected column name from lastmjd to mjdendhist
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.75237202644348,2025-05-20T17:33:56,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,57,3,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
nearby_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        io.identifier, 
        io.ra AS input_ra, 
        io.dec AS input_dec, 
        io.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects io
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(io.dec)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(io.dec)) * COS(RADIANS(o.meandec)) * COS(RADIANS(io.ra - o.meanra)))) <= io.search_radius)
)
SELECT 
    identifier, 
    input_ra AS ra, 
    input_dec AS dec, 
    search_radius, 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd
FROM 
    nearby_objects
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.21096420288086,2025-04-29T12:13:14,"[  identifier        ra       dec  search_radius           oid  ndet  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx     2   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb     1   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc    96   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm    89   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix    46   

       meanra    meandec      firstmjd  
0  354.671235  15.954552  58431.216979  
1  354.663704  15.955837  59935.163229  
2  354.670313  15.954038  59098.360544  
3   20.799247   1.003320  59073.419086  
4   20.799251   1.003313  59073.419086  ]",,167.32422924041748,2025-05-20T17:36:52,1.0,1.0,0.5555555555555556,0.5555555555555556,1.0,0.0
0.16.3,gpt-4o,v1,57,4,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
filtered_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        io.identifier, 
        io.ra AS input_ra, 
        io.dec AS input_dec, 
        io.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects io
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(io.dec)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(io.dec)) * COS(RADIANS(o.meandec)) * COS(RADIANS(io.ra - o.meanra)))) <= io.search_radius)
)
SELECT 
    fo.identifier, 
    fo.input_ra AS ra, 
    fo.input_dec AS dec, 
    fo.search_radius, 
    fo.oid AS ztf_identifier, 
    fo.ndet AS number_of_detections, 
    fo.meanra AS mean_ra, 
    fo.meandec AS mean_dec, 
    fo.firstmjd AS first_detection_date
FROM 
    filtered_objects fo
ORDER BY 
    fo.lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,20.540930032730103,2025-04-29T12:13:35,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,155.05400156974792,2025-05-20T17:39:38,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,5,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date
    FROM 
        object o
    JOIN 
        input_objects io
    ON 
        (acos(sin(radians(io.dec)) * sin(radians(o.meandec)) + cos(radians(io.dec)) * cos(radians(o.meandec)) * cos(radians(io.ra - o.meanra))) * 180/pi()) <= io.search_radius
)
SELECT 
    io.identifier,
    io.ra AS input_ra,
    io.dec AS input_dec,
    io.search_radius,
    ztf.ztf_identifier,
    ztf.number_of_detections,
    ztf.mean_ra,
    ztf.mean_dec,
    ztf.first_detection_date
FROM 
    input_objects io
JOIN 
    ztf_objects ztf
ON 
    true
ORDER BY 
    ztf.last_detection_date DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.944085597991943,2025-04-29T12:13:57,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date
    FROM 
        object o
    WHERE EXISTS (
        SELECT 1
        FROM input_objects io
        WHERE (acos(sin(radians(io.dec)) * sin(radians(o.meandec)) + cos(radians(io.dec)) * cos(radians(o.meandec)) * cos(radians(io.ra - o.meanra))) * 180/pi()) <= io.search_radius
    )
)
SELECT 
    io.identifier,
    io.ra AS input_ra,
    io.dec AS input_dec,
    io.search_radius,
    ztf.ztf_identifier,
    ztf.number_of_detections,
    ztf.mean_ra,
    ztf.mean_dec,
    ztf.first_detection_date
FROM 
    input_objects io
JOIN 
    ztf_objects ztf
ON 
    (acos(sin(radians(io.dec)) * sin(radians(ztf.mean_dec)) + cos(radians(io.dec)) * cos(radians(ztf.mean_dec)) * cos(radians(io.ra - ztf.mean_ra))) * 180/pi()) <= io.search_radius
ORDER BY 
    ztf.last_detection_date DESC
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.39437317848206,2025-05-20T17:44:02,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,57,6,"
WITH id_1_objects AS (
    SELECT 
        oid, 
        meanra, 
        meandec, 
        ndet, 
        firstmjd, 
        lastmjd,
        (2 * asin(sqrt(sin(radians((meandec - 15.954) / 2))^2 + cos(radians(15.954)) * cos(radians(meandec)) * sin(radians((meanra - 354.67) / 2))^2))) * 180/pi() * 3600 AS distance_arcsec
    FROM 
        object
    WHERE 
        (2 * asin(sqrt(sin(radians((meandec - 15.954) / 2))^2 + cos(radians(15.954)) * cos(radians(meandec)) * sin(radians((meanra - 354.67) / 2))^2))) * 180/pi() * 3600 <= 30
),
id_2_objects AS (
    SELECT 
        oid, 
        meanra, 
        meandec, 
        ndet, 
        firstmjd, 
        lastmjd,
        (2 * asin(sqrt(sin(radians((meandec - 1.00331) / 2))^2 + cos(radians(1.00331)) * cos(radians(meandec)) * sin(radians((meanra - 20.7993) / 2))^2))) * 180/pi() * 3600 AS distance_arcsec
    FROM 
        object
    WHERE 
        (2 * asin(sqrt(sin(radians((meandec - 1.00331) / 2))^2 + cos(radians(1.00331)) * cos(radians(meandec)) * sin(radians((meanra - 20.7993) / 2))^2))) * 180/pi() * 3600 <= 20
),
combined_objects AS (
    SELECT * FROM id_1_objects
    UNION
    SELECT * FROM id_2_objects
)
SELECT 
    'id_1' AS input_identifier,
    354.67 AS input_ra,
    15.954 AS input_dec,
    30/3600.0 AS search_radius_deg,
    co.oid AS ztf_identifier,
    co.ndet AS number_of_detections,
    co.meanra AS mean_ra,
    co.meandec AS mean_dec,
    co.firstmjd AS first_detection_date
FROM 
    combined_objects co
ORDER BY 
    co.lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.898033380508423,2025-04-29T12:14:23,"[  input_identifier  input_ra  input_dec  search_radius_deg           oid  \
0             id_1    354.67     15.954           0.008333  ZTF18acfqezx   
1             id_1    354.67     15.954           0.008333  ZTF22acabgbb   
2             id_1    354.67     15.954           0.008333  ZTF20abyptpc   
3             id_1    354.67     15.954           0.008333  ZTF20abywohm   
4             id_1    354.67     15.954           0.008333  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,56.188167333602905,2025-05-20T17:45:35,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,7,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid, 
        o.ndet, 
        o.meanra, 
        o.meandec, 
        o.firstmjd, 
        o.lastmjd,
        io.identifier AS input_identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects io
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(io.dec)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(io.dec)) * COS(RADIANS(o.meandec)) * COS(RADIANS(io.ra - o.meanra)))) <= io.search_radius)
)
SELECT 
    input_identifier AS identifier,
    input_ra AS ra,
    input_dec AS dec,
    search_radius,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    ztf_objects
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,27.32415270805359,2025-04-29T12:14:51,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,151.38456559181213,2025-05-20T17:48:44,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,8,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
filtered_objects AS (
    SELECT 
        o.oid, 
        o.meanra, 
        o.meandec, 
        o.ndet, 
        o.firstmjd, 
        o.lastmjd,
        io.identifier,
        io.ra AS input_ra,
        io.dec AS input_dec,
        io.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects io
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(io.dec)) * SIN(RADIANS(o.meandec)) + COS(RADIANS(io.dec)) * COS(RADIANS(o.meandec)) * COS(RADIANS(io.ra - o.meanra)))) <= io.search_radius)
)
SELECT 
    identifier,
    input_ra AS ra,
    input_dec AS dec,
    search_radius,
    oid AS ztf_identifier,
    ndet AS number_of_detections,
    meanra AS mean_ra,
    meandec AS mean_dec,
    firstmjd AS first_detection_date
FROM 
    filtered_objects
ORDER BY 
    lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.372729063034058,2025-04-29T12:15:14,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,161.54998779296875,2025-05-20T17:51:37,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,9,"
WITH id_1_objects AS (
    SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
    FROM object
    WHERE (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(15.954)) + COS(RADIANS(meandec)) * COS(RADIANS(15.954)) * COS(RADIANS(meanra - 354.67)))) * 3600) <= 30
),
id_2_objects AS (
    SELECT oid, meanra, meandec, ndet, firstmjd, lastmjd
    FROM object
    WHERE (DEGREES(ACOS(SIN(RADIANS(meandec)) * SIN(RADIANS(1.00331)) + COS(RADIANS(meandec)) * COS(RADIANS(1.00331)) * COS(RADIANS(meanra - 20.7993)))) * 3600) <= 20
),
combined_objects AS (
    SELECT * FROM id_1_objects
    UNION
    SELECT * FROM id_2_objects
)
SELECT 
    'id_1' AS input_identifier, 354.67 AS input_ra, 15.954 AS input_dec, 30/3600.0 AS search_radius_deg,
    co.oid AS ztf_identifier, co.ndet AS number_of_detections, 
    co.meanra AS mean_ra, co.meandec AS mean_dec, 
    co.firstmjd AS first_detection_date
FROM combined_objects co
ORDER BY co.lastmjd DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.021767616271973,2025-04-29T12:15:37,"[  input_identifier  input_ra  input_dec  search_radius_deg           oid  \
0             id_1  354.6700   15.95400           0.008333  ZTF18acfqezx   
1             id_1  354.6700   15.95400           0.008333  ZTF22acabgbb   
2             id_1  354.6700   15.95400           0.008333  ZTF20abyptpc   
3             id_2   20.7993    1.00331           0.005556  ZTF20abywohm   
4             id_2   20.7993    1.00331           0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,95.44956588745116,2025-05-20T17:53:20,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,57,10,"
WITH input_objects AS (
    SELECT 'id_1' AS identifier, 354.67 AS ra, 15.954 AS dec, 30/3600.0 AS search_radius
    UNION ALL
    SELECT 'id_2', 20.7993, 1.00331, 20/3600.0
),
ztf_objects AS (
    SELECT 
        o.oid AS ztf_identifier,
        o.ndet AS number_of_detections,
        o.meanra AS mean_ra,
        o.meandec AS mean_dec,
        o.firstmjd AS first_detection_date,
        o.lastmjd AS last_detection_date,
        i.identifier,
        i.ra AS input_ra,
        i.dec AS input_dec,
        i.search_radius
    FROM 
        object o
    CROSS JOIN 
        input_objects i
    WHERE 
        (DEGREES(ACOS(SIN(RADIANS(o.meandec)) * SIN(RADIANS(i.dec)) + COS(RADIANS(o.meandec)) * COS(RADIANS(i.dec)) * COS(RADIANS(o.meanra - i.ra)))) <= i.search_radius)
)
SELECT 
    identifier,
    input_ra AS ra,
    input_dec AS dec,
    search_radius,
    ztf_identifier,
    number_of_detections,
    mean_ra,
    mean_dec,
    first_detection_date
FROM 
    ztf_objects
ORDER BY 
    last_detection_date DESC
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.898801803588867,2025-04-29T12:15:56,"[  identifier        ra       dec  search_radius           oid  \
0       id_1  354.6700  15.95400       0.008333  ZTF18acfqezx   
1       id_1  354.6700  15.95400       0.008333  ZTF22acabgbb   
2       id_1  354.6700  15.95400       0.008333  ZTF20abyptpc   
3       id_2   20.7993   1.00331       0.005556  ZTF20abywohm   
4       id_2   20.7993   1.00331       0.005556  ZTF18abqyaix   

   number_of_detections     mean_ra   mean_dec  first_detection_date  
0                     2  354.671235  15.954552          58431.216979  
1                     1  354.663704  15.955837          59935.163229  
2                    96  354.670313  15.954038          59098.360544  
3                    89   20.799247   1.003320          59073.419086  
4                    46   20.799251   1.003313          59073.419086  ]",,151.63145661354065,2025-05-20T17:56:00,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,,,75,0,"SELECT
    *
FROM
    ss_ztf
WHERE
    ssnamenr != 'null'
LIMIT 100",,,,,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF19abxgnls   978299663015015029       0.0     19.0   165003
96  ZTF19abxgnlv   978299666115015019       0.0     18.6    22372
97  ZTF19abxgnvm   978299665915015007       0.0     18.6    70052
98  ZTF19abxgnyg   978299665615015026       0.0     18.1    47269
99  ZTF19abxgobf   978300113215015003       0.0     18.6   151419

[100 rows x 5 columns]]",,3.374661922454834,2025-05-20T17:56:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,75,1,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.0303070545196533,2025-04-29T12:15:58,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,7.445497989654541,2025-05-20T17:56:28,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,2,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.227222204208374,2025-04-29T12:16:01,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,7.684425354003906,2025-05-20T17:56:43,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,3,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.4657740592956543,2025-04-29T12:16:03,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.57072901725769,2025-05-20T17:56:58,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,4,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.3090202808380127,2025-04-29T12:16:06,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,7.657769441604614,2025-05-20T17:57:12,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,5,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.3580243587493896,2025-04-29T12:16:08,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.244497060775757,2025-05-20T17:57:28,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,6,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.798748254776001,2025-04-29T12:16:11,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.273772954940796,2025-05-20T17:57:43,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,7,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,5.494010210037232,2025-04-29T12:16:17,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,8.632095336914062,2025-05-20T17:58:00,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,8,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.9541432857513428,2025-04-29T12:16:20,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,7.512763500213623,2025-05-20T17:58:14,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,9,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,4.195446968078613,2025-04-29T12:16:24,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,7.721165657043457,2025-05-20T17:58:29,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,75,10,"
SELECT * 
FROM ss_ztf 
WHERE ssnamenr IS NOT NULL 
LIMIT 100
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,2.882386922836304,2025-04-29T12:16:27,"[             oid               candid  ssdistnr  ssmagnr ssnamenr
0   ZTF22aaboujf  1876506993715015001       1.0     20.1   257692
1   ZTF22aaboujb  1876505551515015016       0.0     19.6    47076
2   ZTF22aabouiw  1876505551515015019       0.0     16.7     1074
3   ZTF22aabouix  1876505551515015020       0.0     18.0     3133
4   ZTF22aabouji  1876505552215015016       0.0     18.7    14567
..           ...                  ...       ...      ...      ...
95  ZTF22aabouvy  1876506513915015010       0.0     19.3    15928
96  ZTF22aabouuq  1876506514615015010       0.0     19.9    12954
97  ZTF22aabouuu  1876506990415015007       0.0     20.1    63356
98  ZTF22aabouuz  1876507462215015007    -999.0   -999.0     null
99  ZTF22aabouvd  1876506511615015001       0.0     18.9    29242

[100 rows x 5 columns]]",,7.088431358337402,2025-05-20T17:58:44,0.75,0.75,1.0,1.0,0.0,1.0
0.16.3,,,43,0,"SELECT
    oid, candid, xpos, ypos, scorr
FROM
    dataquality
WHERE
    oid IN ('ZTF20acwrybw','ZTF22abugigx')
    AND fid = 2",,,,,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,3.29244327545166,2025-05-20T17:58:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,1,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx')
  AND fid = 2  -- Filter for r-band
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.901644229888916,2025-04-29T12:16:40,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,7.801230430603027,2025-05-20T17:59:11,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,2,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.765151023864746,2025-04-29T12:16:54,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,8.15261459350586,2025-05-20T17:59:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,3,"
-- Query to retrieve r-band epochs for specified ZTF identifiers from the dataquality table
SELECT 
    dq.oid,          -- ZTF identifier
    dq.candid,       -- Candidate identifier
    dq.xpos,         -- X-image position
    dq.ypos,         -- Y-image position
    dq.scorr         -- Peak-pixel signal-to-noise ratio
FROM 
    dataquality dq
INNER JOIN 
    object o ON dq.oid = o.oid
WHERE 
    dq.fid = 2       -- Filter for r-band
    AND dq.oid IN ('ZTF20acwrybw', 'ZTF22abugigx') -- Filter for specified ZTF identifiers
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.559078216552734,2025-04-29T12:17:06,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,10.878050088882446,2025-05-20T17:59:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,4,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,15.066186666488647,2025-04-29T12:17:21,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,7.812891721725464,2025-05-20T17:59:59,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,5,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.80086064338684,2025-04-29T12:17:35,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,7.257438898086548,2025-05-20T18:00:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,6,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,16.79169273376465,2025-04-29T12:17:52,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,10.04741072654724,2025-05-20T18:00:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,7,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.864027738571169,2025-04-29T12:18:06,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,7.477557420730591,2025-05-20T18:00:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,8,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') 
  AND fid = 2  -- Filter for r-band observations
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.126296758651732,2025-04-29T12:18:18,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,8.040504455566406,2025-05-20T18:01:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,9,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE oid IN ('ZTF20acwrybw', 'ZTF22abugigx') AND fid = 2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.849597215652466,2025-04-29T12:18:30,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,8.648604393005371,2025-05-20T18:01:17,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,43,10,"
SELECT oid, candid, xpos, ypos, scorr
FROM dataquality
WHERE fid = 2
AND oid IN ('ZTF20acwrybw', 'ZTF22abugigx')
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.844850778579712,2025-04-29T12:18:43,"[             oid               candid       xpos       ypos     scorr
0   ZTF20acwrybw  1433166885615015067   172.2290   563.6970  9.628150
1   ZTF20acwrybw  1440139345615015033   173.3743   564.3097  5.196096
2   ZTF20acwrybw  1789128565615015030   214.1380   575.0902  6.518314
3   ZTF20acwrybw  1944491225615015075   150.4586   529.5159  8.528032
4   ZTF20acwrybw  1956473945615015064   139.7179   545.4087  5.655714
5   ZTF20acwrybw  2154166925615015018   208.1079   593.9471  6.181045
6   ZTF20acwrybw  2159150415615015068   222.3189   579.3848  5.737109
7   ZTF20acwrybw  2212139135615015081   178.9274   618.2436  5.307838
8   ZTF20acwrybw  2311500890615010051  1432.1919  2603.5596  5.402905
9   ZTF20acwrybw  2455283545615015060   213.3926   570.4003  6.419781
10  ZTF20acwrybw  2514165935615015068   215.5384   593.9085  6.248292
11  ZTF20acwrybw  2791392345615015051   192.9884   552.4688  6.480486
12  ZTF20acwrybw  2930185335615015117    96.3896   601.2983  6.994815
13  ZTF22abugigx  2145539015815015004   401.1461  1468.7751  5.943883]",,7.761894226074219,2025-05-20T18:01:32,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,89,0,"SELECT
    *
FROM
    dataquality
WHERE
    oid in
(
SELECT
    oid
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'SN'
    AND probability > 0.7
LIMIT 50
)",,,,,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF18abnvzka   595211421815015003    1  2348.3770  1466.9610  2.417564   
1    ZTF18abnvzka   596338331815015017    1  2367.2670  1453.9397  3.303847   
2    ZTF18abnvzka   596362871815015005    2  2369.9410  1448.2580  1.527190   
3    ZTF18abnvzka   597211651815015002    2  2351.1218  1472.4780  2.084753   
4    ZTF18abnvzka   598274091815015007    2  2363.7341  1412.3038  2.648157   
..            ...                  ...  ...        ...        ...       ...   
811  ZTF21abjkdli  1649423035115015004    2  1082.9626   821.8861  1.453475   
812  ZTF21abjkdli  1649423986215015011    2  2939.4395   799.7333  1.715245   
813  ZTF21abjkdli  1651434786215015008    2  2949.7979   770.1141  1.018056   
814  ZTF21abjkdli  1651435255115015006    2  1091.4350   791.7807  1.969983   
815  ZTF21abjkdli  1660462036215015007    2  2963.1653   817.9428  0.732299   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   -5.308269  1.851852     0.554    724.1231  ...     0.000012     0.033544   
1    2.276773  2.480000     0.982    705.2330  ...     0.000003     0.018943   
2    6.463317  1.790000     0.976    702.5592  ...     0.000003     0.022639   
3    2.766719  2.030000     0.967    721.3782  ...     0.000004     0.025518   
4    7.521810  1.630000     0.968    708.7659  ...     0.000004     0.024331   
..        ...       ...       ...         ...  ...          ...          ...   
811 -0.629522  1.910000     0.924    821.8861  ...     0.000012     0.042992   
812  0.253719  2.150000     0.950    133.0605  ...     0.000011     0.041369   
813 -0.233256  2.080000     0.867    122.7022  ...     0.000012     0.043971   
814 -0.016986  2.640000     0.883    791.7807  ...     0.000012     0.042323   
815 -0.153397  1.193382     0.741    109.3348  ...     0.000011     0.040959   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0      1318.0  0.004446  0.000031 -0.000019  26.2515   0.557  0.166258   
1      1649.0 -0.051099  0.000007 -0.000004  26.2260   0.557  0.163792   
2      1633.0  0.083738  0.000007 -0.000005  26.3650   0.557  0.163550   
3      1632.0  0.095526  0.000009 -0.000006  26.4510   0.557  0.164979   
4      1639.0  0.080029  0.000010 -0.000006  26.3900   0.556  0.164084   
..        ...       ...       ...       ...      ...     ...       ...   
811     347.0  0.106456  0.000016 -0.000013  26.0960   0.720  0.329570   
812     375.0  0.103521  0.000015 -0.000011  26.0730   0.717  0.325018   
813     370.0  0.109534  0.000017 -0.000014  26.0840   0.707  0.323961   
814     344.0  0.102209  0.000017 -0.000013  26.1125   0.717  0.331814   
815     373.0  0.100610  0.000015 -0.000012  26.1550   0.720  0.325981   

     exptime  
0        0.0  
1        0.0  
2        0.0  
3        0.0  
4        0.0  
..       ...  
811     30.0  
812     30.0  
813     30.0  
814     30.0  
815     30.0  

[816 rows x 32 columns]]",,4.44918966293335,2025-05-20T18:01:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,89,1,"
-- Retrieve all columns from the 'dataquality' table for ZTF objects with a probability greater than 0.7 of being supernovae in the 'stamp_classifier'
SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.89173674583435,2025-04-29T12:18:56,"[             oid               candid  fid       xpos       ypos     chipsf  \
0   ZTF18abajubk   550448705015010010    1  2363.1300  1590.8900   1.091460   
1   ZTF18abajubk  1244455435015010022    1  2502.1700  1519.2397   0.999364   
2   ZTF18abajubk   589388705015010006    1  2365.3400  1686.8500   1.133900   
3   ZTF18abajubk   887455875015010021    1  2461.9897  1465.3381   1.126149   
4   ZTF18abajubk   683261775015015065    2  2351.6592  1586.6317   1.694215   
5   ZTF18abajubk  1358281555015010016    1  2462.5500  1748.4000   2.524290   
6   ZTF18abajubk   562405715015010013    1  2361.8200  1703.2100   1.372850   
7   ZTF18abajubk   991161635015015037    2  2452.7075  1530.5306  10.881584   
8   ZTF18abajubk  1323342805015010017    1  2476.7550  1515.7151   1.633817   
9   ZTF18abajubk   565404585015010128    1  2355.5500  1604.1400   0.863611   
10  ZTF18abajubk   981284985015010018    1  2433.7000  1547.1600   0.919049   
11  ZTF18abajubk  1295326435015010018    1  2480.0430  1516.0284   0.740173   
12  ZTF18abajubk  1326390055015010021    1  2460.7300  1491.3200   1.259100   
13  ZTF18abajubk   598386285015010007    1  2367.8300  1464.0800   0.809586   
14  ZTF18abajubk  1355219295015010074    1  2451.9500  1769.7400   0.836573   
15  ZTF18abajubk   634130825015010014    1  2353.3000  1412.8300   0.995418   
16  ZTF18abajubk   551453445015010017    1  2361.2900  1660.2000   0.978502   
17  ZTF18abajubk   676128475015010016    1  2369.9400  1582.5800   1.738650   
18  ZTF18abajubk   620262455015010015    1  2366.5200  1545.7400   2.576410   
19  ZTF18abajubk   881464525015010032    1  2423.6500  1508.3600   1.636640   
20  ZTF18abajubk   534434815015010013    1  2357.0000  1740.0500   0.857417   
21  ZTF18abajubk   567430155015010141    1  2356.5566  1587.7671   1.243266   
22  ZTF18abajubk   919349765015010022    1  2446.4400  1509.3100   1.654850   
23  ZTF18abajubk   671151345015010013    1  2367.5200  1604.5300   1.624900   
24  ZTF18abajubk  1037176505015010025    1  2414.8600  1544.1300   0.714876   
25  ZTF18abajubk   588406715015010013    1  2369.1900  1659.5400   1.274410   
26  ZTF18abajubk   635149455015010015    1  2383.7300  1409.0100   0.972936   
27  ZTF18abajubk   566454155015010010    1  2361.7100  1587.7500   1.411000   
28  ZTF18abajubk   595370945015010020    1  2369.5500  1527.3800   1.268140   
29  ZTF18abajubk   920436365015010014    1  2434.8300  1527.7800   1.514680   
30  ZTF18abajubk   528426605015010009    1  2357.0930  1691.2654   1.202099   
31  ZTF18abajubk   539456225015010026    1  2361.6300  1604.4700   1.038960   
32  ZTF18abajubk   675181795015010016    1  2365.2600  1609.6100   1.677890   
33  ZTF18abajubk  1262374505015015074    1  2485.3545  1501.3448   4.763503   
34  ZTF18abajubk  1238477615015010018    1  2459.0600  1549.2500   0.801844   
35  ZTF18abajubk  1301390035015010043    1  2460.4200  1532.8000   1.100990   
36  ZTF18abajubk   594358815015010009    1  2365.5800  1534.9800   1.481960   
37  ZTF18abajubk   914454785015010014    1  2454.8428  1535.7771   1.283093   
38  ZTF18abajubk  1213445935015010029    1  2478.9500  1469.1300   1.050690   
39  ZTF18abajubk   557363265015010018    1  2354.3800  1581.4200   2.016430   
40  ZTF18abajubk   624311115015010023    1  2370.5900  1512.2900   1.767500   
41  ZTF18abajubk   989191605015010013    1  2458.7300  1526.2200   0.894857   
42  ZTF18abajubk  1075075775015015018    2  2413.2850  1577.0382   1.003873   
43  ZTF18abajubk   609304275015010020    1  2366.2400  1521.2500   1.148760   
44  ZTF18abajubk   612259795015010017    1  2362.5200  1518.1100   1.062650   
45  ZTF18abajubk   537423565015010016    1  2357.7168  1565.5750   2.316718   
46  ZTF18abajubk   529428795015010015    1  2359.0100  1654.4103   1.596820   
47  ZTF18abajubk   623269535015010022    1  2367.6800  1520.4700   1.193750   
48  ZTF18abajubk   885444975015010024    1  2451.4600  1471.5300   2.150720   
49  ZTF18abajubk   940325525015010017    1  2465.4248  1518.6692   1.283184   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.898201  1.229870     0.820    709.3650  ...     0.000000     0.000000   
1  -0.530137  1.440000     0.706    570.3302  ...     0.000005     0.025476   
2   0.653858  2.350000     0.837    707.1560  ...     0.000000     0.000000   
3  -0.306191  2.380000     0.779    610.5102  ...     0.000003     0.018652   
4  -2.058976  2.480000     0.979    720.8408  ...     0.000003     0.023923   
5  -1.529330  1.223430     0.816    609.9490  ...     0.000005     0.022791   
6   0.607827  3.420000     0.550    710.6780  ...     0.000000     0.000000   
7   2.489394  2.000000     1.000    619.7925  ...     0.000003     0.023670   
8  -0.556357  2.500000     0.972    595.7451  ...     0.000005     0.024694   
9   1.346350  2.350000     0.548    716.9460  ...     0.000000     0.000000   
10 -0.249826  1.282660     0.817    638.7960  ...     0.000003     0.017900   
11 -0.378967  1.287570     0.740    592.4570  ...     0.000005     0.023982   
12 -0.771332  1.233720     0.792    611.7710  ...     0.000005     0.021484   
13 -0.698426  1.211760     0.856    704.6690  ...     0.000000     0.000000   
14  0.549026  1.394700     0.549    620.5530  ...     0.000006     0.025979   
15 -1.092310  1.218260     0.938    719.2030  ...     0.000000     0.000000   
16 -0.529316  1.305840     0.713    711.2060  ...     0.000000     0.000000   
17  0.154270  2.950000     0.446    702.5570  ...     0.000000     0.000000   
18  0.402242  2.100000     0.745    705.9820  ...     0.000000     0.000000   
19 -0.284690  1.298560     0.745    648.8540  ...     0.000000     0.000000   
20  1.622150  2.350000     0.451    715.4970  ...     0.000000     0.000000   
21  1.169282  3.130000     0.660    715.9434  ...     0.000012     0.034525   
22 -0.744736  1.260300     0.887    626.0640  ...     0.000003     0.017523   
23 -0.738202  2.540000     0.627    704.9840  ...     0.000000     0.000000   
24 -0.569493  1.254020     0.869    657.6380  ...     0.000004     0.019494   
25  0.765531  1.386760     0.559    703.3050  ...     0.000000     0.000000   
26 -0.718450  1.380000     0.734    688.7730  ...     0.000000     0.000000   
27  0.769788  2.300000     0.600    710.7880  ...     0.000000     0.000000   
28  0.420102  1.281420     0.850    702.9460  ...     0.000000     0.000000   
29 -0.711193  2.260000     0.737    637.6720  ...     0.000003     0.018106   
30 -0.637638  1.800000     0.789    715.4069  ...     0.000000     0.000000   
31 -0.247725  2.540000     0.887    710.8720  ...     0.000000     0.000000   
32 -0.928245  1.242640     0.835    707.2360  ...     0.000000     0.000000   
33  0.645100  2.410000     0.983    587.1454  ...     0.000005     0.027093   
34 -0.224080  1.281420     0.777    613.4350  ...     0.000004     0.019491   
35  0.256814  1.299780     0.740    612.0830  ...     0.000006     0.024509   
36 -0.347527  1.243910     0.704    706.9230  ...     0.000000     0.000000   
37 -0.439021  1.820000     0.787    617.6572  ...     0.000003     0.019378   
38 -1.137230  2.690000     0.721    593.5460  ...     0.000005     0.023082   
39 -0.061586  1.255280     0.675    718.1210  ...     0.000000     0.000000   
40 -0.553299  1.970000     0.836    701.9140  ...     0.000000     0.000000   
41 -0.542285  1.224720     0.799    613.7710  ...     0.000004     0.020148   
42  0.964322  2.370000     0.973    659.2152  ...     0.000002     0.021559   
43  1.394810  2.910000     0.592    706.2560  ...     0.000000     0.000000   
44  0.747216  2.160000     0.859    709.9800  ...     0.000000     0.000000   
45 -0.658143  1.920000     0.733    714.7832  ...     0.000000     0.000000   
46 -0.285689  2.290000     0.794    713.4901  ...     0.000000     0.000000   
47  0.224682  2.040000     0.841    704.8200  ...     0.000000     0.000000   
48 -0.259921  2.750000     0.916    621.0430  ...     0.000000     0.000000   
49 -0.343172  1.282656     0.709    607.0751  ...     0.000003     0.020074   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0        NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
1     1804.0 -0.068054  0.000009 -0.000007  26.3010   0.720  0.178090     30.0  
2        NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
3     1820.0 -0.035159  0.000005 -0.000004  26.2340   0.718  0.182630     30.0  
4     1883.0  0.094004  0.000005 -0.000004  26.3210   0.711  0.173847     30.0  
5        NaN -0.066295  0.000009       NaN      NaN     NaN       NaN      NaN  
6        NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
7     1840.0  0.091444  0.000005 -0.000004  26.2625   0.717  0.176289     30.0  
8     1824.0 -0.066206  0.000008 -0.000006  26.2710   0.719  0.178960     30.0  
9        NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
10       NaN -0.034088  0.000006       NaN      NaN     NaN       NaN      NaN  
11    1818.0 -0.060336  0.000008 -0.000006  26.3620   0.720  0.180524     30.0  
12       NaN -0.062158  0.000008       NaN      NaN     NaN       NaN      NaN  
13       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
14       NaN -0.055033  0.000011       NaN      NaN     NaN       NaN      NaN  
15       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
16       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
17       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
18       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
19       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
20       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
21    1873.0 -0.003999  0.000020 -0.000015  26.3920   0.710  0.177899      0.0  
22       NaN -0.046849  0.000005       NaN      NaN     NaN       NaN      NaN  
23       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
24       NaN -0.076357  0.000007       NaN      NaN     NaN       NaN      NaN  
25       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
26       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
27       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
28       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
29       NaN -0.048896  0.000006       NaN      NaN     NaN       NaN      NaN  
30       0.0  0.000000  0.000000  0.000000   0.0000   0.000  0.000000      0.0  
31       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
32       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
33    1822.0 -0.076154  0.000009 -0.000007  26.0840   0.720  0.181617     30.0  
34       NaN -0.067651  0.000006       NaN      NaN     NaN       NaN      NaN  
35       NaN -0.062968  0.000010       NaN      NaN     NaN       NaN      NaN  
36       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
37    1834.0 -0.054435  0.000005 -0.000004  26.2670   0.717  0.178613     30.0  
38       NaN -0.058751  0.000009       NaN      NaN     NaN       NaN      NaN  
39       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
40       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
41       NaN -0.031509  0.000007       NaN      NaN     NaN       NaN      NaN  
42    1886.0  0.088116  0.000004 -0.000003  26.3820   0.715  0.176842     30.0  
43       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
44       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
45       0.0  0.000000  0.000000  0.000000   0.0000   0.000  0.000000      0.0  
46       0.0  0.000000  0.000000  0.000000   0.0000   0.000  0.000000      0.0  
47       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
48       NaN  0.000000  0.000000       NaN      NaN     NaN       NaN      NaN  
49    1830.0 -0.049451  0.000006 -0.000004  26.2360   0.717  0.177429     30.0  

[50 rows x 32 columns]]",,8.988969326019287,2025-05-20T18:02:02,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,2,"
-- Select all columns from the dataquality table for ZTF objects with a probability greater than 0.7 of being supernovae
SELECT dq.*
FROM dataquality dq
INNER JOIN probability p ON dq.oid = p.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.931897163391112,2025-04-29T12:19:10,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21abkiefj  1670190486015015007    2  3017.7295   273.6781  4.117697   
1   ZTF21abkiefj  1670231056015015002    1  3006.7290   262.0561  1.198613   
2   ZTF21abkiefj  1672231576015015007    2  3001.3037   263.1388  2.469692   
3   ZTF21abkiefj  1674190326015015001    2  2991.6018   270.3133  3.881409   
4   ZTF21abkiefj  1674190790615015029    2  1763.9520  2275.1775  1.585795   
5   ZTF21abkiefj  1680172346015015003    2  2954.4312   247.1371  2.883233   
6   ZTF21abkiefj  1680173760615015030    2  1730.3794  2252.3657  4.155335   
7   ZTF21abkiefj  1682189546015015000    2  2998.9446   309.4838  2.079065   
8   ZTF21abkiefj  1685190870615015010    2  1776.0500  2271.3562  1.418044   
9   ZTF21abkiefj  1669190300615015015    1  1785.1697  2280.4860  3.519156   
10  ZTF21abkiefj  1665228910615015005    1  1767.8813  2258.0527  1.172439   
11  ZTF21abkiefj  1658210996015015005    2  3019.4670   274.0360  1.961870   
12  ZTF21abkiefj  1657188910615015014    1  1818.1642  2280.2673  1.559104   
13  ZTF21abkiefj  1656189366015015001    1  3037.4453   269.8035  2.185194   
14  ZTF21abkiefj  1655212360615015019    1  1818.1040  2265.4255  2.796105   
15  ZTF21abkiefj  1655207490615015028    2  1793.7561  2251.7937  2.434399   
16  ZTF21abkiefj  1654210636015015007    2  3024.3076   259.7524  2.430877   
17  ZTF21abkiefj  1654189396015015003    1  3015.9553   261.8556  1.489923   
18  ZTF21abkiefj  1653232710615015012    1  1780.1373  2261.2490  0.947515   
19  ZTF21abkiefj  1653190090615015025    2  1772.2141  2263.7727  2.055899   
20  ZTF21abkiefj  1652231506015015003    2  3021.8580   260.1218  1.636744   
21  ZTF21abkiefj  1652228626015015001    1  3038.4797   253.0226  1.382141   
22  ZTF21abkiefj  1651212250615015019    1  1799.4995  2268.4120  2.841852   
23  ZTF21abkiefj  1651191950615015023    2  1808.0396  2272.4985  1.780986   
24  ZTF21abkiefj  1650210696015015005    2  3024.5532   264.9733  1.509419   
25  ZTF21abjbswm  1673201461315015017    2  1742.0803  2522.1313  1.140096   
26  ZTF21abjbswm  1673186150015015010    2   397.5981  2387.1152  1.896485   
27  ZTF21abjbswm  1671220351315015009    1  1720.1830  2523.4020  1.295057   
28  ZTF21abjbswm  1669223770015015009    1   400.8648  2378.5403  1.393245   
29  ZTF21abjbswm  1661263220015015002    1   413.5323  2360.3198  1.379226   
30  ZTF21abjbswm  1661261341315015004    1  1748.4248  2502.9634  1.039963   
31  ZTF21abjbswm  1661198920015015007    2   426.4610  2387.4543  2.231894   
32  ZTF21abjbswm  1658241340015015005    1   409.7013  2382.0483  1.406298   
33  ZTF21abjbswm  1658238471315015061    1  1760.8756  2519.7688  1.376167   
34  ZTF21abjbswm  1658222110015015010    2   402.1827  2391.9285  1.104859   
35  ZTF21abjbswm  1656244221315015007    2  1746.1506  2509.2258  1.625926   
36  ZTF21abjbswm  1656215560015015006    2   422.5228  2382.3225  2.523561   
37  ZTF21abjbswm  1656201921315015018    1  1764.8792  2526.2085  1.694364   
38  ZTF21abjbswm  1654220031315015010    2  1774.0842  2505.6660  1.541657   
39  ZTF21abjbswm  1654199141315015021    1  1759.7054  2518.2046  2.472747   
40  ZTF21abjbswm  1652263881315015009    2  1742.5676  2502.1172  1.294739   
41  ZTF21abjbswm  1652245850015015011    2   410.2238  2370.1223  1.081085   
42  ZTF21abjbswm  1652201900015015008    1   427.0147  2377.7256  1.023324   
43  ZTF21abjbswm  1652200021315015025    1  1772.3281  2519.1616  1.392815   
44  ZTF21abjbswm  1650217921315015006    2  1776.7924  2519.6182  1.120127   
45  ZTF19acctirs  2262486904615015001    1   279.9120   331.9722  1.578271   
46  ZTF19acctirs  2262468274615015001    2   279.9597   318.4447  1.880756   
47  ZTF19acctirs  1007107104615015001    2   236.3989   207.0961  5.656323   
48  ZTF19acctirs  1221306454615015000    1   277.0500   155.2001  0.924304   
49  ZTF19acctirs  1011109354615015000    2   206.0279   197.7677  2.763697   

         sky  fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.015340  2.33     0.983     54.7705  ...     0.000002     0.024430   
1   0.321150  2.73     0.979     65.7710  ...     0.000005     0.032359   
2   0.684695  2.49     0.982     71.1962  ...     0.000004     0.031590   
3   0.925767  2.32     0.983     80.8982  ...     0.000002     0.024956   
4   0.701596  1.90     0.983    805.3226  ...     0.000002     0.027318   
5   0.410403  2.99     0.978    118.0689  ...     0.000002     0.026961   
6   0.347295  1.92     1.000    828.1343  ...     0.000003     0.026730   
7   1.100114  2.08     0.981     73.5555  ...     0.000003     0.030280   
8   0.657599  3.20     0.964    809.1437  ...     0.000006     0.039033   
9  -0.117751  2.02     0.982    800.0138  ...     0.000003     0.027573   
10  5.871525  2.00     0.972    822.4472  ...     0.000028     0.042985   
11  1.863180  2.11     0.982     53.0329  ...     0.000003     0.027777   
12  0.142931  2.11     0.982    800.2326  ...     0.000005     0.033961   
13  0.387543  2.52     0.981     35.0546  ...     0.000005     0.031997   
14  0.552588  2.07     0.982    815.0744  ...     0.000004     0.033009   
15  0.936475  1.72     0.982    828.7062  ...     0.000002     0.025773   
16  0.649785  2.28     0.983     48.1925  ...     0.000003     0.027665   
17 -0.052298  2.42     0.973     56.5446  ...     0.000005     0.031523   
18  0.024449  2.27     0.971    819.2509  ...     0.000004     0.030305   
19  0.134114  1.75     0.982    816.7274  ...     0.000002     0.026329   
20  0.577941  2.00     0.976     50.6422  ...     0.000003     0.028869   
21 -0.074486  3.57     0.791     34.0202  ...     0.000006     0.035808   
22 -0.162883  2.80     0.999    812.0879  ...     0.000004     0.029374   
23  0.384629  2.06     0.979    808.0014  ...     0.000002     0.026143   
24  0.433572  2.47     0.969     47.9467  ...     0.000002     0.024345   
25  0.607914  2.01     0.991    558.3686  ...     0.000010     0.046496   
26  0.663577  1.97     0.993    397.5981  ...     0.000011     0.044664   
27 -0.126054  2.22     0.935    557.0979  ...     0.000015     0.042620   
28  0.260295  2.70     0.932    400.8648  ...     0.000015     0.035781   
29  0.259157  3.16     0.993    413.5323  ...     0.000028     0.043277   
30 -0.247568  2.40     0.977    577.5367  ...     0.000019     0.044337   
31  0.392996  2.81     0.943    426.4610  ...     0.000014     0.045631   
32  0.271451  2.72     0.980    409.7013  ...     0.000021     0.038135   
33 -0.388790  2.07     0.983    560.7313  ...     0.000019     0.044033   
34  0.883771  2.19     0.980    402.1827  ...     0.000016     0.049305   
35 -0.140736  2.28     0.981    571.2741  ...     0.000014     0.047801   
36 -0.246244  2.24     0.985    422.5228  ...     0.000013     0.045120   
37 -0.446723  2.18     0.982    554.2914  ...     0.000013     0.039584   
38 -0.035348  1.45     0.973    574.8341  ...     0.000014     0.045655   
39 -0.136171  2.31     0.978    562.2955  ...     0.000020     0.045892   
40  0.147690  1.87     0.969    578.3827  ...     0.000013     0.046520   
41  0.927020  2.29     0.972    410.2238  ...     0.000010     0.044290   
42 -0.193824  3.19     0.961    427.0147  ...     0.000021     0.039542   
43  0.357722  2.52     0.972    561.3385  ...     0.000012     0.038256   
44  0.417469  2.44     0.828    560.8819  ...     0.000010     0.044395   
45 -0.453859  2.81     0.983    279.9120  ...     0.000004     0.033845   
46  0.291297  3.20     0.969    279.9597  ...     0.000002     0.029627   
47  0.297485  1.81     0.983    207.0961  ...     0.000002     0.028817   
48 -2.017068  3.09     0.981    155.2001  ...     0.000009     0.040961   
49 -0.563220  1.99     0.983    197.7677  ...     0.000002     0.029525   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0       2093  0.074547  0.000005 -0.000003  26.1250   0.533  0.192183     30.0  
1       2096 -0.052635  0.000012 -0.000007  26.0400   0.533  0.194129     30.0  
2       2108  0.079719  0.000010 -0.000006  26.0230   0.534  0.190773     30.0  
3       2114  0.075643  0.000005 -0.000003  26.0930   0.533  0.190362     30.0  
4       1978  0.084887  0.000005 -0.000003  26.2150   0.567  0.205143     30.0  
5       2127  0.078796  0.000006 -0.000004  26.1370   0.535  0.191306     30.0  
6       1998  0.070692  0.000006 -0.000004  26.2460   0.565  0.205331     30.0  
7       2104  0.079241  0.000009 -0.000005  25.9970   0.534  0.190815     30.0  
8       1963  0.081004  0.000015 -0.000009  25.9530   0.568  0.206810     30.0  
9       1979 -0.044821  0.000008 -0.000005  26.1250   0.566  0.209963     30.0  
10       992 -0.046338  0.000075 -0.000044  25.7820   0.548  0.155020     30.0  
11      2093  0.076603  0.000007 -0.000004  26.0110   0.533  0.191938     30.0  
12      1969 -0.044394  0.000012 -0.000008  25.9590   0.569  0.211726     30.0  
13      2071 -0.044027  0.000012 -0.000007  25.8440   0.532  0.193857     30.0  
14      1981 -0.069582  0.000010 -0.000006  25.9920   0.568  0.209125     30.0  
15      1992  0.073583  0.000005 -0.000003  26.1000   0.567  0.204792     30.0  
16      2093  0.079844  0.000007 -0.000004  25.8410   0.533  0.190678     30.0  
17      2092 -0.029213  0.000012 -0.000007  25.7210   0.533  0.193737     30.0  
18      1979 -0.032059  0.000010 -0.000006  25.9710   0.565  0.208595     30.0  
19      1988  0.081528  0.000005 -0.000003  26.1220   0.566  0.206001     30.0  
20      2094  0.079372  0.000008 -0.000005  26.0310   0.534  0.190825     30.0  
21      2065 -0.028692  0.000016 -0.000010  25.9620   0.533  0.192842     30.0  
22      1987 -0.060044  0.000008 -0.000005  26.1160   0.568  0.210061     30.0  
23      1987  0.076677  0.000005 -0.000003  26.1950   0.568  0.206484     30.0  
24      2091  0.074156  0.000005 -0.000003  26.0610   0.534  0.191485     30.0  
25       383  0.117552  0.000016 -0.000012  26.1830   0.696  0.330470     30.0  
26       360  0.107754  0.000017 -0.000013  26.1460   0.692  0.336074     30.0  
27       383 -0.089862  0.000022 -0.000016  26.1180   0.672  0.331975     30.0  
28       358 -0.054710  0.000023 -0.000017  26.1000   0.665  0.335303     30.0  
29       326 -0.044232  0.000048 -0.000034  26.0700   0.590  0.325212     30.0  
30       339 -0.090455  0.000032 -0.000022  26.1210   0.597  0.320967     30.0  
31       359  0.104956  0.000021 -0.000015  26.1820   0.695  0.336460     30.0  
32       340 -0.043611  0.000033 -0.000024  25.9890   0.635  0.331504     30.0  
33       365 -0.086375  0.000030 -0.000022  26.0530   0.662  0.325824     30.0  
34       358  0.114415  0.000024 -0.000018  26.0820   0.685  0.334849     30.0  
35       381  0.113296  0.000022 -0.000016  26.0180   0.675  0.329243     30.0  
36       359  0.105437  0.000019 -0.000014  26.0360   0.680  0.335929     30.0  
37       381 -0.082922  0.000020 -0.000015  25.9970   0.695  0.330685     30.0  
38       385  0.104991  0.000021 -0.000016  25.9840   0.696  0.329742     30.0  
39       379 -0.088625  0.000030 -0.000023  25.8910   0.668  0.329810     30.0  
40       384  0.110732  0.000020 -0.000015  26.0900   0.696  0.329371     30.0  
41       362  0.108828  0.000015 -0.000011  26.0920   0.692  0.336100     30.0  
42       355 -0.049377  0.000032 -0.000024  26.0830   0.667  0.335688     30.0  
43       380 -0.081215  0.000018 -0.000013  26.1240   0.696  0.332360     30.0  
44       383  0.110517  0.000015 -0.000011  26.1680   0.722  0.331754     30.0  
45      1923 -0.049412  0.000012 -0.000007  26.2790   0.505  0.215847     30.0  
46      1945  0.089168  0.000006 -0.000003  26.3260   0.508  0.212493     30.0  
47      1979  0.082296  0.000006 -0.000003  26.1520   0.508  0.211412     30.0  
48      1615 -0.021057  0.000025 -0.000014  26.2670   0.499  0.201301     30.0  
49      1978  0.085809  0.000006 -0.000004  26.1345   0.510  0.211936     30.0  

[50 rows x 32 columns]]",,8.10383415222168,2025-05-20T18:02:18,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,3,"
-- Query to find at most 50 ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
-- and return all columns from the 'dataquality' table for such objects.

SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN' -- Filter for supernovae class
  AND p.classifier_name = 'stamp_classifier' -- Use the stamp classifier
  AND p.probability > 0.7 -- Probability greater than 0.7
  AND p.ranking = 1 -- Only the most likely probabilities
LIMIT 50 -- Limit the results to at most 50 objects
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.644443988800049,2025-04-29T12:19:24,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF21abkutme  1652348932715015119    2  1943.4562  2690.0146  1.466628   
1    ZTF21abkuvcj  1652348930515015091    2  1124.2831  2866.8123  2.161177   
2    ZTF21abkuuvi  1652348460115015117    2  2773.3003   573.6035  1.814733   
3    ZTF21abkuvcp  1652348930515015100    2  1056.2231  2852.4043  1.326207   
4    ZTF21abkuysp  1652357600915015001    1  1971.8114   263.0432  1.279641   
..            ...                  ...  ...        ...        ...       ...   
322  ZTF21abkqrcc  1660415703415015003    1  3013.3394   855.6658  1.490105   
323  ZTF21abkqrcc  1660463463415015002    2  3022.5994   873.2801  2.158039   
324  ZTF21abkqrcc  1674399763415015003    2  2978.2234   866.3085  1.918417   
325  ZTF21ablfbmu  1653419320915015117    2  2850.4810   498.2734  1.895503   
326  ZTF21ablfcjd  1653419801915015014    2   702.7825   144.9252  0.959922   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    5.024870  2.920000     0.881    390.4853  ...     0.027942     0.898697   
1   -2.250216  1.202608     0.921    213.6877  ...     0.000256     0.197235   
2    2.341711  2.350000     0.717    299.1998  ...     0.000021     0.060143   
3   -1.856112  1.202608     0.626    228.0956  ...     0.000256     0.197235   
4    0.536840  2.210000     0.892    263.0432  ...     0.000002     0.015935   
..        ...       ...       ...         ...  ...          ...          ...   
322  1.106900  2.480000     0.927     59.1606  ...     0.000013     0.046155   
323  1.375207  2.040000     0.970     49.9006  ...     0.000008     0.041000   
324  1.954645  1.570000     0.959     94.2767  ...     0.000006     0.039656   
325 -0.345012  3.450000     0.933    222.0191  ...     0.000202     0.179836   
326 -3.588626  1.170675     0.770    144.9252  ...     0.000396     0.196472   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0       301.0  0.955728  0.062962 -0.039977  23.2820   0.579  0.201637   
1      1795.0  0.086291  0.000391 -0.000303  25.9870   0.709  0.234084   
2      1347.0  0.094037  0.000035 -0.000026  25.9800   0.662  0.253696   
3      1795.0  0.086291  0.000391 -0.000303  25.9870   0.709  0.234084   
4      1990.0 -0.051502  0.000006 -0.000003  25.9410   0.517  0.134088   
..        ...       ...       ...       ...      ...     ...       ...   
322     665.0 -0.093340  0.000019 -0.000014  26.1820   0.725  0.316590   
323     665.0  0.097329  0.000011 -0.000009  26.3860   0.731  0.315973   
324     674.0  0.101343  0.000008 -0.000006  26.3850   0.728  0.317269   
325     915.0  0.100520  0.000354 -0.000243  25.5000   0.575  0.311102   
326     638.0  0.130882  0.000581 -0.000443  25.2725   0.651  0.315445   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3       30.0  
4       30.0  
..       ...  
322     30.0  
323     30.0  
324     30.0  
325     30.0  
326     30.0  

[327 rows x 32 columns]]",,9.557010412216188,2025-05-20T18:02:36,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,4,"
-- Query to find at most 50 ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
SELECT dq.*
FROM dataquality dq
INNER JOIN (
    SELECT oid
    FROM probability
    WHERE class_name = 'SN'
      AND classifier_name = 'stamp_classifier'
      AND probability > 0.7
      AND ranking = 1
    LIMIT 50
) AS filtered_prob ON dq.oid = filtered_prob.oid
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,17.661300659179688,2025-04-29T12:19:42,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF21abmbtyx  1656372700815015019    1  1537.7194  1772.2870  1.739587   
1    ZTF21abmbtyx  2451152650815015036    1  1558.4529  1815.4047  7.301857   
2    ZTF18acavjuu   940326454415015005    1   516.7603   370.5958  1.629949   
3    ZTF18acavjuu   940356014415015000    2   517.7106   376.7795  2.495755   
4    ZTF18acavjuu  1186494674415015007    1   493.8990   371.0400  1.456230   
..            ...                  ...  ...        ...        ...       ...   
366  ZTF21abmqbcp  1699293191615015010    2  2511.7407  1188.0446  1.232616   
367  ZTF21abmqbcp  1709272221615015002    2  2514.0493  1208.1525  0.845575   
368  ZTF21abmqbcp  1713231991615015007    2  2532.1973  1190.4056  1.089470   
369  ZTF21abmqbcp  1730251861615015005    2  2524.4927  1208.1824  1.697368   
370  ZTF21abmqike  1658398134715015019    2  2575.0020   672.6002  2.757728   

          sky  fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    1.497786  2.16     0.975   1308.2130  ...     0.000003     0.017418   
1    1.286180  2.18     0.985   1265.0953  ...     0.000003     0.018228   
2    0.810726  2.21     0.911    370.5958  ...     0.000006     0.023552   
3    0.522169  1.78     0.980    376.7795  ...     0.000005     0.030109   
4   -0.361025  3.67     0.882    371.0400  ...     0.000036     0.053778   
..        ...   ...       ...         ...  ...          ...          ...   
366  0.099715  2.24     0.971    560.7593  ...     0.000003     0.040440   
367  0.488578  1.78     0.955    558.4507  ...     0.000006     0.046248   
368  0.271811  3.38     0.892    540.3028  ...     0.000003     0.040063   
369 -0.175719  2.12     0.991    548.0073  ...     0.000003     0.042884   
370  0.954647  1.87     0.997    497.4981  ...     0.000004     0.027243   

     nmatches  clrcoeff  clrcounc  zpclrcov   zpmed  clrmed    clrrms  exptime  
0      1871.0 -0.045882  0.000008 -0.000005  26.139   0.580  0.132561     30.0  
1      1888.0 -0.078623  0.000007 -0.000004  26.400   0.580  0.132144     30.0  
2      1868.0 -0.041461  0.000005 -0.000005  26.212   0.995  0.221415     30.0  
3      1873.0  0.107418  0.000004 -0.000004  26.373   0.998  0.217672     30.0  
4         NaN -0.038275  0.000032       NaN     NaN     NaN       NaN      NaN  
..        ...       ...       ...       ...     ...     ...       ...      ...  
366    1260.0  0.107645  0.000005 -0.000003  26.254   0.564  0.300470     30.0  
367    1263.0  0.096362  0.000011 -0.000008  26.220   0.555  0.300002     30.0  
368    1263.0  0.102655  0.000006 -0.000004  26.154   0.563  0.299585     30.0  
369    1269.0  0.110968  0.000006 -0.000004  26.171   0.563  0.300611     30.0  
370    1906.0  0.105227  0.000009 -0.000006  26.416   0.640  0.162303     30.0  

[371 rows x 32 columns]]",,8.989409923553467,2025-05-20T18:02:55,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,5,"
-- Retrieve all columns from the 'dataquality' table for ZTF objects with a probability greater than 0.7 of being supernovae
SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,23.98081350326538,2025-04-29T12:20:07,"[             oid               candid  fid       xpos       ypos     chipsf  \
0   ZTF18adbldgs  2848246261515015000    1   428.9925  1128.9946   2.471782   
1   ZTF18adbldgs  2751395031515015015    2   508.9337  1116.7745   7.476057   
2   ZTF18adbldgs  2396405901515015014    1   581.8058  1115.6317   2.318561   
3   ZTF18adbldgs  2396369811515015019    2   572.8404  1125.6713   2.279914   
4   ZTF18adbldgs  2394375191515015020    2   595.7707  1107.7747  20.999647   
5   ZTF18adbldgs  2394315201515015014    1   557.4873  1114.4830  80.784470   
6   ZTF18adbldgs  1440107331515015007    2   479.1415  1130.2413   4.314870   
7   ZTF18adbldgs  1242464721515015024    2   494.9786  1020.0731   1.319784   
8   ZTF18adbldgs  1325308571515015007    2   477.9711   981.6793   6.005737   
9   ZTF18adbldgs  1325315081515015004    1   505.5941   998.2955   9.513612   
10  ZTF18adbldgs   986353181515015003    2   386.1672   991.2497   1.387316   
11  ZTF18adbldgs  1245413511515015002    1   509.0966   989.0811   0.688189   
12  ZTF18adbldgs  1242448791515015010    1   475.9527  1009.9848   1.981501   
13  ZTF18adbldgs  1245457821515015010    2   510.3142  1000.7607   0.897067   
14  ZTF18adbldgs  1661375921515015004    2   565.8878  1109.0039   1.200264   
15  ZTF18adbldgs  1661436351515015011    1   525.5111  1105.9486   3.500595   
16  ZTF18adbldgs  1997419291515015019    2   542.9662  1139.6746  21.505253   
17  ZTF18adbldgs  1999422761515015018    1   552.8281  1129.9138   9.422522   
18  ZTF18adbldgs  1999457371515015006    2   565.8049  1117.7897  26.558567   
19  ZTF18adbldgs  2002393651515015012    2   561.9559  1121.4044  27.427427   
20  ZTF18adbldgs  2002440911515015011    1   557.0912  1129.2588  17.380560   
21  ZTF18adbldgs  2056238591515015009    1   532.9666  1121.1677   2.259549   
22  ZTF18adbldgs  2056273501515015010    2   570.6750  1126.6653  10.489505   
23  ZTF21abnedwn  1676341480615015014    2  1576.4960  1685.9080   0.995720   
24  ZTF21abnedwn  1674360370615015014    2  1551.0299  1698.4761   1.526442   
25  ZTF21abnedwn  1661377330615015012    2  1598.5778  1691.9954   1.239839   
26  ZTF21abneefx  1661378270615015000    2  1175.4080    53.2716   1.079500   
27  ZTF21abneefx  1661439880615015002    1  1139.3375    54.8222   0.752831   
28  ZTF21abneefx  1670303730615015001    1  1169.4454    47.5216   1.233544   
29  ZTF21abneefx  1670330670615015000    2  1171.5808    52.8378   1.702891   
30  ZTF21abneefx  1672328260615015000    1  1172.4450    60.7930   1.377153   
31  ZTF21abneefx  1674312700615015000    1  1185.4149    49.2420   1.523632   
32  ZTF21abneefx  1674354070615015000    2  1121.8419    54.8990   0.934679   
33  ZTF21abneefx  1676308960615015001    1  1176.8677    39.0516   0.929647   
34  ZTF21abneefx  1676340530615015001    2  1150.1564    48.5312   1.396348   
35  ZTF21abneeyl  1661379692715015010    2  1324.6020  2653.7000   1.753519   
36  ZTF21abneeyl  1661433512715015028    1  1272.2810  2649.6267   1.158528   
37  ZTF21abneulu  1661402215015015022    2  2736.8528  2333.1045   0.829588   
38  ZTF21abmsdqy  1661409930415015013    2   413.3216  1691.3932   1.680926   
39  ZTF21abmsdqy  1661463200415015017    1   414.6967  1707.7559   1.769445   
40  ZTF21abmsdqy  1668406920415015004    2   402.0120  1681.3102   1.172330   
41  ZTF21abmsdqy  1668448190415015006    1   396.1081  1694.1725   1.055225   
42  ZTF21abmsdqy  1670388810415015005    2   423.1463  1696.9723   0.969781   
43  ZTF21abmsdqy  1672451060415015009    2   413.7919  1710.7458   1.076521   
44  ZTF21abmsdqy  1674431050415015014    1   396.1447  1709.3704   1.219986   
45  ZTF21abmsdqy  1674473100415015019    2   405.1398  1714.9666   1.458988   
46  ZTF21abmsdqy  1680366240415015004    2   414.3826  1668.8519   1.770030   
47  ZTF21abmsdqy  1680428740415015022    1   398.5672  1684.9154   1.394371   
48  ZTF21abmsdqy  1682386080415015008    2   401.3516  1746.5361   2.583531   
49  ZTF21abmsdqy  1682433490415015015    1   414.8616  1753.8324   0.940895   

         sky     fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   1.419050  6.09000     0.982    428.9925  ...     0.000059     0.046387   
1   0.364952  2.58000     0.983    508.9337  ...     0.000002     0.033215   
2   0.324524  6.24000     0.938    581.8058  ...     0.000026     0.049443   
3   0.680788  1.95000     0.981    572.8404  ...     0.000005     0.040498   
4   0.593321  2.48000     0.987    595.7707  ...     0.000002     0.031748   
5   0.004985  2.59000     0.985    557.4873  ...     0.000006     0.045513   
6   0.148425  4.33000     0.979    479.1415  ...     0.000008     0.049612   
7   0.471081  1.87000     0.983    494.9786  ...     0.000002     0.031457   
8   0.301906  1.87000     0.983    477.9711  ...     0.000003     0.033963   
9  -0.012822  2.34000     0.996    505.5941  ...     0.000003     0.038872   
10 -0.372477  2.64000     0.983    386.1672  ...     0.000008     0.047639   
11 -0.156837  3.49000     0.893    509.0966  ...     0.000005     0.039237   
12 -0.154219  1.98000     0.982    475.9527  ...     0.000003     0.029397   
13  0.108274  3.10000     0.872    510.3142  ...     0.000002     0.032447   
14  0.573807  1.97000     0.983    565.8878  ...     0.000003     0.033806   
15  0.178695  2.47000     0.982    525.5111  ...     0.000004     0.038645   
16  0.594785  1.95000     0.984    542.9662  ...     0.000002     0.033484   
17  0.303283  2.10000     0.983    552.8281  ...     0.000005     0.037759   
18  0.886558  2.29000     0.989    565.8049  ...     0.000002     0.031849   
19  0.760535  2.14000     0.983    561.9559  ...     0.000002     0.033874   
20  0.356549  2.56000     0.983    557.0912  ...     0.000004     0.038122   
21  0.486286  2.10000     0.983    532.9666  ...     0.000007     0.043646   
22  0.819354  2.37000     0.992    570.6750  ...     0.000002     0.031104   
23  0.091663  2.35000     0.877   1394.5920  ...     0.000002     0.034724   
24  0.406301  2.34000     0.988   1382.0239  ...     0.000002     0.032830   
25 -0.133097  2.04000     0.993   1388.5046  ...     0.000002     0.033790   
26  0.369361  2.92000     0.940     53.2716  ...     0.000002     0.024200   
27  0.286576  2.68000     0.985     54.8222  ...     0.000002     0.025670   
28  0.547859  2.21000     0.999     47.5216  ...     0.000003     0.026129   
29  0.321376  1.96000     0.874     52.8378  ...     0.000002     0.023125   
30  0.129421  2.41000     0.969     60.7930  ...     0.000002     0.026347   
31 -0.076036  2.08000     0.926     49.2420  ...     0.000002     0.025814   
32  0.780918  1.69000     0.807     54.8990  ...     0.000002     0.022850   
33  0.412639  2.36000     0.965     39.0516  ...     0.000002     0.022507   
34 -0.007548  2.73000     0.932     48.5312  ...     0.000001     0.020873   
35  0.905419  2.27000     0.997    426.8001  ...     0.000002     0.016061   
36  0.209722  2.24000     0.808    430.8734  ...     0.000003     0.018650   
37 -0.166224  1.12809     0.859    335.6473  ...     0.000012     0.039765   
38  1.007938  1.96000     0.976    413.3216  ...     0.000001     0.017121   
39  0.633780  2.17000     0.994    414.6967  ...     0.000002     0.015859   
40  0.575872  1.87000     0.953    402.0120  ...     0.000002     0.018134   
41  0.977988  1.81000     0.977    396.1081  ...     0.000002     0.018291   
42  1.050969  1.92000     0.975    423.1463  ...     0.000002     0.020121   
43  1.626784  1.97000     0.977    413.7919  ...     0.000002     0.020356   
44  0.845433  2.65000     0.970    396.1447  ...     0.000002     0.016558   
45  1.524508  2.05000     0.980    405.1398  ...     0.000001     0.017432   
46  0.829911  2.50000     0.977    414.3826  ...     0.000002     0.018086   
47  0.742738  1.72000     0.903    398.5672  ...     0.000002     0.018029   
48  1.370242  2.43000     0.971    401.3516  ...     0.000002     0.019921   
49  0.918214  2.43000     0.873    414.8616  ...     0.000002     0.017579   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0        541 -0.014937  0.000185 -0.000101  26.115000   0.498  0.146366   
1       1757  0.085517  0.000005 -0.000003  26.153000   0.566  0.264252   
2        542 -0.102386  0.000060 -0.000037  26.222000   0.533  0.238213   
3       1756  0.078147  0.000010 -0.000006  26.169000   0.568  0.265165   
4       1741  0.082881  0.000004 -0.000003  26.180000   0.566  0.264789   
5       1742 -0.087124  0.000013 -0.000008  26.189499   0.566  0.264839   
6       1740  0.096496  0.000015 -0.000010  26.213000   0.569  0.263771   
7       1762  0.085918  0.000004 -0.000002  26.195000   0.571  0.266254   
8       1765  0.082339  0.000005 -0.000004  26.131000   0.570  0.266649   
9       1758 -0.097481  0.000007 -0.000004  26.106000   0.568  0.266884   
10      1538  0.092633  0.000015 -0.000010  26.017000   0.569  0.271020   
11      1760 -0.068234  0.000010 -0.000006  26.149000   0.569  0.267807   
12      1766 -0.050407  0.000005 -0.000004  26.177000   0.568  0.266704   
13      1756  0.085961  0.000004 -0.000003  26.194000   0.569  0.265696   
14      1760  0.086264  0.000005 -0.000003  26.139000   0.569  0.266186   
15      1755 -0.092328  0.000007 -0.000005  26.125000   0.568  0.265023   
16      1740  0.087803  0.000005 -0.000003  26.216500   0.568  0.264727   
17      1756 -0.064980  0.000009 -0.000006  26.215000   0.568  0.266094   
18      1759  0.081342  0.000004 -0.000003  26.206000   0.568  0.266029   
19      1758  0.089590  0.000005 -0.000003  26.249000   0.568  0.265930   
20      1752 -0.073486  0.000009 -0.000006  26.278000   0.569  0.265910   
21      1742 -0.063374  0.000014 -0.000009  25.989000   0.565  0.262555   
22      1758  0.078200  0.000004 -0.000003  26.131000   0.568  0.265617   
23      1368  0.092773  0.000004 -0.000003  26.289000   0.574  0.289024   
24      1368  0.088550  0.000004 -0.000003  26.266000   0.573  0.287826   
25      1359  0.088236  0.000004 -0.000003  26.222000   0.574  0.288900   
26      1970  0.075731  0.000005 -0.000003  26.241000   0.543  0.194054   
27      1978 -0.074382  0.000006 -0.000004  26.251000   0.543  0.195627   
28      1970 -0.073626  0.000006 -0.000004  26.280000   0.543  0.195982   
29      1971  0.077372  0.000004 -0.000002  26.283000   0.543  0.194768   
30      1968 -0.082516  0.000006 -0.000003  26.242000   0.543  0.195960   
31      1958 -0.085828  0.000005 -0.000003  26.273000   0.543  0.194551   
32      1977  0.079612  0.000004 -0.000002  26.274000   0.544  0.194734   
33      1966 -0.064034  0.000005 -0.000003  26.304000   0.544  0.195745   
34      1975  0.074612  0.000003 -0.000002  26.304000   0.543  0.194090   
35      1963  0.079425  0.000005 -0.000003  26.294000   0.511  0.122932   
36      1983 -0.076329  0.000009 -0.000005  26.186000   0.510  0.123438   
37       467  0.087584  0.000017 -0.000013  26.267000   0.686  0.316664   
38      2072  0.074559  0.000004 -0.000002  26.278000   0.541  0.147506   
39      2057 -0.048509  0.000004 -0.000003  26.262000   0.540  0.147717   
40      2072  0.076467  0.000004 -0.000003  26.314000   0.541  0.147549   
41      2073 -0.062379  0.000006 -0.000003  26.317000   0.541  0.146359   
42      2060  0.075390  0.000006 -0.000004  26.296000   0.541  0.147312   
43      2062  0.075643  0.000007 -0.000004  26.287000   0.541  0.147174   
44      2073 -0.053114  0.000005 -0.000003  26.302000   0.540  0.147699   
45      2075  0.076194  0.000004 -0.000002  26.342000   0.541  0.148728   
46      2063  0.073239  0.000005 -0.000003  26.332000   0.541  0.147221   
47      2069 -0.078070  0.000004 -0.000003  26.308000   0.540  0.146764   
48      2074  0.075825  0.000006 -0.000003  26.246000   0.541  0.149039   
49      2055 -0.059277  0.000005 -0.000003  26.230000   0.541  0.148262   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,8.337319135665894,2025-05-20T18:03:12,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,6,"
SELECT dq.* 
FROM dataquality dq
INNER JOIN probability p ON dq.oid = p.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.864831447601318,2025-04-29T12:20:19,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21abotose  1669215603615015010    1   936.7305  1843.8676  3.589783   
1   ZTF21abotose  1671195373615015008    2   942.3093  1842.4587  3.926872   
2   ZTF21abotose  1671228033615015012    1   903.6098  1838.7091  2.248935   
3   ZTF21abotose  1673194253615015017    2   931.5075  1844.7882  2.342674   
4   ZTF21abotose  1673233483615015007    1   922.6449  1838.8999  1.463273   
5   ZTF21abotose  1675254543615015008    1   900.2406  1844.1293  1.467296   
6   ZTF21abotose  1680213723615015016    1   908.4723  1819.9573  2.247768   
7   ZTF21abotose  1682214453615015016    2   911.8995  1877.3975  3.349744   
8   ZTF21abotose  1682235523615015007    1   908.7653  1877.5463  3.801641   
9   ZTF21abotose  1685176683615015004    1   952.5805  1846.6309  2.576299   
10  ZTF21abotose  1687172913615015083    2   910.8410  1845.2554  1.441423   
11  ZTF21abotose  1687244903615015003    1   870.0775  1830.8954  1.769002   
12  ZTF21abotose  1689193443615015002    1   922.6441  1833.3086  1.440975   
13  ZTF21abotose  1689263073615015003    2   860.9708  1821.5684  1.600551   
14  ZTF21abotose  1693206233615015004    2   885.8688  1857.6619  2.209709   
15  ZTF21abotose  1696174843615015009    2   923.0867  1846.2955  2.502679   
16  ZTF21abotose  1700269753615015002    2   876.2350  1799.2134  1.337667   
17  ZTF21abotose  1706205473615015010    2   881.1913  1835.8176  1.252663   
18  ZTF21abotose  1708196963615015003    2   906.4439  1837.1548  2.056722   
19  ZTF21abotose  1710225753615015005    2   883.0401  1808.4592  1.734860   
20  ZTF21abotose  1712150913615015008    2   893.6054  1834.6176  2.721947   
21  ZTF21abotose  1716141273615015009    2   878.1623  1841.3420  1.228163   
22  ZTF21abowrtk  1669216533715015008    1  2526.6445  2309.0835  1.042174   
23  ZTF21abowrtk  1671224253715015009    1  2496.7854  2305.5305  1.619537   
24  ZTF21abowrtk  1673235353715015005    1  2503.8245  2306.2124  0.836881   
25  ZTF21abowrtk  1675274653715015007    1  2453.6577  2298.4265  1.133452   
26  ZTF21abowrtk  1680217023715015007    1  2507.4260  2274.5754  1.653681   
27  ZTF21abowrtk  1682192383715015012    2  2498.5151  2349.0623  1.024401   
28  ZTF21abowsdo  1669216531615015013    1  2684.6328  2589.4153  0.957068   
29  ZTF21abnslrs  1669217020615015002    1  1249.0162    88.8190  1.176866   
30  ZTF21abnslrs  1669243020615015001    2  1229.0403    82.3621  1.137298   
31  ZTF21abnslrs  1671208220615015001    2  1237.5970    83.6978  3.012428   
32  ZTF21abnslrs  1671237620615015003    1  1237.4017    80.0135  1.851852   
33  ZTF21abnslrs  1673215040615015000    2  1236.6720    86.8324  2.154172   
34  ZTF21abnslrs  1673275390615015000    1  1207.3667    75.4809  1.954438   
35  ZTF21abnslrs  1675275600615015000    1  1180.1783    78.9061  1.261575   
36  ZTF21abnslrs  1680197210615015001    2  1242.0130    58.6168  2.726922   
37  ZTF21abnslrs  1680217490615015001    1  1228.4174    56.5185  3.098295   
38  ZTF21abnslrs  1682215420615015001    2  1226.0485   122.1692  1.840247   
39  ZTF21abnslrs  1682267160615015001    1  1195.3100   112.1661  1.760262   
40  ZTF21abnslrs  1685226560615015000    2  1230.8488    78.3452  1.270946   
41  ZTF21abnslrs  1687196490615015000    2  1246.0416    86.0218  0.787929   
42  ZTF21abowsub  1712154212415015007    2  2088.9590  2390.3330  1.868315   
43  ZTF21abowsub  1708204562415015004    2  2096.8076  2383.8670  1.560642   
44  ZTF21abowsub  1706221872415015006    2  2085.4934  2381.2563  2.199191   
45  ZTF21abowsub  1704204792415015006    2  2086.1125  2388.4214  2.177197   
46  ZTF21abowsub  1700297872415015006    2  2061.1028  2336.6096  1.412541   
47  ZTF21abowsub  1698207712415015016    2  2100.7085  2395.0564  1.034499   
48  ZTF21abowsub  1696202932415015004    1  2102.3071  2396.9658  0.934956   
49  ZTF21abowsub  1696163942415015002    2  2112.0571  2410.1692  1.009547   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.121505  2.260000     0.983    936.7305  ...     0.000006     0.036437   
1   0.150941  1.770000     0.996    942.3093  ...     0.000003     0.035935   
2  -0.184180  2.190000     0.983    903.6098  ...     0.000006     0.036799   
3   0.151697  1.940000     0.993    931.5075  ...     0.000003     0.037763   
4   0.143352  2.520000     0.967    922.6449  ...     0.000006     0.036984   
5  -0.356009  2.530000     0.875    900.2406  ...     0.000005     0.033392   
6  -0.174767  2.120000     0.980    908.4723  ...     0.000005     0.034846   
7   0.114705  1.660000     0.982    911.8995  ...     0.000003     0.037438   
8   0.173074  2.500000     0.984    908.7653  ...     0.000005     0.034767   
9  -0.036690  2.490000     0.978    952.5805  ...     0.000007     0.036582   
10  7.782639  1.950000     0.983    910.8410  ...     0.000010     0.050596   
11 -0.038117  2.100000     0.980    870.0775  ...     0.000022     0.057879   
12 -0.166547  1.940000     0.975    922.6441  ...     0.000015     0.042546   
13  0.416737  2.210000     1.000    860.9708  ...     0.000007     0.049833   
14  0.531784  1.840000     1.000    885.8688  ...     0.000004     0.041724   
15 -0.665855  2.010000     0.980    923.0867  ...     0.000004     0.042181   
16  0.189566  2.890000     0.965    876.2350  ...     0.000004     0.041588   
17 -0.216679  1.820000     0.927    881.1913  ...     0.000003     0.037948   
18  0.259615  2.340000     0.970    906.4439  ...     0.000003     0.038534   
19 -0.024596  2.230000     0.899    883.0401  ...     0.000003     0.039677   
20 -0.006809  2.320000     0.727    893.6054  ...     0.000003     0.040090   
21 -0.150940  2.900000     0.992    878.1623  ...     0.000003     0.040387   
22  0.496257  2.510000     0.971    545.8555  ...     0.000006     0.033863   
23 -0.142912  2.000000     0.966    575.7147  ...     0.000005     0.032477   
24  0.274387  2.000000     0.968    568.6755  ...     0.000006     0.034896   
25  0.144199  2.780000     0.969    618.8423  ...     0.000007     0.032244   
26  0.270419  2.170000     0.997    565.0740  ...     0.000005     0.032971   
27 -0.009490  1.237548     0.811    573.9849  ...     0.000004     0.041488   
28  0.131209  3.070000     0.863    387.8671  ...     0.000011     0.040709   
29  0.110403  3.240000     0.936     88.8190  ...     0.000003     0.031588   
30  0.298751  2.240000     0.854     82.3621  ...     0.000002     0.034804   
31 -0.001211  1.330000     0.999     83.6978  ...     0.000002     0.032358   
32  0.168882  2.350000     0.992     80.0135  ...     0.000003     0.031639   
33  0.718126  1.950000     0.882     86.8324  ...     0.000002     0.031233   
34 -0.181473  2.510000     0.987     75.4809  ...     0.000004     0.036822   
35 -0.120785  2.270000     0.990     78.9061  ...     0.000004     0.035647   
36  0.346397  1.710000     0.999     58.6168  ...     0.000002     0.030969   
37  0.144486  2.900000     0.998     56.5185  ...     0.000003     0.030073   
38  0.369857  1.810000     0.942    122.1692  ...     0.000002     0.032704   
39  0.258519  2.350000     0.865    112.1661  ...     0.000004     0.032067   
40 -0.006974  1.710000     0.860     78.3452  ...     0.000004     0.038355   
41 -0.250598  1.214367     0.948     86.0218  ...     0.000005     0.039554   
42  0.178818  1.630000     0.962    690.1669  ...     0.000005     0.042710   
43 -0.100726  2.440000     0.975    696.6330  ...     0.000005     0.043283   
44  0.078817  2.000000     0.980    699.2437  ...     0.000008     0.049758   
45  0.191331  2.310000     0.963    692.0785  ...     0.000005     0.041885   
46  0.562640  3.070000     0.967    743.8905  ...     0.000008     0.050305   
47  3.388801  1.700000     0.999    685.4435  ...     0.000024     0.064387   
48 -0.272006  2.180000     0.964    683.5343  ...     0.000016     0.039221   
49  0.845316  1.159835     0.987    670.3307  ...     0.000006     0.048099   

    nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  exptime  
0       1091 -0.056638  0.000012 -0.000008  26.1770   0.545  0.283730     30.0  
1       1098  0.102012  0.000005 -0.000003  26.3060   0.551  0.285504     30.0  
2       1090 -0.059802  0.000012 -0.000008  26.1620   0.544  0.281621     30.0  
3       1099  0.103846  0.000006 -0.000004  26.3080   0.548  0.285940     30.0  
4       1100 -0.067797  0.000011 -0.000007  26.1840   0.547  0.284484     30.0  
5       1100 -0.052441  0.000010 -0.000006  26.1900   0.546  0.285936     30.0  
6       1101 -0.061273  0.000010 -0.000007  26.2110   0.545  0.286150     30.0  
7       1109  0.104426  0.000006 -0.000004  26.2520   0.551  0.286014     30.0  
8       1098 -0.058453  0.000011 -0.000007  26.0820   0.544  0.282983     30.0  
9       1058 -0.045014  0.000015 -0.000010  25.9820   0.537  0.273864     30.0  
10      1102  0.104784  0.000019 -0.000012  26.0900   0.549  0.285591     30.0  
11      1008 -0.030368  0.000048 -0.000030  26.0060   0.525  0.259892     30.0  
12       856 -0.019400  0.000036 -0.000021  25.9030   0.510  0.239440     30.0  
13      1073  0.126041  0.000014 -0.000009  25.9850   0.549  0.283524     30.0  
14      1103  0.112730  0.000008 -0.000005  26.2520   0.551  0.285889     30.0  
15      1103  0.115441  0.000008 -0.000005  26.1510   0.549  0.286274     30.0  
16      1092  0.112287  0.000008 -0.000005  26.2560   0.551  0.286347     30.0  
17      1101  0.107149  0.000006 -0.000004  26.3130   0.549  0.284832     30.0  
18      1107  0.106095  0.000006 -0.000004  26.3340   0.549  0.285368     30.0  
19      1098  0.110917  0.000006 -0.000004  26.2570   0.549  0.284981     30.0  
20      1111  0.110434  0.000007 -0.000004  26.3020   0.549  0.285460     30.0  
21      1094  0.114005  0.000006 -0.000004  26.3380   0.549  0.285657     30.0  
22       796 -0.061585  0.000011 -0.000007  26.1610   0.575  0.306294     30.0  
23       799 -0.064573  0.000009 -0.000006  26.1570   0.574  0.307966     30.0  
24       800 -0.062623  0.000011 -0.000008  26.1560   0.571  0.308030     30.0  
25       798 -0.038294  0.000012 -0.000008  26.1430   0.569  0.301642     30.0  
26       804 -0.061498  0.000010 -0.000007  26.1840   0.577  0.306908     30.0  
27       813  0.112866  0.000007 -0.000005  26.2480   0.581  0.307066     30.0  
28       754 -0.068112  0.000022 -0.000014  26.1620   0.535  0.279751     30.0  
29      1097 -0.068678  0.000007 -0.000004  26.2610   0.523  0.286068     30.0  
30      1108  0.096934  0.000005 -0.000003  26.2730   0.529  0.287050     30.0  
31      1108  0.086787  0.000005 -0.000003  26.2695   0.528  0.287395     30.0  
32      1101 -0.075351  0.000006 -0.000004  26.2240   0.526  0.286463     30.0  
33      1109  0.088497  0.000004 -0.000002  26.2760   0.528  0.287129     30.0  
34      1106 -0.086367  0.000008 -0.000005  26.2230   0.525  0.287262     30.0  
35      1106 -0.083897  0.000008 -0.000005  26.2595   0.523  0.285354     30.0  
36      1112  0.087103  0.000004 -0.000002  26.3030   0.525  0.287895     30.0  
37      1106 -0.067402  0.000006 -0.000004  26.2890   0.524  0.287854     30.0  
38      1114  0.084926  0.000005 -0.000003  26.2240   0.530  0.287295     30.0  
39      1109 -0.065989  0.000007 -0.000005  26.1340   0.529  0.287960     30.0  
40      1109  0.093121  0.000008 -0.000005  26.1210   0.529  0.287652     30.0  
41      1107  0.091041  0.000010 -0.000006  26.1940   0.528  0.287272     30.0  
42       653  0.112077  0.000009 -0.000006  26.3370   0.591  0.312977     30.0  
43       655  0.115016  0.000009 -0.000006  26.3820   0.591  0.313591     30.0  
44       652  0.126279  0.000014 -0.000010  26.3610   0.592  0.313841     30.0  
45       653  0.112947  0.000008 -0.000005  26.3230   0.591  0.312956     30.0  
46       656  0.128486  0.000014 -0.000010  26.2800   0.592  0.313209     30.0  
47       650  0.120728  0.000043 -0.000029  25.9455   0.587  0.312841     30.0  
48       522 -0.040247  0.000038 -0.000023  25.9290   0.511  0.267238     30.0  
49       648  0.129450  0.000010 -0.000007  26.1200   0.592  0.313845     30.0  

[50 rows x 32 columns]]",,10.09541082382202,2025-05-20T18:03:31,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,7,"
-- Query to find at most 50 ZTF objects with a probability greater than 0.7 of being supernovae in the stamp classifier
-- and return all columns from the 'dataquality' table for such objects.

SELECT dq.*
FROM dataquality dq
INNER JOIN probability p ON dq.oid = p.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,17.409234762191772,2025-04-29T12:20:37,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21abpooxg  1671234310015015003    1  2000.7219   656.3645  1.432024   
1   ZTF21abpooxg  1673233950015015003    1  2005.0623   658.4868  1.576058   
2   ZTF21abpooxg  1675273700015015002    1  1944.2170   655.1033  1.011889   
3   ZTF21abpooxg  1680235250015015000    1  1964.4820   637.7143  1.507751   
4   ZTF21abporbr  1671236674215015025    1   833.5273  2118.8765  1.428178   
5   ZTF21abporbr  1673224234215015010    2   824.1545  2121.2534  1.916591   
6   ZTF21abporbr  1673256634215015023    1   821.3805  2115.6968  1.631974   
7   ZTF21abporbr  1675255024215015027    1   807.7845  2125.9395  1.112766   
8   ZTF21abporbr  1680195314215015005    2   839.2632  2097.2273  1.505442   
9   ZTF21abporbr  1680216554215015014    1   827.8264  2094.3977  1.562663   
10  ZTF21abporbr  1682206234215015007    2   813.6701  2162.1106  2.331255   
11  ZTF21abporbr  1682235994215015015    1   818.4124  2161.4620  1.571452   
12  ZTF21abporbr  1687205824215015001    2   818.2981  2118.8208  1.509305   
13  ZTF21abporbr  1687244444215015045    1   781.1281  2114.3872  0.750688   
14  ZTF21abporbr  1712151384215015007    2   809.0849  2114.9860  1.349437   
15  ZTF21abowteg  1682215900815015014    2  2750.8557  2110.2559  1.165787   
16  ZTF21abowteg  1682266700815015024    1  2721.6387  2100.4397  1.591380   
17  ZTF21abowteg  1685225620815015006    2  2755.8103  2067.1199  1.104557   
18  ZTF21abowteg  1671238090815015025    1  2761.9824  2068.4246  1.816729   
19  ZTF21abowteg  1673223280815015016    2  2752.2388  2072.9949  1.312881   
20  ZTF21abowteg  1673278210815015018    1  2737.9473  2060.0217  1.318966   
21  ZTF21abowteg  1675276060815015017    1  2707.3150  2066.3242  1.174255   
22  ZTF21abowteg  1680201570815015024    2  2755.9940  2047.0577  0.934629   
23  ZTF21abowteg  1680218430815015022    1  2755.5337  2044.3243  2.210506   
24  ZTF21abowuhq  1671241385815015018    1  1686.0974  1598.0190  1.079904   
25  ZTF21abowuhq  1673220935815015009    2  1674.9634  1600.0594  0.712596   
26  ZTF21abowuhq  1673280595815015027    1  1664.8289  1591.7858  1.068183   
27  ZTF21abowuhq  1675246755815015008    2  1687.5483  1598.9281  2.071074   
28  ZTF21abpoufi  1671242431715015004    1  2712.0066   828.1928  1.739271   
29  ZTF21abpoufi  1673282061715015003    1  2699.3830   812.7198  2.028919   
30  ZTF21abpoufi  1673323481715015006    2  2704.9187   792.9725  0.618238   
31  ZTF21abpoufi  1675304281715015007    1  2671.1328   800.5486  2.737906   
32  ZTF21abpoufi  1680199661715015003    2  2709.1890   812.1020  0.981098   
33  ZTF21abpoufi  1680222261715015002    1  2710.5740   801.9599  1.864628   
34  ZTF21abpoufi  1682200431715015003    2  2695.2220   879.4230  2.680060   
35  ZTF21abpoufi  1682260461715015002    1  2703.4307   850.3131  1.971988   
36  ZTF21abpoufi  1685204281715015002    2  2710.7410   834.0996  1.046480   
37  ZTF21abpoufi  1687180981715015006    2  2699.2798   840.9357  1.386873   
38  ZTF21abpoufi  1687239611715015002    1  2694.3306   815.6998  0.946843   
39  ZTF21abpoufi  1695181711715015004    2  2688.3418   842.9004  1.020387   
40  ZTF21abpoufi  1697165871715015006    2  2699.9550   845.2698  0.949702   
41  ZTF21abpowsm  1671246682315015013    1  2886.8154  2537.2610  1.432183   
42  ZTF21abpoywq  1676211415615015016    2  1425.9438  2421.4846  1.571338   
43  ZTF21abpoywq  1673213125615015008    2  1437.8844  2420.2954  1.209230   
44  ZTF21abpoywq  1671250045615015012    1  1409.6282  2417.0046  1.733340   
45  ZTF21abppabg  1682270032815015004    1  2947.5913   995.6143  1.626793   
46  ZTF21abppabg  1680249672815015008    1  2968.7737   926.4227  1.875611   
47  ZTF21abppabg  1680191082815015013    2  2986.5690   944.9965  2.594809   
48  ZTF21abppabg  1675290832815015006    1  2930.6511   952.3675  1.921167   
49  ZTF21abppabg  1673252822815015007    1  2961.4258   970.5800  1.696047   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0  -0.047055  2.150000     0.972    656.3645  ...     0.000003     0.028675   
1   0.042119  3.100000     0.961    658.4868  ...     0.000003     0.032809   
2  -0.090356  2.780000     0.954    655.1033  ...     0.000005     0.035944   
3   0.024041  3.050000     0.995    637.7143  ...     0.000003     0.030210   
4   0.516893  2.580000     0.995    833.5273  ...     0.000004     0.033398   
5   0.222449  2.130000     0.981    824.1545  ...     0.000003     0.035263   
6  -0.178016  2.410000     0.971    821.3805  ...     0.000005     0.036066   
7   0.171260  2.610000     0.980    807.7845  ...     0.000005     0.033950   
8  -0.062092  2.110000     0.983    839.2632  ...     0.000003     0.037033   
9   0.343541  2.320000     0.979    827.8264  ...     0.000005     0.037992   
10  0.182315  2.120000     0.997    813.6701  ...     0.000003     0.037571   
11  0.338205  2.870000     0.964    818.4124  ...     0.000006     0.035899   
12  0.311119  1.990000     0.999    818.2981  ...     0.000004     0.042351   
13  2.717408  3.610000     0.941    781.1281  ...     0.000028     0.062021   
14 -0.097117  1.870000     0.933    809.0849  ...     0.000003     0.037169   
15  0.403990  2.060000     0.965    321.6443  ...     0.000003     0.035850   
16 -0.015394  2.410000     0.960    350.8613  ...     0.000003     0.033939   
17 -0.028336  1.790000     0.893    316.6896  ...     0.000003     0.037175   
18  0.310922  2.910000     0.913    310.5175  ...     0.000004     0.033855   
19  0.126974  1.530000     0.943    320.2613  ...     0.000002     0.035306   
20  0.150244  2.540000     0.962    334.5527  ...     0.000004     0.036653   
21  0.295080  2.980000     0.933    365.1851  ...     0.000005     0.043960   
22  0.131218  2.020000     0.976    316.5062  ...     0.000002     0.034639   
23  0.059870  2.290000     0.975    316.9664  ...     0.000004     0.039954   
24  0.402976  2.060000     0.949   1386.4026  ...     0.000005     0.029723   
25  0.428187  1.970000     0.970   1397.5366  ...     0.000005     0.040473   
26  0.126789  2.380000     0.959   1407.6711  ...     0.000007     0.034522   
27  0.495707  2.110000     0.973   1384.9517  ...     0.000004     0.035377   
28  0.066593  2.210000     0.981    360.4933  ...     0.000010     0.034334   
29 -0.414867  2.750000     0.997    373.1169  ...     0.000030     0.050747   
30  0.074446  2.050000     0.981    367.5814  ...     0.000007     0.038865   
31  0.325634  2.230000     0.982    401.3673  ...     0.000010     0.032475   
32 -0.046604  2.130000     0.980    363.3111  ...     0.000007     0.038152   
33 -0.162194  2.300000     0.979    361.9261  ...     0.000010     0.036911   
34 -0.283466  2.250000     0.985    377.2781  ...     0.000008     0.038841   
35 -0.298572  1.910000     0.975    369.0694  ...     0.000012     0.036608   
36 -0.135968  2.110000     0.974    361.7591  ...     0.000007     0.039058   
37  0.397025  2.330000     0.965    373.2202  ...     0.000008     0.039000   
38  0.226607  3.270000     0.983    378.1695  ...     0.000015     0.036095   
39 -0.466820  2.350000     0.986    384.1583  ...     0.000009     0.040057   
40 -0.040316  1.270000     0.828    372.5450  ...     0.000007     0.037943   
41  0.118093  2.190000     0.967    185.6846  ...     0.000020     0.052085   
42  0.648765  2.060000     0.968    659.0155  ...     0.000002     0.025272   
43  0.501880  2.050000     0.940    660.2046  ...     0.000001     0.022733   
44  0.052700  2.190000     0.963    663.4953  ...     0.000003     0.027041   
45  0.618124  2.960000     0.969    124.9086  ...     0.000003     0.020480   
46  0.958235  3.250000     0.966    103.7263  ...     0.000002     0.019896   
47  0.696901  1.181415     0.967     85.9310  ...     0.000002     0.020243   
48  0.461989  2.430000     0.993    141.8489  ...     0.000003     0.019517   
49  0.553814  2.890000     0.979    111.0742  ...     0.000003     0.020068   

    nmatches  clrcoeff  clrcounc  zpclrcov      zpmed  clrmed    clrrms  \
0       1529 -0.038366  0.000006 -0.000004  26.097000   0.521  0.277474   
1       1534 -0.053127  0.000007 -0.000004  26.131000   0.523  0.278597   
2       1510 -0.044512  0.000010 -0.000006  26.099000   0.519  0.273564   
3       1533 -0.041723  0.000006 -0.000004  26.130000   0.525  0.280670   
4        965 -0.072164  0.000008 -0.000005  26.255000   0.564  0.290996   
5        971  0.100436  0.000005 -0.000003  26.423000   0.565  0.289880   
6        962 -0.077635  0.000010 -0.000006  26.247000   0.563  0.289365   
7        960 -0.064874  0.000010 -0.000007  26.290000   0.561  0.289135   
8        961  0.105286  0.000005 -0.000003  26.444000   0.564  0.291172   
9        963 -0.084166  0.000010 -0.000007  26.309000   0.563  0.290824   
10       967  0.105243  0.000006 -0.000004  26.367000   0.565  0.288278   
11       962 -0.064605  0.000012 -0.000008  26.182499   0.559  0.287387   
12       970  0.117432  0.000008 -0.000005  26.327000   0.564  0.289630   
13       853 -0.035756  0.000065 -0.000039  26.057000   0.520  0.260433   
14       963  0.102234  0.000006 -0.000004  26.413000   0.565  0.288584   
15      1060  0.092280  0.000005 -0.000003  26.275000   0.559  0.304671   
16      1060 -0.076312  0.000006 -0.000004  26.177000   0.560  0.305389   
17      1056  0.099361  0.000005 -0.000003  26.158000   0.559  0.304797   
18      1054 -0.073156  0.000007 -0.000004  26.234000   0.559  0.304364   
19      1059  0.097247  0.000004 -0.000003  26.311000   0.560  0.303945   
20      1061 -0.085428  0.000007 -0.000005  26.253000   0.558  0.303658   
21      1058 -0.104168  0.000009 -0.000006  26.294000   0.555  0.304830   
22      1057  0.090713  0.000005 -0.000003  26.335000   0.556  0.303355   
23      1059 -0.099452  0.000007 -0.000005  26.319000   0.559  0.303756   
24       828 -0.045649  0.000009 -0.000006  26.223000   0.621  0.302678   
25       836  0.104460  0.000008 -0.000006  26.315000   0.625  0.303692   
26       841 -0.048461  0.000013 -0.000009  26.263000   0.621  0.303649   
27       830  0.091841  0.000006 -0.000004  26.319000   0.625  0.303216   
28       481 -0.075013  0.000016 -0.000012  26.088000   0.638  0.296037   
29       480 -0.065753  0.000051 -0.000036  26.080000   0.633  0.298092   
30       484  0.105991  0.000012 -0.000008  26.221000   0.645  0.299371   
31       482 -0.058508  0.000018 -0.000013  26.108000   0.640  0.297801   
32       486  0.103858  0.000012 -0.000008  26.291000   0.644  0.298104   
33       482 -0.083703  0.000017 -0.000012  26.157000   0.640  0.297541   
34       483  0.102261  0.000014 -0.000010  26.207000   0.635  0.296415   
35       482 -0.070099  0.000021 -0.000015  25.991000   0.632  0.298617   
36       485  0.105789  0.000012 -0.000009  26.092000   0.637  0.297392   
37       482  0.104111  0.000013 -0.000009  26.170000   0.640  0.297342   
38       460 -0.051915  0.000028 -0.000019  25.963000   0.608  0.290571   
39       483  0.102199  0.000016 -0.000011  26.248000   0.641  0.298242   
40       481  0.102658  0.000012 -0.000008  26.252000   0.638  0.297218   
41       477 -0.109249  0.000033 -0.000023  26.117000   0.612  0.314386   
42      2088  0.075582  0.000005 -0.000003  26.248000   0.500  0.201506   
43      2090  0.075332  0.000003 -0.000002  26.235000   0.499  0.201441   
44      2093 -0.041668  0.000007 -0.000004  26.147000   0.499  0.204834   
45      2061 -0.053106  0.000007 -0.000004  26.062000   0.573  0.156178   
46      2054 -0.059792  0.000006 -0.000004  26.214000   0.573  0.156757   
47      2047  0.080894  0.000005 -0.000003  26.368000   0.573  0.154622   
48      2046 -0.043744  0.000007 -0.000004  26.177500   0.573  0.154873   
49      2060 -0.046274  0.000007 -0.000004  26.184000   0.573  0.155447   

    exptime  
0      30.0  
1      30.0  
2      30.0  
3      30.0  
4      30.0  
5      30.0  
6      30.0  
7      30.0  
8      30.0  
9      30.0  
10     30.0  
11     30.0  
12     30.0  
13     30.0  
14     30.0  
15     30.0  
16     30.0  
17     30.0  
18     30.0  
19     30.0  
20     30.0  
21     30.0  
22     30.0  
23     30.0  
24     30.0  
25     30.0  
26     30.0  
27     30.0  
28     30.0  
29     30.0  
30     30.0  
31     30.0  
32     30.0  
33     30.0  
34     30.0  
35     30.0  
36     30.0  
37     30.0  
38     30.0  
39     30.0  
40     30.0  
41     30.0  
42     30.0  
43     30.0  
44     30.0  
45     30.0  
46     30.0  
47     30.0  
48     30.0  
49     30.0  

[50 rows x 32 columns]]",,8.582698106765747,2025-05-20T18:03:49,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,8,"
SELECT dq.* 
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,13.117942571640016,2025-04-29T12:20:50,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21abqfpsc  1716167991215015006    2  2736.4430   507.3061  2.245807   
1   ZTF21abqfpsc  1714230541215015004    2  2740.9514   494.7738  1.246868   
2   ZTF21abqfpsc  1712211271215015000    1  2776.6733   495.9780  1.125849   
3   ZTF21abqfpsc  1712168071215015004    2  2758.7192   500.3285  2.307325   
4   ZTF21abqfpsc  1710233111215015002    1  2779.9568   492.7936  1.210400   
5   ZTF21abqfpsc  1710211051215015004    2  2787.4610   496.5696  3.493864   
6   ZTF21abqfpsc  1708230551215015000    2  2735.2654   507.5454  1.852408   
7   ZTF21abqfpsc  1706272141215015002    1  2715.7324   497.0353  1.183578   
8   ZTF21abqfpsc  1706231041215015002    2  2729.8882   509.6857  1.784323   
9   ZTF21abqfpsc  1703231281215015000    1  2773.0725   504.5519  1.582263   
10  ZTF21abqfpsc  1700293931215015008    2  2726.4026   481.6035  1.775872   
11  ZTF21abqfpsc  1700230611215015005    1  2787.2217   492.4108  2.017278   
12  ZTF21abqfpsc  1698251451215015005    2  2751.3247   505.0480  2.759511   
13  ZTF21abqfpsc  1694230391215015001    2  2764.8525   512.9511  0.817106   
14  ZTF21abqfpsc  1688274301215015003    1  2786.8755   470.4556  3.687651   
15  ZTF21abqfpsc  1688233611215015004    2  2810.0674   479.3189  1.374695   
16  ZTF21abqfpsc  1684209731215015001    1  2755.9055   558.8328  1.695075   
17  ZTF21abqfpsc  1680344051215015001    2  2791.8490   464.3656  3.347093   
18  ZTF21abqfpsc  1680251191215015004    1  2752.4446   475.2954  5.457131   
19  ZTF21abqfpsc  1675292811215015008    1  2722.6975   502.0842  1.164846   
20  ZTF21abqfpsc  1673293121215015002    1  2752.8480   502.3075  1.286089   
21  ZTF21abqfsfu  1673297892315015006    1   885.3172  1644.8344  5.378551   
22  ZTF21abqfttg  1673297894315015002    1  1508.1562   570.2802  0.887996   
23  ZTF21abqfttg  1673319644315015004    2  1490.9875   569.8618  1.175553   
24  ZTF21abqfttg  1675311884315015008    1  1456.8448   565.6684  1.782007   
25  ZTF21abqfttg  1680205024315015003    2  1497.2633   545.6270  4.839537   
26  ZTF21abqfttg  1680253644315015002    1  1497.0505   546.0013  1.008818   
27  ZTF21abqfttg  1682227784315015005    2  1491.4198   613.9341  3.866942   
28  ZTF21abqfttg  1682254734315015002    1  1490.8033   616.2559  1.762937   
29  ZTF21abqfttg  1685214604315015006    2  1512.3688   576.2684  2.469387   
30  ZTF21abqfttg  1685256054315015004    1  1512.4438   574.1723  1.230290   
31  ZTF21abqfttg  1687191774315015005    2  1508.5118   576.8800  3.252874   
32  ZTF21abqfttg  1696278884315015006    2  1472.7533   565.5556  1.421010   
33  ZTF21abqfttg  1698225964315015007    2  1481.3962   578.3092  1.778364   
34  ZTF21abqfttg  1700211844315015006    1  1494.3647   567.9411  1.090210   
35  ZTF21abqfttg  1700279514315015004    2  1491.0472   549.0451  0.776981   
36  ZTF21abqfttg  1704224614315015002    2  1475.8914   574.7198  1.830332   
37  ZTF21abqfttg  1706215624315015003    2  1487.4987   577.7266  2.414333   
38  ZTF21abqfttg  1708214684315015004    2  1491.7858   575.2964  1.366751   
39  ZTF21abqfttg  1710214864315015001    2  1503.3374   563.7293  1.660758   
40  ZTF21abqftqr  1777110775315015030    2  1124.0739  1665.2489  1.082520   
41  ZTF21abqftqr  1770103915315015006    2  1145.0950  1665.3431  1.890998   
42  ZTF21abqftqr  1768161295315015009    2  1125.0369  1655.2417  1.203145   
43  ZTF21abqftqr  1768141005315015011    1  1135.6854  1663.0933  0.907421   
44  ZTF21abqftqr  1766203815315015017    2  1113.2010  1648.8857  1.137547   
45  ZTF21abqftqr  1756143225315015005    2  1145.3307  1678.3813  1.239189   
46  ZTF21abqftqr  1750137295315015011    2  1150.8647  1680.6373  1.638560   
47  ZTF21abqftqr  1748161595315015009    2  1126.6887  1696.6346  1.682503   
48  ZTF21abqftqr  1748139725315015007    1  1140.1903  1697.0027  0.840455   
49  ZTF21abqftqr  1744152555315015004    2  1163.6545  1686.0093  3.010428   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   1.037834  3.700000     0.968    336.0568  ...     0.000002     0.019930   
1   2.010935  1.970000     0.979    331.5485  ...     0.000003     0.020763   
2  -0.087830  3.400000     0.700    295.8266  ...     0.000003     0.021361   
3   0.978781  1.830000     0.983    313.7808  ...     0.000003     0.019680   
4   0.418327  2.250000     0.927    292.5432  ...     0.000002     0.017696   
5   1.726357  2.530000     1.000    285.0391  ...     0.000003     0.019591   
6  -0.022471  2.600000     0.977    337.2347  ...     0.000007     0.028624   
7   0.144075  2.610000     0.954    356.7676  ...     0.000005     0.023470   
8   0.743635  2.280000     0.982    342.6118  ...     0.000002     0.018098   
9  -0.961356  2.780000     0.978    299.4274  ...     0.000016     0.041887   
10  1.262861  2.390000     1.000    346.0975  ...     0.000005     0.025286   
11  0.154264  2.600000     0.982    285.2783  ...     0.000002     0.016947   
12  1.570197  2.010000     0.983    321.1752  ...     0.000004     0.022440   
13  0.036657  2.210000     0.977    307.6474  ...     0.000005     0.024490   
14  0.474371  2.320000     0.982    285.6244  ...     0.000003     0.019213   
15  0.454313  2.280000     0.982    262.4327  ...     0.000002     0.017905   
16  0.597276  2.140000     0.983    316.5946  ...     0.000002     0.017039   
17  1.330961  2.160000     0.982    280.6510  ...     0.000002     0.016742   
18  0.808756  2.120000     0.992    320.0553  ...     0.000002     0.015860   
19  0.184054  2.360000     0.976    349.8026  ...     0.000002     0.016677   
20  0.262833  2.890000     0.968    319.6522  ...     0.000003     0.018150   
21  0.787633  2.600000     0.982    885.3172  ...     0.000007     0.029162   
22 -0.105108  2.160000     0.967    570.2802  ...     0.000002     0.015900   
23  0.826800  2.170000     0.890    569.8618  ...     0.000002     0.017944   
24  0.529801  2.410000     0.982    565.6684  ...     0.000002     0.016455   
25  0.725040  2.800000     0.999    545.6270  ...     0.000002     0.019520   
26  0.102150  2.070000     0.979    546.0013  ...     0.000002     0.017122   
27  0.968942  2.450000     0.981    613.9341  ...     0.000001     0.017963   
28  0.061980  2.090000     0.981    616.2559  ...     0.000002     0.017177   
29  0.415127  1.990000     0.983    576.2684  ...     0.000001     0.018061   
30 -0.142675  2.720000     0.973    574.1723  ...     0.000002     0.017844   
31  0.875466  1.860000     0.978    576.8800  ...     0.000002     0.019878   
32  1.637862  2.600000     0.959    565.5556  ...     0.000002     0.019427   
33  1.619668  2.890000     0.957    578.3092  ...     0.000002     0.018846   
34  0.210140  1.216964     0.722    567.9411  ...     0.000002     0.016154   
35  0.797292  1.640000     0.949    549.0451  ...     0.000001     0.017826   
36  0.881842  2.230000     0.863    574.7198  ...     0.000001     0.018008   
37  0.876767  2.350000     0.993    577.7266  ...     0.000002     0.017989   
38  0.744262  1.237548     0.922    575.2964  ...     0.000001     0.018225   
39  0.990628  1.193382     0.713    563.7293  ...     0.000002     0.019185   
40  0.201016  4.480000     0.890   1124.0739  ...     0.000003     0.030299   
41  0.413560  1.830000     0.981   1145.0950  ...     0.000002     0.023969   
42  0.026084  1.860000     0.980   1125.0369  ...     0.000001     0.022235   
43  0.430765  2.060000     0.967   1135.6854  ...     0.000002     0.021696   
44 -2.375804  3.410000     0.934   1113.2010  ...     0.000003     0.029041   
45 -0.520192  1.229870     0.999   1145.3307  ...     0.000002     0.025974   
46 -0.053400  2.470000     0.982   1150.8647  ...     0.000002     0.023939   
47 -1.373555  2.840000     0.983   1126.6887  ...     0.000002     0.023624   
48 -0.217612  4.140000     0.919   1140.1903  ...     0.000004     0.031847   
49  0.335542  1.860000     0.984   1163.6545  ...     0.000001     0.021822   

    nmatches  clrcoeff  clrcounc  zpclrcov   zpmed  clrmed    clrrms  exptime  
0       1975  0.083132  0.000008 -0.000004  26.245   0.518  0.134407     30.0  
1       1973  0.078358  0.000009 -0.000005  26.131   0.518  0.133618     30.0  
2       1960 -0.096521  0.000009 -0.000005  26.079   0.518  0.132276     30.0  
3       1968  0.078369  0.000008 -0.000004  26.157   0.518  0.132776     30.0  
4       1957 -0.059017  0.000007 -0.000004  26.073   0.518  0.133576     30.0  
5       1959  0.077030  0.000008 -0.000004  26.190   0.518  0.132873     30.0  
6       1965  0.071796  0.000021 -0.000012  26.240   0.517  0.132735     30.0  
7       1962 -0.041454  0.000015 -0.000008  26.052   0.517  0.133988     30.0  
8       1980  0.077849  0.000006 -0.000003  26.217   0.518  0.134010     30.0  
9       1950 -0.043045  0.000049 -0.000027  26.015   0.518  0.134100     30.0  
10      1967  0.082734  0.000015 -0.000008  26.173   0.517  0.133539     30.0  
11      1948 -0.056994  0.000007 -0.000004  26.158   0.517  0.132060     30.0  
12      1970  0.077149  0.000011 -0.000006  26.200   0.518  0.133928     30.0  
13      1976  0.073395  0.000014 -0.000008  26.143   0.518  0.134042     30.0  
14      1954 -0.053339  0.000009 -0.000005  25.961   0.518  0.133728     30.0  
15      1958  0.076978  0.000006 -0.000003  26.101   0.518  0.133051     30.0  
16      1978 -0.026649  0.000008 -0.000004  25.791   0.519  0.135355     30.0  
17      1959  0.074232  0.000005 -0.000003  26.126   0.520  0.134027     30.0  
18      1962 -0.045373  0.000006 -0.000003  26.125   0.518  0.132892     30.0  
19      1959 -0.037424  0.000007 -0.000004  26.116   0.517  0.134779     30.0  
20      1964 -0.039010  0.000009 -0.000005  26.080   0.517  0.134076     30.0  
21      2012 -0.052152  0.000023 -0.000013  26.269   0.515  0.132438     30.0  
22      2001 -0.037646  0.000006 -0.000003  26.285   0.518  0.142140     30.0  
23      2007  0.073055  0.000005 -0.000003  26.418   0.517  0.141111     30.0  
24      2012 -0.047418  0.000006 -0.000003  26.311   0.518  0.141611     30.0  
25      2020  0.081623  0.000006 -0.000003  26.450   0.518  0.141777     30.0  
26      2015 -0.051705  0.000006 -0.000003  26.324   0.517  0.141375     30.0  
27      2011  0.084450  0.000004 -0.000002  26.380   0.517  0.142137     30.0  
28      2003 -0.043375  0.000006 -0.000004  26.228   0.516  0.142658     30.0  
29      2014  0.088256  0.000004 -0.000002  26.306   0.518  0.141607     30.0  
30      2002 -0.040408  0.000007 -0.000004  26.116   0.517  0.143410     30.0  
31      2009  0.084709  0.000006 -0.000004  26.354   0.518  0.140676     30.0  
32      2020  0.080367  0.000006 -0.000003  26.186   0.518  0.140804     30.0  
33      2019  0.076581  0.000006 -0.000003  26.465   0.518  0.140890     30.0  
34      2006 -0.047781  0.000005 -0.000003  26.357   0.518  0.142377     30.0  
35      2024  0.085886  0.000004 -0.000002  26.451   0.517  0.142952     30.0  
36      2022  0.083771  0.000004 -0.000002  26.423   0.518  0.143683     30.0  
37      2017  0.082961  0.000005 -0.000003  26.476   0.518  0.141973     30.0  
38      2017  0.086639  0.000004 -0.000002  26.477   0.517  0.142617     30.0  
39      2016  0.079330  0.000006 -0.000003  26.455   0.518  0.141953     30.0  
40      1976  0.074000  0.000011 -0.000005  26.294   0.469  0.186897     30.0  
41      1968  0.072408  0.000006 -0.000003  26.310   0.469  0.186020     30.0  
42      1982  0.068913  0.000005 -0.000003  26.256   0.469  0.185500     30.0  
43      1963 -0.030906  0.000006 -0.000003  26.254   0.469  0.186065     30.0  
44      1983  0.072916  0.000010 -0.000005  26.153   0.472  0.185548     30.0  
45      1962  0.066574  0.000008 -0.000004  25.935   0.469  0.186591     30.0  
46      1953  0.060916  0.000007 -0.000003  26.295   0.469  0.184625     30.0  
47      1970  0.068796  0.000006 -0.000003  26.277   0.469  0.184220     30.0  
48      1948 -0.042190  0.000014 -0.000007  26.300   0.469  0.186688     30.0  
49      1949  0.075753  0.000004 -0.000002  26.275   0.472  0.185689     30.0  

[50 rows x 32 columns]]",,10.394766092300417,2025-05-20T18:04:08,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,9,"
-- Retrieve all columns from the 'dataquality' table for ZTF objects with a high probability of being supernovae
SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability > 0.7
  AND p.ranking = 1
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,14.054017543792725,2025-04-29T12:21:05,"[             oid               candid  fid       xpos       ypos    chipsf  \
0   ZTF21abqoovx  2458383390815015020    2  1677.0552  2028.4014  1.528578   
1   ZTF21abqoovx  2416408840815015008    2  1712.9111  2021.7981  0.825031   
2   ZTF21abqoovx  2204142430815015011    2  1648.1956  2052.3820  0.927964   
3   ZTF21abqoovx  2183155910815015010    2  1659.7650  2055.8003  0.806958   
4   ZTF21abqoovx  2152154210815015018    2  1663.1466  2028.1125  1.163416   
5   ZTF21abqoovx  2125288000815015007    2  1666.2787  2072.9397  0.789297   
6   ZTF21abqoovx  1674387950815015017    2  1678.9710  1988.8196  1.162427   
7   ZTF21abqoovx  1676386850815015027    2  1721.0150  1978.7251  1.223467   
8   ZTF21abqoovx  1676414910815015013    1  1688.8613  1982.7234  1.058643   
9   ZTF21abqoovx  1684466240815015025    2  1679.3379  2070.2020  0.964745   
10  ZTF21abqoovx  1705368220815015014    2  1699.8572  2008.0728  1.004191   
11  ZTF21abqoovx  1707365120815015015    2  1686.2395  2009.3591  1.647061   
12  ZTF21abqoovx  1711370250815015009    2  1710.2438  1994.0540  1.242353   
13  ZTF21abqoovx  1713387560815015019    2  1669.0647  1998.7812  1.362383   
14  ZTF21abqoovx  1713430700815015011    1  1690.5583  1998.8050  1.153764   
15  ZTF21abqoovx  1715353840815015021    1  1682.2405  2001.9429  0.722003   
16  ZTF21abqoovx  1715389660815015018    2  1688.1841  1997.1339  1.313423   
17  ZTF21abqoovx  1763241420815015011    2  1676.2319  2000.7512  0.923367   
18  ZTF21abqoovx  2009454830815015015    1  1699.8242  1982.5700  1.584445   
19  ZTF21abqoovx  2012390120815015015    2  1688.2406  1977.7583  1.323450   
20  ZTF21abqoovx  2012428680815015021    1  1689.7325  1988.2014  1.001738   
21  ZTF21abqoovx  2015424390815015016    1  1706.2444  1996.7662  0.929074   
22  ZTF21abqoovx  2044456340815015011    2  1707.9071  2006.0820  1.125890   
23  ZTF21abqoovx  2059382090815015011    2  1719.7635  2006.2174  1.045119   
24  ZTF21abqoovx  2065471820815015017    2  1691.0627  2004.9304  0.930842   
25  ZTF21abqoovx  2088387740815015009    2  1682.3079  2034.4290  1.048620   
26  ZTF21abqoovx  2090317870815015004    2  1691.0306  2006.3270  1.069970   
27  ZTF21abqoovx  2095267550815015038    1  1695.0337  2000.5503  1.050787   
28  ZTF21abqoovx  2095304540815015008    2  1690.4166  2005.7241  1.589242   
29  ZTF21abqoovx  2097299980815015005    2  1716.1825  2011.7668  0.794088   
30  ZTF21abqoovx  2100370320815015019    1  1677.6805  1997.7346  0.856771   
31  ZTF21abqoovx  2102346190815015008    2  1692.3073  2039.2327  1.301955   
32  ZTF21abqoovx  2117196070815015009    2  1695.1506  2025.1412  0.996533   
33  ZTF21abqooyw  1674392545815015007    2  2613.9644  2518.7770  0.965851   
34  ZTF21abqooyw  1676237625815015009    2  2658.1824  2533.3699  1.043234   
35  ZTF21abqooyw  1681224355815015012    1  2651.2295  2534.4355  1.544756   
36  ZTF21abqooyw  1681257845815015006    2  2617.6810  2535.4650  2.393871   
37  ZTF21abqooyw  1688249155815015008    2  2644.2915  2511.3296  1.214002   
38  ZTF21abqooyw  1701269765815015008    2  2623.6355  2523.2483  1.419211   
39  ZTF21abqooyw  1705202095815015004    2  2603.3015  2551.9438  1.163186   
40  ZTF21abqooyw  1709267115815015016    2  2614.3691  2550.4856  1.682012   
41  ZTF21abqooyw  1713384525815015008    2  2581.8467  2469.3738  1.235786   
42  ZTF21abqooyw  1719262155815015007    2  2581.0684  2541.6833  0.785240   
43  ZTF21abqooyw  1734195835815015005    2  2595.1084  2565.5510  1.068814   
44  ZTF21abqooyw  1744329605815015013    2  2586.4468  2472.9148  1.262734   
45  ZTF21abqooyw  1763285575815015006    2  2587.1294  2451.4253  0.928478   
46  ZTF21abqooyw  1766257765815015010    2  2583.4187  2505.3140  1.009103   
47  ZTF21abqooyw  1768204375815015010    2  2590.2239  2519.1292  0.666073   
48  ZTF21abqooyw  1770252445815015015    2  2584.6548  2480.3857  1.425444   
49  ZTF21abqooyw  1772136525815015008    2  2596.2760  2548.1660  1.466960   

         sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0   0.626586  1.184085     0.785   1052.0986  ...     0.000002     0.026172   
1   0.804051  1.900000     0.791   1058.7019  ...     0.000001     0.024595   
2   0.393116  1.356831     0.715   1028.1179  ...     0.000001     0.024229   
3   0.115515  2.390000     0.966   1024.6997  ...     0.000001     0.023120   
4   0.208892  2.570000     0.946   1052.3875  ...     0.000001     0.023846   
5   0.029140  1.970000     0.853   1007.5602  ...     0.000001     0.025480   
6   0.371341  1.910000     0.900   1091.6804  ...     0.000001     0.024136   
7   0.594567  2.020000     0.788   1101.7749  ...     0.000001     0.025405   
8   0.116955  1.910000     0.848   1097.7766  ...     0.000002     0.025128   
9   0.616376  1.173369     0.866   1010.2980  ...     0.000002     0.027337   
10  0.333005  2.420000     0.838   1072.4272  ...     0.000001     0.024362   
11  0.327094  2.120000     0.906   1071.1409  ...     0.000001     0.024461   
12  0.549942  1.910000     0.923   1086.4460  ...     0.000001     0.024936   
13  0.528555  2.670000     0.776   1081.7188  ...     0.000001     0.023548   
14 -0.068885  2.590000     0.599   1081.6950  ...     0.000002     0.031476   
15  0.299734  1.920000     0.883   1078.5571  ...     0.000002     0.025547   
16  0.480735  2.080000     0.840   1083.3661  ...     0.000001     0.025678   
17  0.446642  2.010000     0.739   1079.7488  ...     0.000002     0.028317   
18 -0.104150  2.680000     0.626   1097.9300  ...     0.000002     0.032206   
19  0.133816  2.180000     0.944   1102.7417  ...     0.000001     0.024382   
20  0.014407  2.950000     0.809   1092.2986  ...     0.000002     0.030663   
21  0.238131  1.710000     0.598   1083.7338  ...     0.000002     0.029982   
22 -0.008218  2.810000     0.930   1074.4180  ...     0.000001     0.023515   
23  0.582899  1.227299     0.693   1074.2826  ...     0.000001     0.023974   
24  0.482141  2.180000     0.911   1075.5696  ...     0.000001     0.024221   
25  0.763709  2.610000     0.874   1046.0710  ...     0.000001     0.023806   
26  0.046573  2.370000     0.726   1074.1730  ...     0.000001     0.022543   
27 -0.130439  2.390000     0.768   1079.9497  ...     0.000002     0.028371   
28  0.646826  3.400000     0.840   1074.7759  ...     0.000001     0.023511   
29  0.433300  1.830000     0.868   1068.7332  ...     0.000001     0.023630   
30 -0.016048  2.850000     0.623   1082.7654  ...     0.000002     0.029557   
31  0.202940  2.410000     0.890   1041.2673  ...     0.000001     0.024153   
32 -0.114791  2.190000     0.783   1055.3588  ...     0.000001     0.023378   
33  0.653537  2.220000     0.971    458.5357  ...     0.000005     0.034806   
34 -0.050838  2.090000     0.979    414.3176  ...     0.000005     0.034531   
35 -0.024009  1.960000     0.955    421.2705  ...     0.000009     0.036172   
36  0.573662  2.260000     0.981    454.8190  ...     0.000006     0.035138   
37  0.057698  3.400000     0.996    428.2086  ...     0.000007     0.039225   
38  0.706573  1.980000     0.970    448.8646  ...     0.000005     0.033571   
39  0.917026  2.520000     0.969    469.1985  ...     0.000005     0.034314   
40  0.177693  2.520000     0.978    458.1308  ...     0.000005     0.035094   
41  0.774860  2.260000     0.972    490.6532  ...     0.000004     0.032691   
42  0.431924  2.090000     0.985    491.4316  ...     0.000005     0.036164   
43  0.736322  2.040000     0.994    477.3916  ...     0.000006     0.036323   
44  0.228085  3.670000     0.968    486.0533  ...     0.000007     0.038975   
45  0.273099  2.550000     0.978    485.3705  ...     0.000008     0.039971   
46  0.379134  4.200000     0.935    489.0813  ...     0.000004     0.032933   
47  0.522061  2.160000     0.972    482.2762  ...     0.000005     0.034284   
48  0.502073  2.900000     0.975    487.8453  ...     0.000004     0.031939   
49  0.865855  1.990000     0.979    476.2241  ...     0.000004     0.032546   

    nmatches  clrcoeff  clrcounc  zpclrcov   zpmed  clrmed    clrrms  exptime  
0       2120  0.078501  0.000004 -0.000002  26.372   0.558  0.224395     30.0  
1       2122  0.078636  0.000003 -0.000002  26.335   0.558  0.225059     30.0  
2       2122  0.074769  0.000003 -0.000002  26.371   0.558  0.224153     30.0  
3       2122  0.070421  0.000003 -0.000002  26.378   0.558  0.223977     30.0  
4       2114  0.076284  0.000003 -0.000002  26.380   0.558  0.222694     30.0  
5       2125  0.079096  0.000003 -0.000002  26.356   0.557  0.224228     30.0  
6       2116  0.076558  0.000003 -0.000002  26.309   0.559  0.222631     30.0  
7       2102  0.078316  0.000003 -0.000002  26.322   0.559  0.222996     30.0  
8       2121 -0.067344  0.000004 -0.000002  26.340   0.558  0.224181     30.0  
9       2119  0.078156  0.000004 -0.000003  26.220   0.557  0.224199     30.0  
10      2122  0.077006  0.000003 -0.000002  26.361   0.558  0.222201     30.0  
11      2115  0.078270  0.000003 -0.000002  26.361   0.559  0.223143     30.0  
12      2111  0.077970  0.000003 -0.000002  26.316   0.559  0.222326     30.0  
13      2118  0.074699  0.000003 -0.000002  26.313   0.558  0.222601     30.0  
14      2122 -0.093397  0.000005 -0.000003  26.305   0.558  0.223400     30.0  
15      2118 -0.065457  0.000004 -0.000003  26.377   0.558  0.225185     30.0  
16      2117  0.079574  0.000003 -0.000002  26.353   0.559  0.223655     30.0  
17      2124  0.077030  0.000005 -0.000003  26.391   0.558  0.223467     30.0  
18      2122 -0.103339  0.000005 -0.000003  26.381   0.559  0.224998     30.0  
19      2118  0.079862  0.000003 -0.000002  26.337   0.560  0.223538     30.0  
20      2116 -0.095792  0.000004 -0.000003  26.370   0.559  0.224458     30.0  
21      2122 -0.088268  0.000005 -0.000003  26.371   0.558  0.223800     30.0  
22      2119  0.077352  0.000002 -0.000002  26.344   0.558  0.222167     30.0  
23      2108  0.077327  0.000003 -0.000002  26.318   0.559  0.222763     30.0  
24      2118  0.075547  0.000003 -0.000002  26.340   0.558  0.222682     30.0  
25      2115  0.078110  0.000002 -0.000002  26.375   0.557  0.223294     30.0  
26      2124  0.066976  0.000003 -0.000002  26.400   0.559  0.223969     30.0  
27      2119 -0.081941  0.000004 -0.000003  26.378   0.559  0.222922     30.0  
28      2123  0.073998  0.000003 -0.000002  26.370   0.558  0.223729     30.0  
29      2111  0.067119  0.000003 -0.000002  26.350   0.558  0.223204     30.0  
30      2116 -0.086989  0.000005 -0.000003  26.362   0.558  0.223316     30.0  
31      2119  0.071969  0.000003 -0.000002  26.353   0.557  0.224422     30.0  
32      2115  0.072925  0.000003 -0.000002  26.370   0.558  0.222764     30.0  
33       853  0.093601  0.000008 -0.000006  26.247   0.645  0.276987     30.0  
34       856  0.093546  0.000008 -0.000006  26.268   0.638  0.275676     30.0  
35       846 -0.073402  0.000014 -0.000010  26.119   0.630  0.272788     30.0  
36       850  0.086784  0.000010 -0.000007  26.217   0.641  0.276411     30.0  
37       852  0.102007  0.000011 -0.000008  26.179   0.641  0.276996     30.0  
38       850  0.088695  0.000008 -0.000006  26.258   0.643  0.276724     30.0  
39       851  0.094108  0.000008 -0.000006  26.296   0.642  0.276139     30.0  
40       851  0.097504  0.000008 -0.000006  26.285   0.641  0.276400     30.0  
41       857  0.091585  0.000006 -0.000005  26.202   0.642  0.277844     30.0  
42       857  0.099277  0.000009 -0.000006  26.309   0.642  0.275285     30.0  
43       845  0.094989  0.000010 -0.000007  26.306   0.645  0.276210     30.0  
44       860  0.097684  0.000012 -0.000009  26.287   0.645  0.278239     30.0  
45       855  0.100717  0.000012 -0.000009  26.330   0.642  0.277613     30.0  
46       853  0.091779  0.000007 -0.000005  26.326   0.645  0.277001     30.0  
47       851  0.095058  0.000007 -0.000005  26.319   0.642  0.277578     30.0  
48       858  0.088987  0.000006 -0.000005  26.328   0.645  0.278027     30.0  
49       849  0.087918  0.000007 -0.000005  26.337   0.645  0.276160     30.0  

[50 rows x 32 columns]]",,8.002529621124268,2025-05-20T18:04:24,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,89,10,"
-- Select all columns from the dataquality table for ZTF objects with a probability greater than 0.7 of being supernovae
SELECT dq.*
FROM probability p
INNER JOIN dataquality dq ON p.oid = dq.oid
WHERE p.class_name = 'SN' -- Filter for supernova class
  AND p.classifier_name = 'stamp_classifier' -- Use the stamp classifier
  AND p.probability > 0.7 -- Probability condition
  AND p.ranking = 1 -- Only consider the most likely class
LIMIT 50 -- Limit the results to at most 50 objects
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.2511727809906,2025-04-29T12:21:17,"[              oid               candid  fid       xpos       ypos    chipsf  \
0    ZTF18aczvixb   760134443715015107    2  2364.4077  2843.7150  2.776517   
1    ZTF18aczvixb   760203503715015022    1  2362.5813  2861.0986  1.160585   
2    ZTF18aczvixb   768191073715015034    2  2356.4304  2879.9006  1.964295   
3    ZTF18aczvixb  1002459883715015036    1  2437.5700  2805.2500  1.434650   
4    ZTF18aczvixb  1002495913715015038    2  2422.9514  2800.9460  1.161134   
..            ...                  ...  ...        ...        ...       ...   
586  ZTF21abrfwqo  1680179401615015014    2  1527.1200  2074.0532  1.051704   
587  ZTF21abrfwqo  1680197672915015012    2  2213.8936  2084.0525  1.072242   
588  ZTF21abrfwqo  1680237212915015026    1  2170.3713  2081.6587  1.498075   
589  ZTF21abrfwqo  1682203372915015012    2  2191.8645  2148.9397  1.374813   
590  ZTF21abrfwqo  1682203841615015016    2  1538.3593  2126.9412  1.215373   

          sky      fwhm  classtar  mindtoedge  ...  magzpsciunc  magzpscirms  \
0    0.154206  2.050000     0.979    236.7850  ...     0.000004     0.022965   
1   -0.255882  3.920000     0.915    219.4013  ...     0.000008     0.026108   
2    0.728806  1.650000     0.983    200.5994  ...     0.000003     0.021549   
3   -0.066850  3.100000     0.933    275.2490  ...     0.000005     0.020803   
4    0.295619  2.090000     0.978    279.5539  ...     0.000003     0.020949   
..        ...       ...       ...         ...  ...          ...          ...   
586  0.313193  1.170675     0.889   1006.4467  ...     0.000006     0.043864   
587  0.291161  2.350000     0.743    858.6065  ...     0.000006     0.041989   
588  0.110469  2.910000     0.862    902.1286  ...     0.000008     0.040786   
589  0.004751  2.350000     0.930    880.6355  ...     0.000006     0.042020   
590  0.537773  1.096867     0.679    953.5589  ...     0.000006     0.042663   

     nmatches  clrcoeff  clrcounc  zpclrcov    zpmed  clrmed    clrrms  \
0      2094.0  0.089904  0.000006 -0.000005  26.3120   0.819  0.163844   
1      2091.0 -0.027599  0.000011 -0.000010  26.1460   0.818  0.166235   
2      2089.0  0.090158  0.000004 -0.000004  26.3160   0.819  0.163371   
3         NaN -0.057286  0.000007       NaN      NaN     NaN       NaN   
4      2112.0  0.093327  0.000004 -0.000003  26.2400   0.817  0.164524   
..        ...       ...       ...       ...      ...     ...       ...   
586     596.0  0.115668  0.000011 -0.000007  26.3040   0.605  0.312151   
587     600.0  0.109355  0.000010 -0.000007  26.3265   0.618  0.313559   
588     601.0 -0.093542  0.000014 -0.000010  26.2110   0.622  0.311911   
589     616.0  0.108846  0.000010 -0.000007  26.2670   0.620  0.312022   
590     598.0  0.110690  0.000011 -0.000008  26.2330   0.612  0.310279   

     exptime  
0       30.0  
1       30.0  
2       30.0  
3        NaN  
4       30.0  
..       ...  
586     30.0  
587     30.0  
588     30.0  
589     30.0  
590     30.0  

[591 rows x 32 columns]]",,10.219929218292236,2025-05-20T18:04:43,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,72,0,"SELECT
    *
FROM
    reference
WHERE
    oid = 'ZTF20actnuls'
    AND rfid = '712120223'",,,,,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,3.7149970531463614,2025-05-20T18:04:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,1,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' 
AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.361714601516724,2025-04-29T12:21:20,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.660849094390869,2025-05-20T18:05:11,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,2,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,3.4109840393066406,2025-04-29T12:21:23,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.205514430999756,2025-05-20T18:05:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,3,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.1434648036956787,2025-04-29T12:21:25,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.332663059234619,2025-05-20T18:05:42,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,4,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.624880075454712,2025-04-29T12:21:28,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.556961297988892,2025-05-20T18:05:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,5,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.4820804595947266,2025-04-29T12:21:31,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.961998462677002,2025-05-20T18:06:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,6,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' 
AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,5.683007478713989,2025-04-29T12:21:37,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.8189377784729,2025-05-20T18:06:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,7,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.343341112136841,2025-04-29T12:21:39,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.4239561557769775,2025-05-20T18:06:45,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,8,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.183988571166992,2025-04-29T12:21:41,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,8.285032272338867,2025-05-20T18:07:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,9,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.622476577758789,2025-04-29T12:21:44,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.4241180419921875,2025-05-20T18:07:17,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,72,10,"
SELECT * 
FROM reference 
WHERE oid = 'ZTF20actnuls' AND rfid = 712120223
","['\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",simple,2.7047982215881348,2025-04-29T12:21:47,"[        rfid           oid               candid  fid  rcid  field   magnr  \
0  712120223  ZTF20actnuls  1423498792315015010    2    23    712  18.255   

   sigmagnr  chinr  sharpnr        ranr     decnr   mjdstartref     mjdendref  \
0     0.102  9.673    0.411  159.524295  39.17621  58154.300891  58184.315474   

   nframesref  
0          15  ]",,7.625250101089477,2025-05-20T18:07:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,103,0,"SELECT
    *
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ps1_ztf
    ON object.oid = ps1_ztf.oid
WHERE
    classifier_name = 'lc_classifier'
    AND class_name NOT IN ('SNIa','SNII','SNIbc','SLSN')
    AND probability > 0.7
    AND distpsnr1 > 5
ORDER BY distpsnr1
LIMIT 200
",,,,,,"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: SELECT
    *
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ps1_ztf
    ON object.oid = ps1_ztf.oid
WHERE
    classifier_name = 'lc_classifier'
    AND class_name NOT IN ('SNIa','SNII','SNIbc','SLSN')
    AND probability > 0.7
    AND distpsnr1 > 5
ORDER BY distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",248.0964596271515,2025-05-20T18:11:46,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,103,1,"
-- Subquery to filter probability table for non-supernova classes with probability > 0.7
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join object, filtered_probability, and ps1_ztf tables
SELECT o.*, p.*, ps.*
FROM object o
INNER JOIN filtered_probability fp ON o.oid = fp.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.784273147583008,2025-04-29T12:22:11,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to filter probability table for non-supernova classes with probability > 0.7
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join object, filtered_probability, and ps1_ztf tables
SELECT o.*, fp.*, ps.*
FROM object o
INNER JOIN filtered_probability fp ON o.oid = fp.oid
INNER JOIN ps1_ztf ps ON o.oid = ps.oid
WHERE ps.distpsnr1 > 5
ORDER BY ps.distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",127.97978901863098,2025-05-20T18:17:16,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,103,2,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
  AND probability.probability > 0.7
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,23.82468056678772,2025-04-29T12:22:35,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 53 columns]]",,137.8381791114807,2025-05-20T18:19:55,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,103,3,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
  AND probability.probability > 0.7
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,19.51356410980225,2025-04-29T12:22:54,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,38.54491090774536,2025-05-20T18:20:57,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.16.3,gpt-4o,v1,103,4,"
-- Subquery to filter probability table for objects with specific conditions
WITH filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join tables and apply conditions
SELECT *
FROM object
INNER JOIN filtered_probabilities ON object.oid = filtered_probabilities.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,17.91724944114685,2025-04-29T12:23:12,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,35.34485340118408,2025-05-20T18:21:52,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.16.3,gpt-4o,v1,103,5,"
SELECT 
    o.*, 
    p.*, 
    ps.*
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
INNER JOIN 
    ps1_ztf ps ON o.oid = ps.oid
WHERE 
    ps.distpsnr1 > 5
    AND p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
    AND p.probability > 0.7
    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
ORDER BY 
    ps.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,16.294819116592407,2025-04-29T12:23:29,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT 
    o.*, 
    p.*, 
    ps.*
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
INNER JOIN 
    ps1_ztf ps ON o.oid = ps.oid
WHERE 
    ps.distpsnr1 > 5
    AND p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
    AND p.probability > 0.7
    AND p.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
ORDER BY 
    ps.distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",143.7701551914215,2025-05-20T18:24:34,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,103,6,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
  AND probability.probability > 0.7
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,15.656266927719116,2025-04-29T12:23:44,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Step 1: Create a sub-query to filter the probability table with the necessary conditions
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Step 2: Join the filtered probability results with the object and ps1_ztf tables
SELECT *
FROM object
INNER JOIN filtered_probability ON object.oid = filtered_probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.7282977104187,2025-05-21T22:36:23,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,103,7,"
-- Subquery to filter probability table for objects with ranking = 1, classifier_name = 'lc_classifier', and probability > 0.7
-- Exclude supernova classes by using a WHERE clause with NOT IN for class_name
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join object, probability, and ps1_ztf tables
SELECT *
FROM object
INNER JOIN filtered_probability ON object.oid = filtered_probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1 ASC
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,21.19888615608216,2025-04-29T12:24:06,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,57.30054473876953,2025-05-21T22:38:03,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.16.3,gpt-4o,v1,103,8,"
SELECT *
FROM object
INNER JOIN (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
) AS prob_filtered ON object.oid = prob_filtered.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,19.75401306152344,2025-04-29T12:24:25,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 48 columns]]",,36.78655171394348,2025-05-21T22:38:58,1.0,1.0,0.9056603773584906,1.0,1.0,0.0
0.16.3,gpt-4o,v1,103,9,"
SELECT *
FROM object
INNER JOIN probability ON object.oid = probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
  AND probability.probability > 0.7
  AND probability.class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.798010110855103,2025-04-29T12:24:46,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 53 columns]]",,36.17016911506653,2025-05-21T22:39:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,103,10,"
-- Subquery to filter probability table for non-supernova classes with probability > 0.7
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
      AND probability > 0.7
      AND class_name NOT IN ('SNIa', 'SNIbc', 'SNII', 'SLSN')
)

-- Main query to join tables and apply conditions
SELECT *
FROM object
INNER JOIN filtered_probability ON object.oid = filtered_probability.oid
INNER JOIN ps1_ztf ON object.oid = ps1_ztf.oid
WHERE ps1_ztf.distpsnr1 > 5
ORDER BY ps1_ztf.distpsnr1
LIMIT 200
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,20.07724237442017,2025-04-29T12:25:06,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
1   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
2   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
3   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
4   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
5   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
6   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
7   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
8   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
9   ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
10  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
11  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
12  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
13  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
14  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
15  ZTF20acoknjv       154      1002  59153.503218  60761.148391       True   
16  ZTF20abfttkl       157       618  58992.250000  60206.250000       True   
17  ZTF20aaqvvup       291      2197  58487.255567  60292.506366       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...    sgmag3    srmag3   simag3  \
0     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
1     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
2     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
3     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
4     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
5     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
6     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
7     False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
8     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
9     False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
10    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
11    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
12    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
13    False    81       NaN           NaN  ... -999.0000 -999.0000 -999.000   
14    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
15    False    81       NaN           NaN  ...   18.1699   17.7471   17.525   
16    False   129 -0.129404      0.314863  ... -999.0000 -999.0000 -999.000   
17    False   197  0.213743      0.115465  ... -999.0000 -999.0000 -999.000   

      szmag3  sgscore3   distpsnr3  nmtchps  unique1  unique2 unique3  
0    18.5940       0.5   20.389175       13    False    False   False  
1    18.5940       0.5   20.264050       13    False    False   False  
2    18.5940       0.5   20.427036       13    False    False   False  
3    18.5940       0.5   20.684048       13    False    False   False  
4    17.4021       0.5   20.600231       13    False    False   False  
5    17.4021       0.5   20.477049       13    False    False   False  
6    18.5940       0.5   20.177076       13    False    False   False  
7    17.4021       0.5   20.354027       13    False    False   False  
8    18.5940       0.5   20.425758       13    False    False   False  
9    18.5940       0.5   19.845686       13    False    False   False  
10   17.4021       0.5   20.266893       13    False    False   False  
11   17.4021       0.5   20.013437       12    False    False   False  
12   17.4021       0.5   20.242962       13    False    False   False  
13   18.5940       0.5   19.857320       13    False    False   False  
14   17.4021       0.5   20.165024       13    False    False   False  
15   17.4021       0.5   20.004354       13    False    False   False  
16 -999.0000    -999.0 -999.000000        2    False    False   False  
17 -999.0000    -999.0 -999.000000        1    False    False   False  

[18 rows x 53 columns]]",,113.49581027030945,2025-05-21T22:41:58,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,54,0,"SELECT
    *
FROM
    non_detection
WHERE
    oid IN ('ZTF23abtcveg','ZTF23abudlls')
    AND diffmaglim > 19.5",,,,,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,3.2840609550476074,2025-05-21T22:42:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,1,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.705353260040283,2025-04-29T12:25:09,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.526228666305542,2025-05-21T22:42:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,2,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.117048978805542,2025-04-29T12:25:11,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,8.213789939880371,2025-05-21T22:42:24,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,3,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.391714572906494,2025-04-29T12:25:14,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,11.27934741973877,2025-05-21T22:42:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,4,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.302300453186035,2025-04-29T12:25:16,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.680176734924316,2025-05-21T22:42:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,5,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.127150774002075,2025-04-29T12:25:18,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.659184455871582,2025-05-21T22:43:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,6,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.57853364944458,2025-04-29T12:25:21,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.656733274459839,2025-05-21T22:43:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,7,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.1756234169006348,2025-04-29T12:25:23,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.557464361190796,2025-05-21T22:43:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,8,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.330539464950561,2025-04-29T12:25:26,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.865105628967285,2025-05-21T22:43:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,9,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,2.194096565246582,2025-04-29T12:25:28,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.445636987686157,2025-05-21T22:43:45,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,54,10,"
SELECT *
FROM non_detection
WHERE oid IN ('ZTF23abtcveg', 'ZTF23abudlls')
  AND diffmaglim > 19.5
","['\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n']",simple,1.8536944389343264,2025-04-29T12:25:30,"[             oid           mjd  fid  diffmaglim
0   ZTF23abtcveg  60261.308970    1     20.6738
1   ZTF23abtcveg  60284.217674    1     20.3801
2   ZTF23abtcveg  60288.305741    1     20.3407
3   ZTF23abtcveg  60290.242616    1     20.8268
4   ZTF23abtcveg  60353.176007    1     20.2068
5   ZTF23abtcveg  60355.160891    1     20.2367
6   ZTF23abtcveg  60261.247477    2     20.4632
7   ZTF23abtcveg  60263.365301    2     20.3730
8   ZTF23abtcveg  60284.176146    2     20.3800
9   ZTF23abtcveg  60288.196192    2     20.0561
10  ZTF23abudlls  60262.452164    1     20.4759
11  ZTF23abudlls  60287.393542    1     20.3725
12  ZTF23abudlls  60289.381979    1     20.2992
13  ZTF23abudlls  60291.404294    1     20.3800
14  ZTF23abudlls  60340.381539    1     20.2268
15  ZTF23abudlls  60262.492072    2     20.6710
16  ZTF23abudlls  60287.319722    2     20.0691
17  ZTF23abudlls  60291.346690    2     20.1713]",,7.897945404052734,2025-05-21T22:43:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,99,0,"SELECT
    *
FROM
    forced_photometry
WHERE
    oid in
(
SELECT
    object.oid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    firstmjd > 60310
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability = 1
ORDER BY firstmjd
LIMIT 10
)
",,,,,"[              pid           oid           mjd  fid          ra        dec  \
0   2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
1   2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
2   2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
3   2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
4   2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   
..            ...           ...           ...  ...         ...        ...   
64  2530138582415  ZTF24aaaajsp  60284.138588    2  340.820096  46.927049   
65  2534136252415  ZTF24aaaajsp  60288.136250    1  340.820096  46.927049   
66  2534221122415  ZTF24aaaajsp  60288.221123    2  340.820096  46.927049   
67  2536143512415  ZTF24aaaajsp  60290.143519    2  340.820096  46.927049   
68  2536238642415  ZTF24aaaajsp  60290.238646    1  340.820096  46.927049   

    e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  \
0   None  None  100.000000  100.000000  ...   20.395599          1   
1   None  None  100.000000  100.000000  ...   20.335699          1   
2   None  None   24.218550    5.723178  ...   20.183001          1   
3   None  None   21.659468    0.900523  ...   19.729099          1   
4   None  None  100.000000  100.000000  ...   20.528500          1   
..   ...   ...         ...         ...  ...         ...        ...   
64  None  None   23.181665    1.554161  ...   20.576700          1   
65  None  None   24.333900    6.619290  ...   20.122700          1   
66  None  None   23.318583    5.318606  ...   19.507900          1   
67  None  None   22.721621    1.108646  ...   20.472601          1   
68  None  None   21.928862    0.749431  ...   20.289400          1   

    procstatus        distnr          ranr         decnr      magnr  \
0           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
1           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
2            0 -99999.000000 -99999.000000 -99999.000000 -99999.000   
3           56 -99999.000000 -99999.000000 -99999.000000 -99999.000   
4           61 -99999.000000 -99999.000000 -99999.000000 -99999.000   
..         ...           ...           ...           ...        ...   
64           0      4.621940    340.821625     46.927788     17.041   
65           0      4.609645    340.821625     46.927795     17.605   
66           0      4.621940    340.821625     46.927788     17.041   
67           0      4.621940    340.821625     46.927788     17.041   
68           0      4.609645    340.821625     46.927795     17.605   

     sigmagnr      chinr    sharpnr  
0  -99999.000 -99999.000 -99999.000  
1  -99999.000 -99999.000 -99999.000  
2  -99999.000 -99999.000 -99999.000  
3  -99999.000 -99999.000 -99999.000  
4  -99999.000 -99999.000 -99999.000  
..        ...        ...        ...  
64      0.017      0.740     -0.052  
65      0.021      0.903     -0.069  
66      0.017      0.740     -0.052  
67      0.017      0.740     -0.052  
68      0.021      0.903     -0.069  

[69 rows x 42 columns]]",,3.5905585289001465,2025-05-21T22:44:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,99,1,"
-- Retrieve all columns from the 'forced_photometry' table for ZTF objects
-- that have a first detection date later than MJD 60310 and a probability of 1 of being an asteroid
-- in the stamp classifier, ordered by the first detection date and limited to 10 objects.

SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.probability = 1
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,13.485816240310667,2025-04-29T12:25:43,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,9.252956867218018,2025-05-21T22:44:13,0.14492753623188406,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,2,"
-- Query to find at most 10 ZTF objects with specific conditions
SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.probability = 1
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,13.431059122085571,2025-04-29T12:25:57,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,8.721417903900146,2025-05-21T22:44:26,0.14492753623188406,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,3,"
-- Select all columns from the forced_photometry table for objects meeting the specified conditions
SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability = 1
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,17.221472024917603,2025-04-29T12:26:14,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,10.189685821533203,2025-05-21T22:44:40,0.14492753623188406,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,4,"
-- Retrieve all columns from the forced_photometry table for ZTF objects
-- that have a first detection date later than mjd=60310 days
-- and a probability of 1 of being an asteroid in the stamp classifier
-- Limit the results to at most 10 objects, ordered by the first detection date

SELECT fp.*
FROM forced_photometry fp
INNER JOIN object o ON fp.oid = o.oid
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability = 1
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,14.238971948623655,2025-04-29T12:26:28,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,8.029014587402344,2025-05-21T22:44:52,0.14492753623188406,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,5,"
-- Subquery to filter objects with first detection date later than MJD 60310
WITH filtered_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to filter probabilities for asteroids with probability 1 in the stamp classifier
filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the filtered results and retrieve all columns from forced_photometry
SELECT fp.*
FROM filtered_objects fo
INNER JOIN filtered_probabilities fpb ON fo.oid = fpb.oid
INNER JOIN forced_photometry fp ON fo.oid = fp.oid
ORDER BY (SELECT firstmjd FROM object WHERE oid = fo.oid) ASC
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,16.2199387550354,2025-04-29T12:26:45,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to filter objects with first detection date later than MJD 60310
WITH filtered_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to filter probabilities for asteroids with probability 1 in the stamp classifier
filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the filtered results and retrieve all columns from forced_photometry
SELECT fp.*
FROM forced_photometry fp
WHERE fp.oid IN (
    SELECT fo.oid
    FROM filtered_objects fo
    INNER JOIN filtered_probabilities fpb ON fo.oid = fpb.oid
)
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.73073625564575,2025-05-21T22:49:06,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,99,6,"
SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.probability = 1
  AND p.classifier_name = 'stamp_classifier'
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,17.331674814224243,2025-04-29T12:27:03,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,8.034664392471313,2025-05-21T22:49:18,0.14492753623188406,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,7,"
SELECT fp.*
FROM object o
INNER JOIN probability p ON o.oid = p.oid
INNER JOIN forced_photometry fp ON o.oid = fp.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability = 1
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,14.255781412124634,2025-04-29T12:27:18,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,7.802382707595825,2025-05-21T22:49:30,0.14492753623188406,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,8,"
-- Retrieve all columns from the 'forced_photometry' table for ZTF objects
-- that have a first detection date later than MJD 60310 and a probability of 1 of being an asteroid
-- in the 'stamp_classifier', ordered by the first detection date, limited to 10 results.

SELECT fp.*
FROM forced_photometry fp
INNER JOIN object o ON fp.oid = o.oid
INNER JOIN probability p ON o.oid = p.oid
WHERE o.firstmjd > 60310
  AND p.class_name = 'asteroid'
  AND p.classifier_name = 'stamp_classifier'
  AND p.probability = 1
  AND p.ranking = 1
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",medium,18.297711849212646,2025-04-29T12:27:37,"[             pid           oid           mjd  fid          ra        dec  \
0  2533123443815  ZTF24aaaajcx  60287.123449    2  325.590518  77.130726   
1  2533133663815  ZTF24aaaajcx  60287.133669    1  325.590518  77.130726   
2  2535178323815  ZTF24aaaajcx  60289.178322    1  325.590518  77.130726   
3  2537120003815  ZTF24aaaajcx  60291.120000    2  325.590518  77.130726   
4  2537176313815  ZTF24aaaajcx  60291.176319    1  325.590518  77.130726   
5  2530158592915  ZTF24aaaajnz  60284.158600    2  356.638975  47.487980   
6  2530219763015  ZTF24aaaajnz  60284.219768    1  356.638975  47.487980   
7  2534136721615  ZTF24aaaajnz  60288.136724    1  356.638975  47.487980   
8  2534197701615  ZTF24aaaajnz  60288.197708    2  356.638975  47.487980   
9  2536180323015  ZTF24aaaajnz  60290.180324    2  356.638975  47.487980   

   e_ra e_dec         mag       e_mag  ...  diffmaglim  programid  procstatus  \
0  None  None   21.412384    0.511367  ...   19.907400          1           0   
1  None  None   21.872555    0.786584  ...   19.916599          1           0   
2  None  None   22.387310    1.364911  ...   19.880100          1           0   
3  None  None   22.524460    1.329010  ...   20.095900          1           0   
4  None  None   23.913935    5.575612  ...   19.935200          1           0   
5  None  None  100.000000  100.000000  ...   20.395599          1          61   
6  None  None  100.000000  100.000000  ...   20.335699          1          61   
7  None  None   24.218550    5.723178  ...   20.183001          1           0   
8  None  None   21.659468    0.900523  ...   19.729099          1          56   
9  None  None  100.000000  100.000000  ...   20.528500          1          61   

         distnr         ranr         decnr         magnr   sigmagnr     chinr  \
0 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
1      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
2      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
3 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
4      3.010236    325.59024     77.131561     23.011999      0.276      0.55   
5 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
6 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
7 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
8 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   
9 -99999.000000 -99999.00000 -99999.000000 -99999.000000 -99999.000 -99999.00   

     sharpnr  
0 -99999.000  
1     -0.297  
2     -0.297  
3 -99999.000  
4     -0.297  
5 -99999.000  
6 -99999.000  
7 -99999.000  
8 -99999.000  
9 -99999.000  

[10 rows x 42 columns]]",,7.940182685852051,2025-05-21T22:49:41,0.14492753623188406,1.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,99,9,"
-- Subquery to select oids from the object table with firstmjd > 60310
WITH selected_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to select oids from the probability table with the specified conditions
selected_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the results and retrieve all columns from forced_photometry
SELECT fp.*
FROM forced_photometry fp
INNER JOIN (
    SELECT so.oid
    FROM selected_objects so
    INNER JOIN selected_probabilities sp ON so.oid = sp.oid
) filtered_oids ON fp.oid = filtered_oids.oid
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,24.44525146484375,2025-04-29T12:28:01,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to select oids from the object table with firstmjd > 60310
WITH selected_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to select oids from the probability table with the specified conditions
selected_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the results and retrieve all columns from forced_photometry
SELECT fp.*
FROM forced_photometry fp
WHERE fp.oid IN (
    SELECT so.oid
    FROM selected_objects so
    INNER JOIN selected_probabilities sp ON so.oid = sp.oid
)
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.04375195503235,2025-05-21T22:53:56,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,99,10,"
-- Subquery to select oids from the object table with firstmjd > 60310
WITH selected_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to select oids from the probability table with the specified conditions
selected_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the subqueries and retrieve data from forced_photometry
SELECT fp.*
FROM forced_photometry fp
INNER JOIN selected_objects so ON fp.oid = so.oid
INNER JOIN selected_probabilities sp ON fp.oid = sp.oid
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,20.063894748687744,2025-04-29T12:28:22,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to select oids from the object table with firstmjd > 60310
WITH selected_objects AS (
    SELECT oid
    FROM object
    WHERE firstmjd > 60310
),

-- Subquery to select oids from the probability table with the specified conditions
selected_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND probability = 1
      AND ranking = 1
)

-- Final query to join the subqueries and retrieve data from forced_photometry
SELECT fp.*
FROM forced_photometry fp
WHERE fp.oid IN (
    SELECT so.oid
    FROM selected_objects so
    INNER JOIN selected_probabilities sp ON so.oid = sp.oid
)
ORDER BY (SELECT firstmjd FROM object WHERE oid = fp.oid) ASC
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.99804782867432,2025-05-21T22:58:10,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,40,0,"SELECT
    oid_catalog, ra, dec, w1mpro, w2mpro,
    w1sigmpro, w2sigmpro, j_m_2mass, j_msig_2mass
FROM
    allwise
WHERE
    q3c_radial_query(ra, dec, 23.6488, 30.7314, 0.000277778)",,,,,"[           oid_catalog         ra        dec  w1mpro  w2mpro  w1sigmpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842  13.735       0.03   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,22.634246110916138,2025-05-21T22:58:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,1,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.433444738388061,2025-04-29T12:28:25,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,13.707282304763794,2025-05-21T22:58:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,2,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.843703269958496,2025-04-29T12:28:29,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,13.752784967422485,2025-05-21T22:59:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,3,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,4.133241891860962,2025-04-29T12:28:33,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.571550607681274,2025-05-21T22:59:36,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,4,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,2.954166412353516,2025-04-29T12:28:36,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.600502490997314,2025-05-21T22:59:58,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,5,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(dec)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.5436906814575195,2025-04-29T12:28:40,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,14.270626783370972,2025-05-21T23:00:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,6,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.9698987007141113,2025-04-29T12:28:44,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,15.796560287475586,2025-05-21T23:00:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,7,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.217031478881836,2025-04-29T12:28:47,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,13.359092950820923,2025-05-21T23:01:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,8,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.478934526443481,2025-04-29T12:28:51,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,13.975961685180664,2025-05-21T23:01:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,9,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(dec)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.446058988571167,2025-04-29T12:28:54,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,13.994326829910278,2025-05-21T23:01:42,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,40,10,"
SELECT 
    oid_catalog, 
    ra, 
    dec, 
    w1mpro, 
    w1sigmpro, 
    w2mpro, 
    w2sigmpro, 
    j_m_2mass, 
    j_msig_2mass
FROM 
    allwise
WHERE 
    SQRT(POWER((ra - 23.6488) * COS(RADIANS(30.7314)), 2) + POWER((dec - 30.7314), 2)) * 3600 <= 1
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",simple,3.094377040863037,2025-04-29T12:28:58,"[           oid_catalog         ra        dec  w1mpro  w1sigmpro  w2mpro  \
0  J013435.71+304352.7  23.648805  30.731309  13.842       0.03  13.735   

   w2sigmpro  j_m_2mass  j_msig_2mass  
0      0.038     15.552         0.051  ]",,13.504965543746948,2025-05-21T23:02:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,80,0,"SELECT
    *
FROM
    xmatch
WHERE
    oid IN ('ZTF22abcmmkz','ZTF18abbufof')
    AND dist < 0.5",,,,,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,3.268252372741699,2025-05-21T23:02:05,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,1,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.1769816875457764,2025-04-29T12:29:00,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.40162467956543,2025-05-21T23:02:17,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,2,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.942670583724976,2025-04-29T12:29:03,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.756668567657471,2025-05-21T23:02:28,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,3,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.24397087097168,2025-04-29T12:29:05,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.7100629806518555,2025-05-21T23:02:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,4,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,1.8834493160247805,2025-04-29T12:29:07,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.727263450622559,2025-05-21T23:02:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,5,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.657191753387451,2025-04-29T12:29:11,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.597611427307129,2025-05-21T23:03:02,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,6,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.158827543258667,2025-04-29T12:29:13,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.398900032043457,2025-05-21T23:03:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,7,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.408405065536499,2025-04-29T12:29:15,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.479069232940674,2025-05-21T23:03:24,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,8,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
  AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.1392173767089844,2025-04-29T12:29:18,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.748812198638916,2025-05-21T23:03:36,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,9,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.2119715213775635,2025-04-29T12:29:20,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.585485458374023,2025-05-21T23:03:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,80,10,"
SELECT *
FROM xmatch
WHERE oid IN ('ZTF22abcmmkz', 'ZTF18abbufof')
AND dist < 0.5
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.608182668685913,2025-04-29T12:29:23,"[            oid    catid           oid_catalog      dist class_catalog period
0  ZTF18abbufof  allwise  3398p348_ac51-035739  0.264541          None   None]",,7.755979061126709,2025-05-21T23:04:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,45,0,"SELECT
    COUNT(chipsf)
FROM
    dataquality
WHERE
    oid IN ('ZTF23abjikaf','ZTF20achlced')
    AND chipsf >= 5",,,,,"[   count
0     81]",,3.393967628479004,2025-05-21T23:04:04,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,1,"
-- Count the number of rows in the dataquality table for specific ZTF object identifiers
-- where the reduced chi-square value (chipsf) is at least 5
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.67042875289917,2025-04-29T12:29:34,"[   count
0     81]",,7.7136101722717285,2025-05-21T23:04:16,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,2,"
SELECT COUNT(*)
FROM dataquality
WHERE chipsf >= 5
AND oid IN ('ZTF23abjikaf', 'ZTF20achlced')
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.762644529342651,2025-04-29T12:29:47,"[   count
0     81]",,7.676800489425659,2025-05-21T23:04:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,3,"
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.412947177886965,2025-04-29T12:29:58,"[   count
0     81]",,7.637919902801514,2025-05-21T23:04:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,4,"
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,10.545251846313477,2025-04-29T12:30:08,"[   count
0     81]",,7.59580397605896,2025-05-21T23:04:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,5,"
SELECT COUNT(*) 
FROM dataquality 
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced') 
AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.893950462341309,2025-04-29T12:30:21,"[   count
0     81]",,7.565453290939331,2025-05-21T23:05:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,6,"
-- Count the number of rows in the dataquality table where the reduced chi-square (chipsf) is at least 5
-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'
SELECT COUNT(*)
FROM dataquality
WHERE chipsf >= 5
AND oid IN ('ZTF23abjikaf', 'ZTF20achlced')
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.434345245361328,2025-04-29T12:30:33,"[   count
0     81]",,7.780763149261475,2025-05-21T23:05:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,7,"
-- Count the number of rows in the dataquality table where the reduced chi-square value (chipsf) is at least 5
-- for objects with ZTF identifiers 'ZTF23abjikaf' and 'ZTF20achlced'
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.97732663154602,2025-04-29T12:30:45,"[   count
0     81]",,7.622300386428833,2025-05-21T23:05:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,8,"
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,9.72496509552002,2025-04-29T12:30:54,"[   count
0     81]",,7.442353248596191,2025-05-21T23:05:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,9,"
-- Count the number of rows in the dataquality table for specific objects with a minimum reduced chi-square value of 5
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,11.233624696731567,2025-04-29T12:31:06,"[   count
0     81]",,8.28438687324524,2025-05-21T23:05:45,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,45,10,"
-- Count the number of rows in the 'dataquality' table for specific objects with a minimum reduced chi-square value of 5
SELECT COUNT(*)
FROM dataquality
WHERE oid IN ('ZTF23abjikaf', 'ZTF20achlced')
  AND chipsf >= 5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",medium,12.806450843811035,2025-04-29T12:31:19,"[   count
0     81]",,7.904119253158569,2025-05-21T23:05:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,63,0,"SELECT
    *
FROM
    probability
WHERE
    oid IN ('ZTF21aaobkmg','ZTF21aaomuka')
    AND classifier_name = 'lc_classifier'
    AND ranking <= 2
ORDER BY ranking",,,,,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,3.2452921867370605,2025-05-21T23:06:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,1,"
SELECT *
FROM probability
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')
  AND classifier_name = 'lc_classifier'
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.568111181259156,2025-04-29T12:31:21,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.81075119972229,2025-05-21T23:06:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,2,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.2544596195220947,2025-04-29T12:31:23,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.928449630737305,2025-05-21T23:06:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,3,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.301586866378784,2025-04-29T12:31:26,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.758486986160278,2025-05-21T23:06:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,4,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.841839551925659,2025-04-29T12:31:31,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.693533420562744,2025-05-21T23:06:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,5,"
SELECT *
FROM probability
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')
  AND classifier_name = 'lc_classifier'
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,4.605892181396484,2025-04-29T12:31:35,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.687572002410889,2025-05-21T23:06:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,6,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.664682149887085,2025-04-29T12:31:38,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.897541761398315,2025-05-21T23:07:08,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,7,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.808694362640381,2025-04-29T12:31:41,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.867645740509033,2025-05-21T23:07:20,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,8,"
SELECT * 
FROM probability 
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka') 
  AND classifier_name = 'lc_classifier' 
  AND ranking IN (1, 2) 
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.2322256565093994,2025-04-29T12:31:43,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.987295389175415,2025-05-21T23:07:31,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,9,"
SELECT *
FROM probability
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')
  AND classifier_name = 'lc_classifier'
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.2144694328308105,2025-04-29T12:31:46,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.666032552719116,2025-05-21T23:07:42,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,63,10,"
SELECT *
FROM probability
WHERE oid IN ('ZTF21aaobkmg', 'ZTF21aaomuka')
  AND classifier_name = 'lc_classifier'
  AND ranking IN (1, 2)
ORDER BY ranking
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",simple,2.4753777980804443,2025-04-29T12:31:48,"[            oid classifier_name     classifier_version class_name  \
0  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SNII   
1  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0       SNIa   
2  ZTF21aaobkmg   lc_classifier  hierarchical_rf_1.1.0       SLSN   
3  ZTF21aaomuka   lc_classifier  hierarchical_rf_1.1.0      SNIbc   

   probability  ranking  
0        0.584        1  
1        0.460        1  
2        0.256        2  
3        0.298        2  ]",,7.801453590393066,2025-05-21T23:07:54,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,73,0,"SELECT
    oid, ssnamenr, ssmagnr
FROM
    ss_ztf
WHERE
    oid = 'ZTF21acitntz'
",,,,,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,3.267141819000244,2025-05-21T23:07:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,1,"
SELECT object.oid, ss_ztf.ssnamenr, ss_ztf.ssmagnr
FROM object
INNER JOIN ss_ztf ON object.oid = ss_ztf.oid
WHERE object.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,12.515936851501465,2025-04-29T12:32:01,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,7.835530519485474,2025-05-21T23:08:09,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,2,"
-- Query to find the MPC name and MPC magnitude of the nearest known Solar System object for the ZTF object 'ZTF21acitntz'
SELECT 
    o.oid, 
    s.ssnamenr AS mpc_name, 
    s.ssmagnr AS mpc_magnitude
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,13.836305379867554,2025-04-29T12:32:15,"[            oid mpc_name  mpc_magnitude
0  ZTF21acitntz    17427           18.6]",,7.904873847961426,2025-05-21T23:08:20,1.0,1.0,0.3333333333333333,0.3333333333333333,1.0,0.0
0.16.3,gpt-4o,v1,73,3,"
-- Query to find the MPC name and MPC magnitude of the nearest known Solar System object for the ZTF object 'ZTF21acitntz'
SELECT 
    o.oid, 
    s.ssnamenr, 
    s.ssmagnr
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,11.324328422546388,2025-04-29T12:32:26,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,8.415064096450806,2025-05-21T23:08:32,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,4,"
SELECT 
    ss_ztf.oid, 
    ss_ztf.ssnamenr, 
    ss_ztf.ssmagnr
FROM 
    ss_ztf
WHERE 
    ss_ztf.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,10.922685146331789,2025-04-29T12:32:37,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,8.044606685638428,2025-05-21T23:08:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,5,"
SELECT 
    ss.oid AS ztf_object_identifier, 
    ss.ssnamenr AS mpc_name, 
    ss.ssmagnr AS mpc_magnitude
FROM 
    ss_ztf ss
WHERE 
    ss.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,5.457814931869507,2025-04-29T12:32:42,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,8.683836936950684,2025-05-21T23:08:56,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,73,6,"
-- Query to find the MPC name and MPC magnitude of the nearest known Solar System object for the ZTF object 'ZTF21acitntz'
SELECT 
    o.oid, 
    s.ssnamenr AS mpc_name, 
    s.ssmagnr AS mpc_magnitude
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,13.94395637512207,2025-04-29T12:32:56,"[            oid mpc_name  mpc_magnitude
0  ZTF21acitntz    17427           18.6]",,8.275266170501709,2025-05-21T23:09:08,1.0,1.0,0.3333333333333333,0.3333333333333333,1.0,0.0
0.16.3,gpt-4o,v1,73,7,"
SELECT 
    ss.oid, 
    ss.ssnamenr AS mpc_name, 
    ss.ssmagnr AS mpc_magnitude
FROM 
    ss_ztf ss
WHERE 
    ss.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,12.970305681228638,2025-04-29T12:33:09,"[            oid mpc_name  mpc_magnitude
0  ZTF21acitntz    17427           18.6]",,7.802046775817871,2025-05-21T23:09:19,1.0,1.0,0.3333333333333333,0.3333333333333333,1.0,0.0
0.16.3,gpt-4o,v1,73,8,"
-- Query to find the MPC name and MPC magnitude of the nearest known Solar System object for the ZTF object 'ZTF21acitntz'
SELECT 
    o.oid,          -- ZTF object identifier
    s.ssnamenr,     -- MPC name of the nearest known Solar System object
    s.ssmagnr       -- MPC magnitude of the nearest known Solar System object
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'  -- Filter for the specific ZTF object
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,24.985079526901245,2025-04-29T12:33:35,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,8.249879360198975,2025-05-21T23:09:31,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,9,"
-- Query to retrieve the ZTF object identifier, MPC name, and MPC magnitude for the nearest known Solar System object
SELECT 
    o.oid,          -- ZTF object identifier
    s.ssnamenr,     -- MPC name of the nearest known Solar System object
    s.ssmagnr       -- MPC magnitude of the nearest known Solar System object
FROM 
    object o
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.oid = 'ZTF21acitntz'  -- Filter for the specific ZTF object
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",medium,13.362083673477173,2025-04-29T12:33:48,"[            oid ssnamenr  ssmagnr
0  ZTF21acitntz    17427     18.6]",,9.754342555999756,2025-05-21T23:09:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,73,10,"
SELECT 
    ss_ztf.oid AS ztf_object_identifier, 
    ss_ztf.ssnamenr AS mpc_name, 
    ss_ztf.ssmagnr AS mpc_magnitude
FROM 
    ss_ztf
WHERE 
    ss_ztf.oid = 'ZTF21acitntz'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",simple,3.229830503463745,2025-04-29T12:33:51,"[  ztf_object_identifier mpc_name  mpc_magnitude
0          ZTF21acitntz    17427           18.6]",,8.165801286697388,2025-05-21T23:09:56,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,,,92,0,"SELECT
    oid, classifier_version, class_name, probability
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking = 1
    AND oid in
(
SELECT
    oid
FROM
    magstat
WHERE
    fid = 1
    AND ndet >= 10
    AND ndubious = 0
ORDER BY oid
LIMIT 500
)
",,,,,"[              oid     classifier_version      class_name  probability
0    ZTF17aaaaaxb  hierarchical_rf_1.1.0  Periodic-Other     0.402136
1    ZTF17aaaaaxb   lc_classifier_1.1.13  Periodic-Other     0.384480
2    ZTF17aaaadiz  hierarchical_rf_1.1.0               E     0.282672
3    ZTF17aaaadiz   lc_classifier_1.1.13  Periodic-Other     0.258560
4    ZTF17aaaadyg  hierarchical_rf_1.1.0  Periodic-Other     0.553136
..            ...                    ...             ...          ...
915  ZTF17aaaaaas   lc_classifier_1.1.13  Periodic-Other     0.260952
916  ZTF17aaaaegw  hierarchical_rf_1.1.0             YSO     0.717024
917  ZTF17aaaaegw   lc_classifier_1.1.13             YSO     0.611064
918  ZTF17aaaabel  hierarchical_rf_1.1.0               E     0.371840
919  ZTF17aaaabel   lc_classifier_1.1.13  Periodic-Other     0.440128

[920 rows x 4 columns]]",,4.101135015487671,2025-05-21T23:10:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,92,1,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 entries
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,18.554712772369385,2025-04-29T12:34:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final query combining the sub-queries
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the sub-query for detections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the sub-query for probabilities
INNER JOIN (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
) p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 entries
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",256.3936975002289,2025-05-21T23:14:20,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,2,"
-- Select the required columns from the object and probability tables
SELECT 
    object.oid AS ""ZTF identifier"", 
    probability.classifier_version, 
    probability.class_name, 
    probability.probability
FROM 
    object
-- Join with the detection table to filter based on g band detections and dubious corrections
INNER JOIN (
    SELECT oid
    FROM detection
    WHERE fid = 1 -- g band
    AND dubious = FALSE
    GROUP BY oid
    HAVING COUNT(*) >= 10
) AS valid_detections ON object.oid = valid_detections.oid
-- Join with the probability table to get classification information
INNER JOIN probability ON object.oid = probability.oid
WHERE 
    probability.ranking = 1 -- Only include probabilities with ranking 1
    AND probability.classifier_name = 'lc_classifier'
ORDER BY 
    object.oid
LIMIT 500 -- Limit the results to at most 500 entries
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,18.46792721748352,2025-04-29T12:34:28,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final query combining the sub-queries with the object table
SELECT 
    object.oid AS ""ZTF identifier"", 
    prob.classifier_version, 
    prob.class_name, 
    prob.probability
FROM 
    object
-- Join with the sub-query for valid detections
INNER JOIN (
    SELECT oid
    FROM detection
    WHERE fid = 1 -- g band
    AND dubious = FALSE
    GROUP BY oid
    HAVING COUNT(*) >= 10
) AS valid_detections ON object.oid = valid_detections.oid
-- Join with the sub-query for probabilities
INNER JOIN (
    SELECT oid, classifier_version, class_name, probability
    FROM probability
    WHERE ranking = 1
    AND classifier_name = 'lc_classifier'
) AS prob ON object.oid = prob.oid
ORDER BY 
    object.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.53816151618958,2025-05-21T23:18:35,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,3,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.555657625198364,2025-04-29T12:34:46,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
)

-- Main query to select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the filtered detections sub-query
INNER JOIN filtered_detections d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
) p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.59717464447021,2025-05-21T23:22:49,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,4,"
-- Select the required columns from the probability table
SELECT 
    p.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    -- Join the probability table with the object and detection tables
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    (
        -- Subquery to filter detections in the g band with no dubious corrections
        SELECT 
            oid
        FROM 
            detection
        WHERE 
            fid = 1 -- g band
            AND dubious = FALSE
        GROUP BY 
            oid
        HAVING 
            COUNT(*) >= 10 -- At least 10 detections
    ) d ON o.oid = d.oid
WHERE 
    -- Apply default conditions for the probability table
    p.ranking = 1
    AND p.classifier_name = 'lc_classifier'
ORDER BY 
    o.oid
LIMIT 500
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.75227999687195,2025-04-29T12:35:04,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final query to join the filtered detections and probabilities with the object table
SELECT 
    p.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN 
    (SELECT 
        oid
     FROM 
        detection
     WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
     GROUP BY 
        oid
     HAVING 
        COUNT(*) >= 10 -- At least 10 detections
    ) d ON o.oid = d.oid
INNER JOIN 
    (SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
     FROM 
        probability
     WHERE 
        ranking = 1
        AND classifier_name = 'lc_classifier'
    ) p ON o.oid = p.oid
ORDER BY 
    o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.26998829841614,2025-05-21T23:27:03,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,5,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,15.064086437225342,2025-04-29T12:35:19,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
),
-- Sub-query to get classification details with ranking 1 for the light curve classifier
filtered_probabilities AS (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Main query to join the filtered results
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN filtered_detections d ON o.oid = d.oid
INNER JOIN filtered_probabilities p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.40212225914001,2025-05-21T23:31:16,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,6,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification probabilities
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,15.981138467788696,2025-04-29T12:35:35,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
),
-- Sub-query to get the most likely classification probabilities
filtered_probabilities AS (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Main query to select the required columns from the object and filtered probabilities
SELECT 
    o.oid AS ""ZTF identifier"", 
    fp.classifier_version, 
    fp.class_name, 
    fp.probability
FROM 
    object o
-- Join with the filtered detections to ensure the conditions are met
INNER JOIN filtered_detections fd ON o.oid = fd.oid
-- Join with the filtered probabilities to get classification probabilities
INNER JOIN filtered_probabilities fp ON o.oid = fp.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.38739275932312,2025-05-21T23:35:30,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,7,"
-- Subquery to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_objects AS (
    SELECT oid
    FROM detection
    WHERE fid = 1 -- g band
      AND dubious = FALSE
    GROUP BY oid
    HAVING COUNT(*) >= 10
)

-- Main query to select required information
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
JOIN 
    filtered_objects fo ON o.oid = fo.oid
JOIN 
    probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid
LIMIT 500
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.928287267684937,2025-04-29T12:35:53,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Subquery to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_objects AS (
    SELECT oid
    FROM detection
    WHERE fid = 1 -- g band
      AND dubious = FALSE
    GROUP BY oid
    HAVING COUNT(*) >= 10
),

-- Subquery to filter probabilities with ranking 1 and light curve classifier
filtered_probabilities AS (
    SELECT oid, classifier_version, class_name, probability
    FROM probability
    WHERE ranking = 1
      AND classifier_name = 'lc_classifier'
)

-- Main query to select required information
SELECT 
    o.oid AS ""ZTF identifier"", 
    fp.classifier_version, 
    fp.class_name, 
    fp.probability
FROM 
    object o
JOIN 
    filtered_objects fo ON o.oid = fo.oid
JOIN 
    filtered_probabilities fp ON o.oid = fp.oid
ORDER BY 
    o.oid
LIMIT 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",248.71196174621582,2025-05-21T23:39:43,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,8,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get the classifier version, class name, and probability
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid
LIMIT 500 -- Limit the results to 500
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,22.5619695186615,2025-04-29T12:36:16,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
)

-- Main query to select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the filtered detections sub-query
INNER JOIN filtered_detections d ON o.oid = d.oid
-- Join with the probability table to get the classifier version, class name, and probability
INNER JOIN (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
) p ON o.oid = p.oid
ORDER BY 
    o.oid
LIMIT 500 -- Limit the results to 500
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.60582065582275,2025-05-21T23:43:57,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,9,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,19.27679324150085,2025-04-29T12:36:35,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter objects with at least 10 detections in the g band and no dubious corrections
WITH filtered_detections AS (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
),
-- Sub-query to get classification details with ranking 1 for the light curve classifier
filtered_probabilities AS (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
)
-- Main query to join the filtered results and limit the output
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
INNER JOIN filtered_detections d ON o.oid = d.oid
INNER JOIN filtered_probabilities p ON o.oid = p.oid
ORDER BY 
    o.oid -- Order by ZTF identifier
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.48855876922607,2025-05-21T23:48:11,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,92,10,"
-- Select the required columns from the object and probability tables
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the detection table to filter objects with at least 10 detections in the g band and no dubious corrections
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the probability table to get classification details
INNER JOIN probability p ON o.oid = p.oid
WHERE 
    p.ranking = 1 -- Only include probabilities with ranking 1
    AND p.classifier_name = 'lc_classifier' -- Light curve classifier
ORDER BY 
    o.oid
LIMIT 500 -- Limit the results to at most 500 objects
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",medium,17.55406904220581,2025-04-29T12:36:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Final query combining the sub-queries
SELECT 
    o.oid AS ""ZTF identifier"", 
    p.classifier_version, 
    p.class_name, 
    p.probability
FROM 
    object o
-- Join with the filtered detections sub-query
INNER JOIN (
    SELECT 
        oid
    FROM 
        detection
    WHERE 
        fid = 1 -- g band
        AND dubious = FALSE
    GROUP BY 
        oid
    HAVING 
        COUNT(*) >= 10
) d ON o.oid = d.oid
-- Join with the filtered probabilities sub-query
INNER JOIN (
    SELECT 
        oid, 
        classifier_version, 
        class_name, 
        probability
    FROM 
        probability
    WHERE 
        ranking = 1 -- Only include probabilities with ranking 1
        AND classifier_name = 'lc_classifier' -- Light curve classifier
) p ON o.oid = p.oid
ORDER BY 
    o.oid
LIMIT 500 -- Limit the results to at most 500 objects
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",250.08674216270447,2025-05-21T23:52:25,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,102,0,"SELECT
    *
FROM
    magstat
WHERE
    oid IN
(
SELECT
    probability.oid
FROM
    probability INNER JOIN
    xmatch
    ON probability.oid = xmatch.oid
    INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    w1mpro > 12
    AND w1mpro < 13
    AND classifier_name = 'lc_classifier'
    AND class_name = 'AGN'
    AND probability > 0.6
LIMIT 50
)",,,,,"[              oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0    ZTF18acnnxyp    1    False       True   220         0         NaN   
1    ZTF18acnnxyp    2    False       True   187         0         NaN   
2    ZTF19aaslszp    1    False       True    14         0         NaN   
3    ZTF19aaslszp    2    False       True    38         0         NaN   
4    ZTF19accprws    1    False       True   100         0         NaN   
..            ...  ...      ...        ...   ...       ...         ...   
103  ZTF18abtmeds    2    False       True   236         1         NaN   
104  ZTF18acbycof    1     True       True     6         0         NaN   
105  ZTF18acbycof    2     True       True    10         0         NaN   
106  ZTF19acbuwdb    1    False       True    34         2         NaN   
107  ZTF19acbuwdb    2    False       True    55         2         NaN   

     dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0         NaN            NaN       NaN  ...       16.470194    16.636536   
1         NaN            NaN       NaN  ...       16.283157    16.750060   
2         NaN            NaN       NaN  ...       18.339777    18.424961   
3         NaN            NaN       NaN  ...       17.458006    17.704653   
4         NaN            NaN       NaN  ...       17.323280    17.430521   
..        ...            ...       ...  ...             ...          ...   
103       NaN            NaN       NaN  ...       16.518640    16.809933   
104       NaN            NaN       NaN  ...       17.237503    17.254923   
105       NaN            NaN       NaN  ...       16.987440    17.048979   
106       NaN            NaN       NaN  ...       17.277626    17.629467   
107       NaN            NaN       NaN  ...       16.736994    16.936043   

     magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0      16.110912       0.084070     16.525469      16.636536  58450.504   
1      16.046688       0.075749     16.228830      16.425951  58438.523   
2      18.263086       0.045689     18.313805      18.424961  60120.430   
3      17.340534       0.096294     17.387550      17.511440  58627.406   
4      16.601112       0.097823     17.425760      17.407330  58760.336   
..           ...            ...           ...            ...        ...   
103    16.114622       0.146693     16.563980      16.188840  58425.230   
104    17.131426            NaN     17.234760      17.244194  58397.360   
105    16.947750            NaN     17.048979      17.007450  58423.310   
106    17.136470       0.114029     17.136470      17.192860  58850.426   
107    16.610060       0.084905     16.610060      16.637360  58833.380   

       lastmjd        step_id_corr  saturation_rate  
0    60734.402              27.4.0              0.0  
1    60687.350              27.4.0              0.0  
2    60651.098              26.0.0              0.0  
3    60651.120              26.0.0              0.0  
4    60674.094              26.2.0              0.0  
..         ...                 ...              ...  
103  60706.164              27.3.0              0.0  
104  58514.176  bulk_version_0.0.1              0.0  
105  58493.113  bulk_version_0.0.1              0.0  
106  60699.363              27.4.0              0.0  
107  60710.290              27.4.0              0.0  

[108 rows x 28 columns]]",,6.18362832069397,2025-05-21T23:52:32,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,102,1,"
-- Retrieve all columns from the magstat table for ZTF objects that meet the specified conditions
SELECT magstat.*
FROM probability
INNER JOIN allwise ON probability.oid = allwise.oid_catalog
INNER JOIN magstat ON probability.oid = magstat.oid
WHERE probability.class_name = 'AGN'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
  AND probability.probability > 0.6
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,14.472545623779297,2025-04-29T12:37:07,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,19.518019676208496,2025-05-21T23:52:55,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,2,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,17.43251872062683,2025-04-29T12:37:25,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,7.97117280960083,2025-05-21T23:53:07,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,3,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,13.447794198989868,2025-04-29T12:37:38,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,8.095151424407959,2025-05-21T23:53:19,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,4,"
-- Retrieve all columns from the magstat table for ZTF objects that meet the specified conditions
SELECT magstat.*
FROM magstat
INNER JOIN (
    -- Subquery to filter probability table for AGN classification with probability > 0.6
    SELECT oid
    FROM probability
    WHERE class_name = 'AGN'
      AND probability > 0.6
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
) AS prob_filtered ON magstat.oid = prob_filtered.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,14.706976652145386,2025-04-29T12:37:53,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.601306438446045,2025-05-21T23:53:33,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,5,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,11.973395109176636,2025-04-29T12:38:05,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,8.054066896438599,2025-05-21T23:53:46,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,6,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid_catalog
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,11.554211378097534,2025-04-29T12:38:16,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,8.67775011062622,2025-05-21T23:53:58,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,7,"
SELECT magstat.*
FROM magstat
INNER JOIN (
    SELECT probability.oid
    FROM probability
    INNER JOIN allwise ON probability.oid = allwise.oid_catalog
    WHERE probability.class_name = 'AGN'
      AND probability.classifier_name = 'lc_classifier'
      AND probability.ranking = 1
      AND probability.probability > 0.6
      AND allwise.w1mpro BETWEEN 12 AND 13
) AS filtered_objects ON magstat.oid = filtered_objects.oid
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,12.917136669158936,2025-04-29T12:38:29,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,8.467170715332031,2025-05-21T23:54:11,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,8,"
SELECT magstat.*
FROM probability
INNER JOIN allwise ON probability.oid = allwise.oid_catalog
INNER JOIN magstat ON probability.oid = magstat.oid
WHERE probability.class_name = 'AGN'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.ranking = 1
  AND probability.probability > 0.6
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,11.741945743560793,2025-04-29T12:38:41,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,8.402029275894165,2025-05-21T23:54:23,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,9,"
-- Retrieve all columns from the magstat table for ZTF objects that meet the specified conditions
SELECT magstat.*
FROM probability
INNER JOIN allwise ON probability.oid = allwise.oid_catalog
INNER JOIN magstat ON probability.oid = magstat.oid
WHERE probability.class_name = 'AGN'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND probability.classifier_name = 'lc_classifier'
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,13.174476623535156,2025-04-29T12:38:54,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,8.563198566436768,2025-05-21T23:54:36,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,102,10,"
SELECT magstat.*
FROM magstat
INNER JOIN probability ON magstat.oid = probability.oid
INNER JOIN allwise ON magstat.oid = allwise.oid
WHERE probability.class_name = 'AGN'
  AND probability.classifier_name = 'lc_classifier'
  AND probability.probability > 0.6
  AND probability.ranking = 1
  AND allwise.w1mpro BETWEEN 12 AND 13
LIMIT 50
","['CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",medium,29.123444080352783,2025-04-29T12:39:24,"[Empty DataFrame
Columns: [oid, fid, stellar, corrected, ndet, ndubious, dmdt_first, dm_first, sigmadm_first, dt_first, magmean, magmedian, magmax, magmin, magsigma, maglast, magfirst, magmean_corr, magmedian_corr, magmax_corr, magmin_corr, magsigma_corr, maglast_corr, magfirst_corr, firstmjd, lastmjd, step_id_corr, saturation_rate]
Index: []

[0 rows x 28 columns]]",,9.693214178085327,2025-05-21T23:54:49,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,81,0,"SELECT
    oid, dist
FROM
    xmatch
WHERE
    oid_catalog = 'J163603.54-065228.7'",,,,,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,3.266279935836792,2025-05-21T23:54:52,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,1,"
SELECT xmatch.oid, xmatch.dist
FROM xmatch
INNER JOIN allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE allwise.oid_catalog = 'J163603.54-065228.7'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,10.37748408317566,2025-04-29T12:39:34,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,7.7326929569244385,2025-05-21T23:55:04,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,2,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,11.360469341278076,2025-04-29T12:39:45,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,7.727287530899048,2025-05-21T23:55:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,3,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Specific object in the ALLWISE catalog
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,13.342161893844604,2025-04-29T12:39:59,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,8.969077110290527,2025-05-21T23:55:28,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,4,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    xmatch.oid_catalog = 'J163603.54-065228.7' 
    AND xmatch.catid = 'ALLWISE'  -- Ensure the catalog is ALLWISE
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.300841331481934,2025-04-29T12:40:11,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,9.146608352661133,2025-05-21T23:55:41,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,5,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.6146559715271,2025-04-29T12:40:24,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,7.63282585144043,2025-05-21T23:55:52,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,6,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,10.859402894973757,2025-04-29T12:40:35,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,7.806743144989014,2025-05-21T23:56:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,7,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,11.808361530303957,2025-04-29T12:40:47,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,7.846718788146973,2025-05-21T23:56:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,8,"
SELECT x.oid, x.dist
FROM xmatch x
INNER JOIN allwise a ON x.oid_catalog = a.oid_catalog
WHERE x.oid_catalog = 'J163603.54-065228.7'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.279777526855469,2025-04-29T12:40:59,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,7.707159996032715,2025-05-21T23:56:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,81,9,"
SELECT x.oid, x.dist
FROM xmatch x
INNER JOIN allwise a ON x.oid_catalog = a.oid_catalog
WHERE a.oid_catalog = 'J163603.54-065228.7'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,11.896523237228394,2025-04-29T12:41:11,"[Empty DataFrame
Columns: [oid, dist]
Index: []]",,8.533414840698242,2025-05-21T23:56:38,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,81,10,"
SELECT 
    xmatch.oid,  -- ZTF object identifier
    xmatch.dist  -- Distance from its catalog counterpart
FROM 
    xmatch
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    allwise.oid_catalog = 'J163603.54-065228.7'  -- Filter for the specific ALLWISE catalog identifier
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.37247920036316,2025-04-29T12:41:26,"[            oid      dist
0  ZTF21abbrgtf  0.500686]",,7.775319814682007,2025-05-21T23:56:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,69,0,"SELECT
    *
FROM
    ps1_ztf
WHERE
    oid IN ('ZTF21abstkhj','ZTF22aacqjeb','ZTF21aamwpdf')
    AND sgscore1 < 0.2",,,,,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,3.2175421714782715,2025-05-21T23:56:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,1,"
SELECT *
FROM ps1_ztf
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf')
  AND sgscore1 < 0.2
","['CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.9020817279815674,2025-04-29T12:41:29,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.512183904647827,2025-05-21T23:57:04,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,2,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.706266164779663,2025-04-29T12:41:32,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.599591255187988,2025-05-21T23:57:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,3,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.955204486846924,2025-04-29T12:41:35,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.460286855697632,2025-05-21T23:57:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,4,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.755599021911621,2025-04-29T12:41:38,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,8.141558170318604,2025-05-21T23:57:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,5,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.7846031188964844,2025-04-29T12:41:41,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.634747505187988,2025-05-21T23:57:49,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,6,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.4305574893951416,2025-04-29T12:41:43,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.79947829246521,2025-05-21T23:58:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,7,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.4075019359588623,2025-04-29T12:41:46,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.610715866088867,2025-05-21T23:58:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,8,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.7553837299346924,2025-04-29T12:41:49,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.904936075210571,2025-05-21T23:58:25,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,9,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.5588979721069336,2025-04-29T12:41:51,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.665618658065796,2025-05-21T23:58:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,69,10,"
SELECT * 
FROM ps1_ztf 
WHERE oid IN ('ZTF21abstkhj', 'ZTF22aacqjeb', 'ZTF21aamwpdf') 
AND sgscore1 < 0.2
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",simple,2.4319491386413574,2025-04-29T12:41:54,"[            oid               candid         objectidps1   sgmag1   srmag1  \
0  ZTF21abstkhj  1684349673915015107  157473481124645500  16.9345  16.0276   
1  ZTF22aacqjeb  1886297531515015012   83461337558428560  18.4601  17.9604   

    simag1   szmag1  sgscore1  distpsnr1         objectidps2  ...   sgmag3  \
0  15.9801  15.6985  0.163065   0.650434  157473481124194460  ... -999.000   
1  17.7242  17.3151  0.046250   2.060955   83461337536007620  ...   20.905   

    srmag3   simag3   szmag3  sgscore3  distpsnr3  nmtchps  unique1  unique2  \
0  19.2237  18.4609  17.9329  0.256286   5.943302       12     True     True   
1  19.9740  18.3732  17.6284  0.988167   8.479204       10     True     True   

   unique3  
0     True  
1     True  

[2 rows x 27 columns]]",,7.47450065612793,2025-05-21T23:58:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,61,0,"SELECT
    *
FROM
    magstat
WHERE
    ndet >= 10
    AND magmedian > 19
    AND maglast < 17
ORDER BY oid
LIMIT 30
",,,,,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,132.91077375411987,2025-05-22T00:01:04,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,1,"
SELECT * 
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,5.152464389801025,2025-04-29T12:41:59,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,10.783207654953003,2025-05-22T00:01:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,2,"
SELECT * 
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.472766160964966,2025-04-29T12:42:02,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,9.41451644897461,2025-05-22T00:01:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,3,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.4967682361602783,2025-04-29T12:42:04,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,9.904279947280884,2025-05-22T00:01:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,4,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,6.220038652420044,2025-04-29T12:42:10,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,9.554828643798828,2025-05-22T00:02:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,5,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.472074508666992,2025-04-29T12:42:13,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,9.856072902679443,2025-05-22T00:02:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,6,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,5.027093410491943,2025-04-29T12:42:18,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,10.994611978530884,2025-05-22T00:02:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,7,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,4.0302488803863525,2025-04-29T12:42:22,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,9.979045152664185,2025-05-22T00:02:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,8,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.72204327583313,2025-04-29T12:42:25,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,9.937458515167236,2025-05-22T00:03:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,9,"
SELECT * 
FROM magstat 
WHERE ndet >= 10 
  AND magmedian > 19 
  AND maglast < 17 
ORDER BY oid 
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.409656047821045,2025-04-29T12:42:27,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,9.454332828521729,2025-05-22T00:03:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,61,10,"
SELECT *
FROM magstat
WHERE ndet >= 10
  AND magmedian > 19
  AND maglast < 17
ORDER BY oid
LIMIT 30
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.736592531204224,2025-04-29T12:42:30,"[             oid  fid  stellar  corrected  ndet  ndubious  dmdt_first  \
0   ZTF17aaaazob    1    False       True   595         0         NaN   
1   ZTF17aaadaqj    1    False       True   109         2         NaN   
2   ZTF17aaagzbe    1    False       True    44         0         NaN   
3   ZTF17aaahyqe    1    False       True   142         0         NaN   
4   ZTF17aaaihhg    1    False       True    12         0         NaN   
5   ZTF17aaakimh    2    False       True    31         0         NaN   
6   ZTF17aaakkku    1    False       True    12         0         NaN   
7   ZTF17aaaskut    1    False       True    32         0   -0.324131   
8   ZTF17aaastit    1    False       True   113         0         NaN   
9   ZTF17aaaswvx    1    False       True   626         2         NaN   
10  ZTF17aaatnbo    1    False       True    48         1         NaN   
11  ZTF17aaawcom    1    False       True   167         0         NaN   
12  ZTF17aaawgek    1    False       True   229         1         NaN   
13  ZTF17aaawqfk    1    False       True   547         0         NaN   
14  ZTF17aaazpbo    1    False       True    71         0         NaN   
15  ZTF17aaazyqw    1    False      False    11        11   -0.363830   
16  ZTF17aabghja    1    False       True    13         0         NaN   
17  ZTF17aabunmx    1    False       True   312         0         NaN   
18  ZTF17aabunmx    2    False       True   397         0         NaN   
19  ZTF17aabyrpg    1    False       True   137         0         NaN   
20  ZTF17aaccevp    1    False       True    11         0         NaN   
21  ZTF17aacgwrb    1    False       True    38         2         NaN   
22  ZTF17aacomhx    2    False       True    24         1         NaN   
23  ZTF17aadfmzp    1    False       True    11         0         NaN   
24  ZTF18aaaaofg    1    False       True   126         1         NaN   
25  ZTF18aaadqso    2    False       True   106         0         NaN   
26  ZTF18aaajdrc    1    False       True    41         1         NaN   
27  ZTF18aaakpie    2    False       True    23         1         NaN   
28  ZTF18aaamgxp    2    False       True    15         0   -0.205313   
29  ZTF18aaaogjl    2    False       True    22         1         NaN   

    dm_first  sigmadm_first  dt_first  ...  magmedian_corr  magmax_corr  \
0        NaN            NaN       NaN  ...       18.349495    19.250978   
1        NaN            NaN       NaN  ...       16.816305    17.090448   
2        NaN            NaN       NaN  ...       17.365470    17.422337   
3        NaN            NaN       NaN  ...       20.069712    22.804115   
4        NaN            NaN       NaN  ...       17.421630    17.455881   
5        NaN            NaN       NaN  ...             NaN          NaN   
6        NaN            NaN       NaN  ...       14.078731    14.078731   
7  -1.156400     -20.784653  2.990926  ...       17.704395    17.758635   
8        NaN            NaN       NaN  ...       16.442953    18.112616   
9        NaN            NaN       NaN  ...       18.349104    19.250978   
10       NaN            NaN       NaN  ...       17.135637    17.261750   
11       NaN            NaN       NaN  ...       19.099104    19.469353   
12       NaN            NaN       NaN  ...       19.300646   100.000000   
13       NaN            NaN       NaN  ...       18.957174    19.962952   
14       NaN            NaN       NaN  ...       19.877234    20.651594   
15 -1.233855     -20.473970  2.963820  ...       17.201782    17.435263   
16       NaN            NaN       NaN  ...       17.486992    17.543646   
17       NaN            NaN       NaN  ...       18.589832    20.429623   
18       NaN            NaN       NaN  ...       18.273699    19.876719   
19       NaN            NaN       NaN  ...       18.814323    19.148642   
20       NaN            NaN       NaN  ...       17.028027    17.059195   
21       NaN            NaN       NaN  ...             NaN          NaN   
22       NaN            NaN       NaN  ...             NaN          NaN   
23       NaN            NaN       NaN  ...       16.035013    16.058973   
24       NaN            NaN       NaN  ...       16.540580   100.000000   
25       NaN            NaN       NaN  ...       19.958225   100.000000   
26       NaN            NaN       NaN  ...       16.955814    17.002485   
27       NaN            NaN       NaN  ...             NaN          NaN   
28 -0.470000     -19.526098  0.970706  ...       16.350641    17.169376   
29       NaN            NaN       NaN  ...       16.236862    17.306086   

    magmin_corr  magsigma_corr  maglast_corr  magfirst_corr   firstmjd  \
0     14.514420       0.655273     14.871971      17.780094  58349.434   
1     16.205900       0.345946     16.205900            NaN  58382.460   
2     15.648982       0.269482     15.648982      17.358065  58437.430   
3     16.589040       1.203840     16.789545      18.917585  58371.516   
4     15.928150       0.414757     15.928150      17.446985  58441.460   
5           NaN            NaN           NaN            NaN  58422.350   
6     14.078731       0.000000     14.078731            NaN  58431.227   
7     16.271450       0.356419     16.348988      17.441607  58352.426   
8     16.405207       0.495029     18.062143      16.432556  58374.473   
9     14.450059       0.715195     16.425968      17.780094  58349.434   
10    16.205920       0.224303     16.205920      16.905798  58382.460   
11    15.268386       1.541127     16.175684      19.311296  58693.320   
12    15.210840      23.371240     16.482391      22.726280  58323.426   
13    15.072848       1.047149     16.728190      18.982880  58281.430   
14    16.041350       1.493395     16.566166      19.743600  58764.504   
15    15.912502       0.444554     15.912502            NaN  58346.367   
16    15.858172       0.454879     15.858172      16.802483  58434.438   
17    14.942116       1.196816     15.745890      18.834373  58286.457   
18    15.012147       1.023591     15.772438      18.416862  58289.453   
19    13.964068       1.636876     15.538330      16.012342  58480.490   
20    15.907078       0.337792     15.907078      17.018574  59149.477   
21          NaN            NaN           NaN            NaN  58430.420   
22          NaN            NaN           NaN            NaN  58455.293   
23    15.296916       0.213511     15.296916      16.035013  59843.470   
24    16.453445       7.449521     21.514559      16.530027  58382.477   
25    14.369963       8.126190     15.869367      14.531776  58434.200   
26    15.961990       0.163007     15.961990      16.664300  58440.473   
27          NaN            NaN           NaN            NaN  58510.223   
28    16.190092       0.218214     17.169376      16.326408  58851.445   
29    16.061646       0.244138     17.306086      16.100428  58432.550   

      lastmjd  step_id_corr  saturation_rate  
0   60735.145        27.4.0              0.0  
1   60608.457        24.5.1              0.0  
2   60695.180        27.0.0              0.0  
3   60795.176        27.5.6              0.0  
4   59509.418        27.4.0              0.0  
5   60530.445        24.5.1              0.0  
6   60616.367        24.5.1              0.0  
7   59860.350         1.2.0              0.0  
8   60693.203        27.0.0              0.0  
9   60743.176        27.4.0              0.0  
10  60608.457        27.4.0              0.0  
11  60788.484        27.5.6              0.0  
12  60816.367        27.5.6              0.0  
13  60814.470        27.5.6              0.0  
14  60730.150        27.4.0              0.0  
15  59460.380         1.2.0              0.0  
16  60717.360        27.5.0              0.0  
17  60814.470        27.5.6              0.0  
18  60814.434        27.5.6              0.0  
19  60787.230        27.5.6              0.0  
20  60635.324        27.4.0              0.0  
21  60619.414        24.5.1              0.0  
22  60530.450        24.5.1              0.0  
23  60760.242        27.5.2              0.0  
24  60732.176        27.5.0              0.0  
25  60685.170        26.2.0              0.0  
26  60689.402        26.2.0              0.0  
27  60321.188        24.5.1              0.0  
28  59858.504           dev              0.0  
29  60263.508        26.2.0              0.0  

[30 rows x 28 columns]]",,10.577335119247437,2025-05-22T00:03:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,104,0,"SELECT
    sq1.oid,
    ss_ztf.candid, ss_ztf.ssdistnr, ss_ztf.ssmagnr,
    ss_ztf.ssnamenr, dataquality.fid,
    dataquality.fwhm, dataquality.nmatches,
    dataquality.exptime
FROM
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.9
    AND classifier_version = 'stamp_classifier_1.0.4'
LIMIT 30
) as sq1
INNER JOIN
ss_ztf
ON sq1.oid = ss_ztf.oid
INNER JOIN
dataquality
ON ss_ztf.oid = dataquality.oid
AND ss_ztf.candid = dataquality.candid",,,,,"[             oid               candid  ssdistnr  ssmagnr ssnamenr  fid  \
0   ZTF21abiqtce  1642187814715015011       0.0     19.2    46590    2   
1   ZTF21abiqtch  1642187814715015001       0.0     20.2    43053    2   
2   ZTF21abiqter  1642187333015015003       0.0     19.2    31627    2   
3   ZTF21abiqtfd  1642187815715015004       0.0     19.8    99956    2   
4   ZTF21abiqtfq  1642187810815015010       0.0     19.6    95240    2   
5   ZTF21abiqtdq  1642187813415015016       0.0     19.7    90203    2   
6   ZTF21abiqteb  1642187330415015005       0.0     19.7    49011    2   
7   ZTF21abiqthd  1642187332615015001       0.0     19.7    50206    2   
8   ZTF21abiqtgw  1642187334715015015       0.0     20.0    84185    2   
9   ZTF21abiqthy  1642187810415015009       0.0     19.9    15413    2   
10  ZTF21abiqtjj  1642187812915015015       0.0     20.0   104588    2   
11  ZTF21abiqtpp  1642188425415015000       0.0     19.5    45799    2   
12  ZTF21abiqtco  1642187332815015005       0.0     19.2    16429    2   
13  ZTF21abiqthe  1642187332615015000       0.0     19.8    49544    2   
14  ZTF21abiqtkx  1642187332915015013       0.0     19.6    26316    2   
15  ZTF21abiqtnb  1642187334415015010       0.0     20.4   427804    2   
16  ZTF21abiqtnz  1642187812115015015       0.0     20.5    89670    2   
17  ZTF21abiqtps  1642187334115015000       0.0     19.5    53383    2   
18  ZTF21abiqtbe  1642187334615015007       0.0     19.8    79515    2   
19  ZTF21abiqteh  1642187331215015007       0.0     16.2     1056    2   
20  ZTF21abiqtgg  1642187335515015006       0.0     20.6   231452    2   
21  ZTF21abiqtiv  1642187334315015015       0.0     19.9    94465    2   
22  ZTF21abiqtkn  1642187335715015002       0.0     19.6   108203    2   
23  ZTF21abiqtkw  1642187332915015011       0.0     18.8    14295    2   
24  ZTF21abiqtob  1642187816115015009       0.0     19.8   138479    2   
25  ZTF21abiqtrf  1642188422115015014       0.0     18.2    11192    2   
26  ZTF21abiqtqj  1642187330615015003       0.0     20.5    64508    2   
27  ZTF21abiqtan  1642187330515015010       0.0     19.6    76897    2   
28  ZTF21abiqtbs  1642187813015015002       0.0     20.1    38199    2   
29  ZTF21abiqtaw  1642187336315015001       0.0     19.6    75778    2   

        fwhm  nmatches  exptime  
0   1.930000       363     30.0  
1   2.010000       363     30.0  
2   2.020000       428     30.0  
3   2.200000       312     30.0  
4   1.980000       367     30.0  
5   1.720000       330     30.0  
6   1.670000       431     30.0  
7   1.730000       438     30.0  
8   2.750000       475     30.0  
9   1.660000       386     30.0  
10  2.530000       376     30.0  
11  1.660000      1449     30.0  
12  2.630000       479     30.0  
13  2.280000       438     30.0  
14  2.740000       398     30.0  
15  1.650000       412     30.0  
16  1.114006       361     30.0  
17  2.270000       418     30.0  
18  2.550000       417     30.0  
19  2.150000       430     30.0  
20  2.250000       383     30.0  
21  2.120000       467     30.0  
22  1.930000       446     30.0  
23  2.560000       398     30.0  
24  2.080000       300     30.0  
25  2.040000      1712     30.0  
26  1.089646       433     30.0  
27  1.670000       444     30.0  
28  1.750000       352     30.0  
29  2.360000       448     30.0  ]",,8.551047563552856,2025-05-22T00:03:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,104,1,"
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.nid AS number_of_ps1_calibrators_used,  -- Assuming 'nid' is the number of PS1 calibrators used
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
WHERE 
    p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.probability > 0.9
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,24.595694065094,2025-04-29T12:42:55,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time -- Assuming 'exptime' is the ...
             ^

[SQL: 
-- Step 1: Filter the probability table for the required conditions
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Step 2: Join the filtered probability with the object, ss_ztf, and detection tables
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.distnr AS fwhm_from_sextractor, -- Assuming 'distnr' is the closest match for FWHM
    d.nid AS number_of_ps1_calibrators_used, -- Assuming 'nid' is the number of PS1 calibrators used
    d.exptime AS exposure_time -- Assuming 'exptime' is the correct column for exposure time
FROM 
    filtered_probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.590181350708008,2025-05-22T00:04:03,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,2,"
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_identifier,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    object o ON p.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.probability > 0.9
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.386061429977417,2025-04-29T12:43:16,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time
             ^

[SQL: 
-- Step 1: Filter the probability table for the most likely asteroid classifications with the specified conditions
WITH filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Step 2: Join the filtered probabilities with the object, ss_ztf, and detection tables
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_identifier,
    d.distnr AS fwhm_from_sextractor, -- Corrected column name
    d.nid AS number_of_ps1_calibrators_used, -- Corrected column name
    d.exptime AS exposure_time
FROM 
    filtered_probabilities fp
INNER JOIN 
    object o ON fp.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",14.720621109008789,2025-05-22T00:04:22,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,3,"
-- Subquery to filter objects with a probability > 0.9 of being an asteroid
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Main query to retrieve the required information
SELECT 
    o.oid AS ztf_object_id,
    d.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    p.nmtchps AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_objects fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ps1_ztf p ON d.candid = p.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,27.12235307693481,2025-04-29T12:43:43,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time
             ^

[SQL: 
-- Subquery to filter objects with a probability > 0.9 of being an asteroid
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Main query to retrieve the required information
SELECT 
    o.oid AS ztf_object_id,
    d.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.diffmaglim AS fwhm_from_sextractor, -- Corrected column name
    p.nmtchps AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_objects fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ps1_ztf p ON d.candid = p.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.586431980133057,2025-05-22T00:04:35,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,4,"
-- Step 1: Subquery to filter probability table for asteroids with probability > 0.9
WITH filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Step 2: Join with object, ss_ztf, and detection tables
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_to_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_identifier,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_probabilities fp
INNER JOIN 
    object o ON fp.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE ps1_ztf ( /* information about the three closest sources in Pan STARRS */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    objectidps1 DOUBLE PRECISION, /* identifier of the closest source in pan starrs (ps) */\n    sgmag1 DOUBLE PRECISION, /* ps g band magnitude */\n    srmag1 DOUBLE PRECISION, /* ps r band magnitude */\n    simag1 DOUBLE PRECISION, /* ps i band magnitude */\n    szmag1 DOUBLE PRECISION, /* ps z band magnitude */\n    sgscore1 DOUBLE PRECISION, /* ps star galaxy score */\n    distpsnr1 DOUBLE PRECISION, /* distance to closest source in panstarrs */\n    objectidps2 DOUBLE PRECISION,  /* identifier of the second closest source in pan starrs (ps) */\n    sgmag2 DOUBLE PRECISION, /* g-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag2 DOUBLE PRECISION, /* r-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag2 DOUBLE PRECISION, /* i-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag2 DOUBLE PRECISION, /* z-band PSF magnitude of second closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore2 DOUBLE PRECISION, /* Star/Galaxy score of second closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr2 DOUBLE PRECISION, /* Distance to second closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    objectidps3 DOUBLE PRECISION, /* Object ID of third closest source from PS1 catalog; if exists within 30 arcsec */\n    sgmag3 DOUBLE PRECISION, /* g-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    srmag3 DOUBLE PRECISION, /* r-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    simag3 DOUBLE PRECISION, /* i-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    szmag3 DOUBLE PRECISION, /* z-band PSF magnitude of third closest source from PS1 catalog; if exists within 30 arcsec [mag] */\n    sgscore3 DOUBLE PRECISION, /* Star/Galaxy score of third closest source from PS1 catalog; if exists within 30 arcsec: 0 <= sgscore <= 1 where closer to 1 implies higher likelihood of being a star */\n    distpsnr3 DOUBLE PRECISION, /* Distance to third closest source from PS1 catalog; if exists within 30 arcsec [arcsec] */\n    nmtchps INTEGER NOT NULL, /* Number of source matches from PS1 catalog falling within 30 arcsec */\n    unique1 BOOLEAN NOT NULL, /* Whether the first closest object has changed w.r.t the first alert */\n    unique2 BOOLEAN NOT NULL, /* Whether the second closest object has changed w.r.t the first alert */\n    unique3 BOOLEAN NOT NULL /* Whether the third closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid, candid)\n);']",advanced,21.79699301719665,2025-04-29T12:44:05,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time
             ^

[SQL: 
-- Step 1: Subquery to filter probability table for asteroids with probability > 0.9
WITH filtered_probabilities AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Step 2: Join with object, ss_ztf, and detection tables
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_to_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS mpc_archive_name,
    d.fid AS filter_identifier,
    d.distnr AS fwhm_from_sextractor, -- Corrected column name
    p.nmtchps AS number_of_ps1_calibrators_used, -- Corrected to use ps1_ztf table
    d.exptime AS exposure_time
FROM 
    filtered_probabilities fp
INNER JOIN 
    object o ON fp.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
INNER JOIN 
    ps1_ztf p ON s.candid = p.candid -- Added join with ps1_ztf for calibrators
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.072231769561768,2025-05-22T00:04:50,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,5,"
-- Subquery to filter oids from the probability table
WITH filtered_oids AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Main query to join tables and retrieve the required information
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_identifier,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_oids fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.7346785068512,2025-04-29T12:44:27,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time -- Corrected column name
             ^

[SQL: 
-- Subquery to filter oids from the probability table
WITH filtered_oids AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.9
      AND ranking = 1
)

-- Main query to join tables and retrieve the required information
SELECT 
    o.oid AS ztf_identifier,
    s.candid AS candidate_identifier,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_identifier,
    d.distnr AS fwhm_from_sextractor, -- Corrected column name
    d.nid AS number_of_ps1_calibrators_used, -- Corrected column name
    d.exptime AS exposure_time -- Corrected column name
FROM 
    filtered_oids fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.464144468307495,2025-05-22T00:05:08,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,6,"
SELECT 
    p.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.magpsf AS fwhm, 
    d.nid AS ncalib, 
    d.exptime
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.probability > 0.9 
    AND p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,20.583189249038696,2025-04-29T12:44:48,"[             oid               candid  ssdistnr  ssmagnr ssnamenr  fid  \
0   ZTF21abiqtnn  1642187331515015012       0.0     18.8    18678    2   
1   ZTF21abiqtnp  1642187331515015003       0.0     19.6    22949    2   
2   ZTF21abiqtax  1642187336315015015       0.0     20.2    41993    2   
3   ZTF21abiqtbt  1642187816315015014       0.0     19.5    77484    2   
4   ZTF21abiqtpg  1642187813315015003       0.0     20.0   151224    2   
5   ZTF21abiqtim  1642187334315015010       0.0     19.3    31673    2   
6   ZTF21abiqtmm  1642187812515015018       0.0     19.9   189429    2   
7   ZTF21abiqtez  1642187810015015005       0.0     19.1    50171    2   
8   ZTF21abiqtht  1642187333115015011       0.0     19.5    71174    2   
9   ZTF21abiqtbl  1642187813715015004       0.0     19.3    90128    2   
10  ZTF21abiqugh  1642188900415015010       0.0     20.2   209027    2   
11  ZTF21abiqtaz  1642187334515015007       0.0     18.0     5942    2   
12  ZTF21abiqtdd  1642187812815015009       0.0     19.7    76450    2   
13  ZTF21abiqtel  1642187331215015005       0.0     18.9     8837    2   
14  ZTF21abiqtjy  1642187334215015016       0.0     19.9   234064    2   
15  ZTF21abiqtnj  1642187331515015024       0.0     18.2    14874    2   
16  ZTF21abiqtxi  1642188425615015016       0.0     19.0   103550    2   
17  ZTF21abiqtxs  1642187814015015006       0.0     20.1    55404    2   
18  ZTF21abiquaf  1642187812315015001       0.0     20.0    14935    2   
19  ZTF21abiqtav  1642187336315015016       0.0     20.0    78689    2   
20  ZTF21abiqtdv  1642187330415015001       0.0     19.0    60266    2   
21  ZTF21abiqteg  1642187331315015002       0.0     19.0     9437    2   
22  ZTF21abiqtex  1642187810015015023       0.0     19.1    25762    2   
23  ZTF21abiqtrg  1642188422115015001       0.0     19.5   145456    2   
24  ZTF21abiqtau  1642187336315015003       0.0     19.1    14787    2   
25  ZTF21abiqtdi  1642188425815015014       0.0     19.9    63082    2   
26  ZTF21abiqtdj  1642188425815015003       0.0     19.5    22408    2   
27  ZTF21abiqtds  1642187813415015008       0.0     20.3   238280    2   
28  ZTF21abiqtfk  1642187330915015009       0.0     20.2    80942    2   
29  ZTF21abiqtib  1642187330015015008       0.0     19.3    14307    2   

        fwhm  ncalib    exptime  
0   0.130920    1642  20.173384  
1   0.139023    1642  20.173384  
2   0.165604    1642  20.339418  
3   0.116650    1642  20.370476  
4   0.149700    1642  20.338854  
5   0.083964    1642  20.310892  
6   0.132322    1642  20.277718  
7   0.136262    1642  20.294992  
8   0.112273    1642  20.186512  
9   0.083893    1642  20.373400  
10  0.182625    1642  20.088394  
11  0.056702    1642  20.254187  
12  0.142896    1642  20.335434  
13  0.087427    1642  20.096770  
14  0.130388    1642  20.196990  
15  0.072497    1642  20.173384  
16  0.104522    1642  20.061255  
17  0.167160    1642  20.460085  
18  0.204465    1642  20.332708  
19  0.154313    1642  20.339418  
20  0.086132    1642  20.343622  
21  0.089573    1642  20.088660  
22  0.107396    1642  20.294992  
23  0.117748    1642  20.018170  
24  0.104548    1642  20.339418  
25  0.124394    1642  20.005829  
26  0.156596    1642  20.005829  
27  0.154603    1642  20.274107  
28  0.195706    1642  20.213562  
29  0.095965    1642  20.231161  ]",,13.34023404121399,2025-05-22T00:05:27,0.1,0.1,0.8888888888888888,0.8888888888888888,0.0,0.0
0.16.3,gpt-4o,v1,104,7,"
SELECT 
    p.oid AS ztf_object_id, 
    s.candid AS candidate_id, 
    s.ssdistnr AS distance_from_nearest_solar_system_object, 
    s.ssmagnr AS mpc_archive_magnitude, 
    s.ssnamenr AS nearest_solar_system_object_name, 
    d.fid AS filter_id, 
    d.fwhm AS fwhm_from_sextractor, 
    d.ncalib AS number_of_ps1_calibrators_used, 
    d.exptime AS exposure_time
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,28.706850051879883,2025-04-29T12:45:17,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 12:     d.exptime AS exposure_time
             ^

[SQL: 
-- Final Query: Combine both steps into a single query.
SELECT 
    subquery.ztf_object_id, 
    subquery.candidate_id, 
    subquery.distance_from_nearest_solar_system_object, 
    subquery.mpc_archive_magnitude, 
    subquery.nearest_solar_system_object_name, 
    d.fid AS filter_id, 
    d.distnr AS fwhm_from_sextractor, -- Corrected column name
    d.nid AS number_of_ps1_calibrators_used, -- Corrected column name
    d.exptime AS exposure_time
FROM 
    detection d
INNER JOIN 
    (
        SELECT 
            p.oid AS ztf_object_id, 
            s.candid AS candidate_id, 
            s.ssdistnr AS distance_from_nearest_solar_system_object, 
            s.ssmagnr AS mpc_archive_magnitude, 
            s.ssnamenr AS nearest_solar_system_object_name
        FROM 
            probability p
        INNER JOIN 
            ss_ztf s ON p.oid = s.oid
        WHERE 
            p.class_name = 'asteroid' 
            AND p.classifier_name = 'stamp_classifier' 
            AND p.classifier_version = 'stamp_classifier_1.0.4' 
            AND p.probability > 0.9 
            AND p.ranking = 1
        LIMIT 30
    ) AS subquery ON subquery.candidate_id = d.candid
]
(Background on this error at: https://sqlalche.me/e/20/f405)",13.37450909614563,2025-05-22T00:05:45,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,8,"
SELECT 
    p.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.fwhm, 
    d.ncalib, 
    d.exptime
FROM 
    probability p
INNER JOIN 
    ss_ztf s ON p.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
WHERE 
    p.class_name = 'asteroid' 
    AND p.classifier_name = 'stamp_classifier' 
    AND p.classifier_version = 'stamp_classifier_1.0.4' 
    AND p.probability > 0.9 
    AND p.ranking = 1
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.431063413619995,2025-04-29T12:45:35,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 10:     d.exptime
             ^

[SQL: 
-- Final Query: Combine all steps to get the final result
SELECT 
    s.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.exptime
FROM 
    (SELECT 
        s.oid, 
        s.candid, 
        s.ssdistnr, 
        s.ssmagnr, 
        s.ssnamenr
    FROM 
        ss_ztf s
    INNER JOIN 
        (SELECT 
            p.oid
        FROM 
            probability p
        WHERE 
            p.class_name = 'asteroid' 
            AND p.classifier_name = 'stamp_classifier' 
            AND p.classifier_version = 'stamp_classifier_1.0.4' 
            AND p.probability > 0.9 
            AND p.ranking = 1
        LIMIT 30) filtered_p
    ON 
        s.oid = filtered_p.oid) s
INNER JOIN 
    detection d ON s.candid = d.candid
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.785833358764648,2025-05-22T00:06:02,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,9,"
-- Step 1: Subquery to filter objects with the specified probability conditions
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Step 2: Join with object, ss_ztf, and detection tables
SELECT 
    o.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.fwhm, 
    d.ncalib, 
    d.exptime
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
INNER JOIN detection d ON s.candid = d.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.10161542892456,2025-04-29T12:45:54,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime          -- Assuming 'exptime' is the exposure...
             ^

[SQL: 
-- Step 1: Subquery to filter objects with the specified probability conditions
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Step 2: Join with object, ss_ztf, and detection tables
SELECT 
    o.oid, 
    s.candid, 
    s.ssdistnr, 
    s.ssmagnr, 
    s.ssnamenr, 
    d.fid, 
    d.distnr AS fwhm,  -- Assuming 'distnr' is the closest match for FWHM
    d.nid AS ncalib,   -- Assuming 'nid' is the closest match for number of PS1 calibrators
    d.exptime          -- Assuming 'exptime' is the exposure time
FROM filtered_objects fo
INNER JOIN object o ON fo.oid = o.oid
INNER JOIN ss_ztf s ON o.oid = s.oid
INNER JOIN detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",9.928275346755981,2025-05-22T00:06:16,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,104,10,"
-- Subquery to filter objects with the specified probability conditions
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Main query to join tables and retrieve the required information
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    d.fwhm AS fwhm_from_sextractor,
    d.ncalib AS number_of_ps1_calibrators_used,
    d.exptime AS exposure_time
FROM 
    filtered_objects fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.491296529769897,2025-04-29T12:46:13,[None],"(psycopg2.errors.UndefinedColumn) column d.exptime does not exist
LINE 23:     d.exptime AS exposure_time
             ^

[SQL: 
-- Subquery to filter objects with the specified probability conditions
WITH filtered_objects AS (
    SELECT oid
    FROM probability
    WHERE probability > 0.9
      AND class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND ranking = 1
)

-- Main query to join tables and retrieve the required information
SELECT 
    o.oid AS ztf_object_id,
    s.candid AS candidate_id,
    s.ssdistnr AS distance_from_nearest_solar_system_object,
    s.ssmagnr AS mpc_archive_magnitude,
    s.ssnamenr AS nearest_solar_system_object_name,
    d.fid AS filter_id,
    -- Removed fwhm_from_sextractor as it does not exist in the schema
    -- Removed number_of_ps1_calibrators_used as it does not exist in the schema
    d.exptime AS exposure_time
FROM 
    filtered_objects fo
INNER JOIN 
    object o ON fo.oid = o.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON s.candid = d.candid
LIMIT 30
]
(Background on this error at: https://sqlalche.me/e/20/f405)",10.527525901794434,2025-05-22T00:06:30,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,71,0,"SELECT
    rfid, oid, candid, magnr, sigmagnr
FROM
    reference
WHERE
    oid IN ('ZTF20aczxeud','ZTF21aappfdu','ZTF22aacqjeb')
    AND fid = 1
ORDER BY oid",,,,,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,3.220240354537964,2025-05-22T00:06:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,1,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,16.078418254852295,2025-04-29T12:46:29,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,7.693147659301758,2025-05-22T00:06:46,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,2,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1  -- Filter for g band
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,13.624054670333862,2025-04-29T12:46:43,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,7.854535102844238,2025-05-22T00:06:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,3,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1  -- Filter ID 1 corresponds to the g band
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.946117162704468,2025-04-29T12:46:56,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,7.6679205894470215,2025-05-22T00:07:09,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,4,"
-- Query to retrieve reference information for specific ZTF objects in the 'g' band
SELECT 
    rfid,  -- Identifier of the reference
    oid,   -- ZTF identifier
    candid, -- Candidate identifier
    magnr, -- Magnitude of the nearest reference object
    sigmagnr -- Uncertainty of the magnitude
FROM 
    reference
WHERE 
    oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') -- Filter for specific ZTF identifiers
    AND fid = 1 -- Filter for 'g' band
ORDER BY 
    oid -- Sort results by ZTF identifier
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,15.541321516036987,2025-04-29T12:47:11,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,8.6849045753479,2025-05-22T00:07:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,5,"
SELECT 
    rfid, 
    oid, 
    candid, 
    magnr, 
    sigmagnr
FROM 
    reference
WHERE 
    oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb') 
    AND fid = 1  -- Filter for g band
ORDER BY 
    oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.86180591583252,2025-04-29T12:47:24,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,7.734478712081909,2025-05-22T00:07:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,6,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,10.791408777236938,2025-04-29T12:47:35,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,7.468665599822998,2025-05-22T00:07:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,7,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,10.71144151687622,2025-04-29T12:47:46,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,7.8210625648498535,2025-05-22T00:07:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,8,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.378373384475708,2025-04-29T12:47:58,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,7.68318772315979,2025-05-22T00:08:07,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,9,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,11.183799982070925,2025-04-29T12:48:10,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,7.577575206756592,2025-05-22T00:08:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,71,10,"
SELECT rfid, oid, candid, magnr, sigmagnr
FROM reference
WHERE oid IN ('ZTF20aczxeud', 'ZTF21aappfdu', 'ZTF22aacqjeb')
  AND fid = 1
ORDER BY oid
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",medium,12.440671920776367,2025-04-29T12:48:22,"[        rfid           oid               candid   magnr  sigmagnr
0  371120103  ZTF20aczxeud  1601274780315015114  16.132     0.048
1  313120115  ZTF21aappfdu  1539274811515015018  18.253     0.065
2  313120115  ZTF22aacqjeb  1886297531515015012  18.253     0.065]",,8.797042608261108,2025-05-22T00:08:32,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,42,0,"SELECT
    oid, candid, fid, chipsf, fwhm, classtar,
    nbad, magzpsci, magzpsciunc, exptime
FROM
    dataquality
WHERE
    oid = 'ZTF21aapnixl'
ORDER BY chipsf
",,,,,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,3.319066047668457,2025-05-22T00:08:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,1,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.200922966003418,2025-04-29T12:48:25,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,8.022618770599365,2025-05-22T00:08:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,2,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.4390511512756348,2025-04-29T12:48:28,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,14.744436264038086,2025-05-22T00:09:11,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,3,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.740564346313477,2025-04-29T12:48:31,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,7.657587766647339,2025-05-22T00:09:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,4,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.6965951919555664,2025-04-29T12:48:34,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,7.690520524978638,2025-05-22T00:09:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,5,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.882836103439331,2025-04-29T12:48:38,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,7.464930295944214,2025-05-22T00:09:45,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,6,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,3.10225510597229,2025-04-29T12:48:42,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,8.000935077667236,2025-05-22T00:09:57,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,7,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,4.77508544921875,2025-04-29T12:48:46,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,8.003098487854004,2025-05-22T00:10:09,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,8,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.76728630065918,2025-04-29T12:48:49,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,7.50911283493042,2025-05-22T00:10:20,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,9,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.710254430770874,2025-04-29T12:48:52,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,9.489635944366455,2025-05-22T00:10:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,42,10,"
SELECT oid, candid, fid, chipsf, fwhm, classtar, nbad, magzpsci, magzpsciunc, exptime
FROM dataquality
WHERE oid = 'ZTF21aapnixl'
ORDER BY chipsf
","['\nCREATE TABLE dataquality (\n    candid BIGINT PRIMARY KEY, /* unique identifier for the subtraction candidate */\n    oid VARCHAR NOT NULL, /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    xpos DOUBLE PRECISION, /* x-image position of candidate [pixels] */\n    ypos DOUBLE PRECISION, /* y-image position of candidate [pixels] */\n    chipsf DOUBLE PRECISION, /* Reduced chi-square for PSF-fit */\n    sky DOUBLE PRECISION, /* Local sky background estimate [DN] */\n    fwhm DOUBLE PRECISION, /* Full Width Half Max assuming a Gaussian core, from SExtractor [pixels] */\n    classtar DOUBLE PRECISION, /* Star/Galaxy classification score from SExtractor */\n    mindtoedge DOUBLE PRECISION, /* Distance to nearest edge in image [pixels] */\n    seeratio DOUBLE PRECISION, /* Ratio: difffwhm / fwhm */\n    aimage DOUBLE PRECISION, /* Windowed profile RMS afloat major axis from SExtractor [pixels] */\n    bimage DOUBLE PRECISION, /* Windowed profile RMS afloat minor axis from SExtractor [pixels] */\n    aimagerat DOUBLE PRECISION, /* Ratio: aimage / fwhm */\n    bimagerat DOUBLE PRECISION, /* Ratio: bimage / fwhm */\n    nneg INTEGER, /* number of negative pixels in a 5 x 5 pixel stamp */\n    nbad INTEGER, /* number of prior-tagged bad pixels in a 5 x 5 pixel stamp */\n    sumrat DOUBLE PRECISION, /* Ratio: sum(pixels) / sum(abs(pixels)) in a 5 x 5 pixel stamp where stamp is first median-filtered to mitigate outliers */\n    scorr DOUBLE PRECISION, /* Peak-pixel signal-to-noise ratio in point source matched-filtered detection image */\n    dsnrms DOUBLE PRECISION, /* Ratio: D/stddev(D) on event position where D = difference image */\n    ssnrms DOUBLE PRECISION, /* Ratio: S/stddev(S) on event position where S = image of convolution: D (x) PSF(D) */\n    magzpsci DOUBLE PRECISION, /* Magnitude zero point for photometry estimates [mag] */\n    magzpsciunc DOUBLE PRECISION, /* Magnitude zero point uncertainty (in magzpsci) [mag] */\n    magzpscirms DOUBLE PRECISION, /* RMS (deviation from average) in all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    nmatches INTEGER, /* Number of PS1 photometric calibrators used to calibrate science image from science image processing */\n    clrcoeff DOUBLE PRECISION, /* Color coefficient from linear fit from photometric calibration of science image */\n    clrcounc DOUBLE PRECISION, /* Color coefficient uncertainty from linear fit (corresponding to clrcoeff) */\n    zpclrcov DOUBLE PRECISION, /* Covariance in magzpsci and clrcoeff from science image processing [mag^2] */\n    zpmed DOUBLE PRECISION, /* Magnitude zero point from median of all differences between instrumental photometry and matched photometric calibrators from science image processing [mag] */\n    clrmed DOUBLE PRECISION, /* Median color of all PS1 photometric calibrators used from science image processing [mag]: for filter (fid) = 1, 2, 3, PS1 color used = g-r, g-r, r-i respectively */\n    clrrms DOUBLE PRECISION, /* RMS color (deviation from average) of all PS1 photometric calibrators used from science image processing [mag] */\n    exptime DOUBLE PRECISION /* Integration time of camera exposure [sec] */\n    FOREIGN KEY (candid, oid) REFERENCES detection(candid, oid)\n);\n']",simple,2.532714366912842,2025-04-29T12:48:55,"[            oid               candid  fid    chipsf      fwhm  classtar  nbad  \
0  ZTF21aapnixl  1538534064015015007    2  0.993519  1.248978     0.876     0   
1  ZTF21aapnixl  1536538794015015004    2  1.009326  2.540000     0.992     0   
2  ZTF21aapnixl  1537537024015015004    2  1.243430  1.435979     0.931     0   
3  ZTF21aapnixl  1536541194015015010    2  1.246692  2.340000     0.993     0   
4  ZTF21aapnixl  1537534614015015007    2  1.422183  2.530000     0.763     0   
5  ZTF21aapnixl  1543529474015015016    2  1.682237  2.540000     0.979     0   

    magzpsci  magzpsciunc  exptime  
0  26.197325     0.000002     30.0  
1  26.321283     0.000002     30.0  
2  26.299805     0.000003     30.0  
3  26.338717     0.000003     30.0  
4  26.294783     0.000003     30.0  
5  26.292053     0.000003     30.0  ]",,7.505751609802246,2025-05-22T00:10:44,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,107,0,"SELECT
    object.oid, ndet, firstmjd, lastmjd,
    probability, ss_ztf.candid, ssdistnr,
    ssnamenr, mjd, fid
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
    INNER JOIN
    ss_ztf
    ON object.oid = ss_ztf.oid
    INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ndet > 500
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'asteroid'
    AND probability > 0.5
    AND classifier_version = 'stamp_classifier_1.0.4'
    AND ssdistnr < 2
ORDER BY firstmjd
LIMIT 10
",,,,,"[            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
1  ZTF18abbxrwg   965  58287.335428  60816.399907          1.0   
2  ZTF18abctcjx   961  58301.355914  60815.460382          1.0   
3  ZTF18abegdjb   736  58304.357766  60815.460382          1.0   
4  ZTF18abjxzue   702  58332.271759  60816.378831          1.0   
5  ZTF18abnowwc   601  58348.212234  60814.457593          1.0   
6  ZTF18abnugpf   563  58348.353021  60814.419896          1.0   
7  ZTF17aacmuxo   580  58356.512998  60773.163762          1.0   
8  ZTF17aaapcln  1253  58357.495787  60775.153993          1.0   
9  ZTF18abrbhzl   782  58358.463819  60775.153993          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  1497422265615015015    -999.0     null  59251.422269    1  
1  1499564341415015015    -999.0     null  59253.564340    2  
2  1508557300615015050    -999.0     null  59262.557303    2  
3  1508557301515015029    -999.0     null  59262.557303    2  
4  1494508860715015005    -999.0     null  59248.508866    1  
5  1508557771615015008    -999.0     null  59262.557778    2  
6  1515558154415015007    -999.0     null  59269.558160    2  
7  1521247305515015000    -999.0     null  59275.247303    2  
8  1494169106015015027    -999.0     null  59248.169109    2  
9  1521247305415015012    -999.0     null  59275.247303    2  ]",,130.6087567806244,2025-05-22T00:12:55,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,107,1,"
SELECT 
    o.oid AS ztf_identifier, 
    o.ndet AS number_of_detections, 
    o.firstmjd AS first_detection_date, 
    o.lastmjd AS last_detection_date, 
    p.probability, 
    d.candid AS candidate_identifier, 
    s.ssdistnr AS distance_to_mpc_object, 
    s.ssnamenr AS mpc_name, 
    d.mjd AS detection_date, 
    d.fid AS filter_identifier
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
INNER JOIN 
    detection d ON o.oid = d.oid
WHERE 
    o.ndet > 500
    AND p.probability > 0.5
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.ranking = 1
    AND s.ssdistnr < 2
ORDER BY 
    o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,28.270288228988647,2025-04-29T12:49:23,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2240496781515010017   
1         60814.373657          1.0   2267443691515010008   
2         60814.373657          1.0   2267443215615010000   
3         60814.373657          1.0   2278298941515010013   
4         60814.373657          1.0   2278368001515010003   
5         60814.373657          1.0   2292295131515010015   
6         60814.373657          1.0   2290276151515010004   
7         60814.373657          1.0   2296331551515010005   
8         60814.373657          1.0   2296332025615010001   
9         60814.373657          1.0   2292274235615010002   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    59994.496782                  1  
1                  -999.0     null    60021.443692                  2  
2                  -999.0     null    60021.443218                  2  
3                  -999.0     null    60032.298947                  1  
4                  -999.0     null    60032.368009                  2  
5                  -999.0     null    60046.295139                  1  
6                  -999.0     null    60044.276157                  2  
7                  -999.0     null    60050.331551                  2  
8                  -999.0     null    60050.332026                  2  
9                  -999.0     null    60046.274236                  1  ]",,106.24693083763123,2025-05-22T00:14:48,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,2,"
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability
    FROM object o
    INNER JOIN probability_filtered p ON o.oid = p.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered o ON d.oid = o.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered o ON s.oid = o.oid
    WHERE s.ssdistnr < 2
)
SELECT o.oid AS ztf_identifier, 
       o.ndet AS number_of_detections, 
       o.firstmjd AS first_detection_date, 
       o.lastmjd AS last_detection_date, 
       o.probability, 
       d.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       d.mjd AS detection_date, 
       d.fid AS filter_identifier
FROM object_filtered o
INNER JOIN detection_filtered d ON o.oid = d.oid
INNER JOIN ss_ztf_filtered s ON o.oid = s.oid
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,21.01781916618347,2025-04-29T12:49:44,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2705233311515010014   
1         60814.373657          1.0   2683312481515015017   
2         60814.373657          1.0   2703252951515010009   
3         60814.373657          1.0   2703275405615010001   
4         60814.373657          1.0   2705339385615010002   
5         60814.373657          1.0   2680394605615010000   
6         60814.373657          1.0   2697402755615010070   
7         60814.373657          1.0   2701258461515010004   
8         60814.373657          1.0   2703252951515010010   
9         60814.373657          1.0   2684316091515015015   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    60459.233310                  1  
1                  -999.0     null    60437.312488                  1  
2                  -999.0     null    60457.252951                  1  
3                  -999.0     null    60457.275405                  1  
4                  -999.0     null    60459.339387                  2  
5                  -999.0     null    60434.394606                  1  
6                  -999.0     null    60451.402755                  1  
7                  -999.0     null    60455.258461                  1  
8                  -999.0     null    60457.252951                  1  
9                  -999.0     null    60438.316099                  1  ]",,43.905330657958984,2025-05-22T00:15:37,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,3,"
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability
    FROM object o
    INNER JOIN probability_filtered p ON o.oid = p.oid
    WHERE o.ndet > 500
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    WHERE s.ssdistnr < 2
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
)
SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, o.probability, d.candid, s.ssdistnr, s.ssnamenr, d.mjd, d.fid
FROM object_filtered o
INNER JOIN ss_ztf_filtered s ON o.oid = s.oid
INNER JOIN detection_filtered d ON o.oid = d.oid
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,18.966674089431763,2025-04-29T12:50:03,"[            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
1  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
2  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
3  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
4  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
5  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
6  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
7  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
8  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
9  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  2240496781515010017    -999.0     null  59994.496782    1  
1  2267443691515010008    -999.0     null  60021.443692    2  
2  2267443215615010000    -999.0     null  60021.443218    2  
3  2278298941515010013    -999.0     null  60032.298947    1  
4  2278368001515010003    -999.0     null  60032.368009    2  
5  2292295131515010015    -999.0     null  60046.295139    1  
6  2290276151515010004    -999.0     null  60044.276157    2  
7  2296331551515010005    -999.0     null  60050.331551    2  
8  2296332025615010001    -999.0     null  60050.332026    2  
9  2292274235615010002    -999.0     null  60046.274236    1  ]",,12.168308734893799,2025-05-22T00:15:55,1.0,0.1,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,107,4,"
-- Subquery to filter probability table for objects classified as 'asteroid' with probability > 0.5
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
)

-- Main query to join tables and apply conditions
SELECT 
    o.oid AS ztf_identifier,
    o.ndet AS number_of_detections,
    o.firstmjd AS first_detection_date,
    o.lastmjd AS last_detection_date,
    p.probability,
    d.candid AS candidate_identifier,
    s.ssdistnr AS distance_to_mpc_object,
    s.ssnamenr AS mpc_name,
    d.mjd AS detection_date,
    d.fid AS filter_identifier
FROM 
    object o
INNER JOIN 
    filtered_probability p ON o.oid = p.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.ndet > 500
    AND s.ssdistnr < 2
ORDER BY 
    o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,22.416176319122314,2025-04-29T12:50:26,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2240496781515010017   
1         60814.373657          1.0   2267443691515010008   
2         60814.373657          1.0   2267443215615010000   
3         60814.373657          1.0   2278298941515010013   
4         60814.373657          1.0   2278368001515010003   
5         60814.373657          1.0   2292295131515010015   
6         60814.373657          1.0   2290276151515010004   
7         60814.373657          1.0   2296331551515010005   
8         60814.373657          1.0   2296332025615010001   
9         60814.373657          1.0   2292274235615010002   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    59994.496782                  1  
1                  -999.0     null    60021.443692                  2  
2                  -999.0     null    60021.443218                  2  
3                  -999.0     null    60032.298947                  1  
4                  -999.0     null    60032.368009                  2  
5                  -999.0     null    60046.295139                  1  
6                  -999.0     null    60044.276157                  2  
7                  -999.0     null    60050.331551                  2  
8                  -999.0     null    60050.332026                  2  
9                  -999.0     null    60046.274236                  1  ]",,11.995574474334717,2025-05-22T00:16:12,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,5,"
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       p.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability p ON of.oid = p.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,22.66591429710388,2025-04-29T12:50:48,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       pf.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability_filtered pf ON of.oid = pf.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",143.73121881484985,2025-05-22T00:18:42,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,107,6,"
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       p.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability p ON of.oid = p.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,19.982300758361816,2025-04-29T12:51:08,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       pf.probability, 
       d.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       d.mjd AS detection_date, 
       d.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability_filtered pf ON of.oid = pf.oid
INNER JOIN detection d ON of.oid = d.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.5577929019928,2025-05-22T00:22:59,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,107,7,"
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability
    FROM object o
    INNER JOIN probability_filtered p ON o.oid = p.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered o ON d.oid = o.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered o ON s.oid = o.oid
    WHERE s.ssdistnr < 2
)
SELECT o.oid AS ztf_identifier, 
       o.ndet AS number_of_detections, 
       o.firstmjd AS first_detection_date, 
       o.lastmjd AS last_detection_date, 
       o.probability, 
       d.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       d.mjd AS detection_date, 
       d.fid AS filter_identifier
FROM object_filtered o
INNER JOIN detection_filtered d ON o.oid = d.oid
INNER JOIN ss_ztf_filtered s ON o.oid = s.oid
ORDER BY o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,21.218486785888672,2025-04-29T12:51:30,"[            oid  number_of_detections  first_detection_date  \
0  ZTF18aakqcul                   774          58279.169583   
1  ZTF18aakqcul                   774          58279.169583   
2  ZTF18aakqcul                   774          58279.169583   
3  ZTF18aakqcul                   774          58279.169583   
4  ZTF18aakqcul                   774          58279.169583   
5  ZTF18aakqcul                   774          58279.169583   
6  ZTF18aakqcul                   774          58279.169583   
7  ZTF18aakqcul                   774          58279.169583   
8  ZTF18aakqcul                   774          58279.169583   
9  ZTF18aakqcul                   774          58279.169583   

   last_detection_date  probability  candidate_identifier  \
0         60814.373657          1.0   2705233311515010014   
1         60814.373657          1.0   2683312481515015017   
2         60814.373657          1.0   2703252951515010009   
3         60814.373657          1.0   2703275405615010001   
4         60814.373657          1.0   2705339385615010002   
5         60814.373657          1.0   2680394605615010000   
6         60814.373657          1.0   2697402755615010070   
7         60814.373657          1.0   2701258461515010004   
8         60814.373657          1.0   2703252951515010010   
9         60814.373657          1.0   2684316091515015015   

   distance_to_mpc_object mpc_name  detection_date  filter_identifier  
0                  -999.0     null    60459.233310                  1  
1                  -999.0     null    60437.312488                  1  
2                  -999.0     null    60457.252951                  1  
3                  -999.0     null    60457.275405                  1  
4                  -999.0     null    60459.339387                  2  
5                  -999.0     null    60434.394606                  1  
6                  -999.0     null    60451.402755                  1  
7                  -999.0     null    60455.258461                  1  
8                  -999.0     null    60457.252951                  1  
9                  -999.0     null    60438.316099                  1  ]",,32.26565980911255,2025-05-22T00:23:36,1.0,0.1,0.1,0.1,0.0,0.0
0.16.3,gpt-4o,v1,107,8,"
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       p.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability p ON of.oid = p.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,24.68011832237244,2025-04-29T12:51:54,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_filtered AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_filtered AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd
    FROM object o
    INNER JOIN probability_filtered pf ON o.oid = pf.oid
    WHERE o.ndet > 500
),
detection_filtered AS (
    SELECT d.oid, d.candid, d.mjd, d.fid
    FROM detection d
    INNER JOIN object_filtered of ON d.oid = of.oid
),
ss_ztf_filtered AS (
    SELECT s.oid, s.ssdistnr, s.ssnamenr
    FROM ss_ztf s
    INNER JOIN object_filtered of ON s.oid = of.oid
    WHERE s.ssdistnr < 2
)
SELECT of.oid AS ztf_identifier, 
       of.ndet AS number_of_detections, 
       of.firstmjd AS first_detection_date, 
       of.lastmjd AS last_detection_date, 
       pf.probability, 
       df.candid AS candidate_identifier, 
       s.ssdistnr AS distance_to_mpc_object, 
       s.ssnamenr AS mpc_name, 
       df.mjd AS detection_date, 
       df.fid AS filter_identifier
FROM object_filtered of
INNER JOIN probability_filtered pf ON of.oid = pf.oid
INNER JOIN detection_filtered df ON of.oid = df.oid
INNER JOIN ss_ztf_filtered s ON of.oid = s.oid
ORDER BY of.firstmjd
LIMIT 10
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",140.64289164543152,2025-05-22T00:26:03,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,107,9,"
SELECT 
    o.oid AS ""ZTF identifier"",
    o.ndet AS ""number of detections"",
    o.firstmjd AS ""first detection date"",
    o.lastmjd AS ""last detection date"",
    p.probability AS ""probability"",
    d.candid AS ""candidate identifier"",
    s.ssdistnr AS ""distance between ZTF object and MPC object"",
    s.ssnamenr AS ""MPC name"",
    d.mjd AS ""detection date"",
    d.fid AS ""filter identifier""
FROM 
    object o
INNER JOIN 
    probability p ON o.oid = p.oid
INNER JOIN 
    detection d ON o.oid = d.oid
INNER JOIN 
    ss_ztf s ON o.oid = s.oid
WHERE 
    o.ndet > 500
    AND p.class_name = 'asteroid'
    AND p.classifier_name = 'stamp_classifier'
    AND p.classifier_version = 'stamp_classifier_1.0.4'
    AND p.probability > 0.5
    AND p.ranking = 1
    AND s.ssdistnr < 2
ORDER BY 
    o.firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,23.55281114578247,2025-04-29T12:52:18,"[  ZTF identifier  number of detections  first detection date  \
0   ZTF18aakqcul                   774          58279.169583   
1   ZTF18aakqcul                   774          58279.169583   
2   ZTF18aakqcul                   774          58279.169583   
3   ZTF18aakqcul                   774          58279.169583   
4   ZTF18aakqcul                   774          58279.169583   
5   ZTF18aakqcul                   774          58279.169583   
6   ZTF18aakqcul                   774          58279.169583   
7   ZTF18aakqcul                   774          58279.169583   
8   ZTF18aakqcul                   774          58279.169583   
9   ZTF18aakqcul                   774          58279.169583   

   last detection date  probability  candidate identifier  \
0         60814.373657          1.0   2240496781515010017   
1         60814.373657          1.0   2267443691515010008   
2         60814.373657          1.0   2267443215615010000   
3         60814.373657          1.0   2278298941515010013   
4         60814.373657          1.0   2278368001515010003   
5         60814.373657          1.0   2292295131515010015   
6         60814.373657          1.0   2290276151515010004   
7         60814.373657          1.0   2296331551515010005   
8         60814.373657          1.0   2296332025615010001   
9         60814.373657          1.0   2292274235615010002   

   distance between ZTF object and MPC object MPC name  detection date  \
0                                      -999.0     null    59994.496782   
1                                      -999.0     null    60021.443692   
2                                      -999.0     null    60021.443218   
3                                      -999.0     null    60032.298947   
4                                      -999.0     null    60032.368009   
5                                      -999.0     null    60046.295139   
6                                      -999.0     null    60044.276157   
7                                      -999.0     null    60050.331551   
8                                      -999.0     null    60050.332026   
9                                      -999.0     null    60046.274236   

   filter identifier  
0                  1  
1                  2  
2                  2  
3                  1  
4                  2  
5                  1  
6                  2  
7                  2  
8                  2  
9                  1  ]",,13.498876094818115,2025-05-22T00:26:22,1.0,1.0,0.1,0.1,1.0,0.0
0.16.3,gpt-4o,v1,107,10,"
WITH probability_subquery AS (
    SELECT oid, probability
    FROM probability
    WHERE class_name = 'asteroid'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.5
      AND ranking = 1
),
object_subquery AS (
    SELECT oid, ndet, firstmjd, lastmjd
    FROM object
    WHERE ndet > 500
),
joined_data AS (
    SELECT o.oid, o.ndet, o.firstmjd, o.lastmjd, p.probability, d.candid, d.mjd, d.fid, s.ssdistnr, s.ssnamenr
    FROM object_subquery o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    INNER JOIN detection d ON o.oid = d.oid
    INNER JOIN ss_ztf s ON o.oid = s.oid
    WHERE s.ssdistnr < 2
)
SELECT oid, ndet, firstmjd, lastmjd, probability, candid, ssdistnr, ssnamenr, mjd, fid
FROM joined_data
ORDER BY firstmjd
LIMIT 10
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', ""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n""]",advanced,19.491287231445312,2025-04-29T12:52:38,"[            oid  ndet      firstmjd       lastmjd  probability  \
0  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
1  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
2  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
3  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
4  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
5  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
6  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
7  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
8  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   
9  ZTF18aakqcul   774  58279.169583  60814.373657          1.0   

                candid  ssdistnr ssnamenr           mjd  fid  
0  2240496781515010017    -999.0     null  59994.496782    1  
1  2267443691515010008    -999.0     null  60021.443692    2  
2  2267443215615010000    -999.0     null  60021.443218    2  
3  2278298941515010013    -999.0     null  60032.298947    1  
4  2278368001515010003    -999.0     null  60032.368009    2  
5  2292295131515010015    -999.0     null  60046.295139    1  
6  2290276151515010004    -999.0     null  60044.276157    2  
7  2296331551515010005    -999.0     null  60050.331551    2  
8  2296332025615010001    -999.0     null  60050.332026    2  
9  2292274235615010002    -999.0     null  60046.274236    1  ]",,11.610999584197998,2025-05-22T00:26:39,1.0,0.1,1.0,1.0,0.0,1.0
0.16.3,,,83,0,"SELECT
    *
FROM
    allwise
WHERE
    oid_catalog in
(
SELECT
    oid_catalog
FROM
    xmatch
WHERE
    oid = 'ZTF21aazqwxv'
)",,,,,"[           oid_catalog          ra       dec  w1mpro  w2mpro  w3mpro  w4mpro  \
0  J131116.64+045854.7  197.819368  4.981863  13.319  13.129   9.839   7.761   

   w1sigmpro  w2sigmpro  w3sigmpro  w4sigmpro  j_m_2mass  h_m_2mass  \
0      0.033      0.037      0.056      0.247     15.331     14.491   

   k_m_2mass  j_msig_2mass  h_msig_2mass  k_msig_2mass  
0     14.027         0.109           0.1           0.1  ]",,3.303473949432373,2025-05-22T00:26:43,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,83,1,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.843326568603516,2025-04-29T12:52:41,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",139.48981094360352,2025-05-22T00:29:07,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,2,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.445544004440308,2025-04-29T12:52:43,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",142.83172702789307,2025-05-22T00:31:34,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,3,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.546348810195923,2025-04-29T12:52:47,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",134.0673394203186,2025-05-22T00:33:52,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,4,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.7188143730163574,2025-04-29T12:52:50,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",136.43330025672913,2025-05-22T00:36:13,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,5,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.522404193878174,2025-04-29T12:52:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.97084069252014,2025-05-22T00:38:30,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,6,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.340775966644287,2025-04-29T12:52:55,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.41678977012634,2025-05-22T00:40:49,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,7,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.4299683570861816,2025-04-29T12:52:57,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",131.36736488342285,2025-05-22T00:43:05,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,8,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.305925369262696,2025-04-29T12:53:00,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",132.90814304351807,2025-05-22T00:45:22,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,9,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.4947166442871094,2025-04-29T12:53:02,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",133.55863094329834,2025-05-22T00:47:41,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,83,10,"
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
","['\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n', '\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.138533115386963,2025-04-29T12:53:04,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
SELECT * 
FROM allwise 
WHERE oid_catalog = (
    SELECT oid_catalog 
    FROM object 
    WHERE oid = 'ZTF21aazqwxv'
)
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",130.01229739189148,2025-05-22T00:49:55,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,,,84,0,"SELECT
    oid, xmatch.oid_catalog, dist,
    w1mpro, w2mpro, w3mpro, w4mpro
FROM
    xmatch INNER JOIN
    allwise
    ON xmatch.oid_catalog = allwise.oid_catalog
WHERE
    xmatch.oid = 'ZTF19aascdol'",,,,,"[            oid          oid_catalog      dist  w1mpro  w2mpro  w3mpro  w4mpro
0  ZTF19aascdol  J154334.93+152539.5  0.000043  15.286  14.354  11.747   8.611]",,3.2303967475891113,2025-05-22T00:50:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,84,1,"
SELECT 
    object.oid AS ztf_identifier, 
    xmatch.oid_catalog AS allwise_catalog_identifier, 
    xmatch.dist AS distance_between_counterparts, 
    allwise.w1mpro AS w1_magnitude, 
    allwise.w2mpro AS w2_magnitude, 
    allwise.w3mpro AS w3_magnitude, 
    allwise.w4mpro AS w4_magnitude
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol'
    AND xmatch.catid = 'ALLWISE' -- Assuming 'ALLWISE' is the catalog identifier in xmatch
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.15969729423523,2025-04-29T12:53:20,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,8.245276927947998,2025-05-22T00:50:12,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,2,"
SELECT 
    o.oid AS ztf_identifier, 
    xm.oid_catalog AS allwise_catalog_identifier, 
    xm.dist AS distance_between_counterparts, 
    aw.w1mpro AS w1_magnitude, 
    aw.w2mpro AS w2_magnitude, 
    aw.w3mpro AS w3_magnitude, 
    aw.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch xm ON o.oid = xm.oid
INNER JOIN 
    allwise aw ON xm.oid_catalog = aw.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol' 
    AND xm.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.321882486343384,2025-04-29T12:53:37,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,7.970896244049072,2025-05-22T00:50:25,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,3,"
SELECT 
    o.oid AS ztf_object_id, 
    xm.oid_catalog AS allwise_catalog_id, 
    xm.dist AS distance_between_counterparts, 
    aw.w1mpro AS w1_magnitude, 
    aw.w2mpro AS w2_magnitude, 
    aw.w3mpro AS w3_magnitude, 
    aw.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch xm ON o.oid = xm.oid
INNER JOIN 
    allwise aw ON xm.oid_catalog = aw.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.124496221542358,2025-04-29T12:53:52,"[  ztf_object_id   allwise_catalog_id  distance_between_counterparts  \
0  ZTF19aascdol  J154334.93+152539.5                       0.000043   

   w1_magnitude  w2_magnitude  w3_magnitude  w4_magnitude  
0        15.286        14.354        11.747         8.611  ]",,8.024137020111084,2025-05-22T00:50:39,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,4,"
SELECT 
    object.oid AS ztf_identifier, 
    allwise.oid_catalog AS allwise_catalog_identifier, 
    xmatch.dist AS distance_between_counterparts, 
    allwise.w1mpro AS w1_magnitude, 
    allwise.w2mpro AS w2_magnitude, 
    allwise.w3mpro AS w3_magnitude, 
    allwise.w4mpro AS w4_magnitude
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol' 
    AND xmatch.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,15.508123397827148,2025-04-29T12:54:08,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,9.568174600601196,2025-05-22T00:50:53,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,5,"
SELECT 
    o.oid AS ztf_identifier, 
    x.oid_catalog AS allwise_catalog_identifier, 
    x.dist AS distance_between_counterparts, 
    a.w1mpro AS w1_magnitude, 
    a.w2mpro AS w2_magnitude, 
    a.w3mpro AS w3_magnitude, 
    a.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch x ON o.oid = x.oid
INNER JOIN 
    allwise a ON x.oid_catalog = a.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol' 
    AND x.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.78112506866455,2025-04-29T12:54:21,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,8.703130722045898,2025-05-22T00:51:05,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,6,"
SELECT 
    object.oid AS ztf_identifier, 
    xmatch.oid_catalog AS allwise_catalog_identifier, 
    xmatch.dist AS distance_between_counterparts, 
    allwise.w1mpro AS w1_magnitude, 
    allwise.w2mpro AS w2_magnitude, 
    allwise.w3mpro AS w3_magnitude, 
    allwise.w4mpro AS w4_magnitude
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol' 
    AND xmatch.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.648285865783691,2025-04-29T12:54:34,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,8.110328197479248,2025-05-22T00:51:19,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,7,"
SELECT 
    o.oid AS ztf_identifier, 
    xm.oid_catalog AS allwise_catalog_identifier, 
    xm.dist AS distance_between_counterparts, 
    aw.w1mpro AS w1_magnitude, 
    aw.w2mpro AS w2_magnitude, 
    aw.w3mpro AS w3_magnitude, 
    aw.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch xm ON o.oid = xm.oid
INNER JOIN 
    allwise aw ON xm.oid_catalog = aw.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol' 
    AND xm.catid = 'ALLWISE'  -- Assuming 'ALLWISE' is the catalog identifier in xmatch
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,12.70211148262024,2025-04-29T12:54:47,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,8.107210159301758,2025-05-22T00:51:31,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,8,"
SELECT 
    o.oid AS ztf_identifier, 
    xm.oid_catalog AS allwise_catalog_identifier, 
    xm.dist AS distance_between_counterparts, 
    aw.w1mpro AS w1_magnitude, 
    aw.w2mpro AS w2_magnitude, 
    aw.w3mpro AS w3_magnitude, 
    aw.w4mpro AS w4_magnitude
FROM 
    object o
INNER JOIN 
    xmatch xm ON o.oid = xm.oid
INNER JOIN 
    allwise aw ON xm.oid_catalog = aw.oid_catalog
WHERE 
    o.oid = 'ZTF19aascdol' 
    AND xm.catid = 'ALLWISE' -- Assuming 'ALLWISE' is the identifier for the ALLWISE catalog in xmatch
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.13951349258423,2025-04-29T12:55:04,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,7.776358604431152,2025-05-22T00:51:42,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,9,"
SELECT 
    object.oid AS ztf_identifier, 
    xmatch.oid_catalog AS allwise_catalog_identifier, 
    xmatch.dist AS distance_between_counterparts, 
    allwise.w1mpro AS w1_magnitude, 
    allwise.w2mpro AS w2_magnitude, 
    allwise.w3mpro AS w3_magnitude, 
    allwise.w4mpro AS w4_magnitude
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol' 
    AND xmatch.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,14.540286302566528,2025-04-29T12:55:20,"[Empty DataFrame
Columns: [oid, allwise_catalog_identifier, distance_between_counterparts, w1_magnitude, w2_magnitude, w3_magnitude, w4_magnitude]
Index: []]",,8.19334626197815,2025-05-22T00:51:54,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,84,10,"
SELECT 
    object.oid, 
    xmatch.oid_catalog, 
    xmatch.dist, 
    allwise.w1mpro, 
    allwise.w2mpro, 
    allwise.w3mpro, 
    allwise.w4mpro
FROM 
    object
INNER JOIN 
    xmatch ON object.oid = xmatch.oid
INNER JOIN 
    allwise ON xmatch.oid_catalog = allwise.oid_catalog
WHERE 
    object.oid = 'ZTF19aascdol' 
    AND xmatch.catid = 'ALLWISE'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', ""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n"", '\nCREATE TABLE allwise (\n    oid_catalog VARCHAR PRIMARY KEY, /* object Id inside catalog, correspond to column: designation  in ALLWISE : Sexagesimal, equatorial position-based source name in the form: hhmmss.ss+ddmmss.s. The full naming convention for AllWISE Source Catalog sources has the form ""WISEA  Jhhmmss.ss+ddmmss.s,"" where ""WISEA"" indicates the source is from the AllWISE Source Catalog, and ""J"" indicates the position is J2000. The ""WISEA"" acronym is not listed explicitly in the designation column. */\n    ra DOUBLE PRECISION NOT NULL, /* J2000 right ascension with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    dec DOUBLE PRECISION NOT NULL, /* J2000 declination with respect to the 2MASS PSC reference frame from the non-moving source extraction. */\n    w1mpro DOUBLE PRECISION, /* W1 magnitude measured with profile-fitting photometry, or the magnitude of the 95% confidence brightness upper limit if the W1 flux measurement has SNR<2. This column is null if the source is nominally detected in W1, but no useful brightness estimate could be made. */\n    w2mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w3mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w4mpro DOUBLE PRECISION, /* analogous to w1mpro */\n    w1sigmpro DOUBLE PRECISION, /* W1 profile-fit photometric measurement uncertainty in mag units. This column is null if the W1 profile-fit magnitude is a 95% confidence upper limit or if the source is not measurable. */\n    w2sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w3sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    w4sigmpro DOUBLE PRECISION, /* analogous to w1sigmpro */\n    j_m_2mass DOUBLE PRECISION, /* 2MASS J-band magnitude or magnitude upper limit of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band magnitude entry is ""null"". */\n    h_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    k_m_2mass DOUBLE PRECISION, /* analogous to j_m_2mass */\n    j_msig_2mass DOUBLE PRECISION, /* 2MASS J-band corrected photometric uncertainty of the associated 2MASS PSC source. This column is ""null"" if there is no associated 2MASS PSC source or if the 2MASS PSC J-band uncertainty entry is ""null"". */\n    h_msig_2mass DOUBLE PRECISION, /* analogous to j_msig_2mass */\n    k_msig_2mass DOUBLE PRECISION /* analogous to j_msig_2mass */\n);\n\nCREATE INDEX ix_allwise_dec ON allwise USING btree (dec);\nCREATE INDEX ix_allwise_ra ON allwise USING btree (ra);\n']",medium,17.595354080200195,2025-04-29T12:55:38,"[Empty DataFrame
Columns: [oid, oid_catalog, dist, w1mpro, w2mpro, w3mpro, w4mpro]
Index: []]",,10.623356580734253,2025-05-22T00:52:10,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,96,0,"SELECT
    ss_ztf.*, detection.mjd, detection.fid,
    detection.isdiffpos, detection.ra, detection.dec,
    detection.magpsf, detection.sigmapsf
FROM
    ss_ztf INNER JOIN
    detection
    ON ss_ztf.oid = detection.oid
    AND ss_ztf.candid = detection.candid
WHERE
    ssnamenr IN ('2003FP134','2009UK56')
    AND ssdistnr < 2
ORDER BY ssnamenr, mjd",,,,,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  ]",,27.962526321411133,2025-05-22T00:52:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,96,1,"
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get required detection details
SELECT 
    ss_ztf.*, 
    detection.mjd, 
    detection.fid, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf, 
    detection.sigmapsf
FROM 
    filtered_ss_ztf AS ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
ORDER BY 
    ss_ztf.ssnamenr, detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,16.867366313934326,2025-04-29T12:55:55,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  ]",,14.2909414768219,2025-05-22T00:53:00,1.0,1.0,0.6666666666666666,0.6666666666666666,1.0,0.0
0.16.3,gpt-4o,v1,96,2,"
-- Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Main query to join filtered ss_ztf with detection table
SELECT 
    ss.*,
    d.mjd AS detection_date,
    d.fid AS filter_identifier,
    d.isdiffpos,
    d.ra,
    d.dec,
    d.magpsf AS difference_magnitude,
    d.sigmapsf AS magnitude_uncertainty
FROM 
    filtered_ss_ztf ss
INNER JOIN 
    detection d ON ss.candid = d.candid
ORDER BY 
    ss.ssnamenr, d.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.1252236366272,2025-04-29T12:56:13,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  
27             18.967524               0.107702  ]",,13.65751576423645,2025-05-22T00:53:20,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,96,3,"
-- Subquery to filter ss_ztf for relevant Solar System objects within 2 arcseconds
WITH relevant_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
    AND ssdistnr <= 2
)

-- Main query to join with detection and retrieve required columns
SELECT 
    ss_ztf.*, 
    detection.mjd AS detection_date, 
    detection.fid AS filter_identifier, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS difference_magnitude_uncertainty
FROM 
    relevant_ss_ztf
INNER JOIN 
    detection ON relevant_ss_ztf.candid = detection.candid
ORDER BY 
    ss_ztf.ssnamenr, detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,15.968383312225342,2025-04-29T12:56:29,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  ]",,11.435253143310547,2025-05-22T00:53:38,1.0,1.0,0.6666666666666666,0.6666666666666666,1.0,0.0
0.16.3,gpt-4o,v1,96,4,"
-- Retrieve all detections for ZTF objects within 2 arcseconds of the Solar System identifiers '2003FP134' and '2009UK56'
SELECT 
    ss_ztf.*, 
    detection.mjd AS detection_date, 
    detection.fid AS filter_identifier, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS magnitude_uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')
    AND ss_ztf.ssdistnr <= 2
ORDER BY 
    ss_ztf.ssnamenr, 
    detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,16.48454785346985,2025-04-29T12:56:46,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  
27             18.967524               0.107702  ]",,14.12300968170166,2025-05-22T00:53:59,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,96,5,"
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get relevant detections
SELECT 
    ss_ztf.*, 
    detection.mjd, 
    detection.fid, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf, 
    detection.sigmapsf
FROM 
    filtered_ss_ztf AS ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid

-- Step 3: Order the results by solar system object name and detection date
ORDER BY 
    ss_ztf.ssnamenr, 
    detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,21.53211498260498,2025-04-29T12:57:08,[None],"(psycopg2.errors.UndefinedTable) missing FROM-clause entry for table ""ss_ztf""
LINE 12:     ss_ztf.*, 
             ^

[SQL: 
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get relevant detections
SELECT 
    ss_ztf.*, 
    detection.mjd AS detection_date, 
    detection.fid AS filter_identifier, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS difference_magnitude_uncertainty
FROM 
    filtered_ss_ztf
INNER JOIN 
    detection ON filtered_ss_ztf.oid = detection.oid

-- Step 3: Order the results by solar system object name and detection date
ORDER BY 
    filtered_ss_ztf.ssnamenr, 
    detection.mjd
]
(Background on this error at: https://sqlalche.me/e/20/f405)",12.95491886138916,2025-05-22T00:54:18,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,96,6,"
-- Step 1: Filter ss_ztf for specific solar system identifiers and distance
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table and select required columns
SELECT 
    ss_ztf.*,
    detection.mjd,
    detection.fid,
    detection.isdiffpos,
    detection.ra,
    detection.dec,
    detection.magpsf,
    detection.sigmapsf
FROM filtered_ss_ztf AS ss_ztf
INNER JOIN detection ON ss_ztf.candid = detection.candid

-- Step 3: Sort by MPC name and detection date
ORDER BY ss_ztf.ssnamenr, detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,32.24034404754639,2025-04-29T12:57:40,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

             mjd  fid  isdiffpos          ra        dec     magpsf  sigmapsf  
0   59349.376262    1          1  256.824875 -25.974222  20.192154  0.178280  
1   59362.313553    2          1  254.248201 -24.971674  18.976067  0.170550  
2   59363.376562    2          1  254.000931 -24.876152  19.098774  0.178708  
3   59366.381042    2          1  253.289819 -24.597101  19.052930  0.091880  
4   59368.399213    2          1  252.804054 -24.403010  18.866552  0.111349  
5   59373.365035    2          1  251.609834 -23.908624  19.000805  0.124175  
6   59375.376887    2          1  251.135458 -23.703780  18.983727  0.160271  
7   59378.308762    2          1  250.466414 -23.403652  19.122366  0.093317  
8   59382.315451    2          1  249.608787 -22.995193  19.243404  0.105018  
9   59384.314792    2          1  249.212822 -22.794441  19.301159  0.215448  
10  59394.314606    2          1  247.645013 -21.856142  19.525230  0.168116  
11  59400.209988    2          1  247.099310 -21.379044  19.692917  0.152464  
12  59110.469919    2          1   39.441994  25.290333  20.403624  0.171651  
13  59116.353241    2          1   39.192099  24.766625  20.593506  0.179858  
14  59134.426829    2          1   37.167419  22.314968  20.169308  0.190793  
15  59136.319849    2          1   36.861685  21.984306  20.084251  0.143195  
16  59136.380336    1          1   36.851189  21.973495  20.582052  0.217129  
17  59138.347685    2          1   36.517718  21.615395  20.017073  0.141530  
18  59140.400255    1          1   36.154655  21.227094  20.329580  0.195694  
19  59144.391759    1          1   35.415444  20.432652  20.295746  0.186697  
20  59144.410544    2          1   35.411754  20.428770  19.843100  0.108691  
21  59157.235995    2          1   32.902432  17.607816  19.573830  0.144548  
22  59164.308414    2          1   31.572239  15.965531  19.879513  0.182747  
23  59164.344097    1          1   31.565624  15.957268  20.331053  0.161874  
24  59166.291470    2          1   31.223077  15.505689  20.051088  0.208385  
25  59170.266956    2          1   30.566547  14.594135  19.858680  0.133551  
26  59172.239479    1          1   30.265756  14.149791  20.297800  0.209505  
27  59422.421759    2          1   31.223340  15.505782  18.967524  0.107702  ]",,13.524712085723877,2025-05-22T00:54:38,1.037037037037037,0.9642857142857143,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,96,7,"
-- Step 1: Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Step 2: Join with detection table to get the required columns
SELECT 
    ss_ztf.*,
    detection.mjd AS detection_date,
    detection.fid AS filter_identifier,
    detection.isdiffpos,
    detection.ra,
    detection.dec,
    detection.magpsf AS difference_magnitude,
    detection.sigmapsf AS difference_magnitude_uncertainty
FROM 
    filtered_ss_ztf AS ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
ORDER BY 
    ss_ztf.ssnamenr, detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.926388025283813,2025-04-29T12:58:03,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  ]",,13.638963222503662,2025-05-22T00:54:58,1.0,1.0,0.6666666666666666,0.6666666666666666,1.0,0.0
0.16.3,gpt-4o,v1,96,8,"
-- Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
    AND ssdistnr <= 2
)

-- Main query to join filtered ss_ztf with detection table
SELECT 
    ss.*,
    d.mjd AS detection_date,
    d.fid AS filter_identifier,
    d.isdiffpos,
    d.ra,
    d.dec,
    d.magpsf AS difference_magnitude,
    d.sigmapsf AS magnitude_uncertainty
FROM 
    filtered_ss_ztf ss
INNER JOIN 
    detection d ON ss.candid = d.candid
ORDER BY 
    ss.ssnamenr, d.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,23.949874877929688,2025-04-29T12:58:27,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  magnitude_uncertainty  
0              20.192154               0.178280  
1              18.976067               0.170550  
2              19.098774               0.178708  
3              19.052930               0.091880  
4              18.866552               0.111349  
5              19.000805               0.124175  
6              18.983727               0.160271  
7              19.122366               0.093317  
8              19.243404               0.105018  
9              19.301159               0.215448  
10             19.525230               0.168116  
11             19.692917               0.152464  
12             20.403624               0.171651  
13             20.593506               0.179858  
14             20.169308               0.190793  
15             20.084251               0.143195  
16             20.582052               0.217129  
17             20.017073               0.141530  
18             20.329580               0.195694  
19             20.295746               0.186697  
20             19.843100               0.108691  
21             19.573830               0.144548  
22             19.879513               0.182747  
23             20.331053               0.161874  
24             20.051088               0.208385  
25             19.858680               0.133551  
26             20.297800               0.209505  
27             18.967524               0.107702  ]",,13.821649551391602,2025-05-22T00:55:18,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,96,9,"
-- Subquery to filter ss_ztf for specific solar system objects within 2 arcseconds
WITH filtered_ss_ztf AS (
    SELECT *
    FROM ss_ztf
    WHERE ssnamenr IN ('2003FP134', '2009UK56')
      AND ssdistnr <= 2
)

-- Main query to join with detection and select required columns
SELECT 
    ss.*,
    d.mjd AS detection_date,
    d.fid AS filter_identifier,
    d.isdiffpos,
    d.ra,
    d.dec,
    d.magpsf AS difference_magnitude,
    d.sigmapsf AS difference_magnitude_uncertainty
FROM 
    filtered_ss_ztf ss
INNER JOIN 
    detection d ON ss.candid = d.candid
ORDER BY 
    ss.ssnamenr, d.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.15677261352539,2025-04-29T12:58:46,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  
27             18.967524                          0.107702  ]",,14.119109630584717,2025-05-22T00:55:39,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,gpt-4o,v1,96,10,"
-- Retrieve all detections for ZTF objects within 2 arcseconds of the solar system identifiers '2003FP134' and '2009UK56'
SELECT 
    ss_ztf.*, 
    detection.mjd AS detection_date, 
    detection.fid AS filter_identifier, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS difference_magnitude_uncertainty
FROM 
    ss_ztf
INNER JOIN 
    detection ON ss_ztf.candid = detection.candid
WHERE 
    ss_ztf.ssnamenr IN ('2003FP134', '2009UK56')
    AND ss_ztf.ssdistnr <= 2
ORDER BY 
    ss_ztf.ssnamenr, 
    detection.mjd
","[""CREATE TABLE ss_ztf ( /* this table contains information about the closest known solar system object */\n    oid VARCHAR REFERENCES object(oid),\n    candid BIGINT NOT NULL, /* unique candidate identifier */\n    ssdistnr DOUBLE PRECISION, /* distance to nearest known solar system object */\n    ssmagnr DOUBLE PRECISION, /* magnitude of nearest known solar system object */\n    ssnamenr VARCHAR /* name to nearest known solar system object. If the object is not a known solar system object, this field is 'null' (VARCHAR) */\n    PRIMARY KEY (oid)\n);\nCREATE INDEX ix_ss_ztf_candid ON ss_ztf USING btree (candid);\nCREATE INDEX ix_ss_ztf_ssnamenr ON ss_ztf USING btree (ssnamenr);\n"", 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,16.583386659622192,2025-04-29T12:59:03,"[             oid               candid  ssdistnr  ssmagnr   ssnamenr  \
0   ZTF21abbsmyp  1595376262715015044       0.0     19.5  2003FP134   
1   ZTF21abcqekm  1608313551615015025       0.0     19.0  2003FP134   
2   ZTF21abculin  1609376562915015021       0.0     19.0  2003FP134   
3   ZTF21abdihfx  1612381041715015014       0.0     18.9  2003FP134   
4   ZTF21abdulcm  1614399211715015002       0.0     18.8  2003FP134   
5   ZTF21abeywpa  1619365033915015076       0.0     19.1  2003FP134   
6   ZTF21abfkygj  1621376883815015021       0.0     19.2  2003FP134   
7   ZTF21abgavxk  1624308764315015004       0.0     19.3  2003FP134   
8   ZTF21abgxhjg  1628315454015015046       0.0     19.5  2003FP134   
9   ZTF21abhfyvv  1630314794115015013       0.0     19.5  2003FP134   
10  ZTF21abiljll  1640314606315015016       0.0     19.8  2003FP134   
11  ZTF21abjphvf  1646209986215015001       0.0     20.0  2003FP134   
12  ZTF20acawpht  1356469912115015034       0.0     20.7   2009UK56   
13  ZTF20acdqnho  1362353242215015020       0.0     20.5   2009UK56   
14  ZTF20acilssf  1380426825615015010       0.0     20.1   2009UK56   
15  ZTF20acjbakd  1382319845615015022       0.0     20.1   2009UK56   
16  ZTF20acjdjlc  1382380335615015023       0.0     20.1   2009UK56   
17  ZTF20acjxpmq  1384347685815015007       0.0     20.0   2009UK56   
18  ZTF20ackrekd  1386400255815015038       0.0     20.0   2009UK56   
19  ZTF20acmpwqx  1390391754415015016       0.0     19.9   2009UK56   
20  ZTF20acmriqf  1390410544415015011       0.0     19.9   2009UK56   
21  ZTF20acoyuab  1403235991815015005       0.0     19.7   2009UK56   
22  ZTF20acpljmx  1410308410715015003       0.0     19.8   2009UK56   
23  ZTF20acpmmxt  1410344090715015002       0.0     19.8   2009UK56   
24  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   
25  ZTF20acrfjpp  1416266955415015001       0.0     19.9   2009UK56   
26  ZTF20acruhoq  1418239475415015010       0.0     20.0   2009UK56   
27  ZTF20acqazko  1412291460615015021       0.0     19.8   2009UK56   

    detection_date  filter_identifier  isdiffpos          ra        dec  \
0     59349.376262                  1          1  256.824875 -25.974222   
1     59362.313553                  2          1  254.248201 -24.971674   
2     59363.376562                  2          1  254.000931 -24.876152   
3     59366.381042                  2          1  253.289819 -24.597101   
4     59368.399213                  2          1  252.804054 -24.403010   
5     59373.365035                  2          1  251.609834 -23.908624   
6     59375.376887                  2          1  251.135458 -23.703780   
7     59378.308762                  2          1  250.466414 -23.403652   
8     59382.315451                  2          1  249.608787 -22.995193   
9     59384.314792                  2          1  249.212822 -22.794441   
10    59394.314606                  2          1  247.645013 -21.856142   
11    59400.209988                  2          1  247.099310 -21.379044   
12    59110.469919                  2          1   39.441994  25.290333   
13    59116.353241                  2          1   39.192099  24.766625   
14    59134.426829                  2          1   37.167419  22.314968   
15    59136.319849                  2          1   36.861685  21.984306   
16    59136.380336                  1          1   36.851189  21.973495   
17    59138.347685                  2          1   36.517718  21.615395   
18    59140.400255                  1          1   36.154655  21.227094   
19    59144.391759                  1          1   35.415444  20.432652   
20    59144.410544                  2          1   35.411754  20.428770   
21    59157.235995                  2          1   32.902432  17.607816   
22    59164.308414                  2          1   31.572239  15.965531   
23    59164.344097                  1          1   31.565624  15.957268   
24    59166.291470                  2          1   31.223077  15.505689   
25    59170.266956                  2          1   30.566547  14.594135   
26    59172.239479                  1          1   30.265756  14.149791   
27    59422.421759                  2          1   31.223340  15.505782   

    difference_magnitude  difference_magnitude_uncertainty  
0              20.192154                          0.178280  
1              18.976067                          0.170550  
2              19.098774                          0.178708  
3              19.052930                          0.091880  
4              18.866552                          0.111349  
5              19.000805                          0.124175  
6              18.983727                          0.160271  
7              19.122366                          0.093317  
8              19.243404                          0.105018  
9              19.301159                          0.215448  
10             19.525230                          0.168116  
11             19.692917                          0.152464  
12             20.403624                          0.171651  
13             20.593506                          0.179858  
14             20.169308                          0.190793  
15             20.084251                          0.143195  
16             20.582052                          0.217129  
17             20.017073                          0.141530  
18             20.329580                          0.195694  
19             20.295746                          0.186697  
20             19.843100                          0.108691  
21             19.573830                          0.144548  
22             19.879513                          0.182747  
23             20.331053                          0.161874  
24             20.051088                          0.208385  
25             19.858680                          0.133551  
26             20.297800                          0.209505  
27             18.967524                          0.107702  ]",,13.781479120254517,2025-05-22T00:55:59,1.037037037037037,0.9642857142857143,0.6666666666666666,0.6666666666666666,0.0,0.0
0.16.3,,,67,0,"SELECT
    *
FROM
    gaia_ztf
WHERE
    oid IN ('ZTF18acxlskz','ZTF22aanppbi','ZTF22abunrft')
    AND neargaia < 1.5",,,,,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,3.4264988899230957,2025-05-22T00:56:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,1,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.134937286376953,2025-04-29T12:59:06,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.47609543800354,2025-05-22T00:56:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,2,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,2.610205173492432,2025-04-29T12:59:09,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.4109392166137695,2025-05-22T00:56:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,3,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.04867959022522,2025-04-29T12:59:12,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.52202296257019,2025-05-22T00:56:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,4,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,4.82270073890686,2025-04-29T12:59:17,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.488474369049072,2025-05-22T00:56:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,5,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
  AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,7.130168437957764,2025-04-29T12:59:25,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.483392238616943,2025-05-22T00:57:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,6,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,5.913736581802368,2025-04-29T12:59:31,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.508625507354736,2025-05-22T00:57:13,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,7,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
  AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.2186646461486816,2025-04-29T12:59:34,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.947912216186523,2025-05-22T00:57:25,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,8,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,7.56520676612854,2025-04-29T12:59:42,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.455723524093628,2025-05-22T00:57:36,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,9,"
SELECT *
FROM gaia_ztf
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft')
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.32757306098938,2025-04-29T12:59:45,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.442789554595947,2025-05-22T00:57:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,67,10,"
SELECT * 
FROM gaia_ztf 
WHERE oid IN ('ZTF18acxlskz', 'ZTF22aanppbi', 'ZTF22abunrft') 
AND neargaia <= 1.5
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE gaia_ztf (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate */\n    neargaia DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [arcsec] */\n    neargaiabright DOUBLE PRECISION, /* Distance to closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [arcsec] */\n    maggaia DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog irrespective of magnitude; if exists within 90 arcsec [mag] */\n    maggaiabright DOUBLE PRECISION, /* Gaia (G-band) magnitude of closest source from Gaia DR1 catalog brighter than magnitude 14; if exists within 90 arcsec [mag] */\n    unique1 BOOLEAN NOT NULL /* whether the closest object has changed w.r.t the first alert */\n    PRIMARY KEY (oid)\n);\n']",simple,3.92920446395874,2025-04-29T12:59:50,"[            oid               candid  neargaia  neargaiabright    maggaia  \
0  ZTF18acxlskz  1917201552615010028   0.74125          -999.0  15.321053   

   maggaiabright  unique1  
0         -999.0    False  ]",,7.397303819656372,2025-05-22T00:57:59,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,55,0,"SELECT
    *
FROM
    object
WHERE
    oid = 'ZTF20aatxryt'",,,,,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,3.2818636894226074,2025-05-22T00:58:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,1,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.765812397003174,2025-04-29T12:59:52,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.209370136260986,2025-05-22T00:58:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,2,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.7249984741210938,2025-04-29T12:59:55,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.311904668807983,2025-05-22T00:58:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,3,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.4900877475738525,2025-04-29T12:59:58,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.928175687789917,2025-05-22T00:58:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,4,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.181385040283203,2025-04-29T13:00:01,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.217164039611816,2025-05-22T00:58:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,5,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.690774917602539,2025-04-29T13:00:04,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.339702606201172,2025-05-22T00:59:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,6,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,4.305471181869507,2025-04-29T13:00:09,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.351841926574707,2025-05-22T00:59:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,7,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.8931353092193604,2025-04-29T13:00:12,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.424432277679443,2025-05-22T00:59:27,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,8,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.3809313774108887,2025-04-29T13:00:14,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.841754198074341,2025-05-22T00:59:39,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,9,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,2.938786506652832,2025-04-29T13:00:17,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.396251201629639,2025-05-22T00:59:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,55,10,"
SELECT * 
FROM object 
WHERE oid = 'ZTF20aatxryt'
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n']",simple,3.011510372161865,2025-04-29T13:00:20,"[            oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0  ZTF20aatxryt       177       738  58915.212188  59291.286308       True   

   stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  sigmara  \
0    False    92  0.633835      0.611086  ...  167.946571  29.385115  0.00005   

   sigmadec    deltajd      firstmjd       lastmjd      step_id_corr  diffpos  \
0  0.000048  376.07412  58915.212188  59291.286308  correction_0.0.1     True   

  reference_change  
0            False  

[1 rows x 22 columns]]",,7.174681186676025,2025-05-22T01:00:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,47,0,"SELECT
    oid, candid, fid, mjd, isdiffpos, ra, dec, magpsf, sigmapsf, rb
FROM
    detection
WHERE
    oid IN ('ZTF23aaawbsc','ZTF21abxlmuw')
    AND rb > 0.7
ORDER BY oid, mjd",,,,,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,3.854123830795288,2025-05-22T01:00:08,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,1,"
SELECT 
    o.oid AS ztf_identifier, 
    d.candid AS candidate_identifier, 
    d.fid AS filter_identifier, 
    d.mjd AS detection_date, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb AS real_bogus_score
FROM 
    detection d
INNER JOIN 
    object o ON d.oid = o.oid
WHERE 
    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
ORDER BY 
    o.oid, d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,14.447340726852415,2025-04-29T13:00:35,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,8.810906648635864,2025-05-22T01:00:22,1.0,1.0,0.5,0.5,1.0,0.0
0.16.3,gpt-4o,v1,47,2,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
INNER JOIN 
    object o ON d.oid = o.oid
WHERE 
    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.110684633255005,2025-04-29T13:00:50,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,8.323643445968628,2025-05-22T01:00:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,3,"
SELECT 
    o.oid AS ztf_identifier, 
    d.candid AS candidate_identifier, 
    d.fid AS filter_identifier, 
    d.mjd AS detection_date, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb AS real_bogus_score
FROM 
    detection d
INNER JOIN 
    object o ON d.oid = o.oid
WHERE 
    o.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
ORDER BY 
    o.oid, d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,15.650835752487184,2025-04-29T13:01:07,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec     magpsf  sigmapsf  real_bogus_score  
0            1   21.323490  22.390380  20.659400  0.232067          0.712857  
1            1   21.323480  22.390360  20.626290  0.211267          0.822857  
2            1   21.323425  22.390396  20.667300  0.234949          0.785714  
3            1   21.323386  22.390342  20.724100  0.274779          0.797143  
4            1   21.323460  22.390334  19.865335  0.192379          0.715714  
..         ...         ...        ...        ...       ...               ...  
157          1  265.214006  66.206344  19.306845  0.090955          0.787143  
158          1  265.213977  66.206306  19.475810  0.106966          0.860000  
159          1  265.213962  66.206365  20.027710  0.166629          0.808571  
160          1  265.214055  66.206338  20.245500  0.207126          0.714286  
161          1  265.213992  66.206356  19.808226  0.112136          0.790000  

[162 rows x 10 columns]]",,8.526277542114258,2025-05-22T01:00:47,1.0,1.0,0.5,0.5,1.0,0.0
0.16.3,gpt-4o,v1,47,4,"
SELECT 
    oid, 
    candid, 
    fid, 
    mjd, 
    isdiffpos, 
    ra, 
    dec, 
    magpsf, 
    sigmapsf, 
    rb
FROM 
    detection
WHERE 
    oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND rb > 0.7
ORDER BY 
    oid, 
    mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,18.014184713363647,2025-04-29T13:01:26,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,8.35551905632019,2025-05-22T01:01:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,5,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,12.983172178268433,2025-04-29T13:01:39,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.00359320640564,2025-05-22T01:01:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,6,"
SELECT 
    object.oid AS ztf_identifier, 
    detection.candid AS candidate_identifier, 
    detection.fid AS filter_identifier, 
    detection.mjd AS detection_date, 
    detection.isdiffpos, 
    detection.ra, 
    detection.dec, 
    detection.magpsf AS difference_magnitude, 
    detection.sigmapsf AS magnitude_uncertainty, 
    detection.rb AS real_bogus_score
FROM 
    object
INNER JOIN 
    detection ON object.oid = detection.oid
WHERE 
    object.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND detection.rb > 0.7
ORDER BY 
    object.oid, detection.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,16.038007020950317,2025-04-29T13:01:55,"[              oid  candidate_identifier  filter_identifier  detection_date  \
0    ZTF21abxlmuw   1705387805715015007                  2    59459.387801   
1    ZTF21abxlmuw   1709365085715015008                  1    59463.365081   
2    ZTF21abxlmuw   1711400435715015009                  1    59465.400440   
3    ZTF21abxlmuw   1734359965715015007                  1    59488.359965   
4    ZTF21abxlmuw   2055474085715015001                  2    59809.474086   
..            ...                   ...                ...             ...   
157  ZTF23aaawbsc   2411222961115015002                  2    60165.222963   
158  ZTF23aaawbsc   2415300841115015002                  2    60169.300845   
159  ZTF23aaawbsc   2417329831115015004                  1    60171.329838   
160  ZTF23aaawbsc   2419217801115015003                  1    60173.217801   
161  ZTF23aaawbsc   2424258351115015008                  2    60178.258356   

     isdiffpos          ra        dec  difference_magnitude  \
0            1   21.323490  22.390380             20.659400   
1            1   21.323480  22.390360             20.626290   
2            1   21.323425  22.390396             20.667300   
3            1   21.323386  22.390342             20.724100   
4            1   21.323460  22.390334             19.865335   
..         ...         ...        ...                   ...   
157          1  265.214006  66.206344             19.306845   
158          1  265.213977  66.206306             19.475810   
159          1  265.213962  66.206365             20.027710   
160          1  265.214055  66.206338             20.245500   
161          1  265.213992  66.206356             19.808226   

     magnitude_uncertainty  real_bogus_score  
0                 0.232067          0.712857  
1                 0.211267          0.822857  
2                 0.234949          0.785714  
3                 0.274779          0.797143  
4                 0.192379          0.715714  
..                     ...               ...  
157               0.090955          0.787143  
158               0.106966          0.860000  
159               0.166629          0.808571  
160               0.207126          0.714286  
161               0.112136          0.790000  

[162 rows x 10 columns]]",,8.433468103408813,2025-05-22T01:01:27,1.0,1.0,0.3,0.3,1.0,0.0
0.16.3,gpt-4o,v1,47,7,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw') 
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,14.472642660140991,2025-04-29T13:02:10,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,8.594555854797363,2025-05-22T01:01:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,8,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,14.507857322692873,2025-04-29T13:02:24,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,8.54190993309021,2025-05-22T01:01:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,9,"
SELECT 
    d.oid,          -- ZTF identifier
    d.candid,       -- Candidate identifier
    d.fid,          -- Filter identifier
    d.mjd,          -- Detection date
    d.isdiffpos,    -- Isdiffpos flag
    d.ra,           -- Detection RA
    d.dec,          -- Detection Dec
    d.magpsf,       -- Difference magnitude
    d.sigmapsf,     -- Magnitude uncertainty
    d.rb            -- Real/bogus score
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')  -- Filter for specific ZTF identifiers
    AND d.rb > 0.7                             -- Filter for real/bogus score greater than 0.7
ORDER BY 
    d.oid,                                     -- Sort by ZTF identifier
    d.mjd                                     -- Then sort by detection date
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,16.603166341781616,2025-04-29T13:02:41,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,8.913523197174072,2025-05-22T01:02:06,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,47,10,"
SELECT 
    d.oid, 
    d.candid, 
    d.fid, 
    d.mjd, 
    d.isdiffpos, 
    d.ra, 
    d.dec, 
    d.magpsf, 
    d.sigmapsf, 
    d.rb
FROM 
    detection d
WHERE 
    d.oid IN ('ZTF23aaawbsc', 'ZTF21abxlmuw')
    AND d.rb > 0.7
ORDER BY 
    d.oid, 
    d.mjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",medium,20.652994871139526,2025-04-29T13:03:02,"[              oid               candid  fid           mjd  isdiffpos  \
0    ZTF21abxlmuw  1705387805715015007    2  59459.387801          1   
1    ZTF21abxlmuw  1709365085715015008    1  59463.365081          1   
2    ZTF21abxlmuw  1711400435715015009    1  59465.400440          1   
3    ZTF21abxlmuw  1734359965715015007    1  59488.359965          1   
4    ZTF21abxlmuw  2055474085715015001    2  59809.474086          1   
..            ...                  ...  ...           ...        ...   
157  ZTF23aaawbsc  2411222961115015002    2  60165.222963          1   
158  ZTF23aaawbsc  2415300841115015002    2  60169.300845          1   
159  ZTF23aaawbsc  2417329831115015004    1  60171.329838          1   
160  ZTF23aaawbsc  2419217801115015003    1  60173.217801          1   
161  ZTF23aaawbsc  2424258351115015008    2  60178.258356          1   

             ra        dec     magpsf  sigmapsf        rb  
0     21.323490  22.390380  20.659400  0.232067  0.712857  
1     21.323480  22.390360  20.626290  0.211267  0.822857  
2     21.323425  22.390396  20.667300  0.234949  0.785714  
3     21.323386  22.390342  20.724100  0.274779  0.797143  
4     21.323460  22.390334  19.865335  0.192379  0.715714  
..          ...        ...        ...       ...       ...  
157  265.214006  66.206344  19.306845  0.090955  0.787143  
158  265.213977  66.206306  19.475810  0.106966  0.860000  
159  265.213962  66.206365  20.027710  0.166629  0.808571  
160  265.214055  66.206338  20.245500  0.207126  0.714286  
161  265.213992  66.206356  19.808226  0.112136  0.790000  

[162 rows x 10 columns]]",,9.052274703979492,2025-05-22T01:02:19,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,79,0,"SELECT
    catid, oid_catalog, dist
FROM
    xmatch
WHERE
    oid = 'ZTF20achscch'",,,,,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,3.2477142810821533,2025-05-22T01:02:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,1,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.922708511352539,2025-04-29T13:03:05,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.392396926879883,2025-05-22T01:02:35,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,2,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.8964626789093018,2025-04-29T13:03:08,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.596555471420288,2025-05-22T01:02:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,3,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.0871145725250244,2025-04-29T13:03:11,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.674516439437866,2025-05-22T01:03:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,4,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.5084266662597656,2025-04-29T13:03:15,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.352889776229858,2025-05-22T01:03:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,5,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.016144037246704,2025-04-29T13:03:18,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.313399791717529,2025-05-22T01:03:24,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,6,"
SELECT 
    catid, 
    oid_catalog, 
    dist 
FROM 
    xmatch 
WHERE 
    oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,3.826322317123413,2025-04-29T13:03:22,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,8.179240703582764,2025-05-22T01:03:36,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,7,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.6599602699279785,2025-04-29T13:03:25,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.550052642822266,2025-05-22T01:03:51,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,8,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,4.643218994140625,2025-04-29T13:03:29,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.423951625823975,2025-05-22T01:04:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,9,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.814771890640259,2025-04-29T13:03:32,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.52666974067688,2025-05-22T01:04:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,79,10,"
SELECT catid, oid_catalog, dist
FROM xmatch
WHERE oid = 'ZTF20achscch'
","[""\nCREATE TABLE xmatch (\n    oid VARCHAR REFERENCES object(oid), /* ZTF object Id, same 'oid' from the others tables */\n    catid VARCHAR, /* Catalog Id / Name from which the object was matched */\n    oid_catalog VARCHAR NOT NULL, /* Object Id in Catalog */\n    dist DOUBLE PRECISION NOT NULL, /* Distance to the closest ZTF object [arcsec] */\n    class_catalog VARCHAR, /* Class in the given gatalog if reported */\n    period DOUBLE PRECISION /* Period in the given catalog if reported  [days] */\n);\n""]",simple,2.6497724056243896,2025-04-29T13:03:35,"[     catid          oid_catalog      dist
0  allwise  J224613.54-132225.9  0.000072]",,7.310289621353149,2025-05-22T01:04:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,94,0,"SELECT
    *
FROM
    object INNER JOIN
    reference
    ON object.oid = reference.oid
WHERE
    reference_change
LIMIT 50",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aatudlv        81      2312  58173.380914  60635.474826       True   
1   ZTF18aatudlv        81      2312  58173.380914  60635.474826       True   
2   ZTF18aatudlv        81      2312  58173.380914  60635.474826       True   
3   ZTF18aarzxls        14      2697  58257.260880  60635.490741       True   
4   ZTF18aarzxls        14      2697  58257.260880  60635.490741       True   
5   ZTF18aarzxls        14      2697  58257.260880  60635.490741       True   
6   ZTF18abrjrwt        10      2695  58359.139537  60635.491701       True   
7   ZTF18abrjrwt        10      2695  58359.139537  60635.491701       True   
8   ZTF20abjaqkl        45      2803  58121.433634  60635.490741      False   
9   ZTF20abjaqkl        45      2803  58121.433634  60635.490741      False   
10  ZTF20abjaqkl        45      2803  58121.433634  60635.490741      False   
11  ZTF18aajobpu        62      2682  58103.509259  60635.490741       True   
12  ZTF18aajobpu        62      2682  58103.509259  60635.490741       True   
13  ZTF18aajobpu        62      2682  58103.509259  60635.490741       True   
14  ZTF18abkyhyc        18      3848  58332.257917  60635.509167       True   
15  ZTF18abkyhyc        18      3848  58332.257917  60635.509167       True   
16  ZTF18aanacyo        29      4946  58210.336852  60635.491215       True   
17  ZTF18aanacyo        29      4946  58210.336852  60635.491215       True   
18  ZTF18aanacyo        29      4946  58210.336852  60635.491215       True   
19  ZTF18aanacyo        29      4946  58210.336852  60635.491215       True   
20  ZTF18abrjqzq         9      1741  58469.508426  60635.491701       True   
21  ZTF18abrjqzq         9      1741  58469.508426  60635.491701       True   
22  ZTF18abrjrbe        14      1741  58359.139537  60635.491701       True   
23  ZTF18abrjrbe        14      1741  58359.139537  60635.491701       True   
24  ZTF18acpcwdf         6       681  58434.479549  60635.483206       True   
25  ZTF18acpcwdf         6       681  58434.479549  60635.483206       True   
26  ZTF20aapzbqy        13      1698  58900.324919  60635.491701       True   
27  ZTF20aapzbqy        13      1698  58900.324919  60635.491701       True   
28  ZTF18abkyhce        12      1718  58332.257917  60635.491701       True   
29  ZTF18abkyhce        12      1718  58332.257917  60635.491701       True   
30  ZTF19aallbpi        10      2912  58359.139537  60635.491701       True   
31  ZTF19aallbpi        10      2912  58359.139537  60635.491701       True   
32  ZTF19aallbpi        10      2912  58359.139537  60635.491701       True   
33  ZTF19aallbpi        10      2912  58359.139537  60635.491701       True   
34  ZTF18aarenaw        19      2428  58245.266516  60635.491215       True   
35  ZTF18aarenaw        19      2428  58245.266516  60635.491215       True   
36  ZTF18aarenaw        19      2428  58245.266516  60635.491215       True   
37  ZTF18abbgmmb        21      3292  58285.217222  60635.495613       True   
38  ZTF18abbgmmb        21      3292  58285.217222  60635.495613       True   
39  ZTF18abbgmmb        21      3292  58285.217222  60635.495613       True   
40  ZTF19adghbse        10       792  58514.457708  60635.485081       True   
41  ZTF19adghbse        10       792  58514.457708  60635.485081       True   
42  ZTF19aacfpay        29      2355  58480.399132  60757.212708       True   
43  ZTF19aacfpay        29      2355  58480.399132  60757.212708       True   
44  ZTF19aacfpay        29      2355  58480.399132  60757.212708       True   
45  ZTF19aaloxtf        38      3843  58469.508426  60635.491701       True   
46  ZTF19aaloxtf        38      3843  58469.508426  60635.491701       True   
47  ZTF19aaloxtf        38      3843  58469.508426  60635.491701       True   
48  ZTF19aaloxtf        38      3843  58469.508426  60635.491701       True   
49  ZTF19aaloxtf        38      3843  58469.508426  60635.491701       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0      True    18    None         None  ...  1790  16.559000     0.018  0.810   
1      True    18    None         None  ...   753  15.608000     0.014  0.841   
2      True    18    None         None  ...   753  16.509000     0.013  0.435   
3     False     8    None         None  ...   791  15.178000     0.013  0.497   
4     False     8    None         None  ...   791  14.657000     0.015  0.627   
5     False     8    None         None  ...   791  14.632000     0.029  0.598   
6     False     8    None         None  ...   862  14.752000     0.009  0.231   
7     False     8    None         None  ...   862  13.816999     0.018  0.652   
8     False     6    None         None  ...   791  13.382000     0.012  0.279   
9     False     6    None         None  ...   791  12.917000     0.016  0.715   
10    False     6    None         None  ...   791  12.853000     0.018  0.245   
11    False    19    None         None  ...  1793  13.039000     0.015  0.365   
12    False    19    None         None  ...   791  12.921000     0.013  0.515   
13    False    19    None         None  ...   791  13.677000     0.014  0.816   
14    False     7    None         None  ...   862  14.818000     0.008  0.198   
15    False     7    None         None  ...   862  15.530000     0.016  0.979   
16    False     7    None         None  ...   844  14.295000     0.014  0.605   
17    False     7    None         None  ...   820  14.315000     0.014  0.527   
18    False     7    None         None  ...   820  14.698999     0.011  0.406   
19    False     7    None         None  ...   844  14.276000     0.021  0.299   
20     True     7    None         None  ...   862  12.783999     0.014  0.292   
21     True     7    None         None  ...   862  13.202000     0.011  0.359   
22    False     7    None         None  ...   862  14.775000     0.010  0.173   
23    False     7    None         None  ...   862  14.249000     0.013  0.249   
24     True     4    None         None  ...   363  14.818000     0.013  0.444   
25     True     4    None         None  ...   363  15.536000     0.012  0.536   
26    False     6    None         None  ...   862  16.008000     0.013  0.478   
27    False     6    None         None  ...   862  15.358999     0.017  0.221   
28    False     6    None         None  ...   862  14.264999     0.013  0.467   
29    False     6    None         None  ...   862  13.912000     0.016  0.611   
30    False     8    None         None  ...   874  14.750999     0.015  0.314   
31    False     8    None         None  ...   862  14.757999     0.012  0.461   
32    False     8    None         None  ...   874  15.243999     0.011  0.455   
33    False     8    None         None  ...   862  15.236999     0.014  0.707   
34    False    10    None         None  ...   820  13.278000     0.017  0.968   
35    False    10    None         None  ...   820  13.287000     0.016  0.235   
36    False    10    None         None  ...   820  12.915000     0.013  0.240   
37    False    12    None         None  ...   671  14.865999     0.015  0.650   
38    False    12    None         None  ...  1668  14.865999     0.015  0.855   
39    False    12    None         None  ...   671  15.349000     0.016  0.782   
40    False     4    None         None  ...   418  14.057000     0.013  0.559   
41    False     4    None         None  ...   418  14.053000     0.014  0.542   
42    False    16    None         None  ...   260  14.234000     0.009  0.610   
43    False    16    None         None  ...   261  14.208000     0.014  0.802   
44    False    16    None         None  ...   260  13.863000     0.014  0.286   
45    False    24    None         None  ...   863  14.750999     0.012  0.497   
46    False    24    None         None  ...   862  13.978000     0.012  0.279   
47    False    24    None         None  ...   862  14.749000     0.013  0.671   
48    False    24    None         None  ...   863  13.967000     0.016  0.515   
49    False    24    None         None  ...   862  13.964000     0.017  0.333   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.054  170.089197  50.703901  58206.265891  58567.493090         15  
1    -0.027  170.089175  50.703902  58155.323241  58186.323437         26  
2    -0.018  170.089176  50.703911  58166.320683  58249.205556         15  
3    -0.021  201.097516  52.531518  58202.303009  58227.351852         17  
4    -0.028  201.097517  52.531512  58182.374259  58219.356076         19  
5    -0.050  201.097549  52.531506  58217.250000  59427.250000        100  
6    -0.007  196.892355  73.096536  58202.285845  58336.237708         15  
7    -0.013  196.892303  73.096527  58219.250000  58422.500000         15  
8    -0.029  201.992637  52.454586  58202.303009  58227.351852         17  
9    -0.039  201.992648  52.454579  58182.374259  58219.356076         19  
10    0.007  201.992630  52.454567  58217.250000  59427.250000        100  
11    0.027  200.881767  54.490246  58284.185718  58606.235648         15  
12   -0.027  200.881772  54.490251  58160.559641  58219.333438         15  
13   -0.029  200.881777  54.490253  58202.303009  58227.351852         15  
14    0.005  219.793951  79.731405  58198.371389  58246.261794         15  
15   -0.030  219.793915  79.731400  58202.250000  58349.250000         16  
16   -0.028  193.856738  65.760658  58182.373646  58224.272292         18  
17    0.007  193.856816  65.760674  58182.373079  58218.352581         20  
18   -0.018  193.856803  65.760677  58202.284919  58229.310231         15  
19   -0.006  193.856812  65.760651  58186.500000  59736.250000        100  
20   -0.022  197.738746  75.070437  58182.409028  58448.534294         36  
21   -0.004  197.738726  75.070446  58202.301597  58348.161528         15  
22    0.007  199.385350  74.737432  58202.301597  58348.161528         15  
23    0.000  199.385358  74.737428  58182.409028  58448.534294         36  
24   -0.018  130.949075 -12.509319  58160.270255  58432.542025         15  
25   -0.021  130.949077 -12.509321  58247.171794  58442.481748         15  
26   -0.014  207.433706  75.516600  58202.324734  58441.509745         40  
27    0.001  207.433716  75.516602  58226.250000  59736.250000        100  
28    0.000  203.352464  77.889626  58202.324734  58441.509745         15  
29   -0.029  203.352471  77.889616  58198.371389  58283.323356         15  
30   -0.026  205.843179  79.823549  58637.303241  58708.192870         15  
31   -0.014  205.843178  79.823576  58198.371389  58246.261794         15  
32   -0.025  205.843217  79.823551  58634.242465  58684.262211         15  
33   -0.045  205.843155  79.823578  58202.250000  58427.500000         15  
34    0.001  199.289387  59.193553  58202.284919  58230.345532         16  
35    0.006  199.289383  59.193531  58207.250000  59787.250000        100  
36   -0.022  199.289406  59.193547  58182.373079  58218.354479         20  
37   -0.054  177.216732  32.790017  58155.360393  58186.339282         21  
38   -0.046  177.216734  32.790006  58448.472905  58582.202569         15  
39   -0.029  177.216723  32.790024  58166.378692  58276.216771         16  
40   -0.010  157.074341  -5.443207  58202.254201  58461.459583         15  
41   -0.022  157.074356  -5.443210  58210.250000  59957.500000        100  
42   -0.003  115.819790 -27.855679  58206.134815  58779.520498         15  
43   -0.023  115.819774 -27.855690  58206.134340  58487.448299         15  
44    0.016  115.819778 -27.855679  58472.500000  58476.500000         40  
45   -0.022  216.079876  73.419141  58202.287060  58290.198310         15  
46   -0.003  216.079947  73.419136  58197.328021  58233.199873         15  
47    0.015  216.079924  73.419145  58202.324734  58292.204375         15  
48    0.021  216.079798  73.419138  58186.515266  58258.240278         15  
49    0.023  216.079910  73.419121  58231.250000  59740.250000        100  

[50 rows x 36 columns]]",,3.6853551864624023,2025-05-22T01:04:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,1,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.572192907333374,2025-04-29T13:03:50,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abkyeis        31      3963  58274.361586  60735.389572       True   
1   ZTF18abkyeis        31      3963  58274.361586  60735.389572       True   
2   ZTF18abkyeis        31      3963  58274.361586  60735.389572       True   
3   ZTF18abkyeis        31      3963  58274.361586  60735.389572       True   
4   ZTF20aaekbrc        11      1509  58487.361806  60647.523160       True   
5   ZTF20aaekbrc        11      1509  58487.361806  60647.523160       True   
6   ZTF20aaekbrc        11      1509  58487.361806  60647.523160       True   
7   ZTF19adahucr        92       918  58428.542535  60781.151713       True   
8   ZTF19adahucr        92       918  58428.542535  60781.151713       True   
9   ZTF20aapfsav        16      1578  58899.209282  60635.502153       True   
10  ZTF20aapfsav        16      1578  58899.209282  60635.502153       True   
11  ZTF20aapfsav        16      1578  58899.209282  60635.502153       True   
12  ZTF18abolswn        58      2575  58351.393762  60644.150405       True   
13  ZTF18abolswn        58      2575  58351.393762  60644.150405       True   
14  ZTF18abolswn        58      2575  58351.393762  60644.150405       True   
15  ZTF18aaqtxvo        24      3865  58244.282766  60658.437535       True   
16  ZTF18aaqtxvo        24      3865  58244.282766  60658.437535       True   
17  ZTF18aaqtxvo        24      3865  58244.282766  60658.437535       True   
18  ZTF18aakitay        16      3853  58244.282766  60658.437535       True   
19  ZTF18aakitay        16      3853  58244.282766  60658.437535       True   
20  ZTF18aakitay        16      3853  58244.282766  60658.437535       True   
21  ZTF19abnwimu        12      3854  58701.278866  60635.509167       True   
22  ZTF19abnwimu        12      3854  58701.278866  60635.509167       True   
23  ZTF19abnwimu        12      3854  58701.278866  60635.509167       True   
24  ZTF19abnwimu        12      3854  58701.278866  60635.509167       True   
25  ZTF19abnwimu        12      3854  58701.278866  60635.509167       True   
26  ZTF18abjicty        25      3827  58316.182604  60635.509167       True   
27  ZTF18abjicty        25      3827  58316.182604  60635.509167       True   
28  ZTF18abjicty        25      3827  58316.182604  60635.509167       True   
29  ZTF18abjicty        25      3827  58316.182604  60635.509167       True   
30  ZTF18acyyvyj        14      3839  58469.508426  60635.509167       True   
31  ZTF18acyyvyj        14      3839  58469.508426  60635.509167       True   
32  ZTF18acyyvyj        14      3839  58469.508426  60635.509167       True   
33  ZTF18acyyvyj        14      3839  58469.508426  60635.509167       True   
34  ZTF18abjjcie        65      3833  58323.167697  60635.491701       True   
35  ZTF18abjjcie        65      3833  58323.167697  60635.491701       True   
36  ZTF18abjjcie        65      3833  58323.167697  60635.491701       True   
37  ZTF18abjjcie        65      3833  58323.167697  60635.491701       True   
38  ZTF19aakrlmy        50      5975  58224.454097  60661.447581       True   
39  ZTF19aakrlmy        50      5975  58224.454097  60661.447581       True   
40  ZTF19aakrlmy        50      5975  58224.454097  60661.447581       True   
41  ZTF19aakrlmy        50      5975  58224.454097  60661.447581       True   
42  ZTF19aakrlmy        50      5975  58224.454097  60661.447581       True   
43  ZTF19aakrlmy        50      5975  58224.454097  60661.447581       True   
44  ZTF18aavnxdu        39      5388  58245.291389  60635.514352       True   
45  ZTF18aavnxdu        39      5388  58245.291389  60635.514352       True   
46  ZTF18aavnxdu        39      5388  58245.291389  60635.514352       True   
47  ZTF18aavnxdu        39      5388  58245.291389  60635.514352       True   
48  ZTF18aavnxdu        39      5388  58245.291389  60635.514352       True   
49  ZTF18aaswuek        18      2874  58255.234387  60635.514352       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    16    None         None  ...   862  13.521000     0.016  0.807   
1     False    16    None         None  ...   863  13.518000     0.013  0.315   
2     False    16    None         None  ...   863  13.884000     0.010  0.276   
3     False    16    None         None  ...   862  13.861000     0.012  0.421   
4     False     5    None         None  ...   261  14.620000     0.008  0.851   
5     False     5    None         None  ...   262  14.532000     0.010  0.334   
6     False     5    None         None  ...   261  14.540000     0.012  0.964   
7     False    65    None         None  ...   262  16.749000     0.007  0.140   
8     False    65    None         None  ...   262  16.762001     0.013  0.199   
9      True     8    None         None  ...   262  14.201000     0.012  0.581   
10     True     8    None         None  ...   312  14.143000     0.014  0.506   
11     True     8    None         None  ...   312  14.229000     0.010  0.589   
12    False    19    None         None  ...   397  13.901999     0.014  0.246   
13    False    19    None         None  ...   396  13.879000     0.017  0.832   
14    False    19    None         None  ...   397  13.177000     0.017  0.524   
15    False    13    None         None  ...   845  12.648000     0.011  0.409   
16    False    13    None         None  ...   862  12.103000     0.014  0.724   
17    False    13    None         None  ...   862  12.649000     0.014  0.674   
18    False     4    None         None  ...   845  15.033000     0.011  0.504   
19    False     4    None         None  ...   862  14.394000     0.019  0.464   
20    False     4    None         None  ...   862  14.386000     0.016  0.925   
21    False     9    None         None  ...   863  17.094000     0.021  1.043   
22    False     9    None         None  ...   863  16.683000     0.013  0.423   
23    False     9    None         None  ...   862  17.096000     0.016  0.576   
24    False     9    None         None  ...   862  16.703001     0.015  0.654   
25    False     9    None         None  ...   862  16.682000     0.019  0.369   
26    False    16    None         None  ...   862  15.068000     0.016  0.259   
27    False    16    None         None  ...   863  15.540999     0.010  0.473   
28    False    16    None         None  ...   863  15.077000     0.011  0.494   
29    False    16    None         None  ...   862  15.507000     0.012  0.403   
30    False    10    None         None  ...   863  15.776000     0.019  0.690   
31    False    10    None         None  ...   862  15.769000     0.014  0.504   
32    False    10    None         None  ...   862  16.449000     0.017  0.882   
33    False    10    None         None  ...   862  15.773999     0.021  0.576   
34    False    33    None         None  ...   863  16.758000     0.018  0.944   
35    False    33    None         None  ...   862  16.822000     0.017  0.813   
36    False    33    None         None  ...   863  16.122000     0.017  0.596   
37    False    33    None         None  ...   862  16.139000     0.014  0.728   
38    False    22    None         None  ...   862  13.613999     0.015  0.755   
39    False    22    None         None  ...   863  13.582000     0.018  0.622   
40    False    22    None         None  ...   862  14.021999     0.015  0.903   
41    False    22    None         None  ...   845  14.000000     0.011  0.662   
42    False    22    None         None  ...   863  14.011000     0.013  0.599   
43    False    22    None         None  ...   862  13.601000     0.020  0.442   
44    False    16    None         None  ...  1670  12.878000     0.014  0.428   
45    False    16    None         None  ...   673  12.509000     0.019  1.163   
46    False    16    None         None  ...   626  12.495000     0.019  0.982   
47    False    16    None         None  ...   673  12.870000     0.014  0.637   
48    False    16    None         None  ...   626  12.905000     0.015  0.415   
49    False     6    None         None  ...  1670  14.727000     0.014  0.499   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.004  218.663589  77.868904  58197.362164  58242.374514         15  
1    -0.009  218.663532  77.868896  58186.413843  58246.267049         15  
2    -0.003  218.663495  77.868902  58202.287060  58321.197176         16  
3    -0.016  218.663603  77.868909  58202.324734  58345.182442         15  
4    -0.003  122.746628 -25.858651  58218.197072  58486.409838         40  
5    -0.008  122.746629 -25.858645  58428.542535  59171.506921         15  
6    -0.013  122.746613 -25.858633  58206.250000  58491.500000         15  
7    -0.001  129.831072 -22.440084  58234.146401  59168.480313         15  
8    -0.018  129.831074 -22.440105  58472.433657  58493.392882         40  
9    -0.009  127.361986 -20.628334  58204.200405  59168.480313         15  
10   -0.015  127.361981 -20.628360  58218.195694  58585.148461         15  
11   -0.011  127.361981 -20.628341  58204.220579  58573.226562         15  
12    0.012    5.130870  -0.563241  58286.443785  58350.422604         15  
13   -0.014    5.130873  -0.563228  58280.446030  58366.398646         15  
14   -0.009    5.130872  -0.563243  58289.464792  58350.416354         15  
15    0.008  211.095362  72.891425  58202.287558  58233.300741         15  
16    0.050  211.095381  72.891403  58197.301690  58246.261794         15  
17    0.003  211.095336  72.891407  58202.324734  58336.237708         15  
18   -0.011  211.216137  72.963888  58202.287558  58232.281701         15  
19   -0.025  211.216202  72.963875  58226.250000  59740.250000        100  
20   -0.028  211.216202  72.963890  58197.250000  58246.250000         15  
21   -0.044  216.686638  76.477144  58202.287060  58337.177708         15  
22    0.003  216.686637  76.477141  58186.515266  58293.262685         15  
23   -0.035  216.686696  76.477142  58227.307569  58349.198137         15  
24   -0.011  216.686691  76.477142  58197.250000  58242.250000         15  
25   -0.041  216.686676  76.477135  58257.250000  59736.250000        100  
26   -0.011  208.607146  79.300832  58198.371389  58257.245833         15  
27   -0.010  208.607035  79.300828  58202.287060  58284.264120         15  
28    0.001  208.607055  79.300830  58186.413843  58226.403981         16  
29    0.020  208.607144  79.300834  58202.301597  58349.198137         15  
30   -0.036  212.961916  76.524927  58186.515266  58256.286516         15  
31   -0.022  212.961988  76.524926  58197.328021  58286.302616         15  
32   -0.037  212.961976  76.524927  58202.324734  58349.175868         15  
33    0.005  212.961990  76.524918  58231.250000  59709.500000        100  
34   -0.037  214.787620  74.704114  58202.287060  58303.412488         15  
35   -0.050  214.787702  74.704111  58202.324734  58345.182442         15  
36   -0.041  214.787568  74.704127  58186.515266  58231.304572         15  
37   -0.026  214.787712  74.704117  58197.328021  58242.327917         15  
38   -0.024  215.952763  72.658023  58197.328021  58233.199873         15  
39   -0.032  215.952576  72.658029  58186.515266  58231.304572         15  
40   -0.006  215.952734  72.658024  58202.324734  58292.204375         15  
41   -0.013  215.952685  72.658026  58202.287558  58232.281701         16  
42   -0.019  215.952668  72.658018  58202.287060  58281.267106         15  
43    0.027  215.952744  72.658020  58226.250000  59730.250000        100  
44    0.024  195.239384  29.839280  58166.403843  58522.436991         15  
45    0.064  195.239386  29.839267  58155.443021  58184.343900         19  
46    0.063  195.239398  29.839270  58155.441539  58186.389722         21  
47    0.007  195.239380  29.839262  58166.425266  58246.297581         15  
48   -0.008  195.239397  29.839295  58166.423785  58243.228403         15  
49   -0.024  195.818616  27.906938  58166.403843  58522.436991         15  

[50 rows x 36 columns]]",,7.597229480743408,2025-05-22T01:04:43,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,94,2,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.036941289901732,2025-04-29T13:04:04,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18acdvuos        10      1403  58427.497095  60635.518588       True   
1   ZTF18acdvuos        10      1403  58427.497095  60635.518588       True   
2   ZTF20abqcabj        23      3781  58540.297732  60635.509167       True   
3   ZTF20abqcabj        23      3781  58540.297732  60635.509167       True   
4   ZTF20abqcabj        23      3781  58540.297732  60635.509167       True   
5   ZTF20abqcabj        23      3781  58540.297732  60635.509167       True   
6   ZTF17aaaegom       557      1611  58316.417662  60814.482778       True   
7   ZTF17aaaegom       557      1611  58316.417662  60814.482778       True   
8   ZTF17aaaegom       557      1611  58316.417662  60814.482778       True   
9   ZTF19aachtqm      1243      1588  58247.270382  60816.252222       True   
10  ZTF19aachtqm      1243      1588  58247.270382  60816.252222       True   
11  ZTF19aachtqm      1243      1588  58247.270382  60816.252222       True   
12  ZTF19aachtqm      1243      1588  58247.270382  60816.252222       True   
13  ZTF18acdvvai        20      2163  58103.543657  60635.518588       True   
14  ZTF18acdvvai        20      2163  58103.543657  60635.518588       True   
15  ZTF18adcanml        11       930  58121.500208  60635.524456       True   
16  ZTF18adcanml        11       930  58121.500208  60635.524456       True   
17  ZTF18adcanml        11       930  58121.500208  60635.524456       True   
18  ZTF18acrmuzk         9      1651  58449.485069  60635.519062       True   
19  ZTF18acrmuzk         9      1651  58449.485069  60635.519062       True   
20  ZTF18acrmuzk         9      1651  58449.485069  60635.519062       True   
21  ZTF18acrmuzk         9      1651  58449.485069  60635.519062       True   
22  ZTF19aaszknc        14       595  58602.209907  60635.523044       True   
23  ZTF19aaszknc        14       595  58602.209907  60635.523044       True   
24  ZTF19aaszknc        14       595  58602.209907  60635.523044       True   
25  ZTF18acdvuqh         8      1362  58427.497095  60635.518588       True   
26  ZTF18acdvuqh         8      1362  58427.497095  60635.518588       True   
27  ZTF19aaabsxo       608      1706  58363.372315  60814.478947       True   
28  ZTF19aaabsxo       608      1706  58363.372315  60814.478947       True   
29  ZTF19aaabsxo       608      1706  58363.372315  60814.478947       True   
30  ZTF19aalmvmt        12      2037  58199.292187  60723.342465       True   
31  ZTF19aalmvmt        12      2037  58199.292187  60723.342465       True   
32  ZTF19aalmvmt        12      2037  58199.292187  60723.342465       True   
33  ZTF19aalmvmt        12      2037  58199.292187  60723.342465       True   
34  ZTF18abakubw        13      1402  58283.195903  60635.518588       True   
35  ZTF18abakubw        13      1402  58283.195903  60635.518588       True   
36  ZTF18aakbmjx        90      1402  58202.291088  60635.518588       True   
37  ZTF18aakbmjx        90      1402  58202.291088  60635.518588       True   
38  ZTF18aakbmjx        90      1402  58202.291088  60635.518588       True   
39  ZTF18aakbmjx        90      1402  58202.291088  60635.518588       True   
40  ZTF18aauyiui        19      3828  58362.160590  60635.509167       True   
41  ZTF18aauyiui        19      3828  58362.160590  60635.509167       True   
42  ZTF18aauyiui        19      3828  58362.160590  60635.509167       True   
43  ZTF18aauyiui        19      3828  58362.160590  60635.509167       True   
44  ZTF19aacgxjx        15       501  58492.463449  60635.522569       True   
45  ZTF19aacgxjx        15       501  58492.463449  60635.522569       True   
46  ZTF19aacgxjx        15       501  58492.463449  60635.522569       True   
47  ZTF19aagmflq        44      1488  58503.522488  60735.433044       True   
48  ZTF19aagmflq        44      1488  58503.522488  60735.433044       True   
49  ZTF19aagmflq        44      1488  58503.522488  60735.433044       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False     7    None         None  ...   523  13.731999     0.018  0.833   
1     False     7    None         None  ...   523  14.156000     0.015  0.816   
2     False     9    None         None  ...   862  13.752999     0.014  0.661   
3     False     9    None         None  ...   862  14.111999     0.012  0.488   
4     False     9    None         None  ...   862  13.731000     0.020  0.259   
5     False     9    None         None  ...   863  13.750999     0.013  0.260   
6     False   276    None         None  ...   498  14.783999     0.017  0.403   
7     False   276    None         None  ...   498  15.428000     0.016  0.492   
8     False   276    None         None  ...  1492  14.827000     0.013  0.227   
9     False   756    None         None  ...   323  14.888000     0.013  0.875   
10    False   756    None         None  ...   322  15.004000     0.020  1.301   
11    False   756    None         None  ...   322  14.752000     0.015  0.778   
12    False   756    None         None  ...   323  15.146000     0.023  1.846   
13    False    13    None         None  ...   523  13.882999     0.011  0.453   
14    False    13    None         None  ...   523  12.790999     0.016  0.368   
15    False    10    None         None  ...   472  13.695000     0.018  0.778   
16    False    10    None         None  ...   472  13.998000     0.015  0.678   
17    False    10    None         None  ...  1518  13.726999     0.025  1.363   
18     True     8    None         None  ...   471  13.946000     0.010  0.471   
19     True     8    None         None  ...   471  13.535000     0.015  0.465   
20     True     8    None         None  ...   472  13.941000     0.017  1.163   
21     True     8    None         None  ...   472  13.532000     0.022  0.872   
22    False    11    None         None  ...   368  15.549000     0.010  0.504   
23    False    11    None         None  ...   368  14.976999     0.016  0.461   
24    False    11    None         None  ...   368  14.986000     0.018  0.836   
25     True     5    None         None  ...   523  12.539000     0.017  0.501   
26     True     5    None         None  ...   523  13.139000     0.009  0.160   
27    False   347    None         None  ...   498  17.134000     0.014  0.380   
28    False   347    None         None  ...   498  17.313000     0.015  0.281   
29    False   347    None         None  ...  1492  17.462000     0.020  0.770   
30    False    14    None         None  ...   368  13.780000     0.009  0.289   
31    False    14    None         None  ...   318  13.120000     0.011  0.346   
32    False    14    None         None  ...   318  13.803000     0.008  0.465   
33    False    14    None         None  ...   368  13.094999     0.012  0.320   
34    False     9    None         None  ...   523  14.002999     0.015  0.478   
35    False     9    None         None  ...   523  14.504000     0.012  0.622   
36    False    53    None         None  ...  1569  12.646000     0.072  5.334   
37    False    53    None         None  ...  1569  13.881000     0.040  3.799   
38    False    53    None         None  ...   523  12.717999     0.059  4.441   
39    False    53    None         None  ...   523  13.914000     0.050  5.143   
40     True     7    None         None  ...   862  14.804000     0.012  0.244   
41     True     7    None         None  ...   863  15.439000     0.011  0.506   
42     True     7    None         None  ...   863  14.816999     0.009  0.225   
43     True     7    None         None  ...   862  15.427000     0.013  0.421   
44    False     9    None         None  ...   317  14.562000     0.011  0.512   
45    False     9    None         None  ...   317  14.179999     0.015  0.486   
46    False     9    None         None  ...   317  14.184999     0.016  0.356   
47    False    15    None         None  ...   317  13.021999     0.011  0.434   
48    False    15    None         None  ...   317  12.605000     0.016  0.376   
49    False    15    None         None  ...   267  12.664000     0.009  0.358   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.004  170.779976  14.785507  58155.391019  58186.354711         23  
1    -0.033  170.779976  14.785514  58166.377627  58439.516377         15  
2     0.006  218.518131  77.956116  58197.362164  58242.374514         15  
3     0.006  218.518128  77.956125  58202.324734  58345.182442         15  
4     0.010  218.518112  77.956108  58547.500000  59740.250000        100  
5     0.010  218.518036  77.956108  58186.500000  58246.250000         15  
6    -0.050  357.578473   2.297601  58291.464780  58349.350741         15  
7    -0.027  357.578472   2.297590  58279.470752  58349.396227         16  
8     0.019  357.578491   2.297586  58335.500000  58774.250000         16  
9    -0.022  202.782704 -15.654870  58198.357917  58464.565532         17  
10   -0.047  202.782714 -15.654868  58204.298102  58540.408356         15  
11    0.013  202.782715 -15.654878  58230.250741  58559.271424         15  
12   -0.043  202.782703 -15.654868  58204.297627  58524.436829         15  
13   -0.006  169.332297   8.043519  58166.366296  58441.502836         25  
14    0.028  169.332308   8.043521  58155.428345  58186.354711         17  
15   -0.036  177.547206   4.802667  58165.367153  58447.497419         23  
16   -0.029  177.547204   4.802674  58202.290625  58464.501042         18  
17    0.018  177.547211   4.802652  58476.500000  60077.250000         15  
18    0.010  175.224041   1.488470  58166.412315  58440.482396         16  
19   -0.039  175.224045   1.488473  58165.387118  58440.545486         15  
20   -0.036  175.224013   1.488459  58202.290625  58461.499109         15  
21   -0.045  175.224003   1.488460  58165.367153  58449.485984         21  
22   -0.012  168.374655  -9.697133  58204.278692  58468.457813         15  
23   -0.022  168.374664  -9.697145  58218.250000  59709.250000        100  
24   -0.036  168.374666  -9.697147  58165.394526  58449.541597         15  
25    0.022  169.493117   8.522677  58155.428345  58186.334120         16  
26    0.000  169.493113   8.522673  58166.370914  58441.502836         15  
27    0.032  358.779322   3.166182  58279.470752  58351.423866         15  
28   -0.009  358.779329   3.166163  58291.464780  58369.359352         15  
29   -0.020  358.779327   3.166157  58335.500000  58763.250000         15  
30    0.001  167.865927 -13.329674  58204.278692  58468.457813         15  
31    0.000  167.865939 -13.329659  58218.217199  58557.252882         15  
32    0.002  167.865929 -13.329663  58203.303275  58487.480938         15  
33   -0.012  167.865940 -13.329676  58199.271447  58465.502384         16  
34    0.001  170.219392  14.127169  58155.391019  58186.354711         24  
35   -0.018  170.219396  14.127190  58166.366296  58283.235532         15  
36    0.178  170.077552  13.870017  58155.336157  58186.354248         18  
37    0.049  170.077530  13.870012  58166.365799  58585.200451         15  
38    0.123  170.077512  13.870028  58155.391019  58186.354711         24  
39    0.084  170.077542  13.870046  58166.366296  58283.235532         15  
40   -0.016  213.059194  78.716380  58198.371389  58257.245833         15  
41   -0.017  213.059110  78.716377  58202.287060  58321.197176         16  
42   -0.015  213.059100  78.716368  58186.413843  58226.403981         15  
43    0.000  213.059182  78.716383  58202.324734  58363.181331         15  
44   -0.021  162.709225 -18.818496  58204.214560  58492.504398         15  
45   -0.026  162.709213 -18.818497  58199.250000  59701.250000         89  
46   -0.022  162.709223 -18.818501  58199.270995  58481.529421         16  
47   -0.001  166.986357 -20.699646  58204.279144  58493.523484         15  
48    0.008  166.986366 -20.699647  58218.218588  58481.529421         15  
49   -0.005  166.986357 -20.699645  58218.218125  58568.292813         15  

[50 rows x 36 columns]]",,8.014033794403076,2025-05-22T01:04:55,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,94,3,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.533109188079834,2025-04-29T13:04:19,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19aahhled         8       817  58514.400880  60635.522569       True   
1   ZTF19aahhled         8       817  58514.400880  60635.522569       True   
2   ZTF19aahhled         8       817  58514.400880  60635.522569       True   
3   ZTF19aacgxod        11       817  58492.464352  60635.522569       True   
4   ZTF19aacgxod        11       817  58492.464352  60635.522569       True   
5   ZTF19aacgxod        11       817  58492.464352  60635.522569       True   
6   ZTF19aalmpsu        19      1122  58513.382940  60735.433044       True   
7   ZTF19aalmpsu        19      1122  58513.382940  60735.433044       True   
8   ZTF19aalmpsu        19      1122  58513.382940  60735.433044       True   
9   ZTF19aallixx        28      1122  58514.400880  60735.433044       True   
10  ZTF19aallixx        28      1122  58514.400880  60735.433044       True   
11  ZTF19aallixx        28      1122  58514.400880  60735.433044       True   
12  ZTF19aallixx        28      1122  58514.400880  60735.433044       True   
13  ZTF19aalmptk        18      1122  58543.292882  60735.433044       True   
14  ZTF19aalmptk        18      1122  58543.292882  60735.433044       True   
15  ZTF19aalmptk        18      1122  58543.292882  60735.433044       True   
16  ZTF19aalmpuv         6       816  58543.292882  60635.522569       True   
17  ZTF19aalmpuv         6       816  58543.292882  60635.522569       True   
18  ZTF19aaydqmy       373      1233  58207.352431  60796.292732       True   
19  ZTF19aaydqmy       373      1233  58207.352431  60796.292732       True   
20  ZTF18abshlba        42      3913  58362.409583  60694.122234      False   
21  ZTF18abshlba        42      3913  58362.409583  60694.122234      False   
22  ZTF18abshlba        42      3913  58362.409583  60694.122234      False   
23  ZTF18abshlba        42      3913  58362.409583  60694.122234      False   
24  ZTF19aakreyc        10       941  58539.273206  60635.522569       True   
25  ZTF19aakreyc        10       941  58539.273206  60635.522569       True   
26  ZTF19aakreyc        10       941  58539.273206  60635.522569       True   
27  ZTF19aakreym        11       941  58539.273206  60635.522569       True   
28  ZTF19aakreym        11       941  58539.273206  60635.522569       True   
29  ZTF19aakreym        11       941  58539.273206  60635.522569       True   
30  ZTF19aanjrcw        32      1426  58514.400880  60734.347014       True   
31  ZTF19aanjrcw        32      1426  58514.400880  60734.347014       True   
32  ZTF19aanjrcw        32      1426  58514.400880  60734.347014       True   
33  ZTF19aanjrcw        32      1426  58514.400880  60734.347014       True   
34  ZTF19aaszpxa         7       631  58602.209907  60661.570509       True   
35  ZTF19aaszpxa         7       631  58602.209907  60661.570509       True   
36  ZTF19aaszpxa         7       631  58602.209907  60661.570509       True   
37  ZTF19aakrexy        13      1009  58539.273206  60678.522674       True   
38  ZTF19aakrexy        13      1009  58539.273206  60678.522674       True   
39  ZTF19aakrexy        13      1009  58539.273206  60678.522674       True   
40  ZTF19aakrexy        13      1009  58539.273206  60678.522674       True   
41  ZTF19aakrexv        36      1426  58503.538530  60734.347014       True   
42  ZTF19aakrexv        36      1426  58503.538530  60734.347014       True   
43  ZTF19aakrexv        36      1426  58503.538530  60734.347014       True   
44  ZTF19aakrexv        36      1426  58503.538530  60734.347014       True   
45  ZTF19aakrexx        41      1371  58539.273206  60710.421123       True   
46  ZTF19aakrexx        41      1371  58539.273206  60710.421123       True   
47  ZTF19aakrexx        41      1371  58539.273206  60710.421123       True   
48  ZTF19aakrexx        41      1371  58539.273206  60710.421123       True   
49  ZTF18acyinfn       123      1877  58468.572720  60790.368623       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0      True     4    None         None  ...   267  14.052000     0.013  0.778   
1      True     4    None         None  ...   317  14.531000     0.015  0.842   
2      True     4    None         None  ...   267  14.523000     0.009  0.434   
3     False     9    None         None  ...   317  14.241000     0.010  0.235   
4     False     9    None         None  ...   267  13.917000     0.013  0.858   
5     False     9    None         None  ...   317  13.907000     0.014  0.459   
6     False     8    None         None  ...   317  15.774000     0.010  0.345   
7     False     8    None         None  ...   317  15.339999     0.015  0.399   
8     False     8    None         None  ...   267  15.334000     0.012  0.612   
9     False    13    None         None  ...   317  15.657000     0.012  0.448   
10    False    13    None         None  ...   267  15.637000     0.013  0.802   
11    False    13    None         None  ...   317  15.146000     0.013  0.376   
12    False    13    None         None  ...   267  15.150000     0.014  1.156   
13    False     7    None         None  ...   317  15.261000     0.014  0.588   
14    False     7    None         None  ...   267  14.828000     0.010  0.549   
15    False     7    None         None  ...   267  15.253000     0.009  0.420   
16    False     5    None         None  ...   317  16.536001     0.011  0.502   
17    False     5    None         None  ...   267  16.007000     0.010  0.379   
18    False   259    None         None  ...   272  15.717000     0.010  0.312   
19    False   259    None         None  ...   272  14.931000     0.011  0.425   
20    False    22    None         None  ...   396  14.943000     0.011  0.360   
21    False    22    None         None  ...   396  14.391999     0.017  0.688   
22    False    22    None         None  ...   397  14.904000     0.024  0.991   
23    False    22    None         None  ...   397  14.316999     0.019  0.636   
24    False     8    None         None  ...   318  14.025000     0.012  0.672   
25    False     8    None         None  ...   317  14.036000     0.010  0.494   
26    False     8    None         None  ...   317  13.681000     0.015  0.460   
27    False     8    None         None  ...   317  15.052000     0.013  0.796   
28    False     8    None         None  ...   318  15.061000     0.010  0.400   
29    False     8    None         None  ...   317  14.341000     0.014  0.690   
30    False    13    None         None  ...   317  15.231999     0.010  0.502   
31    False    13    None         None  ...   317  14.745000     0.015  0.563   
32    False    13    None         None  ...   318  15.223000     0.013  0.725   
33    False    13    None         None  ...   318  14.750000     0.015  0.724   
34    False     7    None         None  ...   368  14.658000     0.011  0.540   
35    False     7    None         None  ...   368  14.292000     0.011  0.194   
36    False     7    None         None  ...   368  14.285000     0.014  0.322   
37    False    10    None         None  ...   318  13.988999     0.012  0.741   
38    False    10    None         None  ...   317  13.995999     0.012  0.653   
39    False    10    None         None  ...   317  13.224999     0.012  0.460   
40    False    10    None         None  ...   318  13.236999     0.015  0.657   
41    False    16    None         None  ...   317  13.476000     0.010  0.511   
42    False    16    None         None  ...   318  13.462999     0.012  0.448   
43    False    16    None         None  ...   317  13.068000     0.010  0.189   
44    False    16    None         None  ...   318  13.078000     0.014  0.664   
45    False    16    None         None  ...   318  13.679000     0.010  0.474   
46    False    16    None         None  ...   317  13.683000     0.011  0.495   
47    False    16    None         None  ...   317  13.139000     0.012  0.347   
48    False    16    None         None  ...   318  13.150000     0.016  0.719   
49    False    47    None         None  ...   324  16.333000     0.011  0.437   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0    -0.008  165.645816 -20.597990  58218.218125  58582.230301         15  
1    -0.020  165.645830 -20.598006  58204.279144  58493.523484         15  
2    -0.004  165.645818 -20.597987  58204.279607  58506.463553         15  
3     0.002  165.578167 -20.722191  58204.279144  58493.523484         15  
4    -0.013  165.578157 -20.722182  58218.218125  58582.230301         15  
5    -0.006  165.578171 -20.722201  58218.218588  58481.529421         15  
6     0.001  165.833069 -20.715423  58204.279144  58493.523484         15  
7     0.006  165.833074 -20.715427  58218.218588  58481.529421         15  
8    -0.013  165.833069 -20.715414  58218.250000  58582.250000         15  
9     0.000  165.891498 -20.641237  58204.279144  58493.523484         15  
10   -0.010  165.891491 -20.641220  58204.279607  58506.463553         15  
11    0.005  165.891503 -20.641239  58218.218588  58481.529421         15  
12   -0.017  165.891479 -20.641226  58218.250000  58582.250000         15  
13   -0.010  165.713685 -20.536325  58204.279144  58493.523484         15  
14   -0.003  165.713673 -20.536312  58218.218125  58582.230301         15  
15    0.002  165.713671 -20.536311  58204.279607  58506.463553         15  
16   -0.017  165.515277 -20.740578  58204.279144  58493.523484         15  
17   -0.011  165.515262 -20.740561  58218.218125  58582.230301         15  
18    0.004  201.196685 -20.556015  58204.342083  58617.192245         15  
19   -0.002  201.196686 -20.556016  58218.304097  58642.210069         15  
20    0.002    5.352040  -6.184498  58280.446030  58437.235914         15  
21    0.048    5.352042  -6.184496  58274.482280  58443.136713         34  
22   -0.046    5.351996  -6.184515  58286.443785  58350.422604         15  
23   -0.010    5.351995  -6.184514  58289.464792  58366.372396         15  
24   -0.020  167.614444 -19.586364  58203.303275  58557.276262         15  
25   -0.014  167.614451 -19.586351  58204.279144  58493.523484         15  
26   -0.013  167.614459 -19.586369  58218.218588  58481.529421         15  
27   -0.002  167.491157 -19.573854  58204.279144  58493.523484         15  
28   -0.017  167.491148 -19.573855  58203.303275  58557.276262         15  
29   -0.014  167.491165 -19.573856  58218.250000  58481.500000         15  
30   -0.006  167.704737 -19.767874  58204.279144  58493.523484         15  
31   -0.025  167.704743 -19.767877  58218.218588  58481.529421         15  
32   -0.016  167.704723 -19.767887  58203.303275  58557.276262         15  
33   -0.028  167.704712 -19.767874  58218.250000  58560.250000         15  
34   -0.019  165.152245  -9.571189  58204.278692  58468.457813         15  
35   -0.004  165.152247  -9.571188  58165.394526  58449.541597         15  
36   -0.027  165.152252  -9.571193  58199.250000  59709.250000        100  
37   -0.018  167.503262 -19.747882  58203.303275  58557.276262         15  
38   -0.012  167.503273 -19.747869  58204.279144  58493.523484         15  
39   -0.006  167.503280 -19.747876  58218.218588  58481.529421         15  
40   -0.031  167.503250 -19.747873  58218.250000  58560.250000         15  
41   -0.010  167.561201 -19.722570  58204.279144  58493.523484         15  
42   -0.011  167.561199 -19.722578  58203.303275  58557.276262         15  
43   -0.007  167.561203 -19.722586  58218.250000  58481.500000         15  
44   -0.018  167.561188 -19.722578  58218.250000  58560.250000         15  
45   -0.011  167.650148 -19.799582  58203.303275  58557.276262         15  
46   -0.010  167.650164 -19.799578  58204.279144  58493.523484         15  
47   -0.007  167.650161 -19.799579  58218.218588  58481.529421         15  
48   -0.027  167.650131 -19.799572  58218.250000  58560.250000         15  
49   -0.019  209.550520 -17.746977  58204.343021  58298.188762         15  

[50 rows x 36 columns]]",,7.801044940948486,2025-05-22T01:05:07,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,94,4,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,17.847935676574707,2025-04-29T13:04:36,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19aakrmhm        15      3080  58539.286192  60735.430764       True   
1   ZTF19aakrmhm        15      3080  58539.286192  60735.430764       True   
2   ZTF19aakrmhm        15      3080  58539.286192  60735.430764       True   
3   ZTF18abkyfyl        15      3080  58332.257917  60735.430764       True   
4   ZTF18abkyfyl        15      3080  58332.257917  60735.430764       True   
5   ZTF18abkyfyl        15      3080  58332.257917  60735.430764       True   
6   ZTF18abkyfyl        15      3080  58332.257917  60735.430764       True   
7   ZTF19abksfsi        19      2391  58695.271701  60635.509167       True   
8   ZTF19abksfsi        19      2391  58695.271701  60635.509167       True   
9   ZTF19abksfsi        19      2391  58695.271701  60635.509167       True   
10  ZTF19abksfsi        19      2391  58695.271701  60635.509167       True   
11  ZTF19abksfsi        19      2391  58695.271701  60635.509167       True   
12  ZTF18abkyfyd        18      3838  58332.257917  60635.509167       True   
13  ZTF18abkyfyd        18      3838  58332.257917  60635.509167       True   
14  ZTF18abkyfyd        18      3838  58332.257917  60635.509167       True   
15  ZTF18abkyfyd        18      3838  58332.257917  60635.509167       True   
16  ZTF18abkyfyj        14      1749  58332.257917  60635.509167       True   
17  ZTF18abkyfyj        14      1749  58332.257917  60635.509167       True   
18  ZTF18abkyfyj        14      1749  58332.257917  60635.509167       True   
19  ZTF19abkwoqm        12      2919  58568.243924  60635.509167       True   
20  ZTF19abkwoqm        12      2919  58568.243924  60635.509167       True   
21  ZTF18abkyfye        15      3838  58332.257917  60635.509167       True   
22  ZTF18abkyfye        15      3838  58332.257917  60635.509167       True   
23  ZTF18adbimdc        14       757  58481.555174  60635.523518       True   
24  ZTF18adbimdc        14       757  58481.555174  60635.523518       True   
25  ZTF18actxbrp       209      1319  58426.206887  60586.309931       True   
26  ZTF18actxbrp       209      1319  58426.206887  60586.309931       True   
27  ZTF18absdgzf        11      3833  58362.160590  60635.509167       True   
28  ZTF18absdgzf        11      3833  58362.160590  60635.509167       True   
29  ZTF18abeidtf       121      2562  58129.431528  60776.259618       True   
30  ZTF18abeidtf       121      2562  58129.431528  60776.259618       True   
31  ZTF18abgklou       113      2569  58129.468773  60776.259618       True   
32  ZTF18abgklou       113      2569  58129.468773  60776.259618       True   
33  ZTF18abeidui        57      2373  58129.431528  60686.262280       True   
34  ZTF18abeidui        57      2373  58129.431528  60686.262280       True   
35  ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
36  ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
37  ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
38  ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
39  ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
40  ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
41  ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
42  ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
43  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
44  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
45  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
46  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
47  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
48  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
49  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    11    None         None  ...   874  15.028999     0.019  0.625   
1     False    11    None         None  ...   862  15.500999     0.015  0.709   
2     False    11    None         None  ...   874  15.529000     0.012  0.516   
3      True    13    None         None  ...   874  14.771000     0.022  0.855   
4      True    13    None         None  ...   862  14.770000     0.012  0.440   
5      True    13    None         None  ...   874  15.242000     0.010  0.284   
6      True    13    None         None  ...   862  15.205000     0.013  0.484   
7     False    13    None         None  ...   874  13.743000     0.020  0.489   
8     False    13    None         None  ...   874  14.775000     0.013  0.465   
9     False    13    None         None  ...   862  14.741000     0.014  0.598   
10    False    13    None         None  ...   862  13.747999     0.011  0.364   
11    False    13    None         None  ...   862  13.729000     0.021  0.475   
12    False     8    None         None  ...   863  15.568000     0.013  0.448   
13    False     8    None         None  ...   862  15.553000     0.016  0.997   
14    False     8    None         None  ...   862  16.384000     0.016  0.529   
15    False     8    None         None  ...   863  16.418001     0.013  0.753   
16    False     8    None         None  ...   862  15.938000     0.013  0.640   
17    False     8    None         None  ...   862  15.448000     0.012  0.498   
18    False     8    None         None  ...   862  15.443999     0.021  0.534   
19     True     6    None         None  ...   874  16.044000     0.012  0.357   
20     True     6    None         None  ...   874  15.263000     0.015  0.286   
21    False     6    None         None  ...   862  16.632000     0.018  1.058   
22    False     6    None         None  ...   862  15.742000     0.012  0.630   
23     True    10    None         None  ...   420  13.981999     0.013  0.467   
24     True    10    None         None  ...   420  14.410000     0.013  0.849   
25    False    90    None         None  ...   446  18.354000     0.017  0.361   
26    False    90    None         None  ...   446  18.446000     0.016  0.492   
27     True     5    None         None  ...   863  15.922999     0.017  0.510   
28     True     5    None         None  ...   862  16.773000     0.017  0.651   
29    False    28    None         None  ...   818  16.361000     0.011  0.342   
30    False    28    None         None  ...   818  16.010000     0.011  0.244   
31    False    39    None         None  ...   818  16.091000     0.015  0.528   
32    False    39    None         None  ...   818  15.651000     0.011  0.299   
33    False    19    None         None  ...   818  16.131000     0.013  0.234   
34    False    19    None         None  ...   818  16.515000     0.011  0.305   
35    False    11    None         None  ...   862  12.841000     0.011  0.271   
36    False    11    None         None  ...   863  13.638000     0.013  0.210   
37    False    11    None         None  ...   862  13.611000     0.014  0.449   
38    False    11    None         None  ...   863  12.835000     0.011  0.167   
39    False    11    None         None  ...   863  13.462000     0.013  0.232   
40    False    11    None         None  ...   862  13.896000     0.018  0.688   
41    False    11    None         None  ...   862  13.469999     0.012  0.223   
42    False    11    None         None  ...   863  13.920000     0.016  0.306   
43     True     9    None         None  ...   862  16.019001     0.017  0.709   
44     True     9    None         None  ...   862  15.434999     0.019  0.725   
45     True     9    None         None  ...   863  15.436000     0.011  0.283   
46    False    12    None         None  ...   862  15.168000     0.018  0.750   
47    False    12    None         None  ...   862  14.223000     0.016  0.689   
48    False    12    None         None  ...   863  14.217000     0.012  0.234   
49    False    12    None         None  ...   863  15.181000     0.013  0.360   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0     0.027  208.204110  80.038756  58637.303241  58708.192870         15  
1    -0.036  208.204073  80.038787  58202.324734  58427.535602         15  
2    -0.015  208.204125  80.038763  58634.242465  58684.262211         15  
3     0.000  208.040295  79.962930  58637.303241  58708.192870         15  
4    -0.026  208.040283  79.962969  58198.371389  58246.261794         15  
5    -0.006  208.040347  79.962935  58634.242465  58684.262211         15  
6    -0.003  208.040262  79.962958  58202.324734  58427.535602         15  
7    -0.020  208.517618  79.844500  58637.303241  58708.192870         15  
8    -0.013  208.517637  79.844508  58634.242465  58684.262211         15  
9    -0.030  208.517557  79.844538  58202.324734  58427.535602         15  
10    0.003  208.517608  79.844542  58198.371389  58246.261794         15  
11   -0.057  208.517609  79.844521  58256.250000  59736.250000        100  
12   -0.011  208.655249  79.464282  58186.413843  58226.403981         16  
13   -0.020  208.655292  79.464288  58198.371389  58246.261794         15  
14   -0.020  208.655309  79.464302  58202.324734  58427.535602         15  
15    0.007  208.655228  79.464287  58202.250000  58284.250000         15  
16    0.013  209.047723  79.808768  58202.324734  58427.535602         15  
17   -0.008  209.047751  79.808768  58198.371389  58246.261794         15  
18   -0.030  209.047760  79.808746  58256.250000  59736.250000        100  
19   -0.017  208.042072  79.914930  58634.242465  58684.262211         15  
20   -0.010  208.042053  79.914927  58637.303241  58708.192870         15  
21   -0.036  209.002737  79.498831  58202.324734  58427.535602         15  
22   -0.032  209.002770  79.498829  58198.371389  58246.261794         15  
23   -0.021  170.775211  -6.000719  58165.366620  58449.491678         15  
24   -0.021  170.775201  -6.000716  58204.294630  58487.482303         15  
25    0.019  353.644997  -2.198113  58282.420336  58423.216308         15  
26    0.042  353.644992  -2.198132  58282.478553  58435.255671         29  
27   -0.035  212.158558  77.772304  58186.413843  58226.403981         16  
28   -0.027  212.158588  77.772330  58227.307569  58363.181331         15  
29   -0.001  165.772813  61.863453  58205.310162  58443.517766         34  
30    0.011  165.772822  61.863451  58160.245683  58286.283854         17  
31   -0.015  165.995796  61.855394  58205.310162  58443.517766         34  
32    0.007  165.995804  61.855397  58160.245683  58286.283854         17  
33   -0.008  166.037324  61.983801  58160.245683  58286.283854         17  
34   -0.007  166.037321  61.983806  58205.310162  58443.517766         34  
35    0.001  211.716847  77.826790  58198.371389  58283.323356         15  
36   -0.015  211.716725  77.826795  58202.287060  58337.177708         15  
37   -0.004  211.716796  77.826798  58227.307569  58363.181331         15  
38    0.000  211.716745  77.826783  58186.413843  58226.403981         16  
39   -0.014  211.630568  77.854503  58186.413843  58226.403981         16  
40   -0.039  211.630642  77.854513  58227.307569  58363.181331         15  
41   -0.010  211.630665  77.854506  58198.371389  58283.323356         15  
42    0.011  211.630554  77.854515  58202.250000  58337.250000         15  
43   -0.051  211.943095  77.814396  58227.307569  58363.181331         15  
44   -0.026  211.943092  77.814389  58198.371389  58283.323356         15  
45    0.001  211.943028  77.814379  58186.413843  58226.403981         16  
46   -0.053  211.650226  77.695950  58227.307569  58363.181331         15  
47   -0.027  211.650278  77.695947  58198.371389  58283.323356         15  
48   -0.007  211.650167  77.695940  58186.413843  58226.403981         16  
49   -0.006  211.650174  77.695950  58202.287060  58337.177708         15  

[50 rows x 36 columns]]",,7.833684206008911,2025-05-22T01:05:19,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,94,5,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,15.58079957962036,2025-04-29T13:04:52,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
1   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
2   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
3   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
4   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
5   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
6   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
7   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
8   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
9   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
10  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
11  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
12  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
13  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
14  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
15  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
16  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
17  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
18  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
19  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
20  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
21  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
22  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
23  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
24  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
25  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
26  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
27  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
28  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
29  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
30  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
31  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
32  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
33  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
34  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
35  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
36  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
37  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
38  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
39  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
40  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
41  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
42  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
43  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
44  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
45  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
46  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
47  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
48  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
49  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    11    None         None  ...   862  12.841000     0.011  0.271   
1     False    11    None         None  ...   863  13.638000     0.013  0.210   
2     False    11    None         None  ...   862  13.611000     0.014  0.449   
3     False    11    None         None  ...   863  12.835000     0.011  0.167   
4     False    11    None         None  ...   863  13.462000     0.013  0.232   
5     False    11    None         None  ...   862  13.896000     0.018  0.688   
6     False    11    None         None  ...   862  13.469999     0.012  0.223   
7     False    11    None         None  ...   863  13.920000     0.016  0.306   
8      True     9    None         None  ...   862  16.019001     0.017  0.709   
9      True     9    None         None  ...   862  15.434999     0.019  0.725   
10     True     9    None         None  ...   863  15.436000     0.011  0.283   
11    False    12    None         None  ...   862  15.168000     0.018  0.750   
12    False    12    None         None  ...   862  14.223000     0.016  0.689   
13    False    12    None         None  ...   863  14.217000     0.012  0.234   
14    False    12    None         None  ...   863  15.181000     0.013  0.360   
15    False     9    None         None  ...   863  15.658999     0.013  0.245   
16    False     9    None         None  ...   862  16.024000     0.018  0.505   
17    False     9    None         None  ...   863  16.048000     0.014  0.392   
18     True     9    None         None  ...   862  14.011000     0.015  0.419   
19     True     9    None         None  ...   863  14.006000     0.013  0.261   
20     True     9    None         None  ...   862  15.104000     0.024  1.220   
21    False    10    None         None  ...   862  15.861999     0.011  0.444   
22    False    10    None         None  ...   874  16.750000     0.012  0.504   
23    False    10    None         None  ...   862  16.692000     0.013  0.502   
24    False    10    None         None  ...   874  15.877999     0.020  0.621   
25    False    12    None         None  ...   874  16.381000     0.011  0.362   
26    False    12    None         None  ...   874  15.905999     0.016  0.327   
27    False    12    None         None  ...   862  16.359001     0.021  1.414   
28    False    12    None         None  ...   862  15.908000     0.009  0.299   
29    False   422    None         None  ...   528  16.401001     0.017  0.509   
30    False   422    None         None  ...   528  16.765000     0.018  0.770   
31    False   422    None         None  ...  1523  16.552000     0.020  0.968   
32    False     9    None         None  ...   874  16.155000     0.012  0.396   
33    False     9    None         None  ...   862  16.136000     0.020  1.344   
34    False     9    None         None  ...   874  15.627999     0.016  0.447   
35    False    10    None         None  ...   874  15.405000     0.017  0.460   
36    False    10    None         None  ...   874  15.997000     0.015  0.718   
37    False    10    None         None  ...   862  15.972000     0.014  0.652   
38    False    10    None         None  ...   862  15.410999     0.015  0.678   
39    False    10    None         None  ...   862  15.349000     0.011  0.436   
40    False    10    None         None  ...   874  15.339000     0.021  0.827   
41    False    10    None         None  ...   874  15.743000     0.016  0.795   
42    False    10    None         None  ...   862  15.742000     0.017  1.014   
43    False    10    None         None  ...   862  16.155000     0.013  0.623   
44    False    10    None         None  ...   874  16.517000     0.014  0.641   
45    False    10    None         None  ...   874  16.147000     0.021  0.629   
46    False    10    None         None  ...   862  16.482000     0.017  0.607   
47    False    14    None         None  ...   874  16.026001     0.020  0.559   
48    False    14    None         None  ...   862  16.559000     0.017  0.830   
49    False    14    None         None  ...   862  16.037000     0.013  0.703   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0     0.001  211.716847  77.826790  58198.371389  58283.323356         15  
1    -0.015  211.716725  77.826795  58202.287060  58337.177708         15  
2    -0.004  211.716796  77.826798  58227.307569  58363.181331         15  
3     0.000  211.716745  77.826783  58186.413843  58226.403981         16  
4    -0.014  211.630568  77.854503  58186.413843  58226.403981         16  
5    -0.039  211.630642  77.854513  58227.307569  58363.181331         15  
6    -0.010  211.630665  77.854506  58198.371389  58283.323356         15  
7     0.011  211.630554  77.854515  58202.250000  58337.250000         15  
8    -0.051  211.943095  77.814396  58227.307569  58363.181331         15  
9    -0.026  211.943092  77.814389  58198.371389  58283.323356         15  
10    0.001  211.943028  77.814379  58186.413843  58226.403981         16  
11   -0.053  211.650226  77.695950  58227.307569  58363.181331         15  
12   -0.027  211.650278  77.695947  58198.371389  58283.323356         15  
13   -0.007  211.650167  77.695940  58186.413843  58226.403981         16  
14   -0.006  211.650174  77.695950  58202.287060  58337.177708         15  
15   -0.016  212.059801  77.896782  58186.413843  58226.403981         16  
16   -0.024  212.059892  77.896789  58227.307569  58363.181331         15  
17   -0.009  212.059814  77.896790  58202.250000  58337.250000         15  
18   -0.011  211.815055  77.896675  58198.371389  58283.323356         15  
19   -0.007  211.814964  77.896678  58186.413843  58226.403981         16  
20   -0.054  211.815013  77.896678  58227.307569  58363.181331         15  
21   -0.022  210.525485  80.141086  58198.371389  58246.261794         15  
22   -0.024  210.525408  80.141055  58634.242465  58684.262211         15  
23   -0.030  210.525408  80.141089  58202.324734  58349.198137         15  
24   -0.040  210.525422  80.141056  58634.281377  58693.215486         15  
25   -0.007  210.032913  79.956261  58634.242465  58684.262211         15  
26    0.009  210.032828  79.956262  58634.281377  58693.215486         15  
27   -0.045  210.032873  79.956277  58202.324734  58349.198137         15  
28    0.000  210.032914  79.956284  58198.371389  58246.261794         15  
29   -0.021  206.599263  11.211562  58160.464306  58226.314410         16  
30   -0.033  206.599269  11.211552  58166.464525  58313.237477         15  
31   -0.022  206.599289  11.211553  58476.500000  60060.250000         15  
32   -0.006  210.282196  79.886927  58634.242465  58684.262211         15  
33   -0.043  210.282189  79.886936  58202.324734  58349.198137         15  
34    0.011  210.282109  79.886927  58634.281377  58693.215486         15  
35    0.017  210.038734  80.119469  58634.281377  58693.215486         15  
36   -0.018  210.038768  80.119466  58634.242465  58684.262211         15  
37   -0.023  210.038759  80.119500  58202.324734  58349.198137         15  
38   -0.007  210.038784  80.119504  58198.371389  58246.261794         15  
39   -0.013  210.290381  80.189614  58198.371389  58246.261794         15  
40   -0.015  210.290383  80.189573  58634.281377  58693.215486         15  
41   -0.028  210.290398  80.189568  58634.242465  58684.262211         15  
42    0.043  210.290338  80.189608  58202.324734  58349.198137         15  
43   -0.011  209.972704  80.086418  58198.371389  58246.261794         15  
44   -0.027  209.972763  80.086389  58634.242465  58684.262211         15  
45   -0.055  209.972709  80.086386  58634.281377  58693.215486         15  
46   -0.019  209.972701  80.086425  58202.324734  58349.198137         15  
47   -0.034  209.961203  79.942170  58634.281377  58693.215486         15  
48   -0.030  209.961295  79.942184  58202.324734  58349.198137         15  
49   -0.023  209.961292  79.942188  58198.371389  58246.261794         15  

[50 rows x 36 columns]]",,8.022802114486694,2025-05-22T01:05:32,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,6,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,14.970457315444946,2025-04-29T13:05:07,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
1   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
2   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
3   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
4   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
5   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
6   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
7   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
8   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
9   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
10  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
11  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
12  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
13  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
14  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
15  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
16  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
17  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
18  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
19  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
20  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
21  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
22  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
23  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
24  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
25  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
26  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
27  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
28  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
29  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
30  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
31  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
32  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
33  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
34  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
35  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
36  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
37  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
38  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
39  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
40  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
41  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
42  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
43  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
44  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
45  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
46  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
47  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
48  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
49  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    11    None         None  ...   862  12.841000     0.011  0.271   
1     False    11    None         None  ...   863  13.638000     0.013  0.210   
2     False    11    None         None  ...   862  13.611000     0.014  0.449   
3     False    11    None         None  ...   863  12.835000     0.011  0.167   
4     False    11    None         None  ...   863  13.462000     0.013  0.232   
5     False    11    None         None  ...   862  13.896000     0.018  0.688   
6     False    11    None         None  ...   862  13.469999     0.012  0.223   
7     False    11    None         None  ...   863  13.920000     0.016  0.306   
8      True     9    None         None  ...   862  16.019001     0.017  0.709   
9      True     9    None         None  ...   862  15.434999     0.019  0.725   
10     True     9    None         None  ...   863  15.436000     0.011  0.283   
11    False    12    None         None  ...   862  15.168000     0.018  0.750   
12    False    12    None         None  ...   862  14.223000     0.016  0.689   
13    False    12    None         None  ...   863  14.217000     0.012  0.234   
14    False    12    None         None  ...   863  15.181000     0.013  0.360   
15    False     9    None         None  ...   863  15.658999     0.013  0.245   
16    False     9    None         None  ...   862  16.024000     0.018  0.505   
17    False     9    None         None  ...   863  16.048000     0.014  0.392   
18     True     9    None         None  ...   862  14.011000     0.015  0.419   
19     True     9    None         None  ...   863  14.006000     0.013  0.261   
20     True     9    None         None  ...   862  15.104000     0.024  1.220   
21    False    10    None         None  ...   862  15.861999     0.011  0.444   
22    False    10    None         None  ...   874  16.750000     0.012  0.504   
23    False    10    None         None  ...   862  16.692000     0.013  0.502   
24    False    10    None         None  ...   874  15.877999     0.020  0.621   
25    False    12    None         None  ...   874  16.381000     0.011  0.362   
26    False    12    None         None  ...   874  15.905999     0.016  0.327   
27    False    12    None         None  ...   862  16.359001     0.021  1.414   
28    False    12    None         None  ...   862  15.908000     0.009  0.299   
29    False   422    None         None  ...   528  16.401001     0.017  0.509   
30    False   422    None         None  ...   528  16.765000     0.018  0.770   
31    False   422    None         None  ...  1523  16.552000     0.020  0.968   
32    False     9    None         None  ...   874  16.155000     0.012  0.396   
33    False     9    None         None  ...   862  16.136000     0.020  1.344   
34    False     9    None         None  ...   874  15.627999     0.016  0.447   
35    False    10    None         None  ...   874  15.405000     0.017  0.460   
36    False    10    None         None  ...   874  15.997000     0.015  0.718   
37    False    10    None         None  ...   862  15.972000     0.014  0.652   
38    False    10    None         None  ...   862  15.410999     0.015  0.678   
39    False    10    None         None  ...   862  15.349000     0.011  0.436   
40    False    10    None         None  ...   874  15.339000     0.021  0.827   
41    False    10    None         None  ...   874  15.743000     0.016  0.795   
42    False    10    None         None  ...   862  15.742000     0.017  1.014   
43    False    10    None         None  ...   862  16.155000     0.013  0.623   
44    False    10    None         None  ...   874  16.517000     0.014  0.641   
45    False    10    None         None  ...   874  16.147000     0.021  0.629   
46    False    10    None         None  ...   862  16.482000     0.017  0.607   
47    False    14    None         None  ...   874  16.026001     0.020  0.559   
48    False    14    None         None  ...   862  16.559000     0.017  0.830   
49    False    14    None         None  ...   862  16.037000     0.013  0.703   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0     0.001  211.716847  77.826790  58198.371389  58283.323356         15  
1    -0.015  211.716725  77.826795  58202.287060  58337.177708         15  
2    -0.004  211.716796  77.826798  58227.307569  58363.181331         15  
3     0.000  211.716745  77.826783  58186.413843  58226.403981         16  
4    -0.014  211.630568  77.854503  58186.413843  58226.403981         16  
5    -0.039  211.630642  77.854513  58227.307569  58363.181331         15  
6    -0.010  211.630665  77.854506  58198.371389  58283.323356         15  
7     0.011  211.630554  77.854515  58202.250000  58337.250000         15  
8    -0.051  211.943095  77.814396  58227.307569  58363.181331         15  
9    -0.026  211.943092  77.814389  58198.371389  58283.323356         15  
10    0.001  211.943028  77.814379  58186.413843  58226.403981         16  
11   -0.053  211.650226  77.695950  58227.307569  58363.181331         15  
12   -0.027  211.650278  77.695947  58198.371389  58283.323356         15  
13   -0.007  211.650167  77.695940  58186.413843  58226.403981         16  
14   -0.006  211.650174  77.695950  58202.287060  58337.177708         15  
15   -0.016  212.059801  77.896782  58186.413843  58226.403981         16  
16   -0.024  212.059892  77.896789  58227.307569  58363.181331         15  
17   -0.009  212.059814  77.896790  58202.250000  58337.250000         15  
18   -0.011  211.815055  77.896675  58198.371389  58283.323356         15  
19   -0.007  211.814964  77.896678  58186.413843  58226.403981         16  
20   -0.054  211.815013  77.896678  58227.307569  58363.181331         15  
21   -0.022  210.525485  80.141086  58198.371389  58246.261794         15  
22   -0.024  210.525408  80.141055  58634.242465  58684.262211         15  
23   -0.030  210.525408  80.141089  58202.324734  58349.198137         15  
24   -0.040  210.525422  80.141056  58634.281377  58693.215486         15  
25   -0.007  210.032913  79.956261  58634.242465  58684.262211         15  
26    0.009  210.032828  79.956262  58634.281377  58693.215486         15  
27   -0.045  210.032873  79.956277  58202.324734  58349.198137         15  
28    0.000  210.032914  79.956284  58198.371389  58246.261794         15  
29   -0.021  206.599263  11.211562  58160.464306  58226.314410         16  
30   -0.033  206.599269  11.211552  58166.464525  58313.237477         15  
31   -0.022  206.599289  11.211553  58476.500000  60060.250000         15  
32   -0.006  210.282196  79.886927  58634.242465  58684.262211         15  
33   -0.043  210.282189  79.886936  58202.324734  58349.198137         15  
34    0.011  210.282109  79.886927  58634.281377  58693.215486         15  
35    0.017  210.038734  80.119469  58634.281377  58693.215486         15  
36   -0.018  210.038768  80.119466  58634.242465  58684.262211         15  
37   -0.023  210.038759  80.119500  58202.324734  58349.198137         15  
38   -0.007  210.038784  80.119504  58198.371389  58246.261794         15  
39   -0.013  210.290381  80.189614  58198.371389  58246.261794         15  
40   -0.015  210.290383  80.189573  58634.281377  58693.215486         15  
41   -0.028  210.290398  80.189568  58634.242465  58684.262211         15  
42    0.043  210.290338  80.189608  58202.324734  58349.198137         15  
43   -0.011  209.972704  80.086418  58198.371389  58246.261794         15  
44   -0.027  209.972763  80.086389  58634.242465  58684.262211         15  
45   -0.055  209.972709  80.086386  58634.281377  58693.215486         15  
46   -0.019  209.972701  80.086425  58202.324734  58349.198137         15  
47   -0.034  209.961203  79.942170  58634.281377  58693.215486         15  
48   -0.030  209.961295  79.942184  58202.324734  58349.198137         15  
49   -0.023  209.961292  79.942188  58198.371389  58246.261794         15  

[50 rows x 36 columns]]",,7.972320795059204,2025-05-22T01:05:47,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,7,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,13.717798233032228,2025-04-29T13:05:21,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
1   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
2   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
3   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
4   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
5   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
6   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
7   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
8   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
9   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
10  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
11  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
12  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
13  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
14  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
15  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
16  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
17  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
18  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
19  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
20  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
21  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
22  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
23  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
24  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
25  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
26  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
27  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
28  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
29  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
30  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
31  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
32  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
33  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
34  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
35  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
36  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
37  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
38  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
39  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
40  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
41  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
42  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
43  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
44  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
45  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
46  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
47  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
48  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
49  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    11    None         None  ...   862  12.841000     0.011  0.271   
1     False    11    None         None  ...   863  13.638000     0.013  0.210   
2     False    11    None         None  ...   862  13.611000     0.014  0.449   
3     False    11    None         None  ...   863  12.835000     0.011  0.167   
4     False    11    None         None  ...   863  13.462000     0.013  0.232   
5     False    11    None         None  ...   862  13.896000     0.018  0.688   
6     False    11    None         None  ...   862  13.469999     0.012  0.223   
7     False    11    None         None  ...   863  13.920000     0.016  0.306   
8      True     9    None         None  ...   862  16.019001     0.017  0.709   
9      True     9    None         None  ...   862  15.434999     0.019  0.725   
10     True     9    None         None  ...   863  15.436000     0.011  0.283   
11    False    12    None         None  ...   862  15.168000     0.018  0.750   
12    False    12    None         None  ...   862  14.223000     0.016  0.689   
13    False    12    None         None  ...   863  14.217000     0.012  0.234   
14    False    12    None         None  ...   863  15.181000     0.013  0.360   
15    False     9    None         None  ...   863  15.658999     0.013  0.245   
16    False     9    None         None  ...   862  16.024000     0.018  0.505   
17    False     9    None         None  ...   863  16.048000     0.014  0.392   
18     True     9    None         None  ...   862  14.011000     0.015  0.419   
19     True     9    None         None  ...   863  14.006000     0.013  0.261   
20     True     9    None         None  ...   862  15.104000     0.024  1.220   
21    False    10    None         None  ...   862  15.861999     0.011  0.444   
22    False    10    None         None  ...   874  16.750000     0.012  0.504   
23    False    10    None         None  ...   862  16.692000     0.013  0.502   
24    False    10    None         None  ...   874  15.877999     0.020  0.621   
25    False    12    None         None  ...   874  16.381000     0.011  0.362   
26    False    12    None         None  ...   874  15.905999     0.016  0.327   
27    False    12    None         None  ...   862  16.359001     0.021  1.414   
28    False    12    None         None  ...   862  15.908000     0.009  0.299   
29    False   422    None         None  ...   528  16.401001     0.017  0.509   
30    False   422    None         None  ...   528  16.765000     0.018  0.770   
31    False   422    None         None  ...  1523  16.552000     0.020  0.968   
32    False     9    None         None  ...   874  16.155000     0.012  0.396   
33    False     9    None         None  ...   862  16.136000     0.020  1.344   
34    False     9    None         None  ...   874  15.627999     0.016  0.447   
35    False    10    None         None  ...   874  15.405000     0.017  0.460   
36    False    10    None         None  ...   874  15.997000     0.015  0.718   
37    False    10    None         None  ...   862  15.972000     0.014  0.652   
38    False    10    None         None  ...   862  15.410999     0.015  0.678   
39    False    10    None         None  ...   862  15.349000     0.011  0.436   
40    False    10    None         None  ...   874  15.339000     0.021  0.827   
41    False    10    None         None  ...   874  15.743000     0.016  0.795   
42    False    10    None         None  ...   862  15.742000     0.017  1.014   
43    False    10    None         None  ...   862  16.155000     0.013  0.623   
44    False    10    None         None  ...   874  16.517000     0.014  0.641   
45    False    10    None         None  ...   874  16.147000     0.021  0.629   
46    False    10    None         None  ...   862  16.482000     0.017  0.607   
47    False    14    None         None  ...   874  16.026001     0.020  0.559   
48    False    14    None         None  ...   862  16.559000     0.017  0.830   
49    False    14    None         None  ...   862  16.037000     0.013  0.703   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0     0.001  211.716847  77.826790  58198.371389  58283.323356         15  
1    -0.015  211.716725  77.826795  58202.287060  58337.177708         15  
2    -0.004  211.716796  77.826798  58227.307569  58363.181331         15  
3     0.000  211.716745  77.826783  58186.413843  58226.403981         16  
4    -0.014  211.630568  77.854503  58186.413843  58226.403981         16  
5    -0.039  211.630642  77.854513  58227.307569  58363.181331         15  
6    -0.010  211.630665  77.854506  58198.371389  58283.323356         15  
7     0.011  211.630554  77.854515  58202.250000  58337.250000         15  
8    -0.051  211.943095  77.814396  58227.307569  58363.181331         15  
9    -0.026  211.943092  77.814389  58198.371389  58283.323356         15  
10    0.001  211.943028  77.814379  58186.413843  58226.403981         16  
11   -0.053  211.650226  77.695950  58227.307569  58363.181331         15  
12   -0.027  211.650278  77.695947  58198.371389  58283.323356         15  
13   -0.007  211.650167  77.695940  58186.413843  58226.403981         16  
14   -0.006  211.650174  77.695950  58202.287060  58337.177708         15  
15   -0.016  212.059801  77.896782  58186.413843  58226.403981         16  
16   -0.024  212.059892  77.896789  58227.307569  58363.181331         15  
17   -0.009  212.059814  77.896790  58202.250000  58337.250000         15  
18   -0.011  211.815055  77.896675  58198.371389  58283.323356         15  
19   -0.007  211.814964  77.896678  58186.413843  58226.403981         16  
20   -0.054  211.815013  77.896678  58227.307569  58363.181331         15  
21   -0.022  210.525485  80.141086  58198.371389  58246.261794         15  
22   -0.024  210.525408  80.141055  58634.242465  58684.262211         15  
23   -0.030  210.525408  80.141089  58202.324734  58349.198137         15  
24   -0.040  210.525422  80.141056  58634.281377  58693.215486         15  
25   -0.007  210.032913  79.956261  58634.242465  58684.262211         15  
26    0.009  210.032828  79.956262  58634.281377  58693.215486         15  
27   -0.045  210.032873  79.956277  58202.324734  58349.198137         15  
28    0.000  210.032914  79.956284  58198.371389  58246.261794         15  
29   -0.021  206.599263  11.211562  58160.464306  58226.314410         16  
30   -0.033  206.599269  11.211552  58166.464525  58313.237477         15  
31   -0.022  206.599289  11.211553  58476.500000  60060.250000         15  
32   -0.006  210.282196  79.886927  58634.242465  58684.262211         15  
33   -0.043  210.282189  79.886936  58202.324734  58349.198137         15  
34    0.011  210.282109  79.886927  58634.281377  58693.215486         15  
35    0.017  210.038734  80.119469  58634.281377  58693.215486         15  
36   -0.018  210.038768  80.119466  58634.242465  58684.262211         15  
37   -0.023  210.038759  80.119500  58202.324734  58349.198137         15  
38   -0.007  210.038784  80.119504  58198.371389  58246.261794         15  
39   -0.013  210.290381  80.189614  58198.371389  58246.261794         15  
40   -0.015  210.290383  80.189573  58634.281377  58693.215486         15  
41   -0.028  210.290398  80.189568  58634.242465  58684.262211         15  
42    0.043  210.290338  80.189608  58202.324734  58349.198137         15  
43   -0.011  209.972704  80.086418  58198.371389  58246.261794         15  
44   -0.027  209.972763  80.086389  58634.242465  58684.262211         15  
45   -0.055  209.972709  80.086386  58634.281377  58693.215486         15  
46   -0.019  209.972701  80.086425  58202.324734  58349.198137         15  
47   -0.034  209.961203  79.942170  58634.281377  58693.215486         15  
48   -0.030  209.961295  79.942184  58202.324734  58349.198137         15  
49   -0.023  209.961292  79.942188  58198.371389  58246.261794         15  

[50 rows x 36 columns]]",,7.774698734283447,2025-05-22T01:06:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,8,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,16.742866039276123,2025-04-29T13:05:38,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
1   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
2   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
3   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
4   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
5   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
6   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
7   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
8   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
9   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
10  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
11  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
12  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
13  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
14  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
15  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
16  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
17  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
18  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
19  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
20  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
21  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
22  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
23  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
24  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
25  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
26  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
27  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
28  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
29  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
30  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
31  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
32  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
33  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
34  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
35  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
36  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
37  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
38  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
39  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
40  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
41  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
42  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
43  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
44  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
45  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
46  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
47  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
48  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
49  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    11    None         None  ...   862  12.841000     0.011  0.271   
1     False    11    None         None  ...   863  13.638000     0.013  0.210   
2     False    11    None         None  ...   862  13.611000     0.014  0.449   
3     False    11    None         None  ...   863  12.835000     0.011  0.167   
4     False    11    None         None  ...   863  13.462000     0.013  0.232   
5     False    11    None         None  ...   862  13.896000     0.018  0.688   
6     False    11    None         None  ...   862  13.469999     0.012  0.223   
7     False    11    None         None  ...   863  13.920000     0.016  0.306   
8      True     9    None         None  ...   862  16.019001     0.017  0.709   
9      True     9    None         None  ...   862  15.434999     0.019  0.725   
10     True     9    None         None  ...   863  15.436000     0.011  0.283   
11    False    12    None         None  ...   862  15.168000     0.018  0.750   
12    False    12    None         None  ...   862  14.223000     0.016  0.689   
13    False    12    None         None  ...   863  14.217000     0.012  0.234   
14    False    12    None         None  ...   863  15.181000     0.013  0.360   
15    False     9    None         None  ...   863  15.658999     0.013  0.245   
16    False     9    None         None  ...   862  16.024000     0.018  0.505   
17    False     9    None         None  ...   863  16.048000     0.014  0.392   
18     True     9    None         None  ...   862  14.011000     0.015  0.419   
19     True     9    None         None  ...   863  14.006000     0.013  0.261   
20     True     9    None         None  ...   862  15.104000     0.024  1.220   
21    False    10    None         None  ...   862  15.861999     0.011  0.444   
22    False    10    None         None  ...   874  16.750000     0.012  0.504   
23    False    10    None         None  ...   862  16.692000     0.013  0.502   
24    False    10    None         None  ...   874  15.877999     0.020  0.621   
25    False    12    None         None  ...   874  16.381000     0.011  0.362   
26    False    12    None         None  ...   874  15.905999     0.016  0.327   
27    False    12    None         None  ...   862  16.359001     0.021  1.414   
28    False    12    None         None  ...   862  15.908000     0.009  0.299   
29    False   422    None         None  ...   528  16.401001     0.017  0.509   
30    False   422    None         None  ...   528  16.765000     0.018  0.770   
31    False   422    None         None  ...  1523  16.552000     0.020  0.968   
32    False     9    None         None  ...   874  16.155000     0.012  0.396   
33    False     9    None         None  ...   862  16.136000     0.020  1.344   
34    False     9    None         None  ...   874  15.627999     0.016  0.447   
35    False    10    None         None  ...   874  15.405000     0.017  0.460   
36    False    10    None         None  ...   874  15.997000     0.015  0.718   
37    False    10    None         None  ...   862  15.972000     0.014  0.652   
38    False    10    None         None  ...   862  15.410999     0.015  0.678   
39    False    10    None         None  ...   862  15.349000     0.011  0.436   
40    False    10    None         None  ...   874  15.339000     0.021  0.827   
41    False    10    None         None  ...   874  15.743000     0.016  0.795   
42    False    10    None         None  ...   862  15.742000     0.017  1.014   
43    False    10    None         None  ...   862  16.155000     0.013  0.623   
44    False    10    None         None  ...   874  16.517000     0.014  0.641   
45    False    10    None         None  ...   874  16.147000     0.021  0.629   
46    False    10    None         None  ...   862  16.482000     0.017  0.607   
47    False    14    None         None  ...   874  16.026001     0.020  0.559   
48    False    14    None         None  ...   862  16.559000     0.017  0.830   
49    False    14    None         None  ...   862  16.037000     0.013  0.703   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0     0.001  211.716847  77.826790  58198.371389  58283.323356         15  
1    -0.015  211.716725  77.826795  58202.287060  58337.177708         15  
2    -0.004  211.716796  77.826798  58227.307569  58363.181331         15  
3     0.000  211.716745  77.826783  58186.413843  58226.403981         16  
4    -0.014  211.630568  77.854503  58186.413843  58226.403981         16  
5    -0.039  211.630642  77.854513  58227.307569  58363.181331         15  
6    -0.010  211.630665  77.854506  58198.371389  58283.323356         15  
7     0.011  211.630554  77.854515  58202.250000  58337.250000         15  
8    -0.051  211.943095  77.814396  58227.307569  58363.181331         15  
9    -0.026  211.943092  77.814389  58198.371389  58283.323356         15  
10    0.001  211.943028  77.814379  58186.413843  58226.403981         16  
11   -0.053  211.650226  77.695950  58227.307569  58363.181331         15  
12   -0.027  211.650278  77.695947  58198.371389  58283.323356         15  
13   -0.007  211.650167  77.695940  58186.413843  58226.403981         16  
14   -0.006  211.650174  77.695950  58202.287060  58337.177708         15  
15   -0.016  212.059801  77.896782  58186.413843  58226.403981         16  
16   -0.024  212.059892  77.896789  58227.307569  58363.181331         15  
17   -0.009  212.059814  77.896790  58202.250000  58337.250000         15  
18   -0.011  211.815055  77.896675  58198.371389  58283.323356         15  
19   -0.007  211.814964  77.896678  58186.413843  58226.403981         16  
20   -0.054  211.815013  77.896678  58227.307569  58363.181331         15  
21   -0.022  210.525485  80.141086  58198.371389  58246.261794         15  
22   -0.024  210.525408  80.141055  58634.242465  58684.262211         15  
23   -0.030  210.525408  80.141089  58202.324734  58349.198137         15  
24   -0.040  210.525422  80.141056  58634.281377  58693.215486         15  
25   -0.007  210.032913  79.956261  58634.242465  58684.262211         15  
26    0.009  210.032828  79.956262  58634.281377  58693.215486         15  
27   -0.045  210.032873  79.956277  58202.324734  58349.198137         15  
28    0.000  210.032914  79.956284  58198.371389  58246.261794         15  
29   -0.021  206.599263  11.211562  58160.464306  58226.314410         16  
30   -0.033  206.599269  11.211552  58166.464525  58313.237477         15  
31   -0.022  206.599289  11.211553  58476.500000  60060.250000         15  
32   -0.006  210.282196  79.886927  58634.242465  58684.262211         15  
33   -0.043  210.282189  79.886936  58202.324734  58349.198137         15  
34    0.011  210.282109  79.886927  58634.281377  58693.215486         15  
35    0.017  210.038734  80.119469  58634.281377  58693.215486         15  
36   -0.018  210.038768  80.119466  58634.242465  58684.262211         15  
37   -0.023  210.038759  80.119500  58202.324734  58349.198137         15  
38   -0.007  210.038784  80.119504  58198.371389  58246.261794         15  
39   -0.013  210.290381  80.189614  58198.371389  58246.261794         15  
40   -0.015  210.290383  80.189573  58634.281377  58693.215486         15  
41   -0.028  210.290398  80.189568  58634.242465  58684.262211         15  
42    0.043  210.290338  80.189608  58202.324734  58349.198137         15  
43   -0.011  209.972704  80.086418  58198.371389  58246.261794         15  
44   -0.027  209.972763  80.086389  58634.242465  58684.262211         15  
45   -0.055  209.972709  80.086386  58634.281377  58693.215486         15  
46   -0.019  209.972701  80.086425  58202.324734  58349.198137         15  
47   -0.034  209.961203  79.942170  58634.281377  58693.215486         15  
48   -0.030  209.961295  79.942184  58202.324734  58349.198137         15  
49   -0.023  209.961292  79.942188  58198.371389  58246.261794         15  

[50 rows x 36 columns]]",,7.985147714614868,2025-05-22T01:06:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,9,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,13.736756086349487,2025-04-29T13:05:52,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
1   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
2   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
3   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
4   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
5   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
6   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
7   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
8   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
9   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
10  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
11  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
12  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
13  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
14  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
15  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
16  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
17  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
18  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
19  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
20  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
21  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
22  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
23  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
24  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
25  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
26  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
27  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
28  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
29  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
30  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
31  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
32  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
33  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
34  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
35  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
36  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
37  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
38  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
39  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
40  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
41  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
42  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
43  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
44  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
45  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
46  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
47  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
48  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
49  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    11    None         None  ...   862  12.841000     0.011  0.271   
1     False    11    None         None  ...   863  13.638000     0.013  0.210   
2     False    11    None         None  ...   862  13.611000     0.014  0.449   
3     False    11    None         None  ...   863  12.835000     0.011  0.167   
4     False    11    None         None  ...   863  13.462000     0.013  0.232   
5     False    11    None         None  ...   862  13.896000     0.018  0.688   
6     False    11    None         None  ...   862  13.469999     0.012  0.223   
7     False    11    None         None  ...   863  13.920000     0.016  0.306   
8      True     9    None         None  ...   862  16.019001     0.017  0.709   
9      True     9    None         None  ...   862  15.434999     0.019  0.725   
10     True     9    None         None  ...   863  15.436000     0.011  0.283   
11    False    12    None         None  ...   862  15.168000     0.018  0.750   
12    False    12    None         None  ...   862  14.223000     0.016  0.689   
13    False    12    None         None  ...   863  14.217000     0.012  0.234   
14    False    12    None         None  ...   863  15.181000     0.013  0.360   
15    False     9    None         None  ...   863  15.658999     0.013  0.245   
16    False     9    None         None  ...   862  16.024000     0.018  0.505   
17    False     9    None         None  ...   863  16.048000     0.014  0.392   
18     True     9    None         None  ...   862  14.011000     0.015  0.419   
19     True     9    None         None  ...   863  14.006000     0.013  0.261   
20     True     9    None         None  ...   862  15.104000     0.024  1.220   
21    False    10    None         None  ...   862  15.861999     0.011  0.444   
22    False    10    None         None  ...   874  16.750000     0.012  0.504   
23    False    10    None         None  ...   862  16.692000     0.013  0.502   
24    False    10    None         None  ...   874  15.877999     0.020  0.621   
25    False    12    None         None  ...   874  16.381000     0.011  0.362   
26    False    12    None         None  ...   874  15.905999     0.016  0.327   
27    False    12    None         None  ...   862  16.359001     0.021  1.414   
28    False    12    None         None  ...   862  15.908000     0.009  0.299   
29    False   422    None         None  ...   528  16.401001     0.017  0.509   
30    False   422    None         None  ...   528  16.765000     0.018  0.770   
31    False   422    None         None  ...  1523  16.552000     0.020  0.968   
32    False     9    None         None  ...   874  16.155000     0.012  0.396   
33    False     9    None         None  ...   862  16.136000     0.020  1.344   
34    False     9    None         None  ...   874  15.627999     0.016  0.447   
35    False    10    None         None  ...   874  15.405000     0.017  0.460   
36    False    10    None         None  ...   874  15.997000     0.015  0.718   
37    False    10    None         None  ...   862  15.972000     0.014  0.652   
38    False    10    None         None  ...   862  15.410999     0.015  0.678   
39    False    10    None         None  ...   862  15.349000     0.011  0.436   
40    False    10    None         None  ...   874  15.339000     0.021  0.827   
41    False    10    None         None  ...   874  15.743000     0.016  0.795   
42    False    10    None         None  ...   862  15.742000     0.017  1.014   
43    False    10    None         None  ...   862  16.155000     0.013  0.623   
44    False    10    None         None  ...   874  16.517000     0.014  0.641   
45    False    10    None         None  ...   874  16.147000     0.021  0.629   
46    False    10    None         None  ...   862  16.482000     0.017  0.607   
47    False    14    None         None  ...   874  16.026001     0.020  0.559   
48    False    14    None         None  ...   862  16.559000     0.017  0.830   
49    False    14    None         None  ...   862  16.037000     0.013  0.703   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0     0.001  211.716847  77.826790  58198.371389  58283.323356         15  
1    -0.015  211.716725  77.826795  58202.287060  58337.177708         15  
2    -0.004  211.716796  77.826798  58227.307569  58363.181331         15  
3     0.000  211.716745  77.826783  58186.413843  58226.403981         16  
4    -0.014  211.630568  77.854503  58186.413843  58226.403981         16  
5    -0.039  211.630642  77.854513  58227.307569  58363.181331         15  
6    -0.010  211.630665  77.854506  58198.371389  58283.323356         15  
7     0.011  211.630554  77.854515  58202.250000  58337.250000         15  
8    -0.051  211.943095  77.814396  58227.307569  58363.181331         15  
9    -0.026  211.943092  77.814389  58198.371389  58283.323356         15  
10    0.001  211.943028  77.814379  58186.413843  58226.403981         16  
11   -0.053  211.650226  77.695950  58227.307569  58363.181331         15  
12   -0.027  211.650278  77.695947  58198.371389  58283.323356         15  
13   -0.007  211.650167  77.695940  58186.413843  58226.403981         16  
14   -0.006  211.650174  77.695950  58202.287060  58337.177708         15  
15   -0.016  212.059801  77.896782  58186.413843  58226.403981         16  
16   -0.024  212.059892  77.896789  58227.307569  58363.181331         15  
17   -0.009  212.059814  77.896790  58202.250000  58337.250000         15  
18   -0.011  211.815055  77.896675  58198.371389  58283.323356         15  
19   -0.007  211.814964  77.896678  58186.413843  58226.403981         16  
20   -0.054  211.815013  77.896678  58227.307569  58363.181331         15  
21   -0.022  210.525485  80.141086  58198.371389  58246.261794         15  
22   -0.024  210.525408  80.141055  58634.242465  58684.262211         15  
23   -0.030  210.525408  80.141089  58202.324734  58349.198137         15  
24   -0.040  210.525422  80.141056  58634.281377  58693.215486         15  
25   -0.007  210.032913  79.956261  58634.242465  58684.262211         15  
26    0.009  210.032828  79.956262  58634.281377  58693.215486         15  
27   -0.045  210.032873  79.956277  58202.324734  58349.198137         15  
28    0.000  210.032914  79.956284  58198.371389  58246.261794         15  
29   -0.021  206.599263  11.211562  58160.464306  58226.314410         16  
30   -0.033  206.599269  11.211552  58166.464525  58313.237477         15  
31   -0.022  206.599289  11.211553  58476.500000  60060.250000         15  
32   -0.006  210.282196  79.886927  58634.242465  58684.262211         15  
33   -0.043  210.282189  79.886936  58202.324734  58349.198137         15  
34    0.011  210.282109  79.886927  58634.281377  58693.215486         15  
35    0.017  210.038734  80.119469  58634.281377  58693.215486         15  
36   -0.018  210.038768  80.119466  58634.242465  58684.262211         15  
37   -0.023  210.038759  80.119500  58202.324734  58349.198137         15  
38   -0.007  210.038784  80.119504  58198.371389  58246.261794         15  
39   -0.013  210.290381  80.189614  58198.371389  58246.261794         15  
40   -0.015  210.290383  80.189573  58634.281377  58693.215486         15  
41   -0.028  210.290398  80.189568  58634.242465  58684.262211         15  
42    0.043  210.290338  80.189608  58202.324734  58349.198137         15  
43   -0.011  209.972704  80.086418  58198.371389  58246.261794         15  
44   -0.027  209.972763  80.086389  58634.242465  58684.262211         15  
45   -0.055  209.972709  80.086386  58634.281377  58693.215486         15  
46   -0.019  209.972701  80.086425  58202.324734  58349.198137         15  
47   -0.034  209.961203  79.942170  58634.281377  58693.215486         15  
48   -0.030  209.961295  79.942184  58202.324734  58349.198137         15  
49   -0.023  209.961292  79.942188  58198.371389  58246.261794         15  

[50 rows x 36 columns]]",,8.131263732910156,2025-05-22T01:06:25,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,94,10,"
SELECT * 
FROM object 
INNER JOIN reference ON object.oid = reference.oid 
WHERE object.reference_change = TRUE 
LIMIT 50
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', '\nCREATE TABLE reference (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    rfid BIGINT, /* Processing ID for reference image to facilitate archive retrieval */\n    candid BIGINT NOT NULL, /* unique identifier for the subtraction candidate (first detection for the template) */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    rcid INTEGER, /* Readout channel ID [00 .. 63] */\n    field INTEGER, /* ZTF field ID */\n    magnr DOUBLE PRECISION, /* magnitude of nearest source in reference image PSF-catalog within 30 arcsec [mag] */\n    sigmagnr DOUBLE PRECISION, /* 1-sigma uncertainty in magnr within 30 arcsec [mag] */\n    chinr DOUBLE PRECISION, /* DAOPhot chi parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    sharpnr DOUBLE PRECISION, /* DAOPhot sharp parameter of nearest source in reference image PSF-catalog within 30 arcsec */\n    ranr DOUBLE PRECISION NOT NULL, /* Right Ascension of nearest source in reference image PSF-catalog; J2000 [deg] */\n    decnr DOUBLE PRECISION NOT NULL, /* Declination of nearest source in reference image PSF-catalog; J2000 [deg] */\n    mjdstartref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of earliest exposure used to generate reference image [days] */\n    mjdendref DOUBLE PRECISION NOT NULL, /* Observation Modified Julian date of latest exposure used to generate reference image [days] */\n    nframesref INTEGER NOT NULL /* Number of frames (epochal images) used to generate reference image */\n    PRIMARY KEY (oid, rfid)\n);\n']",advanced,13.115389108657835,2025-04-29T13:06:05,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
1   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
2   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
3   ZTF18absdgxn        21      3830  58362.160590  60635.509167       True   
4   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
5   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
6   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
7   ZTF18aaxlakm        25      3821  58269.349016  60635.509167       True   
8   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
9   ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
10  ZTF18abjiezs        15      3830  58323.167697  60635.509167       True   
11  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
12  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
13  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
14  ZTF18absdgyc        26      3833  58362.160590  60635.509167       True   
15  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
16  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
17  ZTF18abjiezy        14      3842  58323.167697  60672.383507       True   
18  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
19  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
20  ZTF18aaxlakp        18      3705  58269.349016  60635.509167       True   
21  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
22  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
23  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
24  ZTF18abjicnt        19      2922  58323.167697  60635.509167       True   
25  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
26  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
27  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
28  ZTF18acyakqy        17      2923  58469.508426  60635.509167       True   
29  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
30  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
31  ZTF18aaocuut      1022      2094  58174.443900  60814.290961       True   
32  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
33  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
34  ZTF19abhzxwg        12      2110  58688.330081  60635.509167       True   
35  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
36  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
37  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
38  ZTF18abrjrul        17      2923  58359.139537  60635.509167       True   
39  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
40  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
41  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
42  ZTF18abjicmz        16      2884  58323.167697  60635.509167       True   
43  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
44  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
45  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
46  ZTF18acyakst        19      2923  58469.508426  60635.509167       True   
47  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
48  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   
49  ZTF18acyaksp        20      2923  58469.508426  60635.509167       True   

    stellar  ndet g_r_max g_r_max_corr  ... field      magnr  sigmagnr  chinr  \
0     False    11    None         None  ...   862  12.841000     0.011  0.271   
1     False    11    None         None  ...   863  13.638000     0.013  0.210   
2     False    11    None         None  ...   862  13.611000     0.014  0.449   
3     False    11    None         None  ...   863  12.835000     0.011  0.167   
4     False    11    None         None  ...   863  13.462000     0.013  0.232   
5     False    11    None         None  ...   862  13.896000     0.018  0.688   
6     False    11    None         None  ...   862  13.469999     0.012  0.223   
7     False    11    None         None  ...   863  13.920000     0.016  0.306   
8      True     9    None         None  ...   862  16.019001     0.017  0.709   
9      True     9    None         None  ...   862  15.434999     0.019  0.725   
10     True     9    None         None  ...   863  15.436000     0.011  0.283   
11    False    12    None         None  ...   862  15.168000     0.018  0.750   
12    False    12    None         None  ...   862  14.223000     0.016  0.689   
13    False    12    None         None  ...   863  14.217000     0.012  0.234   
14    False    12    None         None  ...   863  15.181000     0.013  0.360   
15    False     9    None         None  ...   863  15.658999     0.013  0.245   
16    False     9    None         None  ...   862  16.024000     0.018  0.505   
17    False     9    None         None  ...   863  16.048000     0.014  0.392   
18     True     9    None         None  ...   862  14.011000     0.015  0.419   
19     True     9    None         None  ...   863  14.006000     0.013  0.261   
20     True     9    None         None  ...   862  15.104000     0.024  1.220   
21    False    10    None         None  ...   862  15.861999     0.011  0.444   
22    False    10    None         None  ...   874  16.750000     0.012  0.504   
23    False    10    None         None  ...   862  16.692000     0.013  0.502   
24    False    10    None         None  ...   874  15.877999     0.020  0.621   
25    False    12    None         None  ...   874  16.381000     0.011  0.362   
26    False    12    None         None  ...   874  15.905999     0.016  0.327   
27    False    12    None         None  ...   862  16.359001     0.021  1.414   
28    False    12    None         None  ...   862  15.908000     0.009  0.299   
29    False   422    None         None  ...   528  16.401001     0.017  0.509   
30    False   422    None         None  ...   528  16.765000     0.018  0.770   
31    False   422    None         None  ...  1523  16.552000     0.020  0.968   
32    False     9    None         None  ...   874  16.155000     0.012  0.396   
33    False     9    None         None  ...   862  16.136000     0.020  1.344   
34    False     9    None         None  ...   874  15.627999     0.016  0.447   
35    False    10    None         None  ...   874  15.405000     0.017  0.460   
36    False    10    None         None  ...   874  15.997000     0.015  0.718   
37    False    10    None         None  ...   862  15.972000     0.014  0.652   
38    False    10    None         None  ...   862  15.410999     0.015  0.678   
39    False    10    None         None  ...   862  15.349000     0.011  0.436   
40    False    10    None         None  ...   874  15.339000     0.021  0.827   
41    False    10    None         None  ...   874  15.743000     0.016  0.795   
42    False    10    None         None  ...   862  15.742000     0.017  1.014   
43    False    10    None         None  ...   862  16.155000     0.013  0.623   
44    False    10    None         None  ...   874  16.517000     0.014  0.641   
45    False    10    None         None  ...   874  16.147000     0.021  0.629   
46    False    10    None         None  ...   862  16.482000     0.017  0.607   
47    False    14    None         None  ...   874  16.026001     0.020  0.559   
48    False    14    None         None  ...   862  16.559000     0.017  0.830   
49    False    14    None         None  ...   862  16.037000     0.013  0.703   

    sharpnr        ranr      decnr   mjdstartref     mjdendref nframesref  
0     0.001  211.716847  77.826790  58198.371389  58283.323356         15  
1    -0.015  211.716725  77.826795  58202.287060  58337.177708         15  
2    -0.004  211.716796  77.826798  58227.307569  58363.181331         15  
3     0.000  211.716745  77.826783  58186.413843  58226.403981         16  
4    -0.014  211.630568  77.854503  58186.413843  58226.403981         16  
5    -0.039  211.630642  77.854513  58227.307569  58363.181331         15  
6    -0.010  211.630665  77.854506  58198.371389  58283.323356         15  
7     0.011  211.630554  77.854515  58202.250000  58337.250000         15  
8    -0.051  211.943095  77.814396  58227.307569  58363.181331         15  
9    -0.026  211.943092  77.814389  58198.371389  58283.323356         15  
10    0.001  211.943028  77.814379  58186.413843  58226.403981         16  
11   -0.053  211.650226  77.695950  58227.307569  58363.181331         15  
12   -0.027  211.650278  77.695947  58198.371389  58283.323356         15  
13   -0.007  211.650167  77.695940  58186.413843  58226.403981         16  
14   -0.006  211.650174  77.695950  58202.287060  58337.177708         15  
15   -0.016  212.059801  77.896782  58186.413843  58226.403981         16  
16   -0.024  212.059892  77.896789  58227.307569  58363.181331         15  
17   -0.009  212.059814  77.896790  58202.250000  58337.250000         15  
18   -0.011  211.815055  77.896675  58198.371389  58283.323356         15  
19   -0.007  211.814964  77.896678  58186.413843  58226.403981         16  
20   -0.054  211.815013  77.896678  58227.307569  58363.181331         15  
21   -0.022  210.525485  80.141086  58198.371389  58246.261794         15  
22   -0.024  210.525408  80.141055  58634.242465  58684.262211         15  
23   -0.030  210.525408  80.141089  58202.324734  58349.198137         15  
24   -0.040  210.525422  80.141056  58634.281377  58693.215486         15  
25   -0.007  210.032913  79.956261  58634.242465  58684.262211         15  
26    0.009  210.032828  79.956262  58634.281377  58693.215486         15  
27   -0.045  210.032873  79.956277  58202.324734  58349.198137         15  
28    0.000  210.032914  79.956284  58198.371389  58246.261794         15  
29   -0.021  206.599263  11.211562  58160.464306  58226.314410         16  
30   -0.033  206.599269  11.211552  58166.464525  58313.237477         15  
31   -0.022  206.599289  11.211553  58476.500000  60060.250000         15  
32   -0.006  210.282196  79.886927  58634.242465  58684.262211         15  
33   -0.043  210.282189  79.886936  58202.324734  58349.198137         15  
34    0.011  210.282109  79.886927  58634.281377  58693.215486         15  
35    0.017  210.038734  80.119469  58634.281377  58693.215486         15  
36   -0.018  210.038768  80.119466  58634.242465  58684.262211         15  
37   -0.023  210.038759  80.119500  58202.324734  58349.198137         15  
38   -0.007  210.038784  80.119504  58198.371389  58246.261794         15  
39   -0.013  210.290381  80.189614  58198.371389  58246.261794         15  
40   -0.015  210.290383  80.189573  58634.281377  58693.215486         15  
41   -0.028  210.290398  80.189568  58634.242465  58684.262211         15  
42    0.043  210.290338  80.189608  58202.324734  58349.198137         15  
43   -0.011  209.972704  80.086418  58198.371389  58246.261794         15  
44   -0.027  209.972763  80.086389  58634.242465  58684.262211         15  
45   -0.055  209.972709  80.086386  58634.281377  58693.215486         15  
46   -0.019  209.972701  80.086425  58202.324734  58349.198137         15  
47   -0.034  209.961203  79.942170  58634.281377  58693.215486         15  
48   -0.030  209.961295  79.942184  58202.324734  58349.198137         15  
49   -0.023  209.961292  79.942188  58198.371389  58246.261794         15  

[50 rows x 36 columns]]",,7.87030029296875,2025-05-22T01:06:37,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,90,0,"SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier'
    AND ranking <= 2
    AND oid in
(
SELECT
    oid
FROM
    feature
WHERE
    name = 'Multiband_period'
    AND version = 'lc_classifier_1.2.1-P'
    AND value < 5
LIMIT 100
)",,,,,"[              oid classifier_name     classifier_version class_name  \
0    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        CEP   
1    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0       DSCT   
2    ZTF19abdyprc   lc_classifier   lc_classifier_1.1.13        RRL   
3    ZTF19abdyprc   lc_classifier  hierarchical_rf_1.1.0        RRL   
4    ZTF18abadjvy   lc_classifier  hierarchical_rf_1.1.0          E   
..            ...             ...                    ...        ...   
321  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0          E   
322  ZTF18abasovn   lc_classifier   lc_classifier_1.1.13          E   
323  ZTF18abasovn   lc_classifier  hierarchical_rf_1.1.0        RRL   
324  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0     Blazar   
325  ZTF22aabwnvh   lc_classifier  hierarchical_rf_1.1.0        QSO   

     probability  ranking  
0       0.155364        2  
1       0.283360        1  
2       0.190032        1  
3       0.227040        2  
4       0.093744        2  
..           ...      ...  
321     0.424664        1  
322     0.288000        1  
323     0.188956        2  
324     0.205800        2  
325     0.678160        1  

[326 rows x 6 columns]]",,3.6049187183380127,2025-05-22T01:06:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,90,1,"
-- Sub-query to filter probability table for the desired classifier and rankings
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter feature table for multiband period less than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from probability table for the filtered oids
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,18.347277402877808,2025-04-29T13:06:23,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,27.888626098632812,2025-05-22T01:07:14,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,2,"
-- Sub-query to filter objects based on the 'multiband_period' feature
WITH filtered_features AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),

-- Sub-query to filter probabilities for the light curve classifier with rankings 1 or 2
filtered_probabilities AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
)

-- Final query to retrieve all columns from the 'probability' table for the filtered objects
SELECT p.*
FROM filtered_probabilities p
INNER JOIN filtered_features f ON p.oid = f.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,21.135013580322266,2025-04-29T13:06:45,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.381310224533081,2025-05-22T01:07:27,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,3,"
-- Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for objects with a multiband period lower than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered objects
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,18.51284766197205,2025-04-29T13:07:03,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
-- Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for objects with a multiband period lower than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'Multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered objects
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",135.1279637813568,2025-05-22T01:09:47,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,90,4,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),
feature_subquery AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
      AND oid IN (SELECT oid FROM probability_subquery)
)
SELECT p.*
FROM probability p
INNER JOIN feature_subquery f ON p.oid = f.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,20.217642068862915,2025-04-29T13:07:23,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.72354245185852,2025-05-22T01:10:00,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,5,"
-- Sub-query to filter objects with a multiband period lower than 5 days in the specified feature version
WITH filtered_features AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),

-- Sub-query to filter probability table for the light curve classifier with rankings 1 or 2
filtered_probabilities AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
)

-- Final query to join the filtered results and limit to 100 objects
SELECT p.*
FROM filtered_probabilities p
INNER JOIN filtered_features f ON p.oid = f.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,20.430039644241333,2025-04-29T13:07:44,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.332231998443604,2025-05-22T01:10:13,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,6,"
-- Sub-query to filter objects with multiband period lower than 5 days in the specified feature version
WITH filtered_features AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),

-- Sub-query to filter probabilities for the light curve classifier with rankings 1 or 2
filtered_probabilities AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
)

-- Final query to select all columns from the probability table for the filtered objects
SELECT p.*
FROM filtered_probabilities p
INNER JOIN filtered_features f ON p.oid = f.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,18.98034143447876,2025-04-29T13:08:03,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,8.526397466659546,2025-05-22T01:10:26,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,7,"
-- Sub-query to filter the probability table for the light curve classifier with rankings 1 or 2
WITH probability_filtered AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for multiband period lower than 5 days in the specified version
feature_filtered AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered objects
SELECT p.*
FROM probability p
INNER JOIN probability_filtered pf ON p.oid = pf.oid
INNER JOIN feature_filtered ff ON p.oid = ff.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,19.794219255447388,2025-04-29T13:08:23,"[             oid classifier_name     classifier_version      class_name  \
0   ZTF17aaaaaal   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
1   ZTF17aaaaaal   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
2   ZTF17aaaaaal   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
3   ZTF17aaaaaal   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
4   ZTF17aaaaaal   lc_classifier  hierarchical_rf_1.1.0  Periodic-Other   
..           ...             ...                    ...             ...   
95  ZTF17aaaaaau   lc_classifier  hierarchical_rf_1.1.0  Periodic-Other   
96  ZTF17aaaaaaw   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
97  ZTF17aaaaaaw   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
98  ZTF17aaaaaaw   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
99  ZTF17aaaaaaw   lc_classifier   lc_classifier_1.1.13  Periodic-Other   

    probability  ranking  
0      0.520344        1  
1      0.520344        1  
2      0.520344        1  
3      0.520344        1  
4      0.630720        1  
..          ...      ...  
95     0.389648        2  
96     0.549472        1  
97     0.549472        1  
98     0.549472        1  
99     0.549472        1  

[100 rows x 6 columns]]",,8.817075490951538,2025-05-22T01:10:39,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,8,"
-- Sub-query to filter the probability table for the desired classifier and rankings
WITH filtered_probability AS (
    SELECT oid
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),

-- Sub-query to filter the feature table for multiband period less than 5 days
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)

-- Final query to select all columns from the probability table for the filtered oids
SELECT p.*
FROM probability p
INNER JOIN (
    SELECT oid
    FROM filtered_probability
    INTERSECT
    SELECT oid
    FROM filtered_feature
) AS filtered_oids ON p.oid = filtered_oids.oid
WHERE p.classifier_name = 'lc_classifier'
  AND p.ranking IN (1, 2)
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,24.415197372436523,2025-04-29T13:08:47,"[Empty DataFrame
Columns: [oid, classifier_name, classifier_version, class_name, probability, ranking]
Index: []]",,21.868154525756836,2025-05-22T01:11:07,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,90,9,"
WITH probability_filtered AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),
feature_filtered AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),
filtered_objects AS (
    SELECT oid
    FROM feature_filtered
    INTERSECT
    SELECT oid
    FROM probability_filtered
)
SELECT p.*
FROM probability p
INNER JOIN filtered_objects fo ON p.oid = fo.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,24.120354175567627,2025-04-29T13:09:12,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_filtered AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),
feature_filtered AS (
    SELECT oid
    FROM feature
    WHERE name = 'Multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
),
filtered_objects AS (
    SELECT oid
    FROM feature_filtered
    INTERSECT
    SELECT oid
    FROM probability_filtered
)
SELECT p.*
FROM probability p
INNER JOIN filtered_objects fo ON p.oid = fo.oid
WHERE p.classifier_name = 'lc_classifier' AND p.ranking IN (1, 2)
LIMIT 100
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",137.05724167823792,2025-05-22T01:13:28,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,90,10,"
WITH filtered_probability AS (
    SELECT *
    FROM probability
    WHERE classifier_name = 'lc_classifier'
      AND ranking IN (1, 2)
),
filtered_feature AS (
    SELECT oid
    FROM feature
    WHERE name = 'multiband_period'
      AND value < 5
      AND version = 'lc_classifier_1.2.1-P'
)
SELECT p.*
FROM filtered_probability p
INNER JOIN filtered_feature f ON p.oid = f.oid
LIMIT 100
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n']",advanced,18.95785880088806,2025-04-29T13:09:31,"[             oid classifier_name     classifier_version      class_name  \
0   ZTF18abscvmd   lc_classifier  hierarchical_rf_1.1.0             RRL   
1   ZTF18abscvmd   lc_classifier   lc_classifier_1.1.13             RRL   
2   ZTF18abscvmd   lc_classifier   lc_classifier_1.1.13         CV/Nova   
3   ZTF18abscvmd   lc_classifier  hierarchical_rf_1.1.0               E   
4   ZTF20ablxsbu   lc_classifier   lc_classifier_1.1.13  Periodic-Other   
..           ...             ...                    ...             ...   
95  ZTF18abkjhnt   lc_classifier   lc_classifier_1.1.13             YSO   
96  ZTF18adaqdfq   lc_classifier  hierarchical_rf_1.1.0  Periodic-Other   
97  ZTF18adaqdfq   lc_classifier  hierarchical_rf_1.1.0               E   
98  ZTF18acuwvpr   lc_classifier  hierarchical_rf_1.1.0  Periodic-Other   
99  ZTF18acuwvpr   lc_classifier   lc_classifier_1.1.13  Periodic-Other   

    probability  ranking  
0      0.357520        1  
1      0.380516        1  
2      0.150136        2  
3      0.214512        2  
4      0.536760        1  
..          ...      ...  
95     0.203904        2  
96     0.406080        1  
97     0.178560        2  
98     0.397536        1  
99     0.226044        1  

[100 rows x 6 columns]]",,8.595886468887329,2025-05-22T01:13:41,0.3067484662576687,1.02,1.0,1.0,0.0,1.0
0.16.3,,,51,0,"SELECT
    oid, mjd, fid, mag, e_mag, mag_corr, e_mag_corr_ext, isdiffpos
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aaiutyh'
ORDER BY mjd",,,,,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr_ext  isdiffpos  
0         0.397760         -1  
1         0.385556          1  
2         0.198804          1  
3         0.396211          1  
4         0.359854          1  
..             ...        ...  
60        0.052439          1  
61        0.056607          1  
62        0.044895          1  
63        0.116776          1  
64        0.086913          1  

[65 rows x 8 columns]]",,3.2687413692474365,2025-05-22T01:13:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,51,1,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.6832337379455566,2025-04-29T13:09:33,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,7.5358545780181885,2025-05-22T01:14:02,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,2,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.599193334579468,2025-04-29T13:09:36,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,7.997651815414429,2025-05-22T01:14:14,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,3,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.555564641952514,2025-04-29T13:09:39,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,7.961366653442383,2025-05-22T01:14:27,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,4,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.59299898147583,2025-04-29T13:09:41,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,8.869661092758179,2025-05-22T01:14:40,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,5,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.731010675430298,2025-04-29T13:09:44,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,8.012193202972412,2025-05-22T01:14:52,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,6,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.837931871414185,2025-04-29T13:09:47,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,7.611485958099365,2025-05-22T01:15:03,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,7,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.8476152420043945,2025-04-29T13:09:50,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,7.867883205413818,2025-05-22T01:15:15,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,8,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.7136693000793457,2025-04-29T13:09:53,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,7.742862939834595,2025-05-22T01:15:27,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,9,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,3.443778276443481,2025-04-29T13:09:56,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,7.5675013065338135,2025-05-22T01:15:39,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,gpt-4o,v1,51,10,"
SELECT 
    oid, 
    mjd, 
    fid, 
    mag, 
    e_mag, 
    mag_corr, 
    e_mag_corr, 
    isdiffpos
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aaiutyh'
ORDER BY 
    mjd
","['CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",simple,2.647568464279175,2025-04-29T13:09:59,"[             oid           mjd  fid        mag     e_mag   mag_corr  \
0   ZTF24aaiutyh  60379.298576    2  22.773140  1.164226  21.607100   
1   ZTF24aaiutyh  60379.353646    1  24.290796  4.187508  21.701127   
2   ZTF24aaiutyh  60388.374248    2  21.594248  0.462391  20.677787   
3   ZTF24aaiutyh  60388.403090    1  22.186195  0.958558  21.226965   
4   ZTF24aaiutyh  60391.247940    2  20.535074  0.539723  20.094963   
..           ...           ...  ...        ...       ...        ...   
60  ZTF24aaiutyh  60461.285498    2  19.569294  0.063208  19.366501   
61  ZTF24aaiutyh  60463.216609    1  19.693674  0.064697  19.548642   
62  ZTF24aaiutyh  60463.241956    2  19.620783  0.054562  19.409044   
63  ZTF24aaiutyh  60475.197060    1  19.829998  0.135698  19.666953   
64  ZTF24aaiutyh  60475.258437    2  19.761471  0.108217  19.523438   

    e_mag_corr  isdiffpos  
0     0.388676         -1  
1     0.374043          1  
2     0.195533          1  
3     0.391576          1  
4     0.359241          1  
..         ...        ...  
60    0.051329          1  
61    0.055123          1  
62    0.043485          1  
63    0.115890          1  
64    0.086023          1  

[65 rows x 8 columns]]",,7.594635009765625,2025-05-22T01:15:50,1.0,1.0,0.875,0.875,1.0,0.0
0.16.3,,,59,0,"
SELECT
    oid, fid, ndet, magmean
FROM
    magstat
WHERE
    oid = 'ZTF18acsvogv'
",,,,,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,3.2568366527557373,2025-05-22T01:15:54,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,1,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.773027896881104,2025-04-29T13:10:03,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.346185207366943,2025-05-22T01:16:07,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,2,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.8537983894348145,2025-04-29T13:10:06,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.490233898162842,2025-05-22T01:16:18,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,3,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.9110677242279053,2025-04-29T13:10:09,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.485592603683472,2025-05-22T01:16:30,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,4,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.493648290634156,2025-04-29T13:10:11,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.321670293807983,2025-05-22T01:16:41,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,5,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.66359281539917,2025-04-29T13:10:14,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.502392530441284,2025-05-22T01:16:53,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,6,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.3269176483154297,2025-04-29T13:10:17,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.633888483047485,2025-05-22T01:17:05,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,7,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,3.81549072265625,2025-04-29T13:10:21,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.708014488220215,2025-05-22T01:17:17,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,8,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.627715587615967,2025-04-29T13:10:23,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.8748250007629395,2025-05-22T01:17:29,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,9,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.5417635440826416,2025-04-29T13:10:26,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.339193105697632,2025-05-22T01:17:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,59,10,"
SELECT oid, fid, ndet, magmean
FROM magstat
WHERE oid = 'ZTF18acsvogv'
","['CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",simple,2.4931769371032715,2025-04-29T13:10:29,"[            oid  fid  ndet    magmean
0  ZTF18acsvogv    1    16  18.035183
1  ZTF18acsvogv    2    11  17.625395]",,7.2866363525390625,2025-05-22T01:17:52,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,100,0,"
SELECT
    oid, mjd, fid, isdiffpos,
    magpsf, sigmapsf, NULL as diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'detection' as table
FROM
    detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, NULL as isdiffpos,
    NULL as magpsf, NULL as sigmapsf, diffmaglim,
    CAST(NULL AS bigint) as mag,
    CAST(NULL AS bigint) as e_mag,
    'non_detection' as table
FROM
    non_detection
WHERE
    oid = 'ZTF24aamtvxb'
UNION ALL
SELECT
    oid, mjd, fid, isdiffpos,
    NULL as magpsf, NULL as sigmapsf,
    NULL as diffmaglim,
    mag, e_mag,
    'forced_photometry' as table
FROM
    forced_photometry
WHERE
    oid = 'ZTF24aamtvxb'
",,,,,"[              oid           mjd  fid  isdiffpos     magpsf  sigmapsf  \
0    ZTF24aamtvxb  60440.276505    1        1.0  18.307241  0.082498   
1    ZTF24aamtvxb  60442.171227    1        1.0  15.560810  0.033140   
2    ZTF24aamtvxb  60444.229016    1        1.0  14.585193  0.024982   
3    ZTF24aamtvxb  60449.220266    1        1.0  13.173624  0.018505   
4    ZTF24aamtvxb  60449.310336    2        1.0  13.359071  0.016791   
..            ...           ...  ...        ...        ...       ...   
244  ZTF24aamtvxb  60592.533183    2        1.0        NaN       NaN   
245  ZTF24aamtvxb  60600.525556    2        1.0        NaN       NaN   
246  ZTF24aamtvxb  60599.535475    2        1.0        NaN       NaN   
247  ZTF24aamtvxb  60595.530752    2        1.0        NaN       NaN   
248  ZTF24aamtvxb  60594.531447    2        1.0        NaN       NaN   

     diffmaglim        mag     e_mag              table  
0           NaN        NaN       NaN          detection  
1           NaN        NaN       NaN          detection  
2           NaN        NaN       NaN          detection  
3           NaN        NaN       NaN          detection  
4           NaN        NaN       NaN          detection  
..          ...        ...       ...                ...  
244         NaN  17.383959  0.047817  forced_photometry  
245         NaN  17.480049  0.060428  forced_photometry  
246         NaN  17.442333  0.028261  forced_photometry  
247         NaN  17.347569  0.024500  forced_photometry  
248         NaN  17.469713  0.041608  forced_photometry  

[249 rows x 10 columns]]",,3.545515298843384,2025-05-22T01:17:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,100,1,"
-- Subquery for detections
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    magpsf AS detection_magnitude, 
    sigmapsf AS detection_magnitude_uncertainty, 
    diffmaglim, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid, 
    mjd, 
    fid, 
    NULL AS isdiffpos, 
    NULL AS detection_magnitude, 
    NULL AS detection_magnitude_uncertainty, 
    diffmaglim, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid, 
    mjd, 
    fid, 
    isdiffpos, 
    mag AS forced_photometry_magnitude, 
    e_mag AS forced_photometry_magnitude_uncertainty, 
    NULL AS diffmaglim, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

-- Optionally order by mjd for chronological sequence
ORDER BY 
    mjd
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,27.01679968833924,2025-04-29T13:10:56,"[              oid           mjd  fid  isdiffpos  detection_magnitude  \
0    ZTF24aamtvxb  60412.344618    1        NaN                  NaN   
1    ZTF24aamtvxb  60412.344618    1       -1.0            22.838831   
2    ZTF24aamtvxb  60416.226053    2       -1.0            22.079575   
3    ZTF24aamtvxb  60416.226053    2        NaN                  NaN   
4    ZTF24aamtvxb  60421.255810    1       -1.0            21.285730   
..            ...           ...  ...        ...                  ...   
244  ZTF24aamtvxb  60761.264560    2        1.0            20.694778   
245  ZTF24aamtvxb  60761.264560    2        NaN                  NaN   
246  ZTF24aamtvxb  60761.276516    1        NaN                  NaN   
247  ZTF24aamtvxb  60761.276516    1        1.0            19.239580   
248  ZTF24aamtvxb  60772.266632    1        1.0            19.171974   

     detection_magnitude_uncertainty  diffmaglim              table  
0                                NaN   20.591200      non_detection  
1                           1.274691         NaN  forced_photometry  
2                           0.798127         NaN  forced_photometry  
3                                NaN   20.167600      non_detection  
4                           1.062008         NaN  forced_photometry  
..                               ...         ...                ...  
244                         0.160550         NaN  forced_photometry  
245                              NaN   20.848500      non_detection  
246                              NaN   20.818400      non_detection  
247                         0.046392         NaN  forced_photometry  
248                         0.164153   19.667288          detection  

[249 rows x 8 columns]]",,9.416500568389893,2025-05-22T01:18:10,1.0,1.0,0.6,0.75,1.0,0.0
0.16.3,gpt-4o,v1,100,2,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    NULL AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,31.654680967330933,2025-04-29T13:11:28,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  five_sigma_mag_limit  \
0             18.307241                        0.082498             20.226849   
1             15.560810                        0.033140             20.494621   
2             14.585193                        0.024982             20.100885   
3             13.173624                        0.018505             19.400555   
4             13.359071                        0.016791             19.018711   
..                  ...                             ...                   ...   
244                 NaN                             NaN                   NaN   
245                 NaN                             NaN                   NaN   
246                 NaN                             NaN                   NaN   
247                 NaN                             NaN                   NaN   
248                 NaN                             NaN                   NaN   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN          detection  
1                NaN                          NaN          detection  
2                NaN                          NaN          detection  
3                NaN                          NaN          detection  
4                NaN                          NaN          detection  
..               ...                          ...                ...  
244        17.383959                     0.047817  forced_photometry  
245        17.480049                     0.060428  forced_photometry  
246        17.442333                     0.028261  forced_photometry  
247        17.347569                     0.024500  forced_photometry  
248        17.469713                     0.041608  forced_photometry  

[249 rows x 10 columns]]",,9.645824670791626,2025-05-22T01:18:25,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,3,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_difference_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,24.87683629989624,2025-04-29T13:11:53,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_difference_magnitude  \
0                         18.307241   
1                         15.560810   
2                         14.585193   
3                         13.173624   
4                         13.359071   
..                              ...   
244                             NaN   
245                             NaN   
246                             NaN   
247                             NaN   
248                             NaN   

     detection_difference_magnitude_uncertainty  five_sigma_magnitude_limit  \
0                                      0.082498                   20.226849   
1                                      0.033140                   20.494621   
2                                      0.024982                   20.100885   
3                                      0.018505                   19.400555   
4                                      0.016791                   19.018711   
..                                          ...                         ...   
244                                         NaN                   18.515301   
245                                         NaN                   18.378099   
246                                         NaN                   19.415501   
247                                         NaN                   19.275900   
248                                         NaN                   18.762501   

     forced_difference_magnitude  forced_difference_magnitude_uncertainty  \
0                            NaN                                      NaN   
1                            NaN                                      NaN   
2                            NaN                                      NaN   
3                            NaN                                      NaN   
4                            NaN                                      NaN   
..                           ...                                      ...   
244                    17.383959                                 0.047817   
245                    17.480049                                 0.060428   
246                    17.442333                                 0.028261   
247                    17.347569                                 0.024500   
248                    17.469713                                 0.041608   

                 table  
0            detection  
1            detection  
2            detection  
3            detection  
4            detection  
..                 ...  
244  forced_photometry  
245  forced_photometry  
246  forced_photometry  
247  forced_photometry  
248  forced_photometry  

[249 rows x 10 columns]]",,17.127959966659546,2025-05-22T01:18:46,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,4,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    isdiffpos,
    magpsf AS detection_diff_mag,
    sigmapsf AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    NULL AS forced_diff_mag,
    NULL AS forced_diff_mag_uncertainty,
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    NULL AS isdiffpos,
    NULL AS detection_diff_mag,
    NULL AS detection_diff_mag_uncertainty,
    diffmaglim AS five_sigma_mag_limit,
    NULL AS forced_diff_mag,
    NULL AS forced_diff_mag_uncertainty,
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier,
    mjd AS epoch_date,
    fid AS filter_identifier,
    isdiffpos,
    NULL AS detection_diff_mag,
    NULL AS detection_diff_mag_uncertainty,
    NULL AS five_sigma_mag_limit,
    mag AS forced_diff_mag,
    e_mag AS forced_diff_mag_uncertainty,
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,22.28162670135498,2025-04-29T13:12:15,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  five_sigma_mag_limit  \
0             18.307241                        0.082498             20.226849   
1             15.560810                        0.033140             20.494621   
2             14.585193                        0.024982             20.100885   
3             13.173624                        0.018505             19.400555   
4             13.359071                        0.016791             19.018711   
..                  ...                             ...                   ...   
244                 NaN                             NaN                   NaN   
245                 NaN                             NaN                   NaN   
246                 NaN                             NaN                   NaN   
247                 NaN                             NaN                   NaN   
248                 NaN                             NaN                   NaN   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN          detection  
1                NaN                          NaN          detection  
2                NaN                          NaN          detection  
3                NaN                          NaN          detection  
4                NaN                          NaN          detection  
..               ...                          ...                ...  
244        17.383959                     0.047817  forced_photometry  
245        17.480049                     0.060428  forced_photometry  
246        17.442333                     0.028261  forced_photometry  
247        17.347569                     0.024500  forced_photometry  
248        17.469713                     0.041608  forced_photometry  

[249 rows x 10 columns]]",,11.564176321029663,2025-05-22T01:19:03,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,5,"
-- Subquery for Detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for Non-Detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for Forced Photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_difference_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,50.93239974975586,2025-04-29T13:13:07,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_difference_magnitude  \
0                         18.307241   
1                         15.560810   
2                         14.585193   
3                         13.173624   
4                         13.359071   
..                              ...   
244                             NaN   
245                             NaN   
246                             NaN   
247                             NaN   
248                             NaN   

     detection_difference_magnitude_uncertainty  five_sigma_magnitude_limit  \
0                                      0.082498                   20.226849   
1                                      0.033140                   20.494621   
2                                      0.024982                   20.100885   
3                                      0.018505                   19.400555   
4                                      0.016791                   19.018711   
..                                          ...                         ...   
244                                         NaN                   18.515301   
245                                         NaN                   18.378099   
246                                         NaN                   19.415501   
247                                         NaN                   19.275900   
248                                         NaN                   18.762501   

     forced_difference_magnitude  forced_difference_magnitude_uncertainty  \
0                            NaN                                      NaN   
1                            NaN                                      NaN   
2                            NaN                                      NaN   
3                            NaN                                      NaN   
4                            NaN                                      NaN   
..                           ...                                      ...   
244                    17.383959                                 0.047817   
245                    17.480049                                 0.060428   
246                    17.442333                                 0.028261   
247                    17.347569                                 0.024500   
248                    17.469713                                 0.041608   

                 table  
0            detection  
1            detection  
2            detection  
3            detection  
4            detection  
..                 ...  
244  forced_photometry  
245  forced_photometry  
246  forced_photometry  
247  forced_photometry  
248  forced_photometry  

[249 rows x 10 columns]]",,12.581249237060547,2025-05-22T01:19:20,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,6,"
-- Subquery for Detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_difference_magnitude, 
    sigmapsf AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for Non-Detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    NULL AS forced_difference_magnitude, 
    NULL AS forced_difference_magnitude_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for Forced Photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_difference_magnitude, 
    NULL AS detection_difference_magnitude_uncertainty, 
    diffmaglim AS five_sigma_magnitude_limit, 
    mag AS forced_difference_magnitude, 
    e_mag AS forced_difference_magnitude_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'

-- Order the combined results by epoch date
ORDER BY 
    epoch_date
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,23.37844204902649,2025-04-29T13:13:31,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60412.344618                  1        NaN   
1    ZTF24aamtvxb  60412.344618                  1       -1.0   
2    ZTF24aamtvxb  60416.226053                  2       -1.0   
3    ZTF24aamtvxb  60416.226053                  2        NaN   
4    ZTF24aamtvxb  60421.255810                  1       -1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60761.264560                  2        1.0   
245  ZTF24aamtvxb  60761.264560                  2        NaN   
246  ZTF24aamtvxb  60761.276516                  1        NaN   
247  ZTF24aamtvxb  60761.276516                  1        1.0   
248  ZTF24aamtvxb  60772.266632                  1        1.0   

     detection_difference_magnitude  \
0                               NaN   
1                               NaN   
2                               NaN   
3                               NaN   
4                               NaN   
..                              ...   
244                             NaN   
245                             NaN   
246                             NaN   
247                             NaN   
248                       19.171974   

     detection_difference_magnitude_uncertainty  five_sigma_magnitude_limit  \
0                                           NaN                   20.591200   
1                                           NaN                   20.591200   
2                                           NaN                   20.167601   
3                                           NaN                   20.167601   
4                                           NaN                   19.095301   
..                                          ...                         ...   
244                                         NaN                   20.848499   
245                                         NaN                   20.848499   
246                                         NaN                   20.818399   
247                                         NaN                   20.818399   
248                                    0.164153                   19.667288   

     forced_difference_magnitude  forced_difference_magnitude_uncertainty  \
0                            NaN                                      NaN   
1                      22.838831                                 1.274691   
2                      22.079575                                 0.798127   
3                            NaN                                      NaN   
4                      21.285730                                 1.062008   
..                           ...                                      ...   
244                    20.694778                                 0.160550   
245                          NaN                                      NaN   
246                          NaN                                      NaN   
247                    19.239580                                 0.046392   
248                          NaN                                      NaN   

                 table  
0        non_detection  
1    forced_photometry  
2    forced_photometry  
3        non_detection  
4    forced_photometry  
..                 ...  
244  forced_photometry  
245      non_detection  
246      non_detection  
247  forced_photometry  
248          detection  

[249 rows x 10 columns]]",,10.497657060623169,2025-05-22T01:19:35,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,7,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim AS five_sigma_mag_limit, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
ORDER BY 
    epoch_date
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,28.67788600921631,2025-04-29T13:14:00,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60412.344618                  1        NaN   
1    ZTF24aamtvxb  60412.344618                  1       -1.0   
2    ZTF24aamtvxb  60416.226053                  2       -1.0   
3    ZTF24aamtvxb  60416.226053                  2        NaN   
4    ZTF24aamtvxb  60421.255810                  1        NaN   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60761.264560                  2        NaN   
245  ZTF24aamtvxb  60761.264560                  2        1.0   
246  ZTF24aamtvxb  60761.276516                  1        1.0   
247  ZTF24aamtvxb  60761.276516                  1        NaN   
248  ZTF24aamtvxb  60772.266632                  1        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  five_sigma_mag_limit  \
0                   NaN                             NaN             20.591200   
1                   NaN                             NaN             20.591200   
2                   NaN                             NaN             20.167601   
3                   NaN                             NaN             20.167601   
4                   NaN                             NaN             19.095301   
..                  ...                             ...                   ...   
244                 NaN                             NaN             20.848499   
245                 NaN                             NaN             20.848499   
246                 NaN                             NaN             20.818399   
247                 NaN                             NaN             20.818399   
248           19.171974                        0.164153             19.667288   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN      non_detection  
1          22.838831                     1.274691  forced_photometry  
2          22.079575                     0.798127  forced_photometry  
3                NaN                          NaN      non_detection  
4                NaN                          NaN      non_detection  
..               ...                          ...                ...  
244              NaN                          NaN      non_detection  
245        20.694778                     0.160550  forced_photometry  
246        19.239580                     0.046392  forced_photometry  
247              NaN                          NaN      non_detection  
248              NaN                          NaN          detection  

[249 rows x 10 columns]]",,10.550793647766113,2025-05-22T01:19:50,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,100,8,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,25.354485034942627,2025-04-29T13:14:26,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  diffmaglim  \
0             18.307241                        0.082498   20.226849   
1             15.560810                        0.033140   20.494621   
2             14.585193                        0.024982   20.100885   
3             13.173624                        0.018505   19.400555   
4             13.359071                        0.016791   19.018711   
..                  ...                             ...         ...   
244                 NaN                             NaN   18.515301   
245                 NaN                             NaN   18.378099   
246                 NaN                             NaN   19.415501   
247                 NaN                             NaN   19.275900   
248                 NaN                             NaN   18.762501   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN          detection  
1                NaN                          NaN          detection  
2                NaN                          NaN          detection  
3                NaN                          NaN          detection  
4                NaN                          NaN          detection  
..               ...                          ...                ...  
244        17.383959                     0.047817  forced_photometry  
245        17.480049                     0.060428  forced_photometry  
246        17.442333                     0.028261  forced_photometry  
247        17.347569                     0.024500  forced_photometry  
248        17.469713                     0.041608  forced_photometry  

[249 rows x 10 columns]]",,11.907129287719727,2025-05-22T01:20:06,1.0,1.0,0.3,0.3,1.0,0.0
0.16.3,gpt-4o,v1,100,9,"
-- Subquery for detections
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    magpsf AS ""detection difference magnitude"", 
    sigmapsf AS ""detection magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    'detection' AS ""table""
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for non-detections
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    NULL AS ""isdiffpos flag"", 
    NULL AS ""detection difference magnitude"", 
    NULL AS ""detection magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    'non_detection' AS ""table""
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for forced photometry
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    mag AS ""forced difference magnitude"", 
    e_mag AS ""forced magnitude uncertainty"", 
    NULL AS ""5-sigma magnitude limit"", 
    'forced_photometry' AS ""table""
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,18.96828842163086,2025-04-29T13:14:45,[None],"(psycopg2.errors.DatatypeMismatch) UNION types text and double precision cannot be matched
LINE 49:     mag AS ""forced difference magnitude"", 
             ^

[SQL: 
-- Subquery for detections
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    magpsf AS ""detection difference magnitude"", 
    sigmapsf AS ""detection magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    NULL AS ""forced difference magnitude"", 
    NULL AS ""forced magnitude uncertainty"", 
    'detection' AS ""table""
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for non-detections
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    NULL AS ""isdiffpos flag"", 
    NULL AS ""detection difference magnitude"", 
    NULL AS ""detection magnitude uncertainty"", 
    diffmaglim AS ""5-sigma magnitude limit"", 
    NULL AS ""forced difference magnitude"", 
    NULL AS ""forced magnitude uncertainty"", 
    'non_detection' AS ""table""
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION

-- Subquery for forced photometry
SELECT 
    oid AS ""ZTF identifier"", 
    mjd AS ""epoch date"", 
    fid AS ""filter identifier"", 
    isdiffpos AS ""isdiffpos flag"", 
    NULL AS ""detection difference magnitude"", 
    NULL AS ""detection magnitude uncertainty"", 
    NULL AS ""5-sigma magnitude limit"", 
    mag AS ""forced difference magnitude"", 
    e_mag AS ""forced magnitude uncertainty"", 
    'forced_photometry' AS ""table""
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
]
(Background on this error at: https://sqlalche.me/e/20/f405)",11.423182487487793,2025-05-22T01:20:22,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,100,10,"
-- Subquery for detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    magpsf AS detection_diff_mag, 
    sigmapsf AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'detection' AS table
FROM 
    detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for non-detections
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    NULL AS isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    NULL AS forced_diff_mag, 
    NULL AS forced_diff_mag_uncertainty, 
    'non_detection' AS table
FROM 
    non_detection
WHERE 
    oid = 'ZTF24aamtvxb'

UNION ALL

-- Subquery for forced photometry
SELECT 
    oid AS ztf_identifier, 
    mjd AS epoch_date, 
    fid AS filter_identifier, 
    isdiffpos, 
    NULL AS detection_diff_mag, 
    NULL AS detection_diff_mag_uncertainty, 
    diffmaglim, 
    mag AS forced_diff_mag, 
    e_mag AS forced_diff_mag_uncertainty, 
    'forced_photometry' AS table
FROM 
    forced_photometry
WHERE 
    oid = 'ZTF24aamtvxb'
","['CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', '\nCREATE TABLE non_detection (\n    oid VARCHAR REFERENCES object(oid), /* unique identifier for this object */\n    fid INTEGER NOT NULL, /* Filter ID (1=g; 2=r; 3=i) */\n    mjd DOUBLE PRECISION NOT NULL, /* Observation Julian date at start of exposure [days] */\n    diffmaglim DOUBLE PRECISION, /* 5-sigma mag limit in difference image based on PSF-fit photometry [mag] */\n    PRIMARY KEY (oid, fid, mjd)\n);\n\nCREATE INDEX ix_non_detection_oid ON non_detection USING hash (oid);\n', 'CREATE TABLE forced_photometry ( /* this table contains information about the forced photometry */\n    pid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    mag DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    e_mag DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    mag_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    e_mag_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    e_mag_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    field INTEGER, /* field identifier */\n    rcid INTEGER, /* reference catalog identifier */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    sciinpseeing DOUBLE PRECISION, /* seeing in the science image */\n    scibckgnd DOUBLE PRECISION, /* background in the science image */\n    scisigpix DOUBLE PRECISION, /* sigma per pixel in the science image */\n    magzpsci DOUBLE PRECISION, /* zero point magnitude in the science image */\n    magzpsciunc DOUBLE PRECISION, /* uncertainty in the zero point magnitude in the science image */\n    magzpscirms DOUBLE PRECISION, /* rms of the zero point magnitude in the science image */\n    clrcoeff DOUBLE PRECISION, /* color correction coefficient */\n    clrcounc DOUBLE PRECISION, /* uncertainty in the color correction coefficient */\n    exptime DOUBLE PRECISION, /* exposure time */\n    adpctdif1 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    adpctdif2 DOUBLE PRECISION, /* percentage difference in aperture photometry */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitude */\n    programid INTEGER, /* program identifier */\n    procstatus VARCHAR, /* processing status */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    ranr DOUBLE PRECISION, /* right ascension of the nearest source in the reference image */\n    decnr DOUBLE PRECISION, /* declination of the nearest source in the reference image */\n    magnr DOUBLE PRECISION, /* magnitude of the nearest source in the reference image */\n    sigmagnr DOUBLE PRECISION, /* magnitude error of the nearest source in the reference image */\n    chinr DOUBLE PRECISION, /* chi of the nearest source in the reference image */\n    sharpnr DOUBLE PRECISION /* sharpness of the nearest source in the reference image */\n);']",advanced,20.6225802898407,2025-04-29T13:15:06,"[              oid    epoch_date  filter_identifier  isdiffpos  \
0    ZTF24aamtvxb  60440.276505                  1        1.0   
1    ZTF24aamtvxb  60442.171227                  1        1.0   
2    ZTF24aamtvxb  60444.229016                  1        1.0   
3    ZTF24aamtvxb  60449.220266                  1        1.0   
4    ZTF24aamtvxb  60449.310336                  2        1.0   
..            ...           ...                ...        ...   
244  ZTF24aamtvxb  60592.533183                  2        1.0   
245  ZTF24aamtvxb  60600.525556                  2        1.0   
246  ZTF24aamtvxb  60599.535475                  2        1.0   
247  ZTF24aamtvxb  60595.530752                  2        1.0   
248  ZTF24aamtvxb  60594.531447                  2        1.0   

     detection_diff_mag  detection_diff_mag_uncertainty  diffmaglim  \
0             18.307241                        0.082498   20.226849   
1             15.560810                        0.033140   20.494621   
2             14.585193                        0.024982   20.100885   
3             13.173624                        0.018505   19.400555   
4             13.359071                        0.016791   19.018711   
..                  ...                             ...         ...   
244                 NaN                             NaN   18.515301   
245                 NaN                             NaN   18.378099   
246                 NaN                             NaN   19.415501   
247                 NaN                             NaN   19.275900   
248                 NaN                             NaN   18.762501   

     forced_diff_mag  forced_diff_mag_uncertainty              table  
0                NaN                          NaN          detection  
1                NaN                          NaN          detection  
2                NaN                          NaN          detection  
3                NaN                          NaN          detection  
4                NaN                          NaN          detection  
..               ...                          ...                ...  
244        17.383959                     0.047817  forced_photometry  
245        17.480049                     0.060428  forced_photometry  
246        17.442333                     0.028261  forced_photometry  
247        17.347569                     0.024500  forced_photometry  
248        17.469713                     0.041608  forced_photometry  

[249 rows x 10 columns]]",,12.25382661819458,2025-05-22T01:20:39,1.0,1.0,0.3,0.3,1.0,0.0
0.16.3,,,106,0,"
SELECT
    sq1.oid, sq1.ndet, sq1.firstmjd,
    sq1.probability as prob_stamp_bogus,
    sq2.probability as prob_lc_transient
FROM
(
SELECT
    object.oid, object.ndet, object.firstmjd,
    probability.class_name,
    probability.probability
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    ndet > 10
    AND classifier_name = 'stamp_classifier'
    AND class_name = 'bogus'
    AND probability > 0.7
    AND classifier_version = 'stamp_classifier_1.0.4'
) AS sq1
INNER JOIN
(
SELECT
    *
FROM
    probability
WHERE
    classifier_name = 'lc_classifier_top'
    AND class_name = 'Transient'
    AND probability > 0.9
) AS sq2
ON sq1.oid = sq2.oid
ORDER BY sq1.oid
LIMIT 30
",,,,,"[             oid  ndet      firstmjd  prob_stamp_bogus  prob_lc_transient
0   ZTF17aaahhwn    16  60168.430151          0.771008              1.000
1   ZTF18aajkcdn    11  59904.431377          0.767230              0.954
2   ZTF18abjrfqx    56  58325.466678          0.745006              1.000
3   ZTF18ablowct    25  58334.328206          0.700790              1.000
4   ZTF18abmwnov    57  58346.359896          0.715889              1.000
5   ZTF18absdojk   368  58362.167813          0.705910              0.952
6   ZTF18abuicad    67  58371.378785          0.835837              0.956
7   ZTF18abzbkby    37  58385.452824          0.864839              0.994
8   ZTF18acbwxcc    23  58423.140255          0.777057              0.970
9   ZTF18acszayr    30  58456.220949          0.767309              0.938
10  ZTF19aaoyjoz    17  58580.254491          0.761249              0.982
11  ZTF19aauoiow   117  58636.423935          0.773761              1.000
12  ZTF19aavjzrz    94  58643.455984          0.794810              1.000
13  ZTF19aawsdlq    34  58636.421644          0.792299              1.000
14  ZTF19aazfvhh    63  58646.469097          0.722329              0.996
15  ZTF19abwsecm    26  58725.461806          0.808821              1.000
16  ZTF19abxjimu   127  58732.422708          0.721538              0.998
17  ZTF19abzqwpr    37  58746.390891          0.713936              0.998
18  ZTF19abzsnqm    20  58746.390394          0.788473              0.988
19  ZTF19acbkczc    25  58754.207940          0.911203              0.936
20  ZTF19aczmkbo    19  58836.133241          0.822191              1.000
21  ZTF20aafpojg    23  58863.214120          0.729397              0.964
22  ZTF20abjsyqn    21  59036.374190          0.710259              0.922
23  ZTF20abylbuf    90  59096.384016          0.724529              1.000
24  ZTF20acjbhhp    60  59136.325822          0.703471              1.000
25  ZTF20acoyvdg    23  59157.236493          0.705165              0.996
26  ZTF20acpmgdz    64  59165.336678          0.724588              1.000
27  ZTF20acqzjqz   107  59169.318993          0.752268              1.000
28  ZTF20acwgxhk    48  59193.197292          0.739050              0.976
29  ZTF20acxdawc    17  59193.198241          0.861717              0.968]",,41.10840439796448,2025-05-22T01:21:21,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,106,1,"
WITH bogus_prob AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
),
transient_prob AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
)
SELECT o.oid, o.ndet, o.firstmjd, bp.prob_stamp_bogus, tp.prob_lc_transient
FROM object o
INNER JOIN bogus_prob bp ON o.oid = bp.oid
INNER JOIN transient_prob tp ON o.oid = tp.oid
WHERE o.ndet > 10
ORDER BY bp.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,19.70303010940552,2025-04-29T13:15:26,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,8.748824119567871,2025-05-22T01:21:39,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,2,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.521501779556274,2025-04-29T13:15:45,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,8.41214656829834,2025-05-22T01:21:53,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,3,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,17.347552061080933,2025-04-29T13:16:03,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,8.639165878295898,2025-05-22T01:22:07,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,4,"
-- Subquery for Stamp Classifier
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),

-- Subquery for Light Curve Classifier Top Level
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)

-- Main Query
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,17.353618621826172,2025-04-29T13:16:20,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,10.024832725524902,2025-05-22T01:22:22,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,5,"
WITH prob_stamp_bogus AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),
prob_lc_transient AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)
SELECT o.oid, o.ndet, o.firstmjd, psb.prob_stamp_bogus, plt.prob_lc_transient
FROM object o
INNER JOIN prob_stamp_bogus psb ON o.oid = psb.oid
INNER JOIN prob_lc_transient plt ON o.oid = plt.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,31.18118119239807,2025-04-29T13:16:53,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,10.093291997909546,2025-05-22T01:22:38,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,6,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,18.39007806777954,2025-04-29T13:17:12,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,8.700035095214844,2025-05-22T01:22:52,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,7,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.270039796829224,2025-04-29T13:17:39,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,8.576931953430176,2025-05-22T01:23:06,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,8,"
WITH bogus_prob AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
),
transient_prob AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
)
SELECT o.oid, o.ndet, o.firstmjd, bp.prob_stamp_bogus, tp.prob_lc_transient
FROM object o
INNER JOIN bogus_prob bp ON o.oid = bp.oid
INNER JOIN transient_prob tp ON o.oid = tp.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,25.22704601287841,2025-04-29T13:18:05,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,8.718043327331543,2025-05-22T01:23:20,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,9,"
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,22.739304065704346,2025-04-29T13:18:28,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,8.80015230178833,2025-05-22T01:23:34,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,106,10,"
-- Subquery for Stamp Classifier
WITH stamp_classifier AS (
    SELECT oid, probability AS prob_stamp_bogus
    FROM probability
    WHERE class_name = 'bogus'
      AND classifier_name = 'stamp_classifier'
      AND classifier_version = 'stamp_classifier_1.0.4'
      AND probability > 0.7
      AND ranking = 1
),

-- Subquery for Light Curve Classifier Top Level
lc_classifier_top AS (
    SELECT oid, probability AS prob_lc_transient
    FROM probability
    WHERE class_name = 'transient'
      AND classifier_name = 'lc_classifier_top'
      AND probability > 0.9
      AND ranking = 1
)

-- Main Query
SELECT o.oid, o.ndet, o.firstmjd, sc.prob_stamp_bogus, lc.prob_lc_transient
FROM object o
INNER JOIN stamp_classifier sc ON o.oid = sc.oid
INNER JOIN lc_classifier_top lc ON o.oid = lc.oid
WHERE o.ndet > 10
ORDER BY o.oid
LIMIT 30
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",advanced,20.05484414100647,2025-04-29T13:18:49,"[Empty DataFrame
Columns: [oid, ndet, firstmjd, prob_stamp_bogus, prob_lc_transient]
Index: []]",,9.63677716255188,2025-05-22T01:23:52,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,56,0,"SELECT
    oid, ndet, meanra, meandec,
    firstmjd, lastmjd,
    g_r_mean, g_r_mean_corr
FROM
    object
WHERE
    oid IN ('ZTF20abywydb','ZTF20abzpxxu','ZTF20acduffd')
    AND not corrected
ORDER BY firstmjd",,,,,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,3.246260404586792,2025-05-22T01:23:56,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,1,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.596601247787476,2025-04-29T13:18:53,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.133021116256714,2025-05-22T01:24:10,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,2,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.09083890914917,2025-04-29T13:18:58,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,7.807088375091553,2025-05-22T01:24:23,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,3,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.807854413986206,2025-04-29T13:19:03,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,7.73302435874939,2025-05-22T01:24:34,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,4,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,7.341605186462402,2025-04-29T13:19:12,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,7.919952154159546,2025-05-22T01:24:47,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,5,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.350906610488892,2025-04-29T13:19:17,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.8082754611969,2025-05-22T01:25:00,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,6,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,5.907216548919678,2025-04-29T13:19:24,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.164765119552612,2025-05-22T01:25:12,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,7,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.192013025283813,2025-04-29T13:19:28,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,7.956370830535889,2025-05-22T01:25:24,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,8,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.224541902542114,2025-04-29T13:19:33,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,7.805392265319824,2025-05-22T01:25:36,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,9,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.9458179473876953,2025-04-29T13:19:38,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,7.895359992980957,2025-05-22T01:25:48,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,56,10,"
SELECT 
    oid, 
    ndet, 
    meanra, 
    meandec, 
    firstmjd, 
    lastmjd, 
    g_r_mean, 
    g_r_mean_corr 
FROM 
    object 
WHERE 
    oid IN ('ZTF20abywydb', 'ZTF20abzpxxu', 'ZTF20acduffd') 
    AND corrected = FALSE 
ORDER BY 
    firstmjd
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,4.837574005126953,2025-04-29T13:19:44,"[            oid  ndet     meanra    meandec      firstmjd       lastmjd  \
0  ZTF20abywydb    43  39.007019   3.236207  59104.424294  59168.290590   
1  ZTF20acduffd    16  37.838208  43.464778  59116.400822  59150.279444   

   g_r_mean g_r_mean_corr  
0  0.266079          None  
1       NaN          None  ]",,8.709097385406494,2025-05-22T01:26:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,48,0,"SELECT
    oid, name, value, fid, version
FROM
    feature
WHERE
    oid = 'ZTF18abqyaix'
ORDER BY name, fid, version
",,,,,"[              oid             name     value  fid                version
0    ZTF18abqyaix        Amplitude  0.269018    1  lc_classifier_1.2.1-P
1    ZTF18abqyaix        Amplitude  0.599888    2  lc_classifier_1.2.1-P
2    ZTF18abqyaix  AndersonDarling  0.249661    1  lc_classifier_1.2.1-P
3    ZTF18abqyaix  AndersonDarling  0.994609    2  lc_classifier_1.2.1-P
4    ZTF18abqyaix   Autocor_length  5.000000    1  lc_classifier_1.2.1-P
..            ...              ...       ...  ...                    ...
173  ZTF18abqyaix              Std  0.360955    2  lc_classifier_1.2.1-P
174  ZTF18abqyaix         StetsonK  0.869824    1  lc_classifier_1.2.1-P
175  ZTF18abqyaix         StetsonK  0.941219    2  lc_classifier_1.2.1-P
176  ZTF18abqyaix            W1-W2       NaN    0  lc_classifier_1.2.1-P
177  ZTF18abqyaix            W2-W3       NaN    0  lc_classifier_1.2.1-P

[178 rows x 5 columns]]",,3.527629852294922,2025-05-22T01:26:05,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,48,1,"
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""feature value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,21.570751667022705,2025-04-29T13:20:07,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.707407236099243,2025-05-22T01:26:19,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,2,"
SELECT 
    oid AS ""ZTF identifier"", 
    name AS ""feature name"", 
    value AS ""feature value"", 
    fid AS ""filter identifier"", 
    version AS ""feature version""
FROM 
    feature
WHERE 
    oid = 'ZTF18abqyaix'
ORDER BY 
    oid, fid, version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,33.88337779045105,2025-04-29T13:20:45,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.377854824066162,2025-05-22T01:26:32,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,3,"
SELECT 
    f.oid AS ""ZTF identifier"", 
    f.name AS ""feature name"", 
    f.value AS ""feature value"", 
    f.fid AS ""filter identifier"", 
    f.version AS ""feature version""
FROM 
    feature f
INNER JOIN 
    object o ON f.oid = o.oid
WHERE 
    o.oid = 'ZTF18abqyaix'
ORDER BY 
    f.oid, f.fid, f.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,22.0603575706482,2025-04-29T13:21:09,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.473721504211426,2025-05-22T01:26:45,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,4,"
SELECT 
    object.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    object.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,33.09180450439453,2025-04-29T13:21:45,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.796605587005615,2025-05-22T01:26:58,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,48,5,"
SELECT 
    object.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""feature value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    object.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,14.037034273147585,2025-04-29T13:22:00,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.452453136444092,2025-05-22T01:27:11,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,6,"
SELECT 
    f.oid AS ""ZTF identifier"", 
    f.name AS ""feature name"", 
    f.value AS ""feature value"", 
    f.fid AS ""filter identifier"", 
    f.version AS ""feature version""
FROM 
    feature f
INNER JOIN 
    object o ON f.oid = o.oid
WHERE 
    o.oid = 'ZTF18abqyaix'
ORDER BY 
    f.oid, f.fid, f.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,32.42563319206238,2025-04-29T13:22:34,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.268371343612671,2025-05-22T01:27:23,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,gpt-4o,v1,48,7,"
SELECT 
    object.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    object.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,20.89116644859314,2025-04-29T13:22:55,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.447900295257568,2025-05-22T01:27:36,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,48,8,"
-- Retrieve all features for the ZTF object 'ZTF18abqyaix'
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,20.94590830802917,2025-04-29T13:23:17,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.243374109268188,2025-05-22T01:27:49,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,48,9,"
SELECT 
    feature.oid AS ""ZTF identifier"", 
    feature.name AS ""feature name"", 
    feature.value AS ""value"", 
    feature.fid AS ""filter identifier"", 
    feature.version AS ""feature version""
FROM 
    feature
INNER JOIN 
    object ON feature.oid = object.oid
WHERE 
    object.oid = 'ZTF18abqyaix'
ORDER BY 
    feature.oid, feature.fid, feature.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",advanced,32.70031714439392,2025-04-29T13:23:51,"[    ZTF identifier    feature name     value  filter identifier  \
0     ZTF18abqyaix            g-W3       NaN                  0   
1     ZTF18abqyaix            g-W2       NaN                  0   
2     ZTF18abqyaix           W2-W3       NaN                  0   
3     ZTF18abqyaix           W1-W2       NaN                  0   
4     ZTF18abqyaix        sgscore1  0.003750                  0   
..             ...             ...       ...                ...   
173   ZTF18abqyaix    Power_rate_2  0.145128                 12   
174   ZTF18abqyaix    Power_rate_3  0.146342                 12   
175   ZTF18abqyaix    Power_rate_4  0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4  0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3  0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.012001276016235,2025-05-22T01:28:01,1.0,1.0,0.2,0.2,1.0,0.0
0.16.3,gpt-4o,v1,48,10,"
SELECT 
    f.oid AS ""ZTF identifier"", 
    f.name AS ""feature name"", 
    f.value AS ""feature value"", 
    f.fid AS ""filter identifier"", 
    f.version AS ""feature version""
FROM 
    feature f
INNER JOIN 
    object o ON f.oid = o.oid
WHERE 
    f.oid = 'ZTF18abqyaix'
ORDER BY 
    f.oid, f.fid, f.version
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE feature ( /* table with features for a given object, each row contains one feature per object */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    name VARCHAR NOT NULL, /* name of the feature */\n    value DOUBLE PRECISION, /* value of the feature */\n    fid INTEGER NOT NULL, /* which bandpass this is based (1: g, 2: r, 3: i, 12: gr, 13: gi, 23: ri, 123: gri, ) */\n    version VARCHAR REFERENCES feature_version(version) NOT NULL, /* version of the features (see table feature_version) */\n    PRIMARY KEY (oid, name, fid, version)\n);\nCREATE INDEX ix_feature_oid_2 ON feature USING hash (oid);\n', '\nCREATE TABLE feature_version (\n    version VARCHAR PRIMARY KEY, /* feature processing version */\n    step_id_feature VARCHAR REFERENCES step(step_id), /* feture step docker id*/\n    step_id_preprocess VARCHAR REFERENCES step(step_id) /* preprocess step docker id*/\n);\n']",medium,26.456074237823486,2025-04-29T13:24:18,"[    ZTF identifier    feature name  feature value  filter identifier  \
0     ZTF18abqyaix            g-W3            NaN                  0   
1     ZTF18abqyaix            g-W2            NaN                  0   
2     ZTF18abqyaix           W2-W3            NaN                  0   
3     ZTF18abqyaix           W1-W2            NaN                  0   
4     ZTF18abqyaix        sgscore1       0.003750                  0   
..             ...             ...            ...                ...   
173   ZTF18abqyaix    Power_rate_2       0.145128                 12   
174   ZTF18abqyaix    Power_rate_3       0.146342                 12   
175   ZTF18abqyaix    Power_rate_4       0.090179                 12   
176   ZTF18abqyaix  Power_rate_1/4       0.114255                 12   
177   ZTF18abqyaix  Power_rate_1/3       0.114255                 12   

           feature version  
0    lc_classifier_1.2.1-P  
1    lc_classifier_1.2.1-P  
2    lc_classifier_1.2.1-P  
3    lc_classifier_1.2.1-P  
4    lc_classifier_1.2.1-P  
..                     ...  
173  lc_classifier_1.2.1-P  
174  lc_classifier_1.2.1-P  
175  lc_classifier_1.2.1-P  
176  lc_classifier_1.2.1-P  
177  lc_classifier_1.2.1-P  

[178 rows x 5 columns]]",,8.164102792739868,2025-05-22T01:28:13,1.0,1.0,0.0,0.0,1.0,0.0
0.16.3,,,58,0,"SELECT
    *
FROM
    object
WHERE
    ndet >= 30
    AND g_r_max_corr > 3.5
    AND deltajd > 10
LIMIT 20",,,,,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abegamx       175       413  58218.504826  60421.418750       True   
1   ZTF18abjmkpw        30        94  58312.464595  58337.391563       True   
2   ZTF17aaanrma        65       355  58102.424062  59275.246366       True   
3   ZTF18aaxappq       508      1365  58262.386192  59265.542604       True   
4   ZTF20abximjo       154      1340  58377.391111  59089.405243       True   
5   ZTF18abkwfho        58      1350  58285.376493  59630.550486       True   
6   ZTF19aabnalk       400       864  58450.377697  59296.227650       True   
7   ZTF18abdlgoi       749      3505  58218.500000  59985.500000       True   
8   ZTF18acdvhuf        57       935  58099.500000  59874.500000       True   
9   ZTF19aawpuaj       239      1302  58606.331157  60463.378322      False   
10  ZTF20acrbfcl       321      1322  58733.500000  59972.250000       True   
11  ZTF18aawcfoq       198      1689  58104.087454  59622.546424      False   
12  ZTF19aasrucu       927      1567  58276.425266  59418.256887       True   
13  ZTF20acytppv       439      2347  58733.505995  60323.272431       True   
14  ZTF18abgzape       109      2320  58247.460544  60469.406088       True   
15  ZTF22aaxzsia       278      2006  58283.355718  60514.298148       True   
16  ZTF20acpjfeq       581      3734  58218.469352  60470.356933       True   
17  ZTF21aahftha       489      1941  58218.500000  60260.250000      False   
18  ZTF20acqtaqp       209      1240  58716.502187  59523.334757      False   
19  ZTF20acuvief       344       797  58092.250000  59899.250000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0      True    30  3.419998      3.596943  ...  276.410020 -12.141381   
1      True    30  3.797401      4.242042  ...  332.246586  54.571963   
2      True    30  2.503662      3.608041  ...   97.805197  10.443283   
3      True    30  4.130401      3.948899  ...  305.949658  32.516529   
4     False    30 -0.044800     77.699196  ...   43.234989  31.969326   
5      True    30  3.648983      5.369053  ...  282.692224  -4.789600   
6      True    30  3.095301      3.721657  ...  108.761044 -11.538900   
7     False    30  4.347900      4.326378  ...  295.784280  22.649020   
8     False    30  0.946190      4.951308  ...   98.631634   7.672397   
9     False    30  0.307500     78.849300  ...  264.125360  -3.569033   
10    False    30 -0.123900     79.092710  ...   90.468303 -20.128641   
11    False    30  3.383300      3.520334  ...  310.549843  35.871089   
12     True    30  3.475138      3.820012  ...  301.753875  29.373305   
13    False    30  0.904100     77.751630  ...   90.203188 -20.506283   
14    False    30  3.680100      4.137546  ...  290.258009  10.990085   
15    False    30  2.442265      3.501978  ...  276.329768  -1.413535   
16    False    30  2.575001      3.506628  ...  282.768116   8.093893   
17    False    30  3.118599      3.936478  ...  301.286563  32.979345   
18    False    30 -0.194288     78.073710  ...   61.963217 -20.351144   
19    False    30  3.220251      3.507006  ...   86.453306  -0.210206   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.050198  0.049075  2117.062361  58304.356389  60421.418750   
1   0.000267  0.000049    24.926968  58312.464595  58337.391563   
2   0.000023  0.000025   914.730903  58360.515463  59275.246366   
3   0.000141  0.000078   189.168981  59076.373623  59265.542604   
4   0.000147  0.000137    28.923843  59060.481401  59089.405243   
5   0.000016  0.000022  1322.173530  58308.376956  59630.550486   
6   0.000078  0.000100   489.745880  58806.481771  59296.227650   
7   0.000187  0.000154  1711.213692  58274.335984  59985.549676   
8   0.000045  0.000051  1447.044688  58427.455243  59874.499931   
9   0.032189  0.032127  1857.047164  58606.331157  60463.378322   
10  0.000179  0.000103   831.860810  59140.373819  59972.234630   
11  0.000106  0.000085  1363.099491  58259.446933  59622.546424   
12  0.000080  0.000054   801.834838  58616.422049  59418.256887   
13  0.032683  0.030612   422.832072  59904.414514  60327.246586   
14  0.086588  0.085000  2154.989340  58314.416748  60469.406088   
15  0.049090  0.049075   741.899722  59772.398426  60514.298148   
16  0.085855  0.085000  1325.251620  59145.105313  60470.356933   
17  0.000126  0.000121  1009.656979  59250.548819  60260.205799   
18  0.000097  0.000124   383.936829  59139.397928  59523.334757   
19  0.000086  0.000120   632.193252  59267.152049  59899.345301   

        step_id_corr  diffpos reference_change  
0             24.4.1    False            False  
1    corr_bulk_0.0.1    False            False  
2   correction_0.0.1    False            False  
3   correction_0.0.1    False            False  
4    corr_bulk_0.0.1    False            False  
5   correction_1.0.6    False             True  
6   correction_0.0.1    False            False  
7              1.1.6     True            False  
8              1.1.6    False            False  
9             24.5.1    False            False  
10             1.1.6    False            False  
11  correction_1.0.6    False            False  
12  correction_1.0.6    False            False  
13   corr_bulk_0.0.1    False            False  
14            24.5.1    False            False  
15          24.5.2a6    False            False  
16            24.5.1    False            False  
17             1.2.1    False            False  
18  correction_1.0.6    False            False  
19             1.1.6    False            False  

[20 rows x 22 columns]]",,18.083259105682373,2025-05-22T01:28:33,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,58,1,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.340736627578736,2025-04-29T13:24:21,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF21aahwwxb       110      2215  58475.418750  60727.330660      False   
1   ZTF19aatkzlh       124      1792  58580.314653  60728.486655       True   
2   ZTF22aabrzct       216       793  58598.189618  60729.255127       True   
3   ZTF22aaefgtp       147      6003  58289.377662  60797.402176      False   
4   ZTF20acfkqtc       186      1990  58596.180984  60730.202049       True   
5   ZTF19acmjgdl       689      2507  58675.476771  60731.173322       True   
6   ZTF20abjgckw       660      4830  58494.186562  60731.179039      False   
7   ZTF21aaxbnvo       797      4286  58209.516817  60732.496586       True   
8   ZTF18aamughp        31      2956  58230.266435  60735.391111       True   
9   ZTF20aaryxow       266      1039  58580.193565  60739.296273       True   
10  ZTF18adlsvti        56      5035  58259.402512  60739.492685       True   
11  ZTF19aarmnyj       204      2492  58597.216863  60743.233854       True   
12  ZTF18abdjxio       957      2410  58257.431910  60750.491377      False   
13  ZTF18abkknef        51      3905  58259.401030  60758.513762       True   
14  ZTF20acyvufd       394      2892  58523.227998  60761.173079       True   
15  ZTF18abcqbhs        84      5311  58277.395961  60773.432130       True   
16  ZTF19abrraad       366      3429  58332.234005  60774.515266       True   
17  ZTF22aajffbs       128     18166  58230.462512  60805.298993       True   
18  ZTF18adopxus        99      1813  58331.434653  60815.495741       True   
19  ZTF18acnxmbb        38      5043  58293.250000  60098.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    21  0.684301      1.092333  ...  111.641160 -20.243739   
1     False    13  0.394901     74.334330  ...  195.208084   1.031803   
2     False    10  0.044651     75.281200  ...  126.615251 -13.116317   
3     False    39  0.607959      0.846174  ...  281.228704  15.419632   
4     False    14  0.573683     78.189224  ...  111.756852  73.275737   
5     False    39  0.465783     78.755745  ...   57.638211  23.090731   
6     False    47  0.443800     78.631920  ...   51.400652  29.678751   
7     False     9  0.827801      0.314740  ...  297.066072  23.056359   
8      True     5  2.783173     -0.020756  ...  243.232529  68.586826   
9     False    12  0.078741     77.443650  ...  148.636843  -5.892735   
10    False     9  2.148153      0.974192  ...  285.969789  36.233312   
11    False    34 -0.578823     73.939156  ...  109.909110   0.891365   
12    False    69  0.529400      3.456688  ...  309.485815  45.454081   
13    False    11  1.297644      1.693893  ...  295.231756  13.443389   
14    False    17  0.087500     76.134940  ...  121.243536   1.015912   
15    False    39  1.499317      1.678068  ...  288.234455  14.817012   
16    False    30  0.212517      1.334896  ...  291.520360   2.224897   
17    False    20 -0.321200      0.308270  ...  248.831881  44.077726   
18    False     9 -1.211835      1.315274  ...   16.034976  45.670135   
19    False    11  1.278583      1.553719  ...  299.954131  22.581867   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  step_id_corr  \
0   0.017539  0.016456  1496.997639  59230.333021  60727.330660        27.4.0   
1   0.020897  0.020894  2148.172002  58580.314653  60728.486655        27.4.0   
2   0.024356  0.023721  1093.045266  59636.209861  60729.255127        27.4.0   
3   0.012253  0.011812  1123.938611  59673.463565  60797.402176        27.5.6   
4   0.075220  0.021646  1613.776065  59116.425984  60730.202049        27.4.0   
5   0.012841  0.011812  1926.829063  58804.344259  60731.173322        27.4.0   
6   0.012885  0.011195  1213.915313  59517.263727  60731.179039        27.4.0   
7   0.026847  0.024702  1436.984537  59295.512049  60732.496586        27.4.0   
8   0.087190  0.031832  2040.115185  58695.275926  60735.391111        27.4.0   
9   0.021191  0.021079  1847.980613  58891.315660  60739.296273        27.4.0   
10  0.031586  0.025478  1032.039051  59707.453634  60739.492685        27.4.0   
11  0.012524  0.012523  1607.756354  59135.477500  60743.233854        27.4.0   
12  0.013762  0.009654  2473.038368  58277.453009  60750.491377        27.4.0   
13  0.025539  0.024839  2428.138611  58330.375150  60758.513762        27.5.0   
14  0.016599  0.016596  1587.731343  59173.441736  60761.173079        27.5.2   
15  0.013479  0.013031  2496.036169  58277.395961  60773.432130        27.5.4   
16  0.012899  0.012889  1479.001343  59295.513924  60774.515266        27.5.4   
17  0.021371  0.015353  1125.970035  59679.328958  60805.298993        27.5.6   
18  0.039036  0.027278  1106.014630  59709.481111  60815.495741        27.5.6   
19  0.000150  0.000136   921.364039  59177.075706  60098.439745         1.2.0   

    diffpos reference_change  
0     False            False  
1     False            False  
2     False            False  
3     False            False  
4     False            False  
5     False            False  
6     False            False  
7     False            False  
8     False            False  
9     False            False  
10    False            False  
11    False            False  
12    False             True  
13    False             True  
14    False            False  
15    False             True  
16    False            False  
17    False            False  
18    False            False  
19    False            False  

[20 rows x 22 columns]]",,20.151267528533936,2025-05-22T01:29:05,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,2,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.6825480461120605,2025-04-29T13:24:24,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18acnxmbb        38      5043  58293.250000  60098.500000       True   
1   ZTF18aakhdqj        39      3357  58224.500000  60118.500000       True   
2   ZTF20aboretp       124      2015  58612.485776  59055.444352       True   
3   ZTF18aagvtrl       843      1908  58158.486863  59275.520347       True   
4   ZTF18aanxtgz       101      9556  58230.500000  59727.250000       True   
5   ZTF20abdcbyq        55      1443  58660.500000  60198.250000       True   
6   ZTF18abcjmyp        69      2064  58289.500000  60170.500000       True   
7   ZTF21aaldnck       576      2040  58101.138889  60447.474711       True   
8   ZTF22aajlqvz        95      1133  58607.250000  60032.500000       True   
9   ZTF18aausdmj       418      4266  58219.382824  59708.380474       True   
10  ZTF18aauegvg        87      2897  58198.500000  60212.250000       True   
11  ZTF20abvayel       122       833  58643.457789  59405.459178       True   
12  ZTF19aasjirb       228      1364  58465.296829  59532.422639      False   
13  ZTF18abjwspe        65      5771  58327.356643  60540.340255       True   
14  ZTF18abnzxue        66      2361  58349.482512  59263.198553       True   
15  ZTF20abtsvhq       142       948  58600.487535  59078.351308       True   
16  ZTF18abnoxks        95       686  58348.250000  60174.250000       True   
17  ZTF18aauqyoi       285      2066  58254.450220  59086.288484       True   
18  ZTF20aambsyh        98       679  58476.250000  59930.250000       True   
19  ZTF18aazumew        38       623  58280.409815  58700.322234       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    11  1.278583      1.553719  ...  299.954131  22.581867   
1     False    19  0.891550      0.481957  ...  282.165522  65.599045   
2     False    17  0.728600     77.899170  ...    5.088008  44.034188   
3     False    17  1.492400      0.717473  ...  248.900420  30.127482   
4     False    32  1.284920      0.915731  ...  257.013481  44.154690   
5     False    15  1.268133      0.406308  ...  316.276679   6.860404   
6     False    35  0.495692      0.625820  ...  331.252299  60.712485   
7     False    54  0.671400      0.588520  ...    9.444578  33.745565   
8     False     6  1.417500     87.308640  ...  271.569353 -12.221428   
9     False     7 -0.121070     -2.840563  ...  265.934761  22.504402   
10    False     4  1.766070      0.789168  ...  284.050253  47.873857   
11    False    20  0.143846     77.677765  ...    8.612912   8.471339   
12    False    37  0.422300     -0.194477  ...   77.442198  15.256604   
13    False    26  0.762501      0.541587  ...  242.757913  79.654936   
14    False    21  6.441300      3.058791  ...   54.198209  54.416002   
15    False    28  0.195280     -1.911835  ...  356.309701  44.005803   
16    False    36  0.269921      0.525373  ...  285.047306 -27.292185   
17     True    31 -0.131599     -1.188907  ...  278.364948  51.536930   
18    False    18  0.877872     78.543470  ...   82.180697 -12.685741   
19    False    11 -0.157976     -3.281277  ...  304.079559  23.035387   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000150  0.000136   921.364039  59177.075706  60098.439745   
1   0.000191  0.000138  1531.032812  58587.449711  60118.482523   
2   0.000202  0.000071    28.972407  59026.471944  59055.444352   
3   0.000170  0.000129  1017.129051  58258.391296  59275.520347   
4   0.000067  0.000122  1443.108981  58284.259410  59727.368391   
5   0.000091  0.000085  1198.926991  58999.428982  60198.355972   
6   0.000090  0.000043  1881.015405  58289.410370  60170.425776   
7   0.036141  0.030052  1195.311678  59252.163032  60447.474711   
8   0.000098  0.000057   352.978368  59679.463542  60032.441910   
9   0.000201  0.000116  1426.996724  58281.383750  59708.380474   
10  0.000051  0.000074  1866.853854  58345.329248  60212.183102   
11  0.000114  0.000099   349.961632  59055.497546  59405.459178   
12  0.000141  0.000086   665.237801  58867.184838  59532.422639   
13  0.361963  0.065000  1854.976806  58685.363449  60540.340255   
14  0.000292  0.000135   913.716042  58349.482512  59263.198553   
15  0.000196  0.000079    27.863958  59050.487349  59078.351308   
16  0.000113  0.000120  1826.092893  58348.210394  60174.303287   
17  0.000101  0.000054   824.834282  58261.454201  59086.288484   
18  0.000191  0.000060  1069.983380  58860.332315  59930.315694   
19  0.000340  0.000059   419.912419  58280.409815  58700.322234   

        step_id_corr  diffpos reference_change  
0              1.2.0    False            False  
1              1.2.0    False            False  
2    corr_bulk_0.0.1    False            False  
3   correction_0.0.1    False            False  
4              1.1.2    False            False  
5              1.2.1    False            False  
6              1.2.0    False            False  
7             24.4.1    False            False  
8              1.1.6     True            False  
9   correction_1.0.6    False            False  
10             1.2.1    False            False  
11  correction_0.0.1    False            False  
12  correction_1.0.6    False            False  
13          24.5.2a6    False             True  
14  correction_0.0.1    False             True  
15   corr_bulk_0.0.1    False            False  
16             1.2.0     True             True  
17   corr_bulk_0.0.1    False            False  
18             1.1.6    False            False  
19   corr_bulk_0.0.1    False            False  

[20 rows x 22 columns]]",,8.775065898895264,2025-05-22T01:29:18,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,3,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,6.398391962051392,2025-04-29T13:24:31,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aazumew        38       623  58280.409815  58700.322234       True   
1   ZTF18acfvaah        38      1467  58431.235648  60530.444086       True   
2   ZTF18abafbzp       301      1722  58255.250000  60109.250000       True   
3   ZTF18acfczxq       105      1403  58246.500000  59727.500000       True   
4   ZTF18abmrzfy        40      4298  58371.366030  60289.153831       True   
5   ZTF18aanwvwd        32      3076  58230.500000  60105.250000       True   
6   ZTF18abjhcva       131      1799  58304.359595  59056.371979      False   
7   ZTF18abnouwy        39      1307  58305.250000  60087.500000       True   
8   ZTF18abnvaik        39      1974  58348.500000  59729.500000       True   
9   ZTF20aasaako        36       530  58846.449352  58909.325671       True   
10  ZTF18ablpfyi        34      1605  58318.500000  60152.250000       True   
11  ZTF17aaakgst        53      1560  58102.250000  59873.500000       True   
12  ZTF21aaczpjs       311      2538  58450.480498  60357.370231       True   
13  ZTF18acccdzh        99       571  58424.250000  60260.250000       True   
14  ZTF21acjhdvg        92      1196  58667.444491  59517.278113       True   
15  ZTF18aboerfb        70      3223  58349.500000  60239.500000       True   
16  ZTF18abiioup       175      2627  58316.476655  60535.347893       True   
17  ZTF20aawiqru       442      1222  58672.250000  59764.500000       True   
18  ZTF18abelbdc        35      2661  58289.283287  60764.481678       True   
19  ZTF22aajmnyf        81      3315  58104.250000  59729.500000      False   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    11 -0.157976     -3.281277  ...  304.079559  23.035387   
1     False    17  3.018428      0.516718  ...   38.623909  -3.260647   
2     False    98  0.791100      0.746266  ...  228.892445  28.863350   
3     False    18  2.202647      2.050104  ...  287.919294   1.411118   
4     False    24  0.103540      1.222468  ...   28.572303  65.631261   
5     False     5  3.591940      0.836409  ...  256.368749  27.237741   
6     False    13  1.411982      1.454377  ...  299.857255  15.583631   
7     False    13  1.830768      1.730567  ...  263.483920 -15.515501   
8     False    17  1.674981      0.729885  ...   13.404528  42.921619   
9      True     6  1.398901      0.904419  ...  149.105326  67.026493   
10    False    20  3.909784      1.221599  ...  315.142843  52.365517   
11    False     5  4.040164      1.647945  ...   36.659701  60.406718   
12    False    16 -0.072300     78.171230  ...  131.955680  -6.226627   
13    False    61  1.360764      0.726143  ...   46.988152 -22.706287   
14    False     3  1.266600     77.309204  ...   21.793555  16.698251   
15    False    20  6.391053      3.047194  ...   54.198019  54.416065   
16    False    47  0.360056      0.048790  ...    0.208010  48.805634   
17    False   255 -0.064690     -0.231903  ...  310.743787  15.130596   
18    False     6  0.475910      0.629802  ...  259.319128 -20.126619   
19    False    24  0.261500     86.584930  ...   16.376486  43.977023   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000340  0.000059   419.912419  58280.409815  58700.322234   
1   0.085138  0.085000  2099.208438  58431.235648  60530.444086   
2   0.000057  0.000067  1758.192454  58351.146331  60109.338785   
3   0.000158  0.000058  1300.318542  58427.103623  59727.422164   
4   0.206007  0.085000  1944.749687  58344.404144  60289.153831   
5   0.000114  0.000026  1374.210150  58731.152558  60105.362708   
6   0.000196  0.000141   752.012384  58304.359595  59056.371979   
7   0.000152  0.000193  1739.225903  58348.197581  60087.423484   
8   0.000207  0.000144  1377.052778  58352.408831  59729.461609   
9   0.000279  0.000036    29.103692  58880.221979  58909.325671   
10  0.000216  0.000142  1833.930509  58318.415046  60152.345556   
11  0.000061  0.000060  1407.141852  58466.239792  59873.381644   
12  0.026324  0.026169  1162.930637  59194.439595  60357.370231   
13  0.000116  0.000132  1833.936296  58426.335509  60260.271806   
14  0.000103  0.000142    26.968507  59490.309606  59517.278113   
15  0.000230  0.000122  1889.921042  58349.482512  60239.403553   
16  0.056980  0.037528  2203.943738  58331.404155  60535.347893   
17  0.000045  0.000043   799.945602  58964.454028  59764.399630   
18  0.031749  0.029810  2118.209143  58646.272535  60764.481678   
19  0.000177  0.000142    21.985949  59707.483553  59729.469502   

        step_id_corr  diffpos reference_change  
0    corr_bulk_0.0.1    False            False  
1           24.5.2a6    False            False  
2              1.2.0    False            False  
3              1.1.2     True            False  
4              1.2.1    False             True  
5              1.2.0    False            False  
6    corr_bulk_0.0.1    False             True  
7              1.2.0     True            False  
8              1.1.2    False            False  
9    corr_bulk_0.0.1    False            False  
10             1.2.0    False            False  
11             1.1.6    False            False  
12   corr_bulk_0.0.1    False            False  
13             1.2.1    False             True  
14  correction_1.0.6    False            False  
15             1.2.1    False             True  
16          24.5.2a6    False            False  
17               dev    False            False  
18            27.5.4     True            False  
19             1.1.2    False            False  

[20 rows x 22 columns]]",,9.866929292678833,2025-05-22T01:29:32,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,4,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.61173152923584,2025-04-29T13:24:35,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF22aajmnyf        81      3315  58104.250000  59729.500000      False   
1   ZTF19aacwqjc        49       624  58426.485278  58597.240023       True   
2   ZTF18abhxzeg       128      2873  58204.500000  60136.500000       True   
3   ZTF19ablflmw       378      1987  58350.500000  59904.250000      False   
4   ZTF18abmavfy        54      2162  58352.390995  60537.433148       True   
5   ZTF20actkkiw        99      1235  58608.172049  60761.235000       True   
6   ZTF20acegabh        46       289  58636.421644  59117.338993      False   
7   ZTF19abwbeke        49      1137  58634.336447  60479.421933       True   
8   ZTF18abhrqoa        34      5543  58104.250000  60090.500000       True   
9   ZTF19achbwpb      1594      4454  58244.469028  60494.341377      False   
10  ZTF18acogcsw        64      3945  58439.127153  60483.351933       True   
11  ZTF18abdrqyo        36      1655  58303.264664  60472.334745       True   
12  ZTF18abfdraq        30      1699  58306.500000  59727.250000       True   
13  ZTF19aafpcjr       107      2974  58511.574016  60398.445741       True   
14  ZTF18abhopxi        34      3288  58316.250000  59727.500000       True   
15  ZTF18aagzegc        94     15470  58224.500000  60222.250000       True   
16  ZTF21aalqcsj       117       958  58723.500000  59914.500000      False   
17  ZTF19acarhgt        93      3651  58346.347245  60509.380729       True   
18  ZTF18acaxbco        32       716  58305.356238  59016.253449       True   
19  ZTF18abpumyp        32      2013  58355.250000  59783.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    24  0.261500     86.584930  ...   16.376486  43.977023   
1      True    11  0.455101      3.536147  ...  159.972466  44.678807   
2     False    19  1.303726      0.667430  ...  266.562378  56.076643   
3     False    52  0.198700     77.920210  ...   13.338592  37.982921   
4     False    20  1.076358      1.021878  ...   23.707964  64.209977   
5     False    14  0.006468     77.219970  ...  116.667336   2.422415   
6     False     5  0.301901     77.774670  ...  338.965269  -5.727165   
7     False    17  0.646511      0.502364  ...  292.011531  -8.195505   
8     False    41  1.815980      0.917959  ...   16.398192  43.976274   
9     False    58  0.111600      1.146304  ...  306.592335  64.115237   
10    False    38  1.267557      0.519638  ...  311.718775  28.566417   
11    False    14  2.645252      2.265931  ...  261.293558 -21.378588   
12    False    11  0.215895      0.365711  ...  260.692008  78.027068   
13    False    19  0.582800      0.902861  ...  271.116865   3.447029   
14    False    30 -0.132962      0.420651  ...    7.323913  51.285473   
15    False    25  0.330196      0.438265  ...  248.640849  43.972645   
16    False     8  0.810830     76.928360  ...   80.925432 -20.061548   
17    False    10  0.528500     -1.459284  ...  350.643283  38.043196   
18     True     4  4.677574      1.266912  ...  278.243851  -0.002408   
19    False     9  2.824242      0.853866  ...    4.713153  22.325983   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000177  0.000142    21.985949  59707.483553  59729.469502   
1   0.000082  0.000065   102.795324  58494.444699  58597.240023   
2   0.000241  0.000109  1772.215845  58364.179224  60136.395069   
3   0.000147  0.000064  1090.044919  58814.152569  59904.197488   
4   0.195369  0.085000  2199.032847  58338.400301  60537.433148   
5   0.018521  0.018504  1595.793252  59165.441748  60761.235000   
6   0.000145  0.000076    28.987188  59088.351806  59117.338993   
7   0.044585  0.044129  1459.036806  59020.385127  60479.421933   
8   0.000143  0.000173  1240.358148  58850.124780  60090.482928   
9   0.043569  0.019021  1715.168970  58779.172407  60494.341377   
10  0.096782  0.085000  1770.182419  58713.169514  60483.351933   
11  0.091281  0.085000  1473.021551  58999.313194  60472.334745   
12  0.000376  0.000151  1420.912813  58306.408657  59727.321470   
13  0.060213  0.060104  1502.909178  58895.536563  60398.445741   
14  0.000188  0.000166  1261.220428  58466.243588  59727.464016   
15  0.000103  0.000085  1797.057176  58425.137893  60222.195069   
16  0.000139  0.000057   661.196169  59253.189363  59914.385532   
17  0.051336  0.040430  1781.977836  58727.402893  60509.380729   
18  0.000057  0.000170    75.747951  58940.505498  59016.253449   
19  0.000133  0.000111  1428.049826  58355.359433  59783.409259   

       step_id_corr  diffpos reference_change  
0             1.1.2    False            False  
1   corr_bulk_0.0.1    False            False  
2             1.2.0     True            False  
3             1.1.6    False            False  
4          24.5.2a6    False            False  
5            27.5.2    False            False  
6   corr_bulk_0.0.1    False            False  
7            24.5.1    False            False  
8             1.2.0    False            False  
9          24.5.2a6    False            False  
10           24.5.1    False            False  
11           24.5.1    False            False  
12            1.1.2    False             True  
13            1.1.6    False            False  
14            1.1.2    False            False  
15            1.2.1    False            False  
16            1.1.6    False            False  
17         24.5.2a6    False            False  
18  corr_bulk_0.0.1    False            False  
19              dev    False            False  

[20 rows x 22 columns]]",,7.948704481124878,2025-05-22T01:29:44,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,5,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.773942232131958,2025-04-29T13:24:38,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abpumyp        32      2013  58355.250000  59783.500000       True   
1   ZTF18abplswa       274      1382  58247.500000  60076.500000       True   
2   ZTF19abnigng       326      2370  58312.500000  60116.500000      False   
3   ZTF21aajzmux       125       936  58705.500000  59958.250000       True   
4   ZTF18abcnlpo        62      5703  58290.374792  60448.400602      False   
5   ZTF22abqquoa       239      1556  58617.500000  59879.250000       True   
6   ZTF18aargvkx        49      7402  58208.500000  60188.250000       True   
7   ZTF18absddda       122       869  58362.250000  59739.250000       True   
8   ZTF20actsrhf        45       334  58434.392164  59179.274549       True   
9   ZTF18acwyzct       170      1754  58429.500000  59730.250000       True   
10  ZTF18aaxgnhp        54      3638  58267.500000  60021.250000       True   
11  ZTF18adbiomm        54       770  58481.567014  60524.180799       True   
12  ZTF18abelmbu        41      1291  58304.250000  60050.500000       True   
13  ZTF18abgueti        96      2430  58313.500000  60236.250000       True   
14  ZTF18aapcftm       484      3497  58219.404178  59710.371840       True   
15  ZTF18abeoggc        48      1217  58304.250000  59729.500000       True   
16  ZTF17aaafymn        40      1289  58101.221944  59374.465613       True   
17  ZTF18abrxmgb        30      3052  58360.250000  60085.500000       True   
18  ZTF18aahvwal        30      4988  58121.500000  60102.250000       True   
19  ZTF19aasckuo       427      3100  58586.500000  60143.250000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False     9  2.824242      0.853866  ...    4.713153  22.325983   
1     False    25  1.073742      1.543956  ...  279.754614 -13.836105   
2     False    26  0.187400     78.713615  ...  346.982213  31.112269   
3     False    10  0.302203     75.161160  ...   64.191974  -4.819466   
4     False    24  0.486600      0.944143  ...  274.473546  29.804139   
5     False    13  0.161905     78.001730  ...  320.526996  30.894558   
6     False     8  0.851923      0.271835  ...  247.679931  43.639846   
7     False    20  0.426018      0.626562  ...  270.626024   8.226568   
8     False     9  0.037264     74.904160  ...   71.720348 -19.191324   
9     False    52  0.116235      0.101227  ...  181.663422  37.244644   
10    False    21 -0.095805      0.454033  ...  267.363236  65.639228   
11    False    16  1.037703      1.407296  ...  236.506539  -9.673829   
12    False    14  0.852330      1.645801  ...  259.704342 -16.446964   
13    False     5  1.435378     -1.505037  ...  336.762523  31.180034   
14    False    66 -0.368140     -2.862864  ...  242.254162  31.983364   
15    False     8  1.439381      1.537991  ...  262.389297 -17.826286   
16     True     6  3.956520      1.009761  ...   36.301904  60.387561   
17    False     8  0.776598      0.948995  ...  292.377516   8.233209   
18    False     8  2.769831      1.150231  ...  208.461179  44.071630   
19    False   124 -0.029508      0.100962  ...  253.571125  12.626810   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000133  0.000111  1428.049826  58355.359433  59783.409259   
1   0.000049  0.000069  1427.167222  58649.274190  60076.441412   
2   0.000139  0.000065  1270.310741  58846.102558  60116.413299   
3   0.000141  0.000077   729.992905  59228.222315  59958.215220   
4   0.097957  0.085000  2158.025810  58290.374792  60448.400602   
5   0.000141  0.000119    28.082998  59851.184873  59879.267870   
6   0.000039  0.000061  1763.040799  58425.137893  60188.178692   
7   0.000054  0.000121  1377.211262  58362.147870  59739.359132   
8   0.000220  0.000073    29.896551  59149.377998  59179.274549   
9   0.000118  0.000056  1132.949421  58597.276134  59730.225556   
10  0.000273  0.000200  1737.000498  58284.370405  60021.370903   
11  0.065938  0.065000  1886.909803  58637.270995  60524.180799   
12  0.000103  0.000143  1467.977847  58582.482755  60050.460602   
13  0.000141  0.000088  1922.685556  58313.457072  60236.142627   
14  0.000121  0.000157  1456.057280  58254.314560  59710.371840   
15  0.000103  0.000059   814.954954  58914.488449  59729.443403   
16  0.000227  0.000153   943.218866  58431.246748  59374.465613   
17  0.000065  0.000092  1725.130451  58360.250718  60085.381169   
18  0.000102  0.000102  1791.025660  58311.243958  60102.269618   
19  0.000077  0.000056  1199.758009  58943.500162  60143.258171   

        step_id_corr  diffpos reference_change  
0                dev    False            False  
1              1.2.0    False            False  
2              1.2.0    False            False  
3              1.1.6    False            False  
4             24.4.1    False             True  
5              1.1.6    False            False  
6              1.2.0    False            False  
7              1.1.2    False            False  
8    corr_bulk_0.0.1    False            False  
9              1.1.2    False            False  
10             1.1.6    False            False  
11          24.5.2a6    False            False  
12             1.1.6    False            False  
13             1.2.1    False            False  
14  correction_1.0.6    False            False  
15             1.1.2     True            False  
16  correction_0.0.1    False            False  
17             1.2.0    False            False  
18             1.2.0    False            False  
19             1.2.0    False            False  

[20 rows x 22 columns]]",,10.363773822784424,2025-05-22T01:29:59,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,6,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.7577598094940186,2025-04-29T13:24:42,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19aasckuo       427      3100  58586.500000  60143.250000       True   
1   ZTF18aanubjd        42      4234  58230.500000  60164.250000       True   
2   ZTF19aatvlzl        94      1717  58336.263843  60527.331285       True   
3   ZTF19aazkihb       120      1860  58601.495231  59054.332384      False   
4   ZTF18acavhjm       233      1459  58292.293472  60484.252442       True   
5   ZTF19aaudgbh        73      6185  58608.454514  60446.450243       True   
6   ZTF19abjjekg        69      1691  58634.500000  59730.500000       True   
7   ZTF19abdcxsq       261      1681  58350.430671  59134.244607      False   
8   ZTF19abnnmmx        50      1365  58600.250000  59727.500000       True   
9   ZTF18abbadmf       154      7888  58284.254699  60503.324583       True   
10  ZTF18aaxysdu       313      2428  58261.471644  60537.255185       True   
11  ZTF20abhahak        73       577  58632.448171  59022.390590       True   
12  ZTF20aaqdkmi        71      2615  58547.360151  58900.475532       True   
13  ZTF20acpdzqn        75       507  58674.484664  59158.337569       True   
14  ZTF20acpytdg        94       490  58598.250000  60056.250000       True   
15  ZTF19abvjqnc       443      2591  58217.500000  59756.250000       True   
16  ZTF18acjvhaj        37      1573  58435.250000  60169.500000       True   
17  ZTF18aabepog        43      1794  58158.500000  60134.250000       True   
18  ZTF18aaohqpt       768      4301  58227.359572  60532.235903       True   
19  ZTF18ablswtx       164      1990  58336.500000  59729.500000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False   124 -0.029508      0.100962  ...  253.571125  12.626810   
1     False     7  0.505754      0.577671  ...  286.936084  33.838846   
2     False    41  0.411297      0.647190  ...  305.433236  14.697169   
3     False    16  0.365400     76.611510  ...  334.087148  38.915792   
4     False    49  1.987901      1.816189  ...  261.128668 -14.950878   
5     False    25  1.065825      1.482968  ...  326.730250  51.291843   
6     False    35 -0.377600      0.078836  ...  270.893076  78.027370   
7     False    36 -0.099081     -0.609830  ...    6.392573  44.283448   
8     False    11  0.622491      1.102308  ...  304.828489  15.661768   
9     False    10 -0.216918      0.357334  ...  255.490278  33.062769   
10    False    67  3.267500      3.029018  ...  324.809447  58.768485   
11    False     8  0.580578     76.327126  ...  346.426515  36.855559   
12     True     8  0.905142      0.396774  ...  224.111253  51.378658   
13    False     9  0.556164     -1.224657  ...   29.013526  -5.888587   
14    False    12 -0.184453     -2.595001  ...  125.993642 -20.593986   
15    False    33  1.060000      1.130012  ...  285.422392  16.698636   
16    False    13  4.242391      0.898762  ...    2.730069  35.040328   
17    False    11  0.947527      0.525713  ...  205.472526  28.347978   
18    False    54 -0.200400      1.295898  ...  261.770989  36.072628   
19    False    25  1.003130      1.044870  ...   13.896893  58.814176   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000077  0.000056  1199.758009  58943.500162  60143.258171   
1   0.000275  0.000125  1741.132373  58423.153750  60164.286123   
2   0.053380  0.051633  1919.862072  58607.469213  60527.331285   
3   0.000154  0.000074    37.862002  59016.470382  59054.332384   
4   0.022521  0.021759  1457.021771  59027.230671  60484.252442   
5   0.096112  0.060104  1837.995729  58608.454514  60446.450243   
6   0.000257  0.000067  1062.104178  58668.288102  59730.392280   
7   0.000228  0.000078   492.795648  58641.448958  59134.244607   
8   0.000090  0.000061  1052.961146  58674.429815  59727.390961   
9   0.077559  0.065000  1808.007373  58543.529421  60351.536794   
10  0.059040  0.030612  2268.800729  58268.454456  60537.255185   
11  0.000172  0.000079    28.907755  58993.482836  59022.390590   
12  0.000092  0.000107    24.982396  58875.493137  58900.475532   
13  0.000129  0.000054    29.070174  59129.267396  59158.337569   
14  0.000135  0.000079   916.705208  59139.501262  60056.206470   
15  0.000078  0.000043   758.911018  58997.398750  59756.309768   
16  0.000147  0.000097  1734.210810  58435.214398  60169.425208   
17  0.000109  0.000118  1856.983657  58277.256308  60134.239965   
18  0.032831  0.026536  2279.781412  58252.454491  60532.235903   
19  0.000163  0.000073  1393.064711  58336.399826  59729.464537   

       step_id_corr  diffpos reference_change  
0             1.2.0    False            False  
1             1.2.0     True            False  
2          24.5.2a6    False            False  
3   corr_bulk_0.0.1    False            False  
4            24.5.1    False            False  
5            24.4.1    False            False  
6             1.1.2    False            False  
7   corr_bulk_0.0.1    False            False  
8             1.1.2    False            False  
9             1.2.0    False            False  
10         24.5.2a6    False            False  
11  corr_bulk_0.0.1    False            False  
12  corr_bulk_0.0.1    False            False  
13  corr_bulk_0.0.1    False            False  
14            1.2.0    False            False  
15            1.1.2    False            False  
16            1.2.0    False            False  
17            1.2.0    False             True  
18         24.5.2a6    False            False  
19            1.1.2    False            False  

[20 rows x 22 columns]]",,11.239318609237671,2025-05-22T01:30:14,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,7,"
SELECT *
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,3.3424723148345947,2025-04-29T13:24:45,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18ablswtx       164      1990  58336.500000  59729.500000       True   
1   ZTF18aagflpa        31      1632  58104.346273  59496.504699       True   
2   ZTF19abjsucj       687      1926  58258.500000  59848.250000       True   
3   ZTF18abckwyd        38      3288  58290.210278  60485.251806       True   
4   ZTF18abiresl        85      1434  58246.438426  60489.356181       True   
5   ZTF19abnmkhb       160      3113  58205.500000  59727.250000       True   
6   ZTF20abngdfb       195      2079  58643.455984  59199.202037       True   
7   ZTF18aaimtvb       293      3858  58211.500000  60250.250000       True   
8   ZTF18acfyaso        68      1633  58305.500000  59729.500000      False   
9   ZTF18aaeonfy        30      1486  58512.342639  59496.504699       True   
10  ZTF18aauenwr       189       776  58252.442269  58366.186331      False   
11  ZTF19aaxmzug        36      1047  58639.371053  60437.397153       True   
12  ZTF19aayqeru       173      2376  58204.500000  60233.250000      False   
13  ZTF18abgpmvq        46      1972  58291.319259  60428.465370       True   
14  ZTF18aarbsox        59      3770  58245.161956  60308.427431       True   
15  ZTF20acqwhql        70      1480  58591.463067  59627.544468       True   
16  ZTF19aceijxa       261      2037  58342.389028  60450.482488       True   
17  ZTF18abfqgyt        31      1074  58308.250000  60091.250000       True   
18  ZTF18abdguyj        36      2096  58246.250000  59753.250000       True   
19  ZTF18abivvah        64      5740  58295.293912  60814.457593       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    25  1.003130      1.044870  ...   13.896893  58.814176   
1      True     5  1.932419      0.273892  ...  124.117892  24.547962   
2     False    79  1.527600      2.005067  ...  295.069288  -3.675507   
3     False     4  3.598699      0.820648  ...  245.938507  25.811852   
4     False    28  2.070515      1.633245  ...  283.876805 -19.228433   
5     False     8  0.746200      0.647119  ...  246.689318  22.663259   
6     False    13  0.288500     78.508930  ...   16.069792  38.304785   
7     False    41  0.021440      0.500746  ...  256.904831  34.609758   
8     False    10  0.919000      0.912121  ...   18.382963  58.440630   
9      True     6  1.336420      0.280342  ...  124.167530  24.461927   
10    False     7  0.264599     -0.929663  ...  289.982560  44.280500   
11    False    13  1.687871      1.652810  ...  265.637995 -12.923907   
12    False    32  2.014400      0.906164  ...  270.178726  19.621386   
13     True    10  1.142679      1.244737  ...  301.383652  35.651349   
14    False    10  2.513201      1.314178  ...  146.542890  65.073072   
15     True    13  0.809300      0.774595  ...  282.201939   9.437555   
16    False    34  0.918800      0.846750  ...   18.952222  42.080807   
17    False     6  1.126100      1.394703  ...  273.549543 -21.028070   
18    False    11  1.468025      0.151640  ...  206.746255  48.851620   
19    False    13  0.173291      1.180494  ...  287.898846   1.011275   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000163  0.000073  1393.064711  58336.399826  59729.464537   
1   0.000100  0.000133  1060.987164  58435.517535  59496.504699   
2   0.000132  0.000130  1147.791134  58700.378252  59848.169387   
3   0.072204  0.065000  1958.702928  58526.548877  60485.251806   
4   0.090022  0.085000  1854.916921  58634.439259  60489.356181   
5   0.000159  0.000091  1048.970718  58678.286505  59727.257222   
6   0.000170  0.000084   165.838762  59033.363276  59199.202037   
7   0.000071  0.000066  1943.845011  58306.299977  60250.144988   
8   0.000186  0.000151  1298.266285  58431.200220  59729.466505   
9   0.000041  0.000116  1060.987164  58435.517535  59496.504699   
10  0.000205  0.000170    93.731007  58272.454410  58366.185417   
11  0.045276  0.044129  1665.283299  58772.113854  60437.397153   
12  0.000225  0.000133  1468.934954  58764.195417  60233.130370   
13  0.104605  0.085000  2116.050567  58312.414803  60428.465370   
14  0.122510  0.051633  1717.087593  58591.339838  60308.427431   
15  0.000228  0.000044   463.422685  59164.121782  59627.544468   
16  0.031763  0.023575  1693.147894  58757.333646  60450.481539   
17  0.000053  0.000077  1483.889815  58607.482130  60091.371944   
18  0.000048  0.000035  1453.066458  58300.198171  59753.264630   
19  0.019306  0.019303  2522.043171  58292.414421  60814.457593   

        step_id_corr  diffpos reference_change  
0              1.1.2    False            False  
1   correction_1.0.6    False             True  
2                dev    False            False  
3             24.5.1    False            False  
4           24.5.2a6    False            False  
5              1.1.2    False            False  
6    corr_bulk_0.0.1    False            False  
7              1.2.1    False            False  
8              1.1.2    False            False  
9   correction_1.0.6    False             True  
10   corr_bulk_0.0.1    False            False  
11            24.4.1    False            False  
12             1.2.1    False            False  
13            24.4.1    False            False  
14             1.1.6    False            False  
15  correction_1.0.6    False            False  
16            24.4.1    False            False  
17             1.2.0    False            False  
18             1.1.2    False            False  
19            27.5.6    False             True  

[20 rows x 22 columns]]",,8.92431640625,2025-05-22T01:30:27,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,8,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND g_r_max_corr - g_r_mean_corr > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.695644855499268,2025-04-29T13:24:48,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18abivvah        64      5740  58295.293912  60814.457593       True   
1   ZTF18ableton        64      1855  58276.427338  60505.384016       True   
2   ZTF18abudgcn        57      3691  58311.250000  59727.500000       True   
3   ZTF18acrijmz        39      1347  58346.320451  59394.435729       True   
4   ZTF18actxrdq        34      1587  58347.250000  59727.500000      False   
5   ZTF18abkosfg        59      1535  58331.250000  59896.250000       True   
6   ZTF19aazphgt       445      1928  58607.476921  60532.307338       True   
7   ZTF20abdtlgh        63      1893  58652.500000  60115.250000       True   
8   ZTF18abcvvug       112      1349  58259.457940  60444.440000       True   
9   ZTF18absfhbq        36      3378  58362.226817  60487.375359       True   
10  ZTF19abbtvhv        77       981  58661.231111  60524.189120       True   
11  ZTF22abqxnxa        87      1464  58350.500000  59880.250000       True   
12  ZTF19abynfpa        41      3197  58373.250000  60165.500000       True   
13  ZTF19aaawtzx        37      3122  58367.250000  59877.250000      False   
14  ZTF18aandemu        45      2858  58230.500000  59740.500000       True   
15  ZTF18aazmxoo        44      2601  58279.443357  60795.421586       True   
16  ZTF18abotdef       255       987  58337.500000  59850.250000       True   
17  ZTF18abtglsg       209      1283  58363.500000  59932.250000       True   
18  ZTF18abicxzt        34      4329  58427.250000  59780.500000       True   
19  ZTF19aashzrv       678      4126  58541.440984  60526.257465       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    13  0.173291      1.180494  ...  287.898846   1.011275   
1     False    28  0.578855      0.557077  ...  291.503775  54.698335   
2     False    12  0.054337      0.533815  ...  266.883905  29.763494   
3      True     4  2.849312      0.922005  ...  311.366843  35.769748   
4     False     5  0.705878      1.401645  ...  319.299574  54.699761   
5     False    38  5.720107      1.584591  ...  315.212714  52.765007   
6     False    37  0.262568      0.856723  ...  341.934155  37.224801   
7     False    20  0.869040      0.644171  ...  312.948585  37.110106   
8     False    21  1.476488      1.605783  ...  271.561827 -12.497110   
9     False    24  0.643421      0.541035  ...  274.207270  13.477823   
10    False    52  2.025874      1.947606  ...  259.231566 -22.045484   
11    False    12  0.682041     75.762670  ...   48.671795  58.903269   
12    False     7  2.262352      1.056100  ...  284.486589  77.726684   
13    False     7  1.266201      2.482714  ...  309.471878  36.992220   
14    False    10  1.304821      1.009965  ...  255.577223  36.974152   
15    False    19  2.436571      1.809785  ...  292.404859   8.737724   
16    False    87 -0.320107     -0.217556  ...   30.317061  -1.224103   
17    False    74 -0.175700     -2.410726  ...   34.570617   3.319457   
18    False    13  1.399205      0.385716  ...  333.546774  36.905813   
19    False   111  0.260200      0.353372  ...  244.973884  39.919363   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.019306  0.019303  2522.043171  58292.414421  60814.457593   
1   0.089349  0.051633  2173.063021  58332.320995  60505.384016   
2   0.000053  0.000129  1348.193461  58379.243762  59727.437222   
3   0.000057  0.000060   709.051725  58685.384005  59394.435729   
4   0.000231  0.000208  1270.294421  58457.161042  59727.455463   
5   0.000159  0.000069  1564.791829  58331.365081  59896.156910   
6   0.031023  0.024702  1424.952824  59107.354514  60532.307338   
7   0.000102  0.000098  1116.930694  58998.427477  60115.358171   
8   0.041411  0.040430  2151.146620  58293.293380  60444.440000   
9   0.047264  0.045962  2125.148542  58362.226817  60487.375359   
10  0.070127  0.065000  1850.891458  58673.297662  60524.189120   
11  0.000245  0.000146    29.837488  59850.341516  59880.179005   
12  0.000355  0.000142  1444.104259  58721.276609  60165.380868   
13  0.000178  0.000110  1389.039722  58488.135937  59877.175660   
14  0.000079  0.000112   783.906250  58956.485914  59740.392164   
15  0.018110  0.017900  2515.978229  58279.443357  60795.421586   
16  0.000044  0.000067  1487.872465  58362.485116  59850.357581   
17  0.000049  0.000059  1568.818889  58363.401806  59932.220694   
18  0.000130  0.000123  1059.119919  58721.260162  59780.380081   
19  0.029349  0.022509  1854.041215  58672.216250  60526.257465   

        step_id_corr  diffpos reference_change  
0             27.5.6    False             True  
1           24.5.2a6    False            False  
2              1.1.2    False            False  
3   correction_0.0.1    False            False  
4              1.1.2    False            False  
5              1.1.6    False            False  
6           24.5.2a6    False            False  
7              1.2.0    False            False  
8             24.4.1    False            False  
9             24.5.1    False            False  
10          24.5.2a6    False            False  
11             1.1.6    False            False  
12             1.2.0    False            False  
13             1.1.6    False            False  
14             1.1.2    False            False  
15            27.5.6    False             True  
16               dev    False            False  
17             1.1.6    False             True  
18               dev    False            False  
19          24.5.2a6    False            False  

[20 rows x 22 columns]]",,9.054795026779175,2025-05-22T01:30:41,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,9,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.774667501449585,2025-04-29T13:24:52,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF19aashzrv       678      4126  58541.440984  60526.257465       True   
1   ZTF18ablvfaw        63      1098  58337.344063  58885.136123       True   
2   ZTF18abrmqkb        55      3767  58321.275556  60326.561169      False   
3   ZTF20aahlfto       216       855  58748.500000  59932.500000       True   
4   ZTF19abrkqwm        31      1230  58719.250000  60228.250000       True   
5   ZTF19aaprnse       219      1685  58303.243194  60463.376435      False   
6   ZTF19aazkbjy        37      1730  58647.500000  60230.250000       True   
7   ZTF18abecgqq        52      5569  58307.380683  60538.261528       True   
8   ZTF18acrixop       127      1812  58252.500000  60084.500000       True   
9   ZTF19aayulwe        61       637  58642.417732  59459.272882       True   
10  ZTF20abnljzr       151       608  58607.467407  59051.363808      False   
11  ZTF19aaqseov        57      1876  58317.423056  60456.449005      False   
12  ZTF20acyzxuc        81      1092  58350.427268  59204.256042       True   
13  ZTF18achlnex       173      2805  58329.500000  59727.500000       True   
14  ZTF18acjwzcy        34       820  58435.250000  60217.250000       True   
15  ZTF18aahaper        73      4233  58217.250000  59740.250000       True   
16  ZTF23aahqfhe        76       861  58598.143530  60743.316551       True   
17  ZTF19abeqlrf        36      1500  58434.250000  60080.500000       True   
18  ZTF20acqzutg        90       659  58428.375185  59169.358843      False   
19  ZTF18aalridh       500      2359  58160.500000  60076.250000       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False   111  0.260200      0.353372  ...  244.973884  39.919363   
1     False     3  1.505138      2.362437  ...  349.510339  51.441918   
2     False    42  2.017520      0.775916  ...  270.988031  20.685347   
3     False     9  0.825599     78.217430  ...  100.873509 -13.088356   
4     False    23  0.730379      0.587789  ...  306.000317   8.629247   
5     False    34  2.627100      2.800004  ...  261.570740 -22.884459   
6     False    18  2.834084      0.690972  ...  327.113161  41.315556   
7     False    30  1.951188      1.072473  ...  301.620274  36.976749   
8     False    26  0.482965      0.602606  ...  312.058834  34.554126   
9     False     7  0.105793     78.430405  ...  305.550193 -27.467440   
10    False     9  0.744900      1.341910  ...  305.386921 -12.010920   
11    False    59  2.447700      2.155041  ...  324.904286  31.741786   
12    False     7  0.360558     76.610670  ...   35.051965  59.001426   
13    False    13  0.782000      0.622522  ...   12.344955  32.263720   
14    False    25  3.522466      0.743568  ...   10.566665 -17.381079   
15    False    16  1.371950      0.316795  ...  222.309707  44.180187   
16    False    10  1.105600     -0.807613  ...  142.656605 -17.186213   
17    False    17  1.457746      0.236056  ...    1.291616  18.092403   
18    False     8  0.002342     75.981350  ...   69.266351  -5.020991   
19    False    39 -0.097627      0.154185  ...  196.102283  47.902710   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.029349  0.022509  1854.041215  58672.216250  60526.257465   
1   0.000339  0.000078   547.792060  58337.344063  58885.136123   
2   0.090857  0.085000  1980.374919  58346.186250  60326.561169   
3   0.000106  0.000064  1072.065799  58860.325058  59932.390856   
4   0.000096  0.000085  1079.165984  59149.101169  60228.267153   
5   0.042512  0.039166  1880.896898  58582.479537  60463.376435   
6   0.000204  0.000125  1492.011273  58738.197373  60230.208646   
7   0.075235  0.060104  2234.892037  58303.369491  60538.261528   
8   0.000096  0.000112  1509.919005  58574.488704  60084.407708   
9   0.000149  0.000118   816.855150  58642.417732  59459.272882   
10  0.000105  0.000075    28.883889  59022.479919  59051.363808   
11  0.025586  0.021759  1868.025440  58588.423565  60456.449005   
12  0.000336  0.000072    27.929549  59176.326493  59204.256042   
13  0.000337  0.000108   938.108681  58789.371898  59727.480579   
14  0.000143  0.000118  1782.127407  58435.189016  60217.316424   
15  0.000089  0.000148  1461.054861  58279.308056  59740.362917   
16  0.025546  0.024405   707.084340  60036.232211  60743.316551   
17  0.000065  0.000073  1409.051979  58671.419387  60080.471366   
18  0.000182  0.000140    25.959398  59143.399444  59169.358843   
19  0.000071  0.000058  1800.079479  58276.207523  60076.287002   

        step_id_corr  diffpos reference_change  
0           24.5.2a6    False            False  
1    corr_bulk_0.0.1    False            False  
2              1.1.6    False            False  
3              1.1.6    False            False  
4              1.2.1    False            False  
5             24.5.1    False             True  
6              1.2.1    False            False  
7           24.5.2a6    False             True  
8              1.2.0    False            False  
9   correction_1.0.6    False            False  
10   corr_bulk_0.0.1    False            False  
11            24.4.1     True            False  
12   corr_bulk_0.0.1    False            False  
13             1.1.2    False            False  
14             1.2.1    False            False  
15             1.1.2    False            False  
16            27.4.0    False            False  
17             1.2.0    False            False  
18   corr_bulk_0.0.1    False            False  
19             1.2.0    False            False  

[20 rows x 22 columns]]",,10.342692136764526,2025-05-22T01:30:55,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,gpt-4o,v1,58,10,"
SELECT * 
FROM object
WHERE ndet >= 30
  AND (g_r_max_corr - g_r_mean_corr) > 3.5
  AND deltajd > 20
LIMIT 20
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n']",simple,2.805142879486084,2025-04-29T13:24:55,"[             oid  ndethist  ncovhist  mjdstarthist    mjdendhist  corrected  \
0   ZTF18aalridh       500      2359  58160.500000  60076.250000       True   
1   ZTF20acrbimm       195      1071  58540.250000  59936.250000       True   
2   ZTF19aasbeid       330      2376  58522.500000  59777.250000       True   
3   ZTF19aavmmxj       261      1796  58288.330498  59047.329016       True   
4   ZTF18abeumfv       696      1255  58262.250000  59793.250000       True   
5   ZTF18absanob       181      1882  58258.500000  60136.500000       True   
6   ZTF19aaprchs        88      1215  58582.461713  60473.418901       True   
7   ZTF19aayxsus        32       926  58646.272986  60463.310810       True   
8   ZTF18abqwufy        45      5094  58355.250000  59956.250000       True   
9   ZTF20abpibek       451      1499  58310.500000  59970.250000       True   
10  ZTF18abdcqet        80       178  58289.450220  58390.194039       True   
11  ZTF18aabwfni        31        66  58184.261910  58618.214699       True   
12  ZTF21aabgvmq       187       754  58334.172870  60434.398032       True   
13  ZTF18abfdzyi       119      7573  58244.403819  60465.359954       True   
14  ZTF18aajsbtu        38      3441  58217.500000  60175.250000       True   
15  ZTF19abgfvhx        84      1983  58371.363160  59047.450938      False   
16  ZTF18aanlyhy        35      7398  58244.250000  60175.250000       True   
17  ZTF20acyzlyr        56      1256  58669.468519  59204.195116       True   
18  ZTF18acvwqcv        51      3187  58464.566597  60473.316111       True   
19  ZTF20aazqmgz       376      4006  58541.449016  60445.425544       True   

    stellar  ndet   g_r_max  g_r_max_corr  ...      meanra    meandec  \
0     False    39 -0.097627      0.154185  ...  196.102283  47.902710   
1     False    17  0.116700     77.259544  ...  108.395491 -13.020559   
2     False    57 -0.181302     -0.036919  ...  217.864788  37.360920   
3      True    13  0.312000      0.191707  ...  274.833335  33.674730   
4     False   121  2.302700      2.435917  ...  261.109375 -14.794262   
5     False    28  0.365134      0.512106  ...  312.366693  21.524892   
6     False    25  1.082691      1.165195  ...  292.046023  -9.964730   
7     False    26  1.565830      1.177427  ...  253.680874 -18.636363   
8     False    27  2.162439      0.970297  ...    4.663975  22.524484   
9     False    34  0.142900      0.308984  ...   24.417956  47.160871   
10    False    62  1.278200      0.254166  ...  310.126688  52.090686   
11     True    16  0.679400      0.642209  ...  166.135038  35.205885   
12    False    39  1.538500      1.744872  ...  248.328000  -8.927457   
13    False    52  0.803928      0.402418  ...  258.993864  72.720581   
14    False    10  0.641087      0.775938  ...  250.168331  34.948001   
15    False    13 -0.073601     -0.285009  ...   16.532968  39.256127   
16    False     8  2.029199      0.509884  ...  248.275820  43.438644   
17    False     4  0.532185     76.375240  ...   33.965630  59.662055   
18    False    27  1.344569      0.924490  ...  229.687118   6.746080   
19     True    20  0.603701      0.294412  ...  242.802134  46.713506   

     sigmara  sigmadec      deltajd      firstmjd       lastmjd  \
0   0.000071  0.000058  1800.079479  58276.207523  60076.287002   
1   0.000104  0.000068   793.828426  59142.521968  59936.350394   
2   0.000077  0.000057  1170.795532  58606.400428  59777.195961   
3   0.000046  0.000029   434.884387  58612.444630  59047.329016   
4   0.000041  0.000037  1461.957465  58331.294919  59793.252384   
5   0.000043  0.000046  1775.173449  58361.228241  60136.401690   
6   0.065996  0.065000  1890.957187  58582.461713  60473.418901   
7   0.068597  0.065000  1817.037824  58646.272986  60463.310810   
8   0.000137  0.000125  1597.749942  58358.399028  59956.148970   
9   0.000204  0.000084   939.732708  59030.470637  59970.203345   
10  0.000274  0.000038   100.743820  58289.450220  58390.194039   
11  0.000047  0.000079    83.841713  58534.372986  58618.214699   
12  0.040926  0.040430  1214.838889  59219.559143  60434.398032   
13  0.126343  0.037528  2153.027604  58312.332350  60465.359954   
14  0.000110  0.000067  1846.018148  58329.176192  60175.194340   
15  0.000159  0.000062   372.995845  58674.455093  59047.450938   
16  0.000148  0.000100  1454.032025  58721.160081  60175.192106   
17  0.000316  0.000085    27.868623  59176.326493  59204.195116   
18  0.065453  0.065000  1929.874305  58543.441806  60473.316111   
19  0.041028  0.028131  1106.096493  59339.329051  60445.425544   

       step_id_corr  diffpos reference_change  
0             1.2.0    False            False  
1             1.1.6    False            False  
2               dev     True            False  
3   corr_bulk_0.0.1    False            False  
4               dev    False            False  
5             1.2.0    False             True  
6            24.5.1    False            False  
7            24.5.1    False            False  
8             1.1.6    False             True  
9             1.1.6    False            False  
10  corr_bulk_0.0.1    False            False  
11  corr_bulk_0.0.1    False            False  
12           24.4.1    False            False  
13           24.5.1    False             True  
14            1.2.0    False            False  
15  corr_bulk_0.0.1    False            False  
16            1.2.0    False            False  
17  corr_bulk_0.0.1    False            False  
18           24.5.1    False            False  
19           24.4.1    False            False  

[20 rows x 22 columns]]",,10.03588056564331,2025-05-22T01:31:10,0.0,0.0,1.0,1.0,0.0,1.0
0.16.3,,,78,0,"SELECT
    *
FROM
    taxonomy
WHERE
    classifier_name = 'lc_classifier'",,,,,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,3.2205941677093506,2025-05-22T01:31:14,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,1,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.140097618103028,2025-04-29T13:24:57,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.2790727615356445,2025-05-22T01:31:28,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,2,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.65638279914856,2025-04-29T13:25:00,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.2451581954956055,2025-05-22T01:31:40,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,3,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.57718563079834,2025-04-29T13:25:03,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.511350393295288,2025-05-22T01:31:52,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,4,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.782160997390747,2025-04-29T13:25:06,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.3550803661346436,2025-05-22T01:32:03,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,5,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.38597059249878,2025-04-29T13:25:09,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.358132839202881,2025-05-22T01:32:15,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,6,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.6676831245422363,2025-04-29T13:25:12,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.410905838012695,2025-05-22T01:32:26,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,7,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,3.6202428340911865,2025-04-29T13:25:16,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.458745002746582,2025-05-22T01:32:38,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,8,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.852095365524292,2025-04-29T13:25:19,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.288325071334839,2025-05-22T01:32:50,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,9,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.158719539642334,2025-04-29T13:25:22,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,7.357494354248047,2025-05-22T01:33:01,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,78,10,"
SELECT classifier_name, classifier_version, classes
FROM taxonomy
WHERE classifier_name = 'lc_classifier'
","['\nCREATE TABLE taxonomy (\n    classifier_name VARCHAR PRIMARY KEY, /* name of the taxonomy */\n    classifier_version VARCHAR PRIMARY KEY, /* taxonomy version */\n    classes VARCHAR[] NOT NULL /* classes in the hierarchical form they are computed */\n);\n']",simple,2.232168197631836,2025-04-29T13:25:24,"[  classifier_name                classifier_version  \
0   lc_classifier  hierarchical_random_forest_1.0.0   

                                             classes  
0  [SNIa, SNIbc, SNII, SLSN, QSO, AGN, Blazar, CV...  ]",,10.349831581115723,2025-05-22T01:33:16,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,,,39,0,"SELECT
  sq.oid, sq.meanra, sq.meandec,
  detection.candid, detection.fid as f_id,detection.magpsf, detection.sigmapsf_corr, detection.sigmapsf_corr_ext
FROM
  (
SELECT
    object.oid, object.meanra, object.meandec, object.ndet
FROM
    object INNER JOIN
    probability
    ON object.oid = probability.oid
WHERE
    probability.classifier_name='lc_classifier_stochastic'
    AND probability.class_name='CV/Nova'
    AND probability.ranking = 1
) AS sq
  INNER JOIN detection
  ON sq.oid = detection.oid
WHERE
  sq.ndet < 50
  AND detection.fid = 2
ORDER BY oid
LIMIT 1000
",,,,,"[              oid      meanra    meandec               candid  f_id  \
0    ZTF17aaaaanb  324.816860  45.593583   537475640115015008     2   
1    ZTF17aaaaanb  324.816860  45.593583   607270780115015027     2   
2    ZTF17aaaaanb  324.816860  45.593583   613325340115010003     2   
3    ZTF17aaaaanb  324.816860  45.593583   536383390115015014     2   
4    ZTF17aaaaanb  324.816860  45.593583   529390300115015005     2   
..            ...         ...        ...                  ...   ...   
995  ZTF17aaadgdr  116.399044  32.744831  1496215692515015015     2   
996  ZTF17aaadgdr  116.399044  32.744831  1563162532515010015     2   
997  ZTF17aaadgdr  116.399044  32.744831  1582202532515015009     2   
998  ZTF17aaadgdr  116.399044  32.744831  1563162532515020015     2   
999  ZTF17aaadgdr  116.399044  32.744831  1097435112515015025     2   

        magpsf  sigmapsf_corr  sigmapsf_corr_ext  
0    19.760700       0.021343           0.031418  
1    19.648392       0.026439           0.034795  
2    19.791729       0.025855           0.043814  
3    19.882864       0.022219           0.032339  
4    19.678644     100.000000           0.019559  
..         ...            ...                ...  
995  19.048782     100.000000           0.004847  
996  16.900568       0.001213           0.020301  
997  18.424658     100.000000           0.008501  
998  16.900600       0.001202           0.020300  
999  18.897345     100.000000           0.008676  

[1000 rows x 8 columns]]",,10.865527629852295,2025-05-22T01:33:28,1.0,1.0,1.0,1.0,1.0,1.0
0.16.3,gpt-4o,v1,39,1,"
WITH probability_filter AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND ranking = 1
      AND classifier_name = 'lc_classifier'
),
detection_r_band AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_r_band AS (
    SELECT oid, (magmax_corr - magmin_corr) AS max_rise
    FROM magstat
    WHERE fid = 2
)
SELECT o.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, m.max_rise
FROM object o
INNER JOIN probability_filter p ON o.oid = p.oid
INNER JOIN detection_r_band d ON o.oid = d.oid
INNER JOIN magstat_r_band m ON o.oid = m.oid
WHERE o.ndet <= 50
ORDER BY o.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,3337.5917880535126,2025-04-29T14:21:02,"[              oid               candid          ra        dec  magpsf_corr  \
0    ZTF17aaaeiey  2885158510215015004  330.679508  59.055687    16.763890   
1    ZTF17aaaeiey  2753365990215015010  330.679506  59.055684    16.678577   
2    ZTF17aaaeiey  2750406430215015009  330.679496  59.055695    16.434649   
3    ZTF17aaaeiey  2747369280215015008  330.679514  59.055682    15.784806   
4    ZTF17aaaeiey  2745411680215015016  330.679496  59.055681    15.836052   
..            ...                  ...         ...        ...          ...   
995  ZTF18aahxwvy  1581300174215010001  211.867649  48.355468    16.522566   
996  ZTF18aahxwvy  1652245394215010001  211.867692  48.355587    16.506456   
997  ZTF18aahxwvy  1944374864215010001  211.867574  48.355411    16.511694   
998  ZTF18aajjavp  2480527415915010020  180.032313  35.378450    15.992287   
999  ZTF18aajjavp  2119528765915010042  180.032305  35.378428    16.695684   

        magpsf  max_rise  
0    16.866314  0.000000  
1    16.772915  0.000000  
2    16.509335  0.000000  
3    15.825217  0.000000  
4    15.878455  0.000000  
..         ...       ...  
995  19.503600  2.247822  
996  19.791325  2.247822  
997  19.688694  2.247822  
998  15.988866  2.025394  
999  15.566641  2.025394  

[1000 rows x 7 columns]]",,59.91180968284607,2025-05-22T01:34:34,0.0,0.0,0.375,0.42857142857142855,0.0,0.0
0.16.3,gpt-4o,v1,39,2,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT o.oid
    FROM object o
    INNER JOIN probability_subquery p ON o.oid = p.oid
    WHERE o.ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection d
    INNER JOIN object_subquery o ON d.oid = o.oid
    WHERE d.fid = 2
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    INNER JOIN object_subquery o ON m.oid = o.oid
    WHERE m.fid = 2
),
final_result AS (
    SELECT d.oid, d.candid, d.f_id, d.ra, d.dec, d.magpsf_corr, d.magpsf,
           (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM detection_subquery d
    INNER JOIN magstat_subquery m ON d.oid = m.oid
)
SELECT *
FROM final_result
ORDER BY oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,30.317638874053955,2025-04-29T14:56:11,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   
996  ZTF17aaaddnz  1518206503615015001     2   82.263432  42.077485   
997  ZTF17aaaddnz  1509196183615010017     2   82.263429  42.077311   
998  ZTF17aaaddnz  1187184203615015004     2   82.263398  42.077486   
999  ZTF17aaaddnz   605476743615015034     2   82.263321  42.077453   

     magpsf_corr     magpsf  max_rise  
0      17.878054  19.760700  0.524338  
1      17.857359  19.648392  0.524338  
2      18.342743  19.791729  0.524338  
3      17.898651  19.882864  0.524338  
4      17.863106  19.678644  0.524338  
..           ...        ...       ...  
995    16.820160  18.601990  0.312553  
996    16.943000  19.474024  0.312553  
997    17.132713  19.942310  0.312553  
998    16.846552  18.745659  0.312553  
999    16.895739  19.064772  0.312553  

[1000 rows x 8 columns]]",,245.9127712249756,2025-05-22T01:38:44,0.964,0.971,0.5,0.5,0.0,0.0
0.16.3,gpt-4o,v1,39,3,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_subquery AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, (m.magmax_corr - m.magmin_corr) AS max_rise
FROM probability_subquery p
INNER JOIN object_subquery o ON p.oid = o.oid
INNER JOIN detection_subquery d ON o.oid = d.oid
INNER JOIN magstat_subquery m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.265557765960693,2025-04-29T14:56:32,"[              oid               candid         ra        dec  magpsf_corr  \
0    ZTF17aaaagbn   602505115315010004  86.961817  36.581604    16.853638   
1    ZTF17aaaagbn   702246145315010012  86.961790  36.581644    16.385958   
2    ZTF17aaaagbn   681360755315015646  86.961912  36.581611    16.173563   
3    ZTF17aaaagbn   671426215315010008  86.961799  36.581603    16.408390   
4    ZTF17aaaagbn   615513935315010005  86.961809  36.581595    16.416248   
..            ...                  ...        ...        ...          ...   
995  ZTF17aabgtns  1439277445715015006  81.825653  29.578663          NaN   
996  ZTF17aabgtns   741279895715015027  81.825638  29.578649          NaN   
997  ZTF17aabgtns  1441348515715015004  81.825673  29.578642          NaN   
998  ZTF17aabgtns   615515785715015011  81.825640  29.578652          NaN   
999  ZTF17aabgtns  1079260545715015006  81.825675  29.578558          NaN   

        magpsf  max_rise  
0    17.187000  0.995937  
1    18.616300  0.995937  
2    19.026300  0.995937  
3    18.455600  0.995937  
4    18.405200  0.995937  
..         ...       ...  
995  18.822277       NaN  
996  18.423044       NaN  
997  19.047470       NaN  
998  19.167915       NaN  
999  19.825552       NaN  

[1000 rows x 7 columns]]",,14.54741644859314,2025-05-22T01:39:05,0.107,0.079,0.375,0.42857142857142855,0.0,0.0
0.16.3,gpt-4o,v1,39,4,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
max_rise_subquery AS (
    SELECT oid, MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise
    FROM detection
    WHERE fid = 2
    GROUP BY oid
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, mrs.max_rise
FROM detection_subquery d
JOIN probability_subquery p ON d.oid = p.oid
JOIN object_subquery o ON d.oid = o.oid
JOIN max_rise_subquery mrs ON d.oid = mrs.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,19.52840805053711,2025-04-29T14:56:52,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
max_rise_subquery AS (
    SELECT oid, MAX(magpsf_corr) - MIN(magpsf_corr) AS max_rise
    FROM detection
    WHERE fid = 2
    GROUP BY oid
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, mrs.max_rise
FROM (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection_subquery d
    JOIN probability_subquery p ON d.oid = p.oid
    JOIN object_subquery o ON d.oid = o.oid
) d
JOIN max_rise_subquery mrs ON d.oid = mrs.oid
ORDER BY d.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",251.6445152759552,2025-05-22T01:43:24,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,39,5,"
-- Sub-query to filter objects classified as 'CV/Nova' with the highest probability using 'lc_classifier_stochastic'
WITH cv_nova_objects AS (
    SELECT p.oid
    FROM probability p
    WHERE p.class_name = 'CV/Nova'
      AND p.ranking = 1
      AND p.classifier_name = 'lc_classifier_stochastic'
),

-- Main query to retrieve the required information
result AS (
    SELECT 
        o.oid,
        d.candid,
        d.fid AS f_id,
        d.ra,
        d.dec,
        d.magpsf_corr,
        d.magpsf,
        ms.magmax_corr,
        ms.magmin_corr,
        (ms.magmax_corr - ms.magmin_corr) AS max_rise_from_min
    FROM cv_nova_objects cno
    INNER JOIN object o ON cno.oid = o.oid
    INNER JOIN detection d ON o.oid = d.oid
    INNER JOIN magstat ms ON o.oid = ms.oid AND d.fid = ms.fid
    WHERE o.ndet <= 50
      AND d.fid = 2 -- r-band filter
      AND ms.fid = 2 -- r-band filter
)

-- Final selection and ordering
SELECT *
FROM result
ORDER BY oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,33.05397891998291,2025-04-29T14:57:25,"[              oid               candid  f_id         ra        dec  \
0    ZTF17aaaagbn   602505115315010004     2  86.961817  36.581604   
1    ZTF17aaaagbn   702246145315010012     2  86.961790  36.581644   
2    ZTF17aaaagbn   681360755315015646     2  86.961912  36.581611   
3    ZTF17aaaagbn   671426215315010008     2  86.961799  36.581603   
4    ZTF17aaaagbn   615513935315010005     2  86.961809  36.581595   
..            ...                  ...   ...        ...        ...   
995  ZTF17aabgtns  1439277445715015006     2  81.825653  29.578663   
996  ZTF17aabgtns   741279895715015027     2  81.825638  29.578649   
997  ZTF17aabgtns  1441348515715015004     2  81.825673  29.578642   
998  ZTF17aabgtns   615515785715015011     2  81.825640  29.578652   
999  ZTF17aabgtns  1079260545715015006     2  81.825675  29.578558   

     magpsf_corr     magpsf  magmax_corr  magmin_corr  max_rise_from_min  
0      16.853638  17.187000      17.1861    16.190163           0.995937  
1      16.385958  18.616300      17.1861    16.190163           0.995937  
2      16.173563  19.026300      17.1861    16.190163           0.995937  
3      16.408390  18.455600      17.1861    16.190163           0.995937  
4      16.416248  18.405200      17.1861    16.190163           0.995937  
..           ...        ...          ...          ...                ...  
995          NaN  18.822277          NaN          NaN                NaN  
996          NaN  18.423044          NaN          NaN                NaN  
997          NaN  19.047470          NaN          NaN                NaN  
998          NaN  19.167915          NaN          NaN                NaN  
999          NaN  19.825552          NaN          NaN                NaN  

[1000 rows x 10 columns]]",,11.097996234893799,2025-05-22T01:43:40,0.107,0.079,0.5,0.4,0.0,0.0
0.16.3,gpt-4o,v1,39,6,"
WITH probability_filter AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_filter AS (
    SELECT o.oid
    FROM object o
    INNER JOIN probability_filter pf ON o.oid = pf.oid
    WHERE o.ndet <= 50
),
detection_filter AS (
    SELECT d.oid, d.candid, d.fid, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection d
    INNER JOIN object_filter of ON d.oid = of.oid
    WHERE d.fid = 2
),
magstat_filter AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    INNER JOIN object_filter of ON m.oid = of.oid
    WHERE m.fid = 2
)
SELECT df.oid, df.candid, df.fid AS f_id, df.ra, df.dec, df.magpsf_corr, df.magpsf, 
       (mf.magmax_corr - mf.magmin_corr) AS max_rise_from_min
FROM detection_filter df
INNER JOIN magstat_filter mf ON df.oid = mf.oid
ORDER BY df.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,21.78544569015503,2025-04-29T14:57:47,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   
996  ZTF17aaaddnz  1518206503615015001     2   82.263432  42.077485   
997  ZTF17aaaddnz  1509196183615010017     2   82.263429  42.077311   
998  ZTF17aaaddnz  1187184203615015004     2   82.263398  42.077486   
999  ZTF17aaaddnz   605476743615015034     2   82.263321  42.077453   

     magpsf_corr     magpsf  max_rise_from_min  
0      17.878054  19.760700           0.524338  
1      17.857359  19.648392           0.524338  
2      18.342743  19.791729           0.524338  
3      17.898651  19.882864           0.524338  
4      17.863106  19.678644           0.524338  
..           ...        ...                ...  
995    16.820160  18.601990           0.312553  
996    16.943000  19.474024           0.312553  
997    17.132713  19.942310           0.312553  
998    16.846552  18.745659           0.312553  
999    16.895739  19.064772           0.312553  

[1000 rows x 8 columns]]",,224.47120237350464,2025-05-22T01:47:33,0.964,0.971,0.5,0.5,0.0,0.0
0.16.3,gpt-4o,v1,39,7,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_subquery AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
),
combined_subquery AS (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
           (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM detection_subquery d
    INNER JOIN magstat_subquery m ON d.oid = m.oid
    WHERE d.oid IN (SELECT oid FROM probability_subquery)
      AND d.oid IN (SELECT oid FROM object_subquery)
)
SELECT *
FROM combined_subquery
ORDER BY oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.586743116378784,2025-04-29T14:58:10,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_subquery AS (
    SELECT oid, magmax_corr, magmin_corr
    FROM magstat
    WHERE fid = 2
),
combined_subquery AS (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
           (m.magmax_corr - m.magmin_corr) AS max_rise
    FROM detection_subquery d
    INNER JOIN magstat_subquery m ON d.oid = m.oid
    WHERE d.oid IN (SELECT oid FROM probability_subquery)
      AND d.oid IN (SELECT oid FROM object_subquery)
)
SELECT *
FROM combined_subquery
ORDER BY oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",236.36896896362305,2025-05-22T01:51:34,0.0,0.0,0.0,0.0,0.0,0.0
0.16.3,gpt-4o,v1,39,8,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT oid, candid, ra, dec, magpsf_corr, magpsf
    FROM detection
    WHERE fid = 2
),
magstat_subquery AS (
    SELECT oid, (magmax_corr - magmin_corr) AS max_rise
    FROM magstat
    WHERE fid = 2
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, m.max_rise
FROM detection_subquery d
INNER JOIN probability_subquery p ON d.oid = p.oid
INNER JOIN object_subquery o ON d.oid = o.oid
INNER JOIN magstat_subquery m ON d.oid = m.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,33.03245401382446,2025-04-29T14:58:43,"[              oid               candid         ra        dec  magpsf_corr  \
0    ZTF17aaaagbn   602505115315010004  86.961817  36.581604    16.853638   
1    ZTF17aaaagbn   702246145315010012  86.961790  36.581644    16.385958   
2    ZTF17aaaagbn   681360755315015646  86.961912  36.581611    16.173563   
3    ZTF17aaaagbn   671426215315010008  86.961799  36.581603    16.408390   
4    ZTF17aaaagbn   615513935315010005  86.961809  36.581595    16.416248   
..            ...                  ...        ...        ...          ...   
995  ZTF17aabgtns  1439277445715015006  81.825653  29.578663          NaN   
996  ZTF17aabgtns   741279895715015027  81.825638  29.578649          NaN   
997  ZTF17aabgtns  1441348515715015004  81.825673  29.578642          NaN   
998  ZTF17aabgtns   615515785715015011  81.825640  29.578652          NaN   
999  ZTF17aabgtns  1079260545715015006  81.825675  29.578558          NaN   

        magpsf  max_rise  
0    17.187000  0.995937  
1    18.616300  0.995937  
2    19.026300  0.995937  
3    18.455600  0.995937  
4    18.405200  0.995937  
..         ...       ...  
995  18.822277       NaN  
996  18.423044       NaN  
997  19.047470       NaN  
998  19.167915       NaN  
999  19.825552       NaN  

[1000 rows x 7 columns]]",,13.355972051620483,2025-05-22T01:51:52,0.107,0.079,0.375,0.42857142857142855,0.0,0.0
0.16.3,gpt-4o,v1,39,9,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND ranking = 1
      AND classifier_name = 'lc_classifier_stochastic'
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.fid AS f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr
    FROM detection d
    INNER JOIN object_subquery o ON d.oid = o.oid
    WHERE d.fid = 2
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    INNER JOIN object_subquery o ON m.oid = o.oid
    WHERE m.fid = 2
)
SELECT d.oid, d.candid, d.f_id, d.ra, d.dec, d.magpsf, d.sigmapsf, d.magpsf_corr, 
       (m.magmax_corr - m.magmin_corr) AS max_rise
FROM detection_subquery d
INNER JOIN magstat_subquery m ON d.oid = m.oid
INNER JOIN probability_subquery p ON d.oid = p.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,20.438241958618164,2025-04-29T14:59:04,"[              oid               candid  f_id          ra        dec  \
0    ZTF17aaaaanb   537475640115015008     2  324.816838  45.593586   
1    ZTF17aaaaanb   607270780115015027     2  324.816914  45.593575   
2    ZTF17aaaaanb   613325340115010003     2  324.816873  45.593583   
3    ZTF17aaaaanb   536383390115015014     2  324.816970  45.593631   
4    ZTF17aaaaanb   529390300115015005     2  324.816837  45.593660   
..            ...                  ...   ...         ...        ...   
995  ZTF17aaaddnz  2155389053615015003     2   82.263332  42.077491   
996  ZTF17aaaddnz  1518206503615015001     2   82.263432  42.077485   
997  ZTF17aaaddnz  1509196183615010017     2   82.263429  42.077311   
998  ZTF17aaaddnz  1187184203615015004     2   82.263398  42.077486   
999  ZTF17aaaddnz   605476743615015034     2   82.263321  42.077453   

        magpsf  sigmapsf  magpsf_corr  max_rise  
0    19.760700  0.177926    17.878054  0.524338  
1    19.648392  0.181106    17.857359  0.524338  
2    19.791729  0.166419    18.342743  0.524338  
3    19.882864  0.201099    17.898651  0.524338  
4    19.678644  0.104125    17.863106  0.524338  
..         ...       ...          ...       ...  
995  18.601990  0.070775    16.820160  0.312553  
996  19.474024  0.169525    16.943000  0.312553  
997  19.942310  0.214416    17.132713  0.312553  
998  18.745659  0.105328    16.846552  0.312553  
999  19.064772  0.108142    16.895739  0.312553  

[1000 rows x 9 columns]]",,129.99894833564758,2025-05-22T01:54:11,0.964,0.971,0.5,0.4444444444444444,0.0,0.0
0.16.3,gpt-4o,v1,39,10,"
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection d
    INNER JOIN object_subquery o ON d.oid = o.oid
    WHERE d.fid = 2
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    INNER JOIN object_subquery o ON m.oid = o.oid
    WHERE m.fid = 2
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
       (m.magmax_corr - m.magmin_corr) AS max_rise
FROM detection_subquery d
INNER JOIN magstat_subquery m ON d.oid = m.oid
INNER JOIN probability_subquery p ON d.oid = p.oid
ORDER BY d.oid
LIMIT 1000
","['\nCREATE TABLE object ( /* this is the most important table. It contains the main statistics of an object, independent of time and band */\n    oid VARCHAR PRIMARY KEY,  /* object identifier, from the ZTF */\n    deltajd DOUBLE PRECISION, /* time difference between last and first detection */\n    firstmjd DOUBLE PRECISION, /* time of first detection */\n    lastmjd DOUBLE PRECISION, /* time of last detection */\n    ndethist INTEGER,  /* number of posible detections above 3 sigma */\n    ncovhist INTEGER,  /* number of visits */\n    mjdstarthist DOUBLE PRECISION,  /* time of first observation even if not detected, Earliest Julian date of epoch corresponding to ndethist [days]*/\n    mjdendhist DOUBLE PRECISION, /* time of last observation even if not detected, Latest Julian date of epoch corresponding to ndethist [days] */\n    corrected BOOLEAN, /* whether the object was corrected */\n    stellar BOOLEAN, /* whether the object is likely psf shaped */\n    ndet INTEGER, /* total number of detections for the object */\n    g_r_max DOUBLE PRECISION, /* g-r difference color at maximum */\n    g_r_max_corr DOUBLE PRECISION, /* g-r color at maximum*/\n    g_r_mean DOUBLE PRECISION, /* mean g-r difference color */\n    g_r_mean_corr DOUBLE PRECISION, /* mean g-r color */\n    meanra DOUBLE PRECISION,  /* mean right ascension */\n    meandec DOUBLE PRECISION,  /* mean declination */\n    sigmara DOUBLE PRECISION, /* right ascension dispersion */\n    sigmadec DOUBLE PRECISION, /* declination dispersion */\n    step_id_corr VARCHAR, /* correction step pipeline version */\n    diffpos BOOLEAN, /* whether the first detection was positive or negative */\n    reference_change BOOLEAN /* whether the reference image changes */\n);\nCREATE INDEX ix_object_ndet ON object USING btree (ndet);\nCREATE INDEX ix_object_firstmjd ON object USING btree (firstmjd);\nCREATE INDEX ix_object_g_r_max ON object USING btree (g_r_max);\nCREATE INDEX ix_object_g_r_mean_corr ON object USING btree (g_r_mean_corr);\nCREATE INDEX ix_object_meanra ON object USING btree (meanra);\nCREATE INDEX ix_object_meandec ON object USING btree (meandec);\n', 'CREATE TABLE probability ( /* this table contains the machine learning derived classification probabilities and rankings */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    class_name VARCHAR, /* name of the class */\n    classifier_name VARCHAR, /* name of the classifier */\n    classifier_version VARCHAR, /* version of the classiifer */\n    probability DOUBLE PRECISION NOT NULL, /* probability of the class given a classifier and version */\n    ranking INTEGER NOT NULL, /* class probability ranking (1 is the most likely class) */\n    PRIMARY KEY (oid, class_name, classifier_name, classifier_version)\n);\nCREATE INDEX ix_probabilities_oid ON probability USING hash (oid);\nCREATE INDEX ix_probabilities_probability ON probability USING btree (probability);\nCREATE INDEX ix_probabilities_ranking ON probability USING btree (ranking);\nCREATE INDEX ix_classification_rank1 ON probability USING btree (ranking) WHERE (ranking = 1);\n', 'CREATE TABLE detection (  /* this table contains information about the object detections, or its light curve. Avoid doing filters on this table in any parameter other than oid */\n    candid BIGINT PRIMARY KEY, /* unique candidate identifier */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    mjd DOUBLE PRECISION NOT NULL, /* time of detection in modified julian date */\n    fid INTEGER NOT NULL, /* filter identifier  (1=g; 2=r; 3=i)*/\n    pid FLOAT NOT NULL, /* program identifier */\n    diffmaglim DOUBLE PRECISION, /* limiting difference magnitud */\n    isdiffpos INTEGER NOT NULL, /* whether the difference is positive or negative */\n    nid INTEGER, /* unique night identifier */\n    ra DOUBLE PRECISION NOT NULL, /* inferred right ascension */\n    dec DOUBLE PRECISION NOT NULL, /* inferred declination */\n    magpsf DOUBLE PRECISION NOT NULL, /* point spread function (psf) difference magnitude */\n    sigmapsf DOUBLE PRECISION NOT NULL, /* psf difference magnitude error */\n    magap DOUBLE PRECISION, /* aperture difference magnitude */\n    sigmagap DOUBLE PRECISION, /* aperture difference magnitud error */\n    distnr DOUBLE PRECISION, /* distance to the nearest source in the reference image */\n    rb DOUBLE PRECISION, /* ZTF real bogus score */\n    rbversion VARCHAR, /* version of the ZTF real bogus score */\n    drb DOUBLE PRECISION, /* ZTF deep learning based real bogus score */\n    drbversion VARCHAR, /* versio  of the ZTF deep learning based real bogus score */\n    magapbig DOUBLE PRECISION, /* large aperture magnitude */\n    sigmagapbig DOUBLE PRECISION, /* large aperture magnitude error */\n    rfid INTEGER, /* identifier of the reference image used for the difference image */\n    magpsf_corr DOUBLE PRECISION, /* apparent magnitude (corrected difference magnitude) */\n    sigmapsf_corr DOUBLE PRECISION, /* error of the apparent magnitude assuming point like source */\n    sigmapsf_corr_ext DOUBLE PRECISION, /* error of the apparent magnitude assuming extended source */\n    corrected BOOLEAN NOT NULL, /* whether the object’s magnitude was corrected */\n    dubious BOOLEAN NOT NULL, /* whether the object is dubious or not */\n    parent_candid BIGINT, /* identifier of the candidate where this information was generated (this happens if the given detection does not pass the real bogus filter, but a later detection does */\n    has_stamp BOOLEAN NOT NULL, /* whether the candidate has an associated image stamp (same as before */\n    step_id_corr VARCHAR NOT NULL /* identifier of the correction step */\n);\nCREATE INDEX ix_ndetection_oid ON detection USING hash (oid);\n', 'CREATE TABLE magstat ( /* different statistics for the object divided by band or filter */\n    oid VARCHAR REFERENCES object(oid), /* unique object identifier */\n    fid INTEGER NOT NULL, /* band or filter identifier (1=g; 2=r; 3=i) */\n    stellar BOOLEAN NOT NULL, /* whether we believe the object is stellar */\n    corrected BOOLEAN NOT NULL, /* whether the object’s light curve has been corrected */\n    ndet INTEGER NOT NULL, /* the object number of detection in the given band */\n    ndubious INTEGER NOT NULL, /* the points in the light curve in the given band that we don’t trust  */\n    dmdt_first DOUBLE PRECISION, /* lower limit for the the rate of magnitude change at detection in the given band */\n    dm_first DOUBLE PRECISION, /* change in magnitude with respect to the last non detection at detection in the given band */\n    sigmadm_first DOUBLE PRECISION, /* error in the change of magnitude w.r.t. the last detection in the given band */\n    dt_first DOUBLE PRECISION, /* time between the last non detection and the first detection for the given band */\n    magmean DOUBLE PRECISION, /* mean difference magnitude for the given band */\n    magmedian DOUBLE PRECISION, /* median difference magnitude for the given band */\n    magmax DOUBLE PRECISION, /* maximum difference magnitude for the given band */\n    magmin DOUBLE PRECISION, /* minimum difference magnitude for the given band */\n    magsigma DOUBLE PRECISION, /* dispersion of the difference magnitude for the given band */\n    maglast DOUBLE PRECISION, /* last difference magnitude for the given band */\n    magfirst DOUBLE PRECISION, /* first difference magnitude for the given band */\n    magmean_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    magmedian_corr DOUBLE PRECISION, /* median apparent (corrected) magnitude for the given band */\n    magmax_corr DOUBLE PRECISION, /* maximum apparent (corrected) magnitude for the given band */\n    magmin_corr DOUBLE PRECISION, /* minimum apparent (corrected) magnitude for the given band */\n    magsigma_corr DOUBLE PRECISION, /* dispersion of the apparent (corrected) magnitude for the given band */\n    maglast_corr DOUBLE PRECISION, /* last apparent (corrected) magnitude for the given band */\n    magfirst_corr DOUBLE PRECISION, /* mean apparent (corrected) magnitude for the given band */\n    firstmjd DOUBLE PRECISION, /* time of first detection for the given band */\n    lastmjd DOUBLE PRECISION, /* time of last detection for the given band */\n    step_id_corr VARCHAR NOT NULL, /* correction step id */\n    saturation_rate DOUBLE PRECISION /* saturation level for the given band */\n);\nCREATE INDEX ix_magstats_dmdt_first ON magstat USING btree (dmdt_first);\nCREATE INDEX ix_magstats_firstmjd ON magstat USING btree (firstmjd);\nCREATE INDEX ix_magstats_lastmjd ON magstat USING btree (lastmjd);\nCREATE INDEX ix_magstats_magmean ON magstat USING btree (magmean);\nCREATE INDEX ix_magstats_magmin ON magstat USING btree (magmin);\nCREATE INDEX ix_magstats_magfirst ON magstat USING btree (magfirst);\nCREATE INDEX ix_magstats_ndet ON magstat USING btree (ndet);\nCREATE INDEX ix_magstats_maglast ON magstat USING btree (maglast);\nCREATE INDEX ix_magstats_oid ON magstat USING hash (oid);\n']",advanced,22.59269618988037,2025-04-29T14:59:27,[None],"(psycopg2.errors.QueryCanceled) canceling statement due to statement timeout

[SQL: 
WITH probability_subquery AS (
    SELECT oid
    FROM probability
    WHERE class_name = 'CV/Nova'
      AND classifier_name = 'lc_classifier_stochastic'
      AND ranking = 1
),
object_subquery AS (
    SELECT oid
    FROM object
    WHERE ndet <= 50
),
detection_subquery AS (
    SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf
    FROM detection d
    WHERE d.fid = 2
      AND EXISTS (SELECT 1 FROM object_subquery o WHERE d.oid = o.oid)
),
magstat_subquery AS (
    SELECT m.oid, m.magmax_corr, m.magmin_corr
    FROM magstat m
    WHERE m.fid = 2
      AND EXISTS (SELECT 1 FROM object_subquery o WHERE m.oid = o.oid)
)
SELECT d.oid, d.candid, d.ra, d.dec, d.magpsf_corr, d.magpsf, 
       (m.magmax_corr - m.magmin_corr) AS max_rise
FROM detection_subquery d
INNER JOIN magstat_subquery m ON d.oid = m.oid
INNER JOIN probability_subquery p ON d.oid = p.oid
ORDER BY d.oid
LIMIT 1000
]
(Background on this error at: https://sqlalche.me/e/20/e3q8)",249.8756239414215,2025-05-22T01:58:25,0.0,0.0,0.0,0.0,0.0,0.0
